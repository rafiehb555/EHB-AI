(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[513],{3063:function(e,t,n){e.exports=n(778)},6446:function(e,t){"use strict";t.byteLength=function(e){var t=l(e),n=t[0],r=t[1];return(n+r)*3/4-r},t.toByteArray=function(e){var t,n,i=l(e),o=i[0],a=i[1],u=new s((o+a)*3/4-a),c=0,d=a>0?o-4:o;for(n=0;n<d;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],u[c++]=t>>16&255,u[c++]=t>>8&255,u[c++]=255&t;return 2===a&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,u[c++]=255&t),1===a&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,u[c++]=t>>8&255,u[c++]=255&t),u},t.fromByteArray=function(e){for(var t,r=e.length,s=r%3,i=[],o=0,a=r-s;o<a;o+=16383)i.push(function(e,t,r){for(var s,i=[],o=t;o<r;o+=3)i.push(n[(s=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]))>>18&63]+n[s>>12&63]+n[s>>6&63]+n[63&s]);return i.join("")}(e,o,o+16383>a?a:o+16383));return 1===s?i.push(n[(t=e[r-1])>>2]+n[t<<4&63]+"=="):2===s&&i.push(n[(t=(e[r-2]<<8)+e[r-1])>>10]+n[t>>4&63]+n[t<<2&63]+"="),i.join("")};for(var n=[],r=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,a=i.length;o<a;++o)n[o]=i[o],r[i.charCodeAt(o)]=o;function l(e){var t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");-1===n&&(n=t);var r=n===t?0:4-n%4;return[n,r]}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},5313:function(e,t,n){"use strict";let r=n(6446),s=n(7164),i="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function o(e){if(e>2147483647)throw RangeError('The value "'+e+'" is invalid for option "size"');let t=new Uint8Array(e);return Object.setPrototypeOf(t,a.prototype),t}function a(e,t,n){if("number"==typeof e){if("string"==typeof t)throw TypeError('The "string" argument must be of type string. Received type number');return c(e)}return l(e,t,n)}function l(e,t,n){if("string"==typeof e)return function(e,t){if(("string"!=typeof t||""===t)&&(t="utf8"),!a.isEncoding(t))throw TypeError("Unknown encoding: "+t);let n=0|p(e,t),r=o(n),s=r.write(e,t);return s!==n&&(r=r.slice(0,s)),r}(e,t);if(ArrayBuffer.isView(e))return function(e){if(U(e,Uint8Array)){let t=new Uint8Array(e);return h(t.buffer,t.byteOffset,t.byteLength)}return d(e)}(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(U(e,ArrayBuffer)||e&&U(e.buffer,ArrayBuffer)||"undefined"!=typeof SharedArrayBuffer&&(U(e,SharedArrayBuffer)||e&&U(e.buffer,SharedArrayBuffer)))return h(e,t,n);if("number"==typeof e)throw TypeError('The "value" argument must not be of type number. Received type number');let r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return a.from(r,t,n);let s=function(e){var t;if(a.isBuffer(e)){let t=0|f(e.length),n=o(t);return 0===n.length||e.copy(n,0,0,t),n}return void 0!==e.length?"number"!=typeof e.length||(t=e.length)!=t?o(0):d(e):"Buffer"===e.type&&Array.isArray(e.data)?d(e.data):void 0}(e);if(s)return s;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return a.from(e[Symbol.toPrimitive]("string"),t,n);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function u(e){if("number"!=typeof e)throw TypeError('"size" argument must be of type number');if(e<0)throw RangeError('The value "'+e+'" is invalid for option "size"')}function c(e){return u(e),o(e<0?0:0|f(e))}function d(e){let t=e.length<0?0:0|f(e.length),n=o(t);for(let r=0;r<t;r+=1)n[r]=255&e[r];return n}function h(e,t,n){let r;if(t<0||e.byteLength<t)throw RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),a.prototype),r}function f(e){if(e>=2147483647)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|e}function p(e,t){if(a.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||U(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);let n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;let s=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return P(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return R(e).length;default:if(s)return r?-1:P(e).length;t=(""+t).toLowerCase(),s=!0}}function m(e,t,n){let s=!1;if((void 0===t||t<0)&&(t=0),t>this.length||((void 0===n||n>this.length)&&(n=this.length),n<=0||(n>>>=0)<=(t>>>=0)))return"";for(e||(e="utf8");;)switch(e){case"hex":return function(e,t,n){let r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);let s="";for(let r=t;r<n;++r)s+=$[e[r]];return s}(this,t,n);case"utf8":case"utf-8":return v(this,t,n);case"ascii":return function(e,t,n){let r="";n=Math.min(e.length,n);for(let s=t;s<n;++s)r+=String.fromCharCode(127&e[s]);return r}(this,t,n);case"latin1":case"binary":return function(e,t,n){let r="";n=Math.min(e.length,n);for(let s=t;s<n;++s)r+=String.fromCharCode(e[s]);return r}(this,t,n);case"base64":var i,o;return i=t,o=n,0===i&&o===this.length?r.fromByteArray(this):r.fromByteArray(this.slice(i,o));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(e,t,n){let r=e.slice(t,n),s="";for(let e=0;e<r.length-1;e+=2)s+=String.fromCharCode(r[e]+256*r[e+1]);return s}(this,t,n);default:if(s)throw TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),s=!0}}function g(e,t,n){let r=e[t];e[t]=e[n],e[n]=r}function y(e,t,n,r,s){var i;if(0===e.length)return -1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),(i=n=+n)!=i&&(n=s?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(s)return -1;n=e.length-1}else if(n<0){if(!s)return -1;n=0}if("string"==typeof t&&(t=a.from(t,r)),a.isBuffer(t))return 0===t.length?-1:b(e,t,n,r,s);if("number"==typeof t)return(t&=255,"function"==typeof Uint8Array.prototype.indexOf)?s?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):b(e,[t],n,r,s);throw TypeError("val must be string, number or Buffer")}function b(e,t,n,r,s){let i,o=1,a=e.length,l=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return -1;o=2,a/=2,l/=2,n/=2}function u(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(s){let r=-1;for(i=n;i<a;i++)if(u(e,i)===u(t,-1===r?0:i-r)){if(-1===r&&(r=i),i-r+1===l)return r*o}else -1!==r&&(i-=i-r),r=-1}else for(n+l>a&&(n=a-l),i=n;i>=0;i--){let n=!0;for(let r=0;r<l;r++)if(u(e,i+r)!==u(t,r)){n=!1;break}if(n)return i}return -1}function v(e,t,n){n=Math.min(e.length,n);let r=[],s=t;for(;s<n;){let t=e[s],i=null,o=t>239?4:t>223?3:t>191?2:1;if(s+o<=n){let n,r,a,l;switch(o){case 1:t<128&&(i=t);break;case 2:(192&(n=e[s+1]))==128&&(l=(31&t)<<6|63&n)>127&&(i=l);break;case 3:n=e[s+1],r=e[s+2],(192&n)==128&&(192&r)==128&&(l=(15&t)<<12|(63&n)<<6|63&r)>2047&&(l<55296||l>57343)&&(i=l);break;case 4:n=e[s+1],r=e[s+2],a=e[s+3],(192&n)==128&&(192&r)==128&&(192&a)==128&&(l=(15&t)<<18|(63&n)<<12|(63&r)<<6|63&a)>65535&&l<1114112&&(i=l)}}null===i?(i=65533,o=1):i>65535&&(i-=65536,r.push(i>>>10&1023|55296),i=56320|1023&i),r.push(i),s+=o}return function(e){let t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);let n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=4096));return n}(r)}function _(e,t,n){if(e%1!=0||e<0)throw RangeError("offset is not uint");if(e+t>n)throw RangeError("Trying to access beyond buffer length")}function w(e,t,n,r,s,i){if(!a.isBuffer(e))throw TypeError('"buffer" argument must be a Buffer instance');if(t>s||t<i)throw RangeError('"value" argument is out of bounds');if(n+r>e.length)throw RangeError("Index out of range")}function x(e,t,n,r,s){C(t,r,s,e,n,7);let i=Number(t&BigInt(4294967295));e[n++]=i,i>>=8,e[n++]=i,i>>=8,e[n++]=i,i>>=8,e[n++]=i;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,n}function k(e,t,n,r,s){C(t,r,s,e,n,7);let i=Number(t&BigInt(4294967295));e[n+7]=i,i>>=8,e[n+6]=i,i>>=8,e[n+5]=i,i>>=8,e[n+4]=i;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[n+3]=o,o>>=8,e[n+2]=o,o>>=8,e[n+1]=o,o>>=8,e[n]=o,n+8}function S(e,t,n,r,s,i){if(n+r>e.length||n<0)throw RangeError("Index out of range")}function A(e,t,n,r,i){return t=+t,n>>>=0,i||S(e,t,n,4,34028234663852886e22,-34028234663852886e22),s.write(e,t,n,r,23,4),n+4}function I(e,t,n,r,i){return t=+t,n>>>=0,i||S(e,t,n,8,17976931348623157e292,-17976931348623157e292),s.write(e,t,n,r,52,8),n+8}t.lW=a,t.h2=50,a.TYPED_ARRAY_SUPPORT=function(){try{let e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),a.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}}),a.poolSize=8192,a.from=function(e,t,n){return l(e,t,n)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array),a.alloc=function(e,t,n){return(u(e),e<=0)?o(e):void 0!==t?"string"==typeof n?o(e).fill(t,n):o(e).fill(t):o(e)},a.allocUnsafe=function(e){return c(e)},a.allocUnsafeSlow=function(e){return c(e)},a.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==a.prototype},a.compare=function(e,t){if(U(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),U(t,Uint8Array)&&(t=a.from(t,t.offset,t.byteLength)),!a.isBuffer(e)||!a.isBuffer(t))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let n=e.length,r=t.length;for(let s=0,i=Math.min(n,r);s<i;++s)if(e[s]!==t[s]){n=e[s],r=t[s];break}return n<r?-1:r<n?1:0},a.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(e,t){let n;if(!Array.isArray(e))throw TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return a.alloc(0);if(void 0===t)for(n=0,t=0;n<e.length;++n)t+=e[n].length;let r=a.allocUnsafe(t),s=0;for(n=0;n<e.length;++n){let t=e[n];if(U(t,Uint8Array))s+t.length>r.length?(a.isBuffer(t)||(t=a.from(t)),t.copy(r,s)):Uint8Array.prototype.set.call(r,t,s);else if(a.isBuffer(t))t.copy(r,s);else throw TypeError('"list" argument must be an Array of Buffers');s+=t.length}return r},a.byteLength=p,a.prototype._isBuffer=!0,a.prototype.swap16=function(){let e=this.length;if(e%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)g(this,t,t+1);return this},a.prototype.swap32=function(){let e=this.length;if(e%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},a.prototype.swap64=function(){let e=this.length;if(e%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},a.prototype.toString=function(){let e=this.length;return 0===e?"":0==arguments.length?v(this,0,e):m.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(e){if(!a.isBuffer(e))throw TypeError("Argument must be a Buffer");return this===e||0===a.compare(this,e)},a.prototype.inspect=function(){let e="",n=t.h2;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},i&&(a.prototype[i]=a.prototype.inspect),a.prototype.compare=function(e,t,n,r,s){if(U(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),!a.isBuffer(e))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===s&&(s=this.length),t<0||n>e.length||r<0||s>this.length)throw RangeError("out of range index");if(r>=s&&t>=n)return 0;if(r>=s)return -1;if(t>=n)return 1;if(t>>>=0,n>>>=0,r>>>=0,s>>>=0,this===e)return 0;let i=s-r,o=n-t,l=Math.min(i,o),u=this.slice(r,s),c=e.slice(t,n);for(let e=0;e<l;++e)if(u[e]!==c[e]){i=u[e],o=c[e];break}return i<o?-1:o<i?1:0},a.prototype.includes=function(e,t,n){return -1!==this.indexOf(e,t,n)},a.prototype.indexOf=function(e,t,n){return y(this,e,t,n,!0)},a.prototype.lastIndexOf=function(e,t,n){return y(this,e,t,n,!1)},a.prototype.write=function(e,t,n,r){var s,i,o,a,l,u,c,d;if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else if(isFinite(t))t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let h=this.length-t;if((void 0===n||n>h)&&(n=h),e.length>0&&(n<0||t<0)||t>this.length)throw RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let f=!1;for(;;)switch(r){case"hex":return function(e,t,n,r){let s;n=Number(n)||0;let i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;let o=t.length;for(r>o/2&&(r=o/2),s=0;s<r;++s){let r=parseInt(t.substr(2*s,2),16);if(r!=r)break;e[n+s]=r}return s}(this,e,t,n);case"utf8":case"utf-8":return s=t,i=n,M(P(e,this.length-s),this,s,i);case"ascii":case"latin1":case"binary":return o=t,a=n,M(function(e){let t=[];for(let n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(e),this,o,a);case"base64":return l=t,u=n,M(R(e),this,l,u);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return c=t,d=n,M(function(e,t){let n,r;let s=[];for(let i=0;i<e.length&&!((t-=2)<0);++i)r=(n=e.charCodeAt(i))>>8,s.push(n%256),s.push(r);return s}(e,this.length-c),this,c,d);default:if(f)throw TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),f=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},a.prototype.slice=function(e,t){let n=this.length;e=~~e,t=void 0===t?n:~~t,e<0?(e+=n)<0&&(e=0):e>n&&(e=n),t<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);let r=this.subarray(e,t);return Object.setPrototypeOf(r,a.prototype),r},a.prototype.readUintLE=a.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||_(e,t,this.length);let r=this[e],s=1,i=0;for(;++i<t&&(s*=256);)r+=this[e+i]*s;return r},a.prototype.readUintBE=a.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||_(e,t,this.length);let r=this[e+--t],s=1;for(;t>0&&(s*=256);)r+=this[e+--t]*s;return r},a.prototype.readUint8=a.prototype.readUInt8=function(e,t){return e>>>=0,t||_(e,1,this.length),this[e]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(e,t){return e>>>=0,t||_(e,2,this.length),this[e]|this[e+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(e,t){return e>>>=0,t||_(e,2,this.length),this[e]<<8|this[e+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(e,t){return e>>>=0,t||_(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(e,t){return e>>>=0,t||_(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},a.prototype.readBigUInt64LE=L(function(e){j(e>>>=0,"offset");let t=this[e],n=this[e+7];(void 0===t||void 0===n)&&N(e,this.length-8);let r=t+256*this[++e]+65536*this[++e]+16777216*this[++e],s=this[++e]+256*this[++e]+65536*this[++e]+16777216*n;return BigInt(r)+(BigInt(s)<<BigInt(32))}),a.prototype.readBigUInt64BE=L(function(e){j(e>>>=0,"offset");let t=this[e],n=this[e+7];(void 0===t||void 0===n)&&N(e,this.length-8);let r=16777216*t+65536*this[++e]+256*this[++e]+this[++e],s=16777216*this[++e]+65536*this[++e]+256*this[++e]+n;return(BigInt(r)<<BigInt(32))+BigInt(s)}),a.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||_(e,t,this.length);let r=this[e],s=1,i=0;for(;++i<t&&(s*=256);)r+=this[e+i]*s;return r>=(s*=128)&&(r-=Math.pow(2,8*t)),r},a.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||_(e,t,this.length);let r=t,s=1,i=this[e+--r];for(;r>0&&(s*=256);)i+=this[e+--r]*s;return i>=(s*=128)&&(i-=Math.pow(2,8*t)),i},a.prototype.readInt8=function(e,t){return(e>>>=0,t||_(e,1,this.length),128&this[e])?-((255-this[e]+1)*1):this[e]},a.prototype.readInt16LE=function(e,t){e>>>=0,t||_(e,2,this.length);let n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},a.prototype.readInt16BE=function(e,t){e>>>=0,t||_(e,2,this.length);let n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},a.prototype.readInt32LE=function(e,t){return e>>>=0,t||_(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},a.prototype.readInt32BE=function(e,t){return e>>>=0,t||_(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},a.prototype.readBigInt64LE=L(function(e){j(e>>>=0,"offset");let t=this[e],n=this[e+7];return(void 0===t||void 0===n)&&N(e,this.length-8),(BigInt(this[e+4]+256*this[e+5]+65536*this[e+6]+(n<<24))<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+16777216*this[++e])}),a.prototype.readBigInt64BE=L(function(e){j(e>>>=0,"offset");let t=this[e],n=this[e+7];return(void 0===t||void 0===n)&&N(e,this.length-8),(BigInt((t<<24)+65536*this[++e]+256*this[++e]+this[++e])<<BigInt(32))+BigInt(16777216*this[++e]+65536*this[++e]+256*this[++e]+n)}),a.prototype.readFloatLE=function(e,t){return e>>>=0,t||_(e,4,this.length),s.read(this,e,!0,23,4)},a.prototype.readFloatBE=function(e,t){return e>>>=0,t||_(e,4,this.length),s.read(this,e,!1,23,4)},a.prototype.readDoubleLE=function(e,t){return e>>>=0,t||_(e,8,this.length),s.read(this,e,!0,52,8)},a.prototype.readDoubleBE=function(e,t){return e>>>=0,t||_(e,8,this.length),s.read(this,e,!1,52,8)},a.prototype.writeUintLE=a.prototype.writeUIntLE=function(e,t,n,r){if(e=+e,t>>>=0,n>>>=0,!r){let r=Math.pow(2,8*n)-1;w(this,e,t,n,r,0)}let s=1,i=0;for(this[t]=255&e;++i<n&&(s*=256);)this[t+i]=e/s&255;return t+n},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(e,t,n,r){if(e=+e,t>>>=0,n>>>=0,!r){let r=Math.pow(2,8*n)-1;w(this,e,t,n,r,0)}let s=n-1,i=1;for(this[t+s]=255&e;--s>=0&&(i*=256);)this[t+s]=e/i&255;return t+n},a.prototype.writeUint8=a.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||w(this,e,t,1,255,0),this[t]=255&e,t+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||w(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||w(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||w(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||w(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},a.prototype.writeBigUInt64LE=L(function(e,t=0){return x(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=L(function(e,t=0){return k(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){let r=Math.pow(2,8*n-1);w(this,e,t,n,r-1,-r)}let s=0,i=1,o=0;for(this[t]=255&e;++s<n&&(i*=256);)e<0&&0===o&&0!==this[t+s-1]&&(o=1),this[t+s]=(e/i>>0)-o&255;return t+n},a.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){let r=Math.pow(2,8*n-1);w(this,e,t,n,r-1,-r)}let s=n-1,i=1,o=0;for(this[t+s]=255&e;--s>=0&&(i*=256);)e<0&&0===o&&0!==this[t+s+1]&&(o=1),this[t+s]=(e/i>>0)-o&255;return t+n},a.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||w(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},a.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||w(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},a.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||w(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},a.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||w(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},a.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||w(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},a.prototype.writeBigInt64LE=L(function(e,t=0){return x(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=L(function(e,t=0){return k(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeFloatLE=function(e,t,n){return A(this,e,t,!0,n)},a.prototype.writeFloatBE=function(e,t,n){return A(this,e,t,!1,n)},a.prototype.writeDoubleLE=function(e,t,n){return I(this,e,t,!0,n)},a.prototype.writeDoubleBE=function(e,t,n){return I(this,e,t,!1,n)},a.prototype.copy=function(e,t,n,r){if(!a.isBuffer(e))throw TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n||0===e.length||0===this.length)return 0;if(t<0)throw RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw RangeError("Index out of range");if(r<0)throw RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);let s=r-n;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,r):Uint8Array.prototype.set.call(e,this.subarray(n,r),t),s},a.prototype.fill=function(e,t,n,r){let s;if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw TypeError("encoding must be a string");if("string"==typeof r&&!a.isEncoding(r))throw TypeError("Unknown encoding: "+r);if(1===e.length){let t=e.charCodeAt(0);("utf8"===r&&t<128||"latin1"===r)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw RangeError("Out of range index");if(n<=t)return this;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(s=t;s<n;++s)this[s]=e;else{let i=a.isBuffer(e)?e:a.from(e,r),o=i.length;if(0===o)throw TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<n-t;++s)this[s+t]=i[s%o]}return this};let E={};function T(e,t,n){E[e]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function z(e){let t="",n=e.length,r="-"===e[0]?1:0;for(;n>=r+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function C(e,t,n,r,s,i){if(e>n||e<t){let r;let s="bigint"==typeof t?"n":"";throw r=i>3?0===t||t===BigInt(0)?`>= 0${s} and < 2${s} ** ${(i+1)*8}${s}`:`>= -(2${s} ** ${(i+1)*8-1}${s}) and < 2 ** ${(i+1)*8-1}${s}`:`>= ${t}${s} and <= ${n}${s}`,new E.ERR_OUT_OF_RANGE("value",r,e)}j(s,"offset"),(void 0===r[s]||void 0===r[s+i])&&N(s,r.length-(i+1))}function j(e,t){if("number"!=typeof e)throw new E.ERR_INVALID_ARG_TYPE(t,"number",e)}function N(e,t,n){if(Math.floor(e)!==e)throw j(e,n),new E.ERR_OUT_OF_RANGE(n||"offset","an integer",e);if(t<0)throw new E.ERR_BUFFER_OUT_OF_BOUNDS;throw new E.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${t}`,e)}T("ERR_BUFFER_OUT_OF_BOUNDS",function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),T("ERR_INVALID_ARG_TYPE",function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`},TypeError),T("ERR_OUT_OF_RANGE",function(e,t,n){let r=`The value of "${e}" is out of range.`,s=n;return Number.isInteger(n)&&Math.abs(n)>4294967296?s=z(String(n)):"bigint"==typeof n&&(s=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(s=z(s)),s+="n"),r+=` It must be ${t}. Received ${s}`},RangeError);let O=/[^+/0-9A-Za-z-_]/g;function P(e,t){let n;t=t||1/0;let r=e.length,s=null,i=[];for(let o=0;o<r;++o){if((n=e.charCodeAt(o))>55295&&n<57344){if(!s){if(n>56319||o+1===r){(t-=3)>-1&&i.push(239,191,189);continue}s=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),s=n;continue}n=(s-55296<<10|n-56320)+65536}else s&&(t-=3)>-1&&i.push(239,191,189);if(s=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else if(n<1114112){if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}else throw Error("Invalid code point")}return i}function R(e){return r.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(O,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function M(e,t,n,r){let s;for(s=0;s<r&&!(s+n>=t.length)&&!(s>=e.length);++s)t[s+n]=e[s];return s}function U(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}let $=function(){let e="0123456789abcdef",t=Array(256);for(let n=0;n<16;++n){let r=16*n;for(let s=0;s<16;++s)t[r+s]=e[n]+e[s]}return t}();function L(e){return"undefined"==typeof BigInt?F:e}function F(){throw Error("BigInt not supported")}},2259:function(e,t,n){let r;var s=n(3656);t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;let n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,s=0;t[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(r++,"%c"===e&&(s=r))}),t.splice(s,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")||t.storage.getItem("DEBUG")}catch(e){}return!e&&void 0!==s&&"env"in s&&(e=s.env.DEBUG),e},t.useColors=function(){let e;return"undefined"!=typeof window&&!!window.process&&("renderer"===window.process.type||!!window.process.__nwjs)||!("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&(e=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(e[1],10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(r=!1,()=>{r||(r=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=n(9552)(t);let{formatters:i}=e.exports;i.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},9552:function(e,t,n){e.exports=function(e){function t(e){let n,s,i;let o=null;function a(...e){if(!a.enabled)return;let r=Number(new Date),s=r-(n||r);a.diff=s,a.prev=n,a.curr=r,n=r,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let i=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(n,r)=>{if("%%"===n)return"%";i++;let s=t.formatters[r];if("function"==typeof s){let t=e[i];n=s.call(a,t),e.splice(i,1),i--}return n}),t.formatArgs.call(a,e),(a.log||t.log).apply(a,e)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=r,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==o?o:(s!==t.namespaces&&(s=t.namespaces,i=t.enabled(e)),i),set:e=>{o=e}}),"function"==typeof t.init&&t.init(a),a}function r(e,n){let r=t(this.namespace+(void 0===n?":":n)+e);return r.log=this.log,r}function s(e,t){let n=0,r=0,s=-1,i=0;for(;n<e.length;)if(r<t.length&&(t[r]===e[n]||"*"===t[r]))"*"===t[r]?(s=r,i=n):n++,r++;else{if(-1===s)return!1;r=s+1,n=++i}for(;r<t.length&&"*"===t[r];)r++;return r===t.length}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){let e=[...t.names,...t.skips.map(e=>"-"+e)].join(",");return t.enable(""),e},t.enable=function(e){for(let n of(t.save(e),t.namespaces=e,t.names=[],t.skips=[],("string"==typeof e?e:"").trim().replace(/\s+/g,",").split(",").filter(Boolean)))"-"===n[0]?t.skips.push(n.slice(1)):t.names.push(n)},t.enabled=function(e){for(let n of t.skips)if(s(e,n))return!1;for(let n of t.names)if(s(e,n))return!0;return!1},t.humanize=n(8514),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach(n=>{t[n]=e[n]}),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t)|0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}},7164:function(e,t){t.read=function(e,t,n,r,s){var i,o,a=8*s-r-1,l=(1<<a)-1,u=l>>1,c=-7,d=n?s-1:0,h=n?-1:1,f=e[t+d];for(d+=h,i=f&(1<<-c)-1,f>>=-c,c+=a;c>0;i=256*i+e[t+d],d+=h,c-=8);for(o=i&(1<<-c)-1,i>>=-c,c+=r;c>0;o=256*o+e[t+d],d+=h,c-=8);if(0===i)i=1-u;else{if(i===l)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,r),i-=u}return(f?-1:1)*o*Math.pow(2,i-r)},t.write=function(e,t,n,r,s,i){var o,a,l,u=8*i-s-1,c=(1<<u)-1,d=c>>1,h=23===s?5960464477539062e-23:0,f=r?0:i-1,p=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(isNaN(t=Math.abs(t))||t===1/0?(a=isNaN(t)?1:0,o=c):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),o+d>=1?t+=h/l:t+=h*Math.pow(2,1-d),t*l>=2&&(o++,l/=2),o+d>=c?(a=0,o=c):o+d>=1?(a=(t*l-1)*Math.pow(2,s),o+=d):(a=t*Math.pow(2,d-1)*Math.pow(2,s),o=0));s>=8;e[n+f]=255&a,f+=p,a/=256,s-=8);for(o=o<<s|a,u+=s;u>0;e[n+f]=255&o,f+=p,o/=256,u-=8);e[n+f-p]|=128*m}},8514:function(e){function t(e,t,n,r){return Math.round(e/n)+" "+r+(t>=1.5*n?"s":"")}e.exports=function(e,n){n=n||{};var r,s,i=typeof e;if("string"===i&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*n;case"weeks":case"week":case"w":return 6048e5*n;case"days":case"day":case"d":return 864e5*n;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*n;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*n;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}(e);if("number"===i&&isFinite(e))return n.long?(r=Math.abs(e))>=864e5?t(e,r,864e5,"day"):r>=36e5?t(e,r,36e5,"hour"):r>=6e4?t(e,r,6e4,"minute"):r>=1e3?t(e,r,1e3,"second"):e+" ms":(s=Math.abs(e))>=864e5?Math.round(e/864e5)+"d":s>=36e5?Math.round(e/36e5)+"h":s>=6e4?Math.round(e/6e4)+"m":s>=1e3?Math.round(e/1e3)+"s":e+"ms";throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},9851:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var s=Object.getOwnPropertyDescriptor(t,n);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,s)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.Allow=t.MalformedJSON=t.PartialJSON=t.parseJSON=t.parse=void 0;let i=n(9409);Object.defineProperty(t,"Allow",{enumerable:!0,get:function(){return i.Allow}}),s(n(9409),t);class o extends Error{}t.PartialJSON=o;class a extends Error{}function l(e,t=i.Allow.ALL){if("string"!=typeof e)throw TypeError(`expecting str, got ${typeof e}`);if(!e.trim())throw Error(`${e} is empty`);return u(e.trim(),t)}t.MalformedJSON=a,t.parseJSON=l;let u=(e,t)=>{let n=e.length,r=0,s=e=>{throw new o(`${e} at position ${r}`)},l=e=>{throw new a(`${e} at position ${r}`)},u=()=>(p(),r>=n&&s("Unexpected end of input"),'"'===e[r])?c():"{"===e[r]?d():"["===e[r]?h():"null"===e.substring(r,r+4)||i.Allow.NULL&t&&n-r<4&&"null".startsWith(e.substring(r))?(r+=4,null):"true"===e.substring(r,r+4)||i.Allow.BOOL&t&&n-r<4&&"true".startsWith(e.substring(r))?(r+=4,!0):"false"===e.substring(r,r+5)||i.Allow.BOOL&t&&n-r<5&&"false".startsWith(e.substring(r))?(r+=5,!1):"Infinity"===e.substring(r,r+8)||i.Allow.INFINITY&t&&n-r<8&&"Infinity".startsWith(e.substring(r))?(r+=8,1/0):"-Infinity"===e.substring(r,r+9)||i.Allow._INFINITY&t&&1<n-r&&n-r<9&&"-Infinity".startsWith(e.substring(r))?(r+=9,-1/0):"NaN"===e.substring(r,r+3)||i.Allow.NAN&t&&n-r<3&&"NaN".startsWith(e.substring(r))?(r+=3,NaN):f(),c=()=>{let o=r,a=!1;for(r++;r<n&&('"'!==e[r]||a&&"\\"===e[r-1]);)a="\\"===e[r]&&!a,r++;if('"'==e.charAt(r))try{return JSON.parse(e.substring(o,++r-Number(a)))}catch(e){l(String(e))}else if(i.Allow.STR&t)try{return JSON.parse(e.substring(o,r-Number(a))+'"')}catch(t){return JSON.parse(e.substring(o,e.lastIndexOf("\\"))+'"')}s("Unterminated string literal")},d=()=>{r++,p();let o={};try{for(;"}"!==e[r];){if(p(),r>=n&&i.Allow.OBJ&t)return o;let s=c();p(),r++;try{let e=u();o[s]=e}catch(e){if(i.Allow.OBJ&t)return o;throw e}p(),","===e[r]&&r++}}catch(e){if(i.Allow.OBJ&t)return o;s("Expected '}' at end of object")}return r++,o},h=()=>{r++;let n=[];try{for(;"]"!==e[r];)n.push(u()),p(),","===e[r]&&r++}catch(e){if(i.Allow.ARR&t)return n;s("Expected ']' at end of array")}return r++,n},f=()=>{if(0===r){"-"===e&&l("Not sure what '-' is");try{return JSON.parse(e)}catch(n){if(i.Allow.NUM&t)try{return JSON.parse(e.substring(0,e.lastIndexOf("e")))}catch(e){}l(String(n))}}let o=r;for("-"===e[r]&&r++;e[r]&&-1===",]}".indexOf(e[r]);)r++;r!=n||i.Allow.NUM&t||s("Unterminated number literal");try{return JSON.parse(e.substring(o,r))}catch(t){"-"===e.substring(o,r)&&s("Not sure what '-' is");try{return JSON.parse(e.substring(o,e.lastIndexOf("e")))}catch(e){l(String(e))}}},p=()=>{for(;r<n&&" \n\r	".includes(e[r]);)r++};return u()};t.parse=l},9409:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Allow=t.ALL=t.COLLECTION=t.ATOM=t.SPECIAL=t.INF=t._INFINITY=t.INFINITY=t.NAN=t.BOOL=t.NULL=t.OBJ=t.ARR=t.NUM=t.STR=void 0,t.STR=1,t.NUM=2,t.ARR=4,t.OBJ=8,t.NULL=16,t.BOOL=32,t.NAN=64,t.INFINITY=128,t._INFINITY=256,t.INF=t.INFINITY|t._INFINITY,t.SPECIAL=t.NULL|t.BOOL|t.INF|t.NAN,t.ATOM=t.STR|t.NUM|t.SPECIAL,t.COLLECTION=t.ARR|t.OBJ,t.ALL=t.ATOM|t.COLLECTION,t.Allow={STR:t.STR,NUM:t.NUM,ARR:t.ARR,OBJ:t.OBJ,NULL:t.NULL,BOOL:t.BOOL,NAN:t.NAN,INFINITY:t.INFINITY,_INFINITY:t._INFINITY,INF:t.INF,SPECIAL:t.SPECIAL,ATOM:t.ATOM,COLLECTION:t.COLLECTION,ALL:t.ALL},t.default=t.Allow},3656:function(e){var t,n,r,s=e.exports={};function i(){throw Error("setTimeout has not been defined")}function o(){throw Error("clearTimeout has not been defined")}function a(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var l=[],u=!1,c=-1;function d(){u&&r&&(u=!1,r.length?l=r.concat(l):c=-1,l.length&&h())}function h(){if(!u){var e=a(d);u=!0;for(var t=l.length;t;){for(r=l,l=[];++c<t;)r&&r[c].run();c=-1,t=l.length}r=null,u=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function p(){}s.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new f(e,t)),1!==l.length||u||a(h)},f.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=p,s.addListener=p,s.once=p,s.off=p,s.removeListener=p,s.removeAllListeners=p,s.emit=p,s.prependListener=p,s.prependOnceListener=p,s.listeners=function(e){return[]},s.binding=function(e){throw Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw Error("process.chdir is not supported")},s.umask=function(){return 0}},318:function(e,t,n){"use strict";var r=n(5313).lW;let s=void 0!==r,i=/"(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])"\s*:/,o=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/;function a(e,t,n){null==n&&null!==t&&"object"==typeof t&&(n=t,t=void 0),s&&r.isBuffer(e)&&(e=e.toString()),e&&65279===e.charCodeAt(0)&&(e=e.slice(1));let a=JSON.parse(e,t);if(null===a||"object"!=typeof a)return a;let u=n&&n.protoAction||"error",c=n&&n.constructorAction||"error";if("ignore"===u&&"ignore"===c)return a;if("ignore"!==u&&"ignore"!==c){if(!1===i.test(e)&&!1===o.test(e))return a}else if("ignore"!==u&&"ignore"===c){if(!1===i.test(e))return a}else if(!1===o.test(e))return a;return l(a,{protoAction:u,constructorAction:c,safe:n&&n.safe})}function l(e,{protoAction:t="error",constructorAction:n="error",safe:r}={}){let s=[e];for(;s.length;){let e=s;for(let i of(s=[],e)){if("ignore"!==t&&Object.prototype.hasOwnProperty.call(i,"__proto__")){if(!0===r)return null;if("error"===t)throw SyntaxError("Object contains forbidden prototype property");delete i.__proto__}if("ignore"!==n&&Object.prototype.hasOwnProperty.call(i,"constructor")&&Object.prototype.hasOwnProperty.call(i.constructor,"prototype")){if(!0===r)return null;if("error"===n)throw SyntaxError("Object contains forbidden prototype property");delete i.constructor}for(let e in i){let t=i[e];t&&"object"==typeof t&&s.push(t)}}}return e}function u(e,t,n){let r=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return a(e,t,n)}finally{Error.stackTraceLimit=r}}e.exports=u,e.exports.default=u,e.exports.parse=u,e.exports.safeParse=function(e,t){let n=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return a(e,t,{safe:!0})}catch(e){return null}finally{Error.stackTraceLimit=n}},e.exports.scan=l},8042:function(e,t,n){"use strict";n.d(t,{R:function(){return r}});let r=(0,n(6916).I)({d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z",displayName:"ArrowBackIcon"})},4593:function(e,t,n){"use strict";n.d(t,{r:function(){return r}});let r=(0,n(6916).I)({displayName:"CheckCircleIcon",d:"M12,0A12,12,0,1,0,24,12,12.014,12.014,0,0,0,12,0Zm6.927,8.2-6.845,9.289a1.011,1.011,0,0,1-1.43.188L5.764,13.769a1,1,0,1,1,1.25-1.562l4.076,3.261,6.227-8.451A1,1,0,1,1,18.927,8.2Z"})},7666:function(e,t,n){"use strict";n.d(t,{X:function(){return r}});let r=(0,n(6916).I)({d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z",displayName:"ChevronRightIcon"})},8620:function(e,t,n){"use strict";n.d(t,{d:function(){return s}});var r=n(2676);let s=(0,n(6916).I)({displayName:"EditIcon",path:(0,r.jsxs)("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeWidth:"2",children:[(0,r.jsx)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,r.jsx)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]})})},5892:function(e,t,n){"use strict";n.d(t,{U:function(){return r}});let r=(0,n(6916).I)({d:"M12,0A12,12,0,1,0,24,12,12.013,12.013,0,0,0,12,0Zm0,19a1.5,1.5,0,1,1,1.5-1.5A1.5,1.5,0,0,1,12,19Zm1.6-6.08a1,1,0,0,0-.6.917,1,1,0,1,1-2,0,3,3,0,0,1,1.8-2.75A2,2,0,1,0,10,9.255a1,1,0,1,1-2,0,4,4,0,1,1,5.6,3.666Z",displayName:"QuestionIcon"})},5915:function(e,t,n){"use strict";n.d(t,{n:function(){return s}});var r=n(2676);let s=(0,n(6916).I)({displayName:"RepeatIcon",path:(0,r.jsxs)("g",{fill:"currentColor",children:[(0,r.jsx)("path",{d:"M10.319,4.936a7.239,7.239,0,0,1,7.1,2.252,1.25,1.25,0,1,0,1.872-1.657A9.737,9.737,0,0,0,9.743,2.5,10.269,10.269,0,0,0,2.378,9.61a.249.249,0,0,1-.271.178l-1.033-.13A.491.491,0,0,0,.6,9.877a.5.5,0,0,0-.019.526l2.476,4.342a.5.5,0,0,0,.373.248.43.43,0,0,0,.062,0,.5.5,0,0,0,.359-.152l3.477-3.593a.5.5,0,0,0-.3-.844L5.15,10.172a.25.25,0,0,1-.2-.333A7.7,7.7,0,0,1,10.319,4.936Z"}),(0,r.jsx)("path",{d:"M23.406,14.1a.5.5,0,0,0,.015-.526l-2.5-4.329A.5.5,0,0,0,20.546,9a.489.489,0,0,0-.421.151l-3.456,3.614a.5.5,0,0,0,.3.842l1.848.221a.249.249,0,0,1,.183.117.253.253,0,0,1,.023.216,7.688,7.688,0,0,1-5.369,4.9,7.243,7.243,0,0,1-7.1-2.253,1.25,1.25,0,1,0-1.872,1.656,9.74,9.74,0,0,0,9.549,3.03,10.261,10.261,0,0,0,7.369-7.12.251.251,0,0,1,.27-.179l1.058.127a.422.422,0,0,0,.06,0A.5.5,0,0,0,23.406,14.1Z"})]})})},1843:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});let r=(0,n(6916).I)({d:"M11.983,0a12.206,12.206,0,0,0-8.51,3.653A11.8,11.8,0,0,0,0,12.207,11.779,11.779,0,0,0,11.8,24h.214A12.111,12.111,0,0,0,24,11.791h0A11.766,11.766,0,0,0,11.983,0ZM10.5,16.542a1.476,1.476,0,0,1,1.449-1.53h.027a1.527,1.527,0,0,1,1.523,1.47,1.475,1.475,0,0,1-1.449,1.53h-.027A1.529,1.529,0,0,1,10.5,16.542ZM11,12.5v-6a1,1,0,0,1,2,0v6a1,1,0,1,1-2,0Z",displayName:"WarningIcon"})},9054:function(e,t,n){"use strict";n.d(t,{K:function(){return l}});var r=n(2676),s=n(5558),i=n(3123),o=n(1886),a=n(6205);let l=(0,o.G)(function(e,t){let{getButtonProps:n}=(0,i.bB)(),o=n(e,t),l={display:"flex",alignItems:"center",width:"100%",outline:0,...(0,i.YO)().button};return(0,r.jsx)(a.m.button,{...o,className:(0,s.cx)("chakra-accordion__button",e.className),__css:l})});l.displayName="AccordionButton"},3123:function(e,t,n){"use strict";n.d(t,{YO:function(){return o},_v:function(){return d},bB:function(){return l},di:function(){return u},ec:function(){return a},lh:function(){return i},mc:function(){return h}});var r=n(4242),s=n(5350);let[i,o]=(0,r.k)({name:"AccordionStylesContext",hookName:"useAccordionStyles",providerName:"<Accordion />"}),[a,l]=(0,r.k)({name:"AccordionItemContext",hookName:"useAccordionItemContext",providerName:"<AccordionItem />"}),[u,c,d,h]=(0,s.n)()},1410:function(e,t,n){"use strict";n.d(t,{X:function(){return l}});var r=n(2676),s=n(5558),i=n(3123),o=n(448),a=n(5942);function l(e){let{isOpen:t,isDisabled:n}=(0,i.bB)(),{reduceMotion:l}=(0,o.EF)(),u=(0,s.cx)("chakra-accordion__icon",e.className),c={opacity:n?.4:1,transform:t?"rotate(-180deg)":void 0,transition:l?void 0:"transform 0.2s",transformOrigin:"center",...(0,i.YO)().icon};return(0,r.jsx)(a.J,{viewBox:"0 0 24 24","aria-hidden":!0,className:u,__css:c,...e,children:(0,r.jsx)("path",{fill:"currentColor",d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"})})}l.displayName="AccordionIcon"},7106:function(e,t,n){"use strict";n.d(t,{Q:function(){return d}});var r=n(2676),s=n(4719),i=n(5558),o=n(5271),a=n(3123),l=n(448),u=n(1886),c=n(6205);let d=(0,u.G)(function(e,t){let{children:n,className:u}=e,{htmlProps:d,...h}=(0,l.Zl)(e),f=(0,a.YO)(),p=(0,s.k0)({...f.container,overflowAnchor:"none"}),m=(0,o.useMemo)(()=>h,[h]);return(0,r.jsx)(a.ec,{value:m,children:(0,r.jsx)(c.m.div,{ref:t,...d,className:(0,i.cx)("chakra-accordion__item",u),__css:p,children:"function"==typeof n?n({isExpanded:!!h.isOpen,isDisabled:!!h.isDisabled}):n})})});d.displayName="AccordionItem"},9649:function(e,t,n){"use strict";n.d(t,{H:function(){return b}});var r=n(2676),s=n(5558),i=n(3123),o=n(448),a=n(7470),l=n(6955),u=n(3546),c=n(5271),d=n(3170);let h=e=>null!=e&&parseInt(e.toString(),10)>0,f={exit:{height:{duration:.2,ease:d.Lj.ease},opacity:{duration:.3,ease:d.Lj.ease}},enter:{height:{duration:.3,ease:d.Lj.ease},opacity:{duration:.4,ease:d.Lj.ease}}},p={exit:({animateOpacity:e,startingHeight:t,transition:n,transitionEnd:r,delay:s})=>({...e&&{opacity:h(t)?1:0},height:t,transitionEnd:r?.exit,transition:n?.exit??d.p$.exit(f.exit,s)}),enter:({animateOpacity:e,endingHeight:t,transition:n,transitionEnd:r,delay:s})=>({...e&&{opacity:1},height:t,transitionEnd:r?.enter,transition:n?.enter??d.p$.enter(f.enter,s)})},m=(0,c.forwardRef)((e,t)=>{let{in:n,unmountOnExit:i,animateOpacity:o=!0,startingHeight:d=0,endingHeight:h="auto",style:f,className:m,transition:g,transitionEnd:y,animatePresenceProps:b,...v}=e,[_,w]=(0,c.useState)(!1);(0,c.useEffect)(()=>{let e=setTimeout(()=>{w(!0)});return()=>clearTimeout(e)},[]),(0,a.Z)({condition:Number(d)>0&&!!i,message:"startingHeight and unmountOnExit are mutually exclusive. You can't use them together"});let x=parseFloat(d.toString())>0,k={startingHeight:d,endingHeight:h,animateOpacity:o,transition:_?g:{enter:{duration:0}},transitionEnd:{enter:y?.enter,exit:i?y?.exit:{...y?.exit,display:x?"block":"none"}}},S=!i||n,A=n||i?"enter":"exit";return(0,r.jsx)(l.M,{...b,initial:!1,custom:k,children:S&&(0,r.jsx)(u.E.div,{ref:t,...v,className:(0,s.cx)("chakra-collapse",m),style:{overflow:"hidden",display:"block",...f},custom:k,variants:p,initial:!!i&&"exit",animate:A,exit:"exit"})})});m.displayName="Collapse";var g=n(1886),y=n(6205);let b=(0,g.G)(function(e,t){let{className:n,motionProps:a,...l}=e,{reduceMotion:u}=(0,o.EF)(),{getPanelProps:c,isOpen:d}=(0,i.bB)(),h=c(l,t),f=(0,s.cx)("chakra-accordion__panel",n),p=(0,i.YO)();u||delete h.hidden;let g=(0,r.jsx)(y.m.div,{...h,__css:p.panel,className:f});return u?g:(0,r.jsx)(m,{in:d,...a,children:g})});b.displayName="AccordionPanel"},4023:function(e,t,n){"use strict";n.d(t,{U:function(){return h}});var r=n(2676),s=n(1902),i=n(5558),o=n(5271),a=n(3123),l=n(448),u=n(1886),c=n(3357),d=n(6205);let h=(0,u.G)(function({children:e,reduceMotion:t,...n},u){let h=(0,c.j)("Accordion",n),f=(0,s.L)(n),{htmlProps:p,descendants:m,...g}=(0,l.As)(f),y=(0,o.useMemo)(()=>({...g,reduceMotion:!!t}),[g,t]);return(0,r.jsx)(a.di,{value:m,children:(0,r.jsx)(l.a2,{value:y,children:(0,r.jsx)(a.lh,{value:h,children:(0,r.jsx)(d.m.div,{ref:u,...p,className:(0,i.cx)("chakra-accordion",n.className),__css:h.root,children:e})})})})});h.displayName="Accordion"},448:function(e,t,n){"use strict";n.d(t,{As:function(){return c},EF:function(){return h},Zl:function(){return f},a2:function(){return d}});var r=n(879),s=n(8483),i=n(4242),o=n(5631),a=n(7470),l=n(5271),u=n(3123);function c(e){let{onChange:t,defaultIndex:n,index:s,allowMultiple:i,allowToggle:o,...c}=e;(function(e){let t=e.index||e.defaultIndex,n=null!=t&&!Array.isArray(t)&&e.allowMultiple;(0,a.Z)({condition:!!n,message:`If 'allowMultiple' is passed, then 'index' or 'defaultIndex' must be an array. You passed: ${typeof t},`})})(e),(0,a.Z)({condition:!!(e.allowMultiple&&e.allowToggle),message:"If 'allowMultiple' is passed, 'allowToggle' will be ignored. Either remove 'allowToggle' or 'allowMultiple' depending on whether you want multiple accordions visible or not"});let d=(0,u._v)(),[h,f]=(0,l.useState)(-1);(0,l.useEffect)(()=>()=>{f(-1)},[]);let[p,m]=(0,r.T)({value:s,defaultValue:()=>i?n??[]:n??-1,onChange:t});return{index:p,setIndex:m,htmlProps:c,getAccordionItemProps:e=>{let t=!1;return null!==e&&(t=Array.isArray(p)?p.includes(e):p===e),{isOpen:t,onChange:t=>{null!==e&&(i&&Array.isArray(p)?m(t?p.concat(e):p.filter(t=>t!==e)):t?m(e):o&&m(-1))}}},focusedIndex:h,setFocusedIndex:f,descendants:d}}let[d,h]=(0,i.k)({name:"AccordionContext",hookName:"useAccordionContext",providerName:"Accordion"});function f(e){var t;let{isDisabled:n,isFocusable:r,id:i,...c}=e,{getAccordionItemProps:d,setFocusedIndex:f}=h(),p=(0,l.useRef)(null),m=(0,l.useId)(),g=i??m,y=`accordion-button-${g}`,b=`accordion-panel-${g}`;(0,a.Z)({condition:!!(e.isFocusable&&!e.isDisabled),message:`Using only 'isFocusable', this prop is reserved for situations where you pass 'isDisabled' but you still want the element to receive focus (A11y). Either remove it or pass 'isDisabled' as well.
    `});let{register:v,index:_,descendants:w}=(0,u.mc)({disabled:n&&!r}),{isOpen:x,onChange:k}=d(-1===_?null:_);t={isOpen:x,isDisabled:n},(0,a.Z)({condition:t.isOpen&&!!t.isDisabled,message:"Cannot open a disabled accordion item"});let S=(0,l.useCallback)(()=>{k?.(!x),f(_)},[_,f,x,k]),A=(0,l.useCallback)(e=>{let t={ArrowDown:()=>{let e=w.nextEnabled(_);e?.node.focus()},ArrowUp:()=>{let e=w.prevEnabled(_);e?.node.focus()},Home:()=>{let e=w.firstEnabled();e?.node.focus()},End:()=>{let e=w.lastEnabled();e?.node.focus()}}[e.key];t&&(e.preventDefault(),t(e))},[w,_]),I=(0,l.useCallback)(()=>{f(_)},[f,_]),E=(0,l.useCallback)(function(e={},t=null){return{...e,type:"button",ref:(0,s.lq)(v,p,t),id:y,disabled:!!n,"aria-expanded":!!x,"aria-controls":b,onClick:(0,o.v)(e.onClick,S),onFocus:(0,o.v)(e.onFocus,I),onKeyDown:(0,o.v)(e.onKeyDown,A)}},[y,n,x,S,I,A,b,v]),T=(0,l.useCallback)(function(e={},t=null){return{...e,ref:t,role:"region",id:b,"aria-labelledby":y,hidden:!x}},[y,x,b]);return{isOpen:x,isDisabled:n,isFocusable:r,onOpen:()=>{k?.(!0)},onClose:()=>{k?.(!1)},getButtonProps:E,getPanelProps:T,htmlProps:c}}},2951:function(e,t,n){"use strict";n.d(t,{W:function(){return r},w:function(){return s}});let[r,s]=(0,n(4242).k)({name:"BreadcrumbStylesContext",errorMessage:"useBreadcrumbStyles returned is 'undefined'. Seems you forgot to wrap the components in \"<Breadcrumb />\" "})},9412:function(e,t,n){"use strict";n.d(t,{g:function(){return f}});var r=n(2676),s=n(4719),i=n(1562),o=n(5558),a=n(5271),l=n(2951),u=n(6362),c=n(1886),d=n(6205);let h=(0,c.G)(function(e,t){let{spacing:n,...i}=e,o=(0,l.w)(),a=(0,s.k0)({mx:n,...o.separator});return(0,r.jsx)(d.m.span,{ref:t,role:"presentation",...i,__css:a})});h.displayName="BreadcrumbSeparator";let f=(0,c.G)(function(e,t){let{isCurrentPage:n,separator:c,isLastChild:f,spacing:p,children:m,className:g,...y}=e,b=(0,i.W)(m).map(e=>e.type===u.A?(0,a.cloneElement)(e,{isCurrentPage:n}):e.type===h?(0,a.cloneElement)(e,{spacing:p,children:e.props.children||c}):e),v=(0,l.w)(),_=(0,s.k0)({display:"inline-flex",alignItems:"center",...v.item}),w=(0,o.cx)("chakra-breadcrumb__list-item",g);return(0,r.jsxs)(d.m.li,{ref:t,className:w,...y,__css:_,children:[b,!f&&(0,r.jsx)(h,{spacing:p,children:c})]})});f.displayName="BreadcrumbItem"},6362:function(e,t,n){"use strict";n.d(t,{A:function(){return l}});var r=n(2676),s=n(5558),i=n(2951),o=n(1886),a=n(6205);let l=(0,o.G)(function(e,t){let{isCurrentPage:n,as:o,className:l,href:u,...c}=e,d=(0,i.w)(),h={ref:t,as:o,className:(0,s.cx)("chakra-breadcrumb__link",l),...c};return n?(0,r.jsx)(a.m.span,{"aria-current":"page",__css:d.link,...h}):(0,r.jsx)(a.m.a,{__css:d.link,href:u,...h})});l.displayName="BreadcrumbLink"},657:function(e,t,n){"use strict";n.d(t,{a:function(){return h}});var r=n(2676),s=n(1902),i=n(1562),o=n(5558),a=n(5271),l=n(2951),u=n(1886),c=n(3357),d=n(6205);let h=(0,u.G)(function(e,t){let n=(0,c.j)("Breadcrumb",e),{children:u,spacing:h="0.5rem",separator:f="/",className:p,listProps:m,...g}=(0,s.L)(e),y=(0,i.W)(u),b=y.length,v=y.map((e,t)=>(0,a.cloneElement)(e,{separator:f,spacing:h,isLastChild:b===t+1})),_=(0,o.cx)("chakra-breadcrumb",p);return(0,r.jsx)(d.m.nav,{ref:t,"aria-label":"breadcrumb",className:_,__css:n.container,...g,children:(0,r.jsx)(l.W,{value:n,children:(0,r.jsx)(d.m.ol,{className:"chakra-breadcrumb__list",...m,__css:{display:"flex",alignItems:"center",...n.list},children:v})})})});h.displayName="Breadcrumb"},8951:function(e,t,n){"use strict";n.d(t,{W:function(){return u}});var r=n(2676),s=n(1902),i=n(5558),o=n(1886),a=n(3357),l=n(6205);let u=(0,o.G)(function(e,t){let{className:n,centerContent:o,...u}=(0,s.L)(e),c=(0,a.m)("Container",e);return(0,r.jsx)(l.m.div,{ref:t,className:(0,i.cx)("chakra-container",n),...u,__css:{...c,...o&&{display:"flex",flexDirection:"column",alignItems:"center"}}})});u.displayName="Container"},1342:function(e,t,n){"use strict";n.d(t,{Y:function(){return b}});var r=n(4327),s=n(5631),i=n(2676),o=n(8483),a=n(1902),l=n(4242),u=n(5558),c=n(5271),d=n(1886),h=n(3357),f=n(6205);let[p,m]=(0,l.k)({name:"FormControlStylesContext",errorMessage:"useFormControlStyles returned is 'undefined'. Seems you forgot to wrap the components in \"<FormControl />\" "}),[g,y]=(0,l.k)({strict:!1,name:"FormControlContext"});function b(e){let{isDisabled:t,isInvalid:n,isReadOnly:i,isRequired:o,...a}=function(e){let t=y(),{id:n,disabled:r,readOnly:i,required:o,isRequired:a,isInvalid:l,isReadOnly:u,isDisabled:c,onFocus:d,onBlur:h,...f}=e,p=e["aria-describedby"]?[e["aria-describedby"]]:[];return t?.hasFeedbackText&&t?.isInvalid&&p.push(t.feedbackId),t?.hasHelpText&&p.push(t.helpTextId),{...f,"aria-describedby":p.join(" ")||void 0,id:n??t?.id,isDisabled:r??c??t?.isDisabled,isReadOnly:i??u??t?.isReadOnly,isRequired:o??a??t?.isRequired,isInvalid:l??t?.isInvalid,onFocus:(0,s.v)(t?.onFocus,d),onBlur:(0,s.v)(t?.onBlur,h)}}(e);return{...a,disabled:t,readOnly:i,required:o,"aria-invalid":(0,r.Q)(n),"aria-required":(0,r.Q)(o),"aria-readonly":(0,r.Q)(i)}}(0,d.G)(function(e,t){let n=(0,h.j)("Form",e),{getRootProps:s,htmlProps:l,...d}=function(e){let{id:t,isRequired:n,isInvalid:s,isDisabled:i,isReadOnly:a,...l}=e,u=(0,c.useId)(),d=t||`field-${u}`,h=`${d}-label`,f=`${d}-feedback`,p=`${d}-helptext`,[m,g]=(0,c.useState)(!1),[y,b]=(0,c.useState)(!1),[v,_]=(0,c.useState)(!1),w=(0,c.useCallback)((e={},t=null)=>({id:p,...e,ref:(0,o.lq)(t,e=>{e&&b(!0)})}),[p]),x=(0,c.useCallback)((e={},t=null)=>({...e,ref:t,"data-focus":(0,r.P)(v),"data-disabled":(0,r.P)(i),"data-invalid":(0,r.P)(s),"data-readonly":(0,r.P)(a),id:void 0!==e.id?e.id:h,htmlFor:void 0!==e.htmlFor?e.htmlFor:d}),[d,i,v,s,a,h]),k=(0,c.useCallback)((e={},t=null)=>({id:f,...e,ref:(0,o.lq)(t,e=>{e&&g(!0)}),"aria-live":"polite"}),[f]),S=(0,c.useCallback)((e={},t=null)=>({...e,...l,ref:t,role:"group","data-focus":(0,r.P)(v),"data-disabled":(0,r.P)(i),"data-invalid":(0,r.P)(s),"data-readonly":(0,r.P)(a)}),[l,i,v,s,a]);return{isRequired:!!n,isInvalid:!!s,isReadOnly:!!a,isDisabled:!!i,isFocused:!!v,onFocus:()=>_(!0),onBlur:()=>_(!1),hasFeedbackText:m,setHasFeedbackText:g,hasHelpText:y,setHasHelpText:b,id:d,labelId:h,feedbackId:f,helpTextId:p,htmlProps:l,getHelpTextProps:w,getErrorMessageProps:k,getRootProps:S,getLabelProps:x,getRequiredIndicatorProps:(0,c.useCallback)((e={},t=null)=>({...e,ref:t,role:"presentation","aria-hidden":!0,children:e.children||"*"}),[])}}((0,a.L)(e)),m=(0,u.cx)("chakra-form-control",e.className);return(0,i.jsx)(g,{value:d,children:(0,i.jsx)(p,{value:n,children:(0,i.jsx)(f.m.div,{...s({},t),className:m,__css:n.container})})})}).displayName="FormControl",(0,d.G)(function(e,t){let n=y(),r=m(),s=(0,u.cx)("chakra-form__helper-text",e.className);return(0,i.jsx)(f.m.div,{...n?.getHelpTextProps(e,t),__css:r.helperText,className:s})}).displayName="FormHelperText"},4881:function(e,t,n){"use strict";n.d(t,{Z:function(){return c},x:function(){return d}});var r=n(2676),s=n(5558),i=n(1752),o=n(6205),a=n(1886);let l=(0,o.m)("div",{baseStyle:{display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",top:"0",zIndex:2}}),u=(0,a.G)(function(e,t){let{placement:n="left",...s}=e,o=(0,i.m)(),a=o.field,u={["left"===n?"insetStart":"insetEnd"]:"0",width:a?.height??a?.h,height:a?.height??a?.h,fontSize:a?.fontSize,...o.element};return(0,r.jsx)(l,{ref:t,__css:u,...s})});u.id="InputElement",u.displayName="InputElement";let c=(0,a.G)(function(e,t){let{className:n,...i}=e,o=(0,s.cx)("chakra-input__left-element",n);return(0,r.jsx)(u,{ref:t,placement:"left",className:o,...i})});c.id="InputLeftElement",c.displayName="InputLeftElement";let d=(0,a.G)(function(e,t){let{className:n,...i}=e,o=(0,s.cx)("chakra-input__right-element",n);return(0,r.jsx)(u,{ref:t,placement:"right",className:o,...i})});d.id="InputRightElement",d.displayName="InputRightElement"},1752:function(e,t,n){"use strict";n.d(t,{B:function(){return m},m:function(){return p}});var r=n(2676),s=n(1902),i=n(4242),o=n(5558),a=n(1562),l=n(4558),u=n(5271),c=n(1886),d=n(3357),h=n(6205);let[f,p]=(0,i.k)({name:"InputGroupStylesContext",errorMessage:"useInputGroupStyles returned is 'undefined'. Seems you forgot to wrap the components in \"<InputGroup />\" "}),m=(0,c.G)(function(e,t){let n=(0,d.j)("Input",e),{children:i,className:c,...p}=(0,s.L)(e),m=(0,o.cx)("chakra-input__group",c),g={},y=(0,a.W)(i),b=n.field;y.forEach(e=>{n&&(b&&"InputLeftElement"===e.type.id&&(g.paddingStart=b.height??b.h),b&&"InputRightElement"===e.type.id&&(g.paddingEnd=b.height??b.h),"InputRightAddon"===e.type.id&&(g.borderEndRadius=0),"InputLeftAddon"===e.type.id&&(g.borderStartRadius=0))});let v=y.map(t=>{let n=(0,l.o)({size:t.props?.size||e.size,variant:t.props?.variant||e.variant});return"Input"!==t.type.id?(0,u.cloneElement)(t,n):(0,u.cloneElement)(t,Object.assign(n,g,t.props))});return(0,r.jsx)(h.m.div,{className:m,ref:t,__css:{width:"100%",display:"flex",position:"relative",isolation:"isolate",...n.group},"data-group":!0,...p,children:(0,r.jsx)(f,{value:n,children:v})})});m.displayName="InputGroup"},7590:function(e,t,n){"use strict";n.d(t,{DE:function(){return m},HC:function(){return p},aV:function(){return f}});var r=n(2676),s=n(1902),i=n(4242),o=n(1562),a=n(5942),l=n(1886),u=n(3357),c=n(6205);let[d,h]=(0,i.k)({name:"ListStylesContext",errorMessage:"useListStyles returned is 'undefined'. Seems you forgot to wrap the components in \"<List />\" "}),f=(0,l.G)(function(e,t){let n=(0,u.j)("List",e),{children:i,styleType:a="none",stylePosition:l,spacing:h,...f}=(0,s.L)(e),p=(0,o.W)(i);return(0,r.jsx)(d,{value:n,children:(0,r.jsx)(c.m.ul,{ref:t,listStyleType:a,listStylePosition:l,role:"list",__css:{...n.container,...h?{"& > *:not(style) ~ *:not(style)":{mt:h}}:{}},...f,children:p})})});f.displayName="List",(0,l.G)((e,t)=>{let{as:n,...s}=e;return(0,r.jsx)(f,{ref:t,as:"ol",styleType:"decimal",marginStart:"1em",...s})}).displayName="OrderedList",(0,l.G)(function(e,t){let{as:n,...s}=e;return(0,r.jsx)(f,{ref:t,as:"ul",styleType:"initial",marginStart:"1em",...s})}).displayName="UnorderedList";let p=(0,l.G)(function(e,t){let n=h();return(0,r.jsx)(c.m.li,{ref:t,...e,__css:n.item})});p.displayName="ListItem";let m=(0,l.G)(function(e,t){let n=h();return(0,r.jsx)(a.J,{ref:t,role:"presentation",...e,__css:n.icon})});m.displayName="ListIcon"},7889:function(e,t,n){"use strict";n.d(t,{f:function(){return u}});var r=n(2676),s=n(5558),i=n(5271),o=n(5861),a=n(1886),l=n(6205);let u=(0,a.G)((e,t)=>{let{className:n,...a}=e,{bodyId:u,setBodyMounted:c}=(0,o.vR)();(0,i.useEffect)(()=>(c(!0),()=>c(!1)),[c]);let d=(0,s.cx)("chakra-modal__body",n),h=(0,o.I_)();return(0,r.jsx)(l.m.div,{ref:t,className:d,id:u,...a,__css:h.body})});u.displayName="ModalBody"},92:function(e,t,n){"use strict";n.d(t,{o:function(){return l}});var r=n(2676),s=n(5558),i=n(5631),o=n(5861),a=n(3084);let l=(0,n(1886).G)((e,t)=>{let{onClick:n,className:l,...u}=e,{onClose:c}=(0,o.vR)(),d=(0,s.cx)("chakra-modal__close-btn",l),h=(0,o.I_)();return(0,r.jsx)(a.P,{ref:t,__css:h.closeButton,className:d,onClick:(0,i.v)(n,e=>{e.stopPropagation(),c()}),...u})});l.displayName="ModalCloseButton"},9391:function(e,t,n){"use strict";n.d(t,{h:function(){return tY}});var r,s,i,o,a=n(2676),l=n(4719),u=n(5558),c=n(5861),d=n(8727),h=n(5271),f=function(){return(f=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};function p(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)0>t.indexOf(r[s])&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]]);return n}"function"==typeof SuppressedError&&SuppressedError;var m="right-scroll-bar-position",g="width-before-scroll-bar";function y(e,t){return"function"==typeof e?e(t):e&&(e.current=t),e}var b="undefined"!=typeof window?h.useLayoutEffect:h.useEffect,v=new WeakMap;function _(e,t){var n,r,s,i=(n=t||null,r=function(t){return e.forEach(function(e){return y(e,t)})},(s=(0,h.useState)(function(){return{value:n,callback:r,facade:{get current(){return s.value},set current(value){var e=s.value;e!==value&&(s.value=value,s.callback(value,e))}}}})[0]).callback=r,s.facade);return b(function(){var t=v.get(i);if(t){var n=new Set(t),r=new Set(e),s=i.current;n.forEach(function(e){r.has(e)||y(e,null)}),r.forEach(function(e){n.has(e)||y(e,s)})}v.set(i,e)},[e]),i}function w(e){return e}function x(e,t){void 0===t&&(t=w);var n=[],r=!1;return{read:function(){if(r)throw Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(e){var s=t(e,r);return n.push(s),function(){n=n.filter(function(e){return e!==s})}},assignSyncMedium:function(e){for(r=!0;n.length;){var t=n;n=[],t.forEach(e)}n={push:function(t){return e(t)},filter:function(){return n}}},assignMedium:function(e){r=!0;var t=[];if(n.length){var s=n;n=[],s.forEach(e),t=n}var i=function(){var n=t;t=[],n.forEach(e)},o=function(){return Promise.resolve().then(i)};o(),n={push:function(e){t.push(e),o()},filter:function(e){return t=t.filter(e),n}}}}}function k(e,t){return void 0===t&&(t=w),x(e,t)}function S(e){void 0===e&&(e={});var t=x(null);return t.options=f({async:!0,ssr:!1},e),t}var A=S(),I=function(){},E=h.forwardRef(function(e,t){var n=h.useRef(null),r=h.useState({onScrollCapture:I,onWheelCapture:I,onTouchMoveCapture:I}),s=r[0],i=r[1],o=e.forwardProps,a=e.children,l=e.className,u=e.removeScrollBar,c=e.enabled,d=e.shards,m=e.sideCar,g=e.noRelative,y=e.noIsolation,b=e.inert,v=e.allowPinchZoom,w=e.as,x=e.gapMode,k=p(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),S=_([n,t]),E=f(f({},k),s);return h.createElement(h.Fragment,null,c&&h.createElement(m,{sideCar:A,removeScrollBar:u,shards:d,noRelative:g,noIsolation:y,inert:b,setCallbacks:i,allowPinchZoom:!!v,lockRef:n,gapMode:x}),o?h.cloneElement(h.Children.only(a),f(f({},E),{ref:S})):h.createElement(void 0===w?"div":w,f({},E,{className:l,ref:S}),a))});E.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},E.classNames={fullWidth:g,zeroRight:m};var T=function(e){var t=e.sideCar,n=p(e,["sideCar"]);if(!t)throw Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw Error("Sidecar medium not found");return h.createElement(r,f({},n))};T.isSideCarExport=!0;var z=function(){var e=0,t=null;return{add:function(r){if(0==e&&(t=function(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=o||n.nc;return t&&e.setAttribute("nonce",t),e}())){var s,i;(s=t).styleSheet?s.styleSheet.cssText=r:s.appendChild(document.createTextNode(r)),i=t,(document.head||document.getElementsByTagName("head")[0]).appendChild(i)}e++},remove:function(){--e||!t||(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},C=function(){var e=z();return function(t,n){h.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},j=function(){var e=C();return function(t){return e(t.styles,t.dynamic),null}},N={left:0,top:0,right:0,gap:0},O=function(e){return parseInt(e||"",10)||0},P=function(e){var t=window.getComputedStyle(document.body),n=t["padding"===e?"paddingLeft":"marginLeft"],r=t["padding"===e?"paddingTop":"marginTop"],s=t["padding"===e?"paddingRight":"marginRight"];return[O(n),O(r),O(s)]},R=function(e){if(void 0===e&&(e="margin"),"undefined"==typeof window)return N;var t=P(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},M=j(),U="data-scroll-locked",$=function(e,t,n,r){var s=e.left,i=e.top,o=e.right,a=e.gap;return void 0===n&&(n="margin"),"\n  .".concat("with-scroll-bars-hidden"," {\n   overflow: hidden ").concat(r,";\n   padding-right: ").concat(a,"px ").concat(r,";\n  }\n  body[").concat(U,"] {\n    overflow: hidden ").concat(r,";\n    overscroll-behavior: contain;\n    ").concat([t&&"position: relative ".concat(r,";"),"margin"===n&&"\n    padding-left: ".concat(s,"px;\n    padding-top: ").concat(i,"px;\n    padding-right: ").concat(o,"px;\n    margin-left:0;\n    margin-top:0;\n    margin-right: ").concat(a,"px ").concat(r,";\n    "),"padding"===n&&"padding-right: ".concat(a,"px ").concat(r,";")].filter(Boolean).join(""),"\n  }\n  \n  .").concat(m," {\n    right: ").concat(a,"px ").concat(r,";\n  }\n  \n  .").concat(g," {\n    margin-right: ").concat(a,"px ").concat(r,";\n  }\n  \n  .").concat(m," .").concat(m," {\n    right: 0 ").concat(r,";\n  }\n  \n  .").concat(g," .").concat(g," {\n    margin-right: 0 ").concat(r,";\n  }\n  \n  body[").concat(U,"] {\n    ").concat("--removed-body-scroll-bar-size",": ").concat(a,"px;\n  }\n")},L=function(){var e=parseInt(document.body.getAttribute(U)||"0",10);return isFinite(e)?e:0},F=function(){h.useEffect(function(){return document.body.setAttribute(U,(L()+1).toString()),function(){var e=L()-1;e<=0?document.body.removeAttribute(U):document.body.setAttribute(U,e.toString())}},[])},B=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,s=void 0===r?"margin":r;F();var i=h.useMemo(function(){return R(s)},[s]);return h.createElement(M,{styles:$(i,!t,s,n?"":"!important")})},D=!1;if("undefined"!=typeof window)try{var q=Object.defineProperty({},"passive",{get:function(){return D=!0,!0}});window.addEventListener("test",q,q),window.removeEventListener("test",q,q)}catch(e){D=!1}var V=!!D&&{passive:!1},W=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return"hidden"!==n[t]&&!(n.overflowY===n.overflowX&&"TEXTAREA"!==e.tagName&&"visible"===n[t])},H=function(e,t){var n=t.ownerDocument,r=t;do{if("undefined"!=typeof ShadowRoot&&r instanceof ShadowRoot&&(r=r.host),G(e,r)){var s=Z(e,r);if(s[1]>s[2])return!0}r=r.parentNode}while(r&&r!==n.body);return!1},G=function(e,t){return"v"===e?W(t,"overflowY"):W(t,"overflowX")},Z=function(e,t){return"v"===e?[t.scrollTop,t.scrollHeight,t.clientHeight]:[t.scrollLeft,t.scrollWidth,t.clientWidth]},J=function(e,t,n,r,s){var i,o=(i=window.getComputedStyle(t).direction,"h"===e&&"rtl"===i?-1:1),a=o*r,l=n.target,u=t.contains(l),c=!1,d=a>0,h=0,f=0;do{if(!l)break;var p=Z(e,l),m=p[0],g=p[1]-p[2]-o*m;(m||g)&&G(e,l)&&(h+=g,f+=m);var y=l.parentNode;l=y&&y.nodeType===Node.DOCUMENT_FRAGMENT_NODE?y.host:y}while(!u&&l!==document.body||u&&(t.contains(l)||t===l));return d&&(s&&1>Math.abs(h)||!s&&a>h)?c=!0:!d&&(s&&1>Math.abs(f)||!s&&-a>f)&&(c=!0),c},K=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},X=function(e){return[e.deltaX,e.deltaY]},Y=function(e){return e&&"current"in e?e.current:e},Q=0,ee=[],et=(r=function(e){var t=h.useRef([]),n=h.useRef([0,0]),r=h.useRef(),s=h.useState(Q++)[0],i=h.useState(j)[0],o=h.useRef(e);h.useEffect(function(){o.current=e},[e]),h.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(s));var t=(function(e,t,n){if(n||2==arguments.length)for(var r,s=0,i=t.length;s<i;s++)!r&&s in t||(r||(r=Array.prototype.slice.call(t,0,s)),r[s]=t[s]);return e.concat(r||Array.prototype.slice.call(t))})([e.lockRef.current],(e.shards||[]).map(Y),!0).filter(Boolean);return t.forEach(function(e){return e.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),t.forEach(function(e){return e.classList.remove("allow-interactivity-".concat(s))})}}},[e.inert,e.lockRef.current,e.shards]);var a=h.useCallback(function(e,t){if("touches"in e&&2===e.touches.length||"wheel"===e.type&&e.ctrlKey)return!o.current.allowPinchZoom;var s,i=K(e),a=n.current,l="deltaX"in e?e.deltaX:a[0]-i[0],u="deltaY"in e?e.deltaY:a[1]-i[1],c=e.target,d=Math.abs(l)>Math.abs(u)?"h":"v";if("touches"in e&&"h"===d&&"range"===c.type)return!1;var h=H(d,c);if(!h)return!0;if(h?s=d:(s="v"===d?"h":"v",h=H(d,c)),!h)return!1;if(!r.current&&"changedTouches"in e&&(l||u)&&(r.current=s),!s)return!0;var f=r.current||s;return J(f,t,e,"h"===f?l:u,!0)},[]),l=h.useCallback(function(e){if(ee.length&&ee[ee.length-1]===i){var n="deltaY"in e?X(e):K(e),r=t.current.filter(function(t){var r;return t.name===e.type&&(t.target===e.target||e.target===t.shadowParent)&&(r=t.delta)[0]===n[0]&&r[1]===n[1]})[0];if(r&&r.should){e.cancelable&&e.preventDefault();return}if(!r){var s=(o.current.shards||[]).map(Y).filter(Boolean).filter(function(t){return t.contains(e.target)});(s.length>0?a(e,s[0]):!o.current.noIsolation)&&e.cancelable&&e.preventDefault()}}},[]),u=h.useCallback(function(e,n,r,s){var i={name:e,delta:n,target:r,should:s,shadowParent:function(e){for(var t=null;null!==e;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}(r)};t.current.push(i),setTimeout(function(){t.current=t.current.filter(function(e){return e!==i})},1)},[]),c=h.useCallback(function(e){n.current=K(e),r.current=void 0},[]),d=h.useCallback(function(t){u(t.type,X(t),t.target,a(t,e.lockRef.current))},[]),f=h.useCallback(function(t){u(t.type,K(t),t.target,a(t,e.lockRef.current))},[]);h.useEffect(function(){return ee.push(i),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:f}),document.addEventListener("wheel",l,V),document.addEventListener("touchmove",l,V),document.addEventListener("touchstart",c,V),function(){ee=ee.filter(function(e){return e!==i}),document.removeEventListener("wheel",l,V),document.removeEventListener("touchmove",l,V),document.removeEventListener("touchstart",c,V)}},[]);var p=e.removeScrollBar,m=e.inert;return h.createElement(h.Fragment,null,m?h.createElement(i,{styles:"\n  .block-interactivity-".concat(s," {pointer-events: none;}\n  .allow-interactivity-").concat(s," {pointer-events: all;}\n")}):null,p?h.createElement(B,{noRelative:e.noRelative,gapMode:e.gapMode}):null)},A.useMedium(r),T),en=h.forwardRef(function(e,t){return h.createElement(E,f({},e,{ref:t,sideCar:et}))});en.classNames=E.classNames;var er=n(4149),es=n(1586),ei="data-focus-lock",eo="data-focus-lock-disabled",ea={width:"1px",height:"0px",padding:0,overflow:"hidden",position:"fixed",top:"1px",left:"1px"},el=k({},function(e){return{target:e.target,currentTarget:e.currentTarget}}),eu=k(),ec=k(),ed=S({async:!0,ssr:"undefined"!=typeof document}),eh=(0,h.createContext)(void 0),ef=[],ep=(0,h.forwardRef)(function(e,t){var n,r=(0,h.useState)(),s=r[0],i=r[1],o=(0,h.useRef)(),a=(0,h.useRef)(!1),l=(0,h.useRef)(null),u=(0,h.useState)({})[1],c=e.children,d=e.disabled,f=void 0!==d&&d,p=e.noFocusGuards,m=void 0!==p&&p,g=e.persistentFocus,y=e.crossFrame,b=e.autoFocus,v=(e.allowTextSelection,e.group),w=e.className,x=e.whiteList,k=e.hasPositiveIndices,S=e.shards,A=void 0===S?ef:S,I=e.as,E=e.lockProps,T=e.sideCar,z=e.returnFocus,C=void 0!==z&&z,j=e.focusOptions,N=e.onActivation,O=e.onDeactivation,P=(0,h.useState)({})[0],R=(0,h.useCallback)(function(e){var t=e.captureFocusRestore;if(!l.current){var n,r=null==(n=document)?void 0:n.activeElement;l.current=r,r!==document.body&&(l.current=t(r))}o.current&&N&&N(o.current),a.current=!0,u()},[N]),M=(0,h.useCallback)(function(){a.current=!1,O&&O(o.current),u()},[O]),U=(0,h.useCallback)(function(e){var t=l.current;if(t){var n=("function"==typeof t?t():t)||document.body,r="function"==typeof C?C(n):C;if(r){var s="object"==typeof r?r:void 0;l.current=null,e?Promise.resolve().then(function(){return n.focus(s)}):n.focus(s)}}},[C]),$=(0,h.useCallback)(function(e){a.current&&el.useMedium(e)},[]),L=eu.useMedium,F=(0,h.useCallback)(function(e){o.current!==e&&(o.current=e,i(e))},[]),B=(0,es.Z)(((n={})[eo]=f&&"disabled",n[ei]=v,n),void 0===E?{}:E),D=!0!==m,q=D&&"tail"!==m,V=_([t,F]),W=(0,h.useMemo)(function(){return{observed:o,shards:A,enabled:!f,active:a.current}},[f,a.current,A,s]);return h.createElement(h.Fragment,null,D&&[h.createElement("div",{key:"guard-first","data-focus-guard":!0,tabIndex:f?-1:0,style:ea}),k?h.createElement("div",{key:"guard-nearest","data-focus-guard":!0,tabIndex:f?-1:1,style:ea}):null],!f&&h.createElement(T,{id:P,sideCar:ed,observed:s,disabled:f,persistentFocus:void 0!==g&&g,crossFrame:void 0===y||y,autoFocus:void 0===b||b,whiteList:x,shards:A,onActivation:R,onDeactivation:M,returnFocus:U,focusOptions:j,noFocusGuards:m}),h.createElement(void 0===I?"div":I,(0,es.Z)({ref:V},B,{className:w,onBlur:L,onFocus:$}),h.createElement(eh.Provider,{value:W},c)),q&&h.createElement("div",{"data-focus-guard":!0,tabIndex:f?-1:0,style:ea}))});function em(e,t){return(em=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function eg(e){return(eg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}ep.propTypes={};var ey=function(e){for(var t=Array(e.length),n=0;n<e.length;++n)t[n]=e[n];return t},eb=function(e){return Array.isArray(e)?e:[e]},ev=function(e){return Array.isArray(e)?e[0]:e},e_=function(e){if(e.nodeType!==Node.ELEMENT_NODE)return!1;var t=window.getComputedStyle(e,null);return!!t&&!!t.getPropertyValue&&("none"===t.getPropertyValue("display")||"hidden"===t.getPropertyValue("visibility"))},ew=function(e){return e.parentNode&&e.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE?e.parentNode.host:e.parentNode},ex=function(e){return e===document||e&&e.nodeType===Node.DOCUMENT_NODE},ek=function(e,t){var n,r=e.get(t);if(void 0!==r)return r;var s=(n=ek.bind(void 0,e),!t||ex(t)||!e_(t)&&!t.hasAttribute("inert")&&n(ew(t)));return e.set(t,s),s},eS=function(e,t){var n,r=e.get(t);if(void 0!==r)return r;var s=(n=eS.bind(void 0,e),!t||!!ex(t)||!!eT(t)&&n(ew(t)));return e.set(t,s),s},eA=function(e){return e.dataset},eI=function(e){return"INPUT"===e.tagName},eE=function(e){return eI(e)&&"radio"===e.type},eT=function(e){return![!0,"true",""].includes(e.getAttribute("data-no-autofocus"))},ez=function(e){var t;return!!(e&&(null===(t=eA(e))||void 0===t?void 0:t.focusGuard))},eC=function(e){return!ez(e)},ej=function(e){return!!e},eN=function(e,t){var n=Math.max(0,e.tabIndex),r=Math.max(0,t.tabIndex),s=n-r,i=e.index-t.index;if(s){if(!n)return 1;if(!r)return -1}return s||i},eO=function(e,t,n){return ey(e).map(function(e,t){var r=e.tabIndex<0&&!e.hasAttribute("tabindex")?0:e.tabIndex;return{node:e,index:t,tabIndex:n&&-1===r?(e.dataset||{}).focusGuard?0:-1:r}}).filter(function(e){return!t||e.tabIndex>=0}).sort(eN)},eP="button:enabled,select:enabled,textarea:enabled,input:enabled,a[href],area[href],summary,iframe,object,embed,audio[controls],video[controls],[tabindex],[contenteditable],[autofocus]",eR="".concat(eP,", [data-focus-guard]"),eM=function(e,t){return ey((e.shadowRoot||e).children).reduce(function(e,n){return e.concat(n.matches(t?eR:eP)?[n]:[],eM(n))},[])},eU=function(e,t){var n;return e instanceof HTMLIFrameElement&&(null===(n=e.contentDocument)||void 0===n?void 0:n.body)?e$([e.contentDocument.body],t):[e]},e$=function(e,t){return e.reduce(function(e,n){var r,s=eM(n,t),i=(r=[]).concat.apply(r,s.map(function(e){return eU(e,t)}));return e.concat(i,n.parentNode?ey(n.parentNode.querySelectorAll(eP)).filter(function(e){return e===n}):[])},[])},eL=function(e,t){return ey(e).filter(function(e){return ek(t,e)}).filter(function(e){return!((eI(e)||"BUTTON"===e.tagName)&&("hidden"===e.type||e.disabled))})},eF=function(e,t){return void 0===t&&(t=new Map),ey(e).filter(function(e){return eS(t,e)})},eB=function(e,t,n){return eO(eL(e$(e,n),t),!0,n)},eD=function(e,t){return eO(eL(e$(e),t),!1)},eq=function(e,t){return e.shadowRoot?eq(e.shadowRoot,t):!!(void 0!==Object.getPrototypeOf(e).contains&&Object.getPrototypeOf(e).contains.call(e,t))||ey(e.children).some(function(e){var n;if(e instanceof HTMLIFrameElement){var r=null===(n=e.contentDocument)||void 0===n?void 0:n.body;return!!r&&eq(r,t)}return eq(e,t)})},eV=function(e){try{return e()}catch(e){return}},eW=function(e){if(void 0===e&&(e=document),e&&e.activeElement){var t=e.activeElement;return t.shadowRoot?eW(t.shadowRoot):t instanceof HTMLIFrameElement&&eV(function(){return t.contentWindow.document})?eW(t.contentWindow.document):t}},eH=function(e){void 0===e&&(e=document);var t=eW(e);return!!t&&ey(e.querySelectorAll("[".concat("data-no-focus-lock","]"))).some(function(e){return eq(e,t)})},eG=function(e){for(var t=new Set,n=e.length,r=0;r<n;r+=1)for(var s=r+1;s<n;s+=1){var i=e[r].compareDocumentPosition(e[s]);(i&Node.DOCUMENT_POSITION_CONTAINED_BY)>0&&t.add(s),(i&Node.DOCUMENT_POSITION_CONTAINS)>0&&t.add(r)}return e.filter(function(e,n){return!t.has(n)})},eZ=function(e){return e.parentNode?eZ(e.parentNode):e},eJ=function(e){return eb(e).filter(Boolean).reduce(function(e,t){var n=t.getAttribute(ei);return e.push.apply(e,n?eG(ey(eZ(t).querySelectorAll("[".concat(ei,'="').concat(n,'"]:not([').concat(eo,'="disabled"])')))):[t]),e},[])},eK=function(e,t){return void 0===t&&(t=eW(ev(e).ownerDocument)),!!t&&(!t.dataset||!t.dataset.focusGuard)&&eJ(e).some(function(e){var n;return eq(e,t)||(n=t,!!ey(e.querySelectorAll("iframe")).some(function(e){return e===n}))})},eX=function(e,t){e&&("focus"in e&&e.focus(t),"contentWindow"in e&&e.contentWindow&&e.contentWindow.focus())},eY=function(e,t){return eE(e)&&e.name&&t.filter(eE).filter(function(t){return t.name===e.name}).filter(function(e){return e.checked})[0]||e},eQ=function(e){var t=new Set;return e.forEach(function(n){return t.add(eY(n,e))}),e.filter(function(e){return t.has(e)})},e0=function(e){return e[0]&&e.length>1?eY(e[0],e):e[0]},e1=function(e,t){return e.indexOf(eY(t,e))},e2="NEW_FOCUS",e6=function(e,t,n,r,s){var i=e.length,o=e[0],a=e[i-1],l=ez(r);if(!(r&&e.indexOf(r)>=0)){var u=void 0!==r?n.indexOf(r):-1,c=s?n.indexOf(s):u,d=s?e.indexOf(s):-1;if(-1===u)return -1!==d?d:e2;if(-1===d)return e2;var h=u-c,f=n.indexOf(o),p=n.indexOf(a),m=eQ(n),g=void 0!==r?m.indexOf(r):-1,y=s?m.indexOf(s):g,b=m.filter(function(e){return e.tabIndex>=0}),v=void 0!==r?b.indexOf(r):-1,_=s?b.indexOf(s):v;if(!h&&d>=0||0===t.length)return d;var w=e1(e,t[0]),x=e1(e,t[t.length-1]);if(u<=f&&l&&Math.abs(h)>1)return x;if(u>=p&&l&&Math.abs(h)>1)return w;if(h&&Math.abs(v>=0&&_>=0?_-v:y-g)>1)return d;if(u<=f)return x;if(u>p)return w;if(h)return Math.abs(h)>1?d:(i+d+h)%i}},e3=function(e,t,n){var r=eF(e.map(function(e){return e.node}).filter(function(e){var t,r=null===(t=eA(e))||void 0===t?void 0:t.autofocus;return e.autofocus||void 0!==r&&"false"!==r||n.indexOf(e)>=0}));return r&&r.length?e0(r):e0(eF(t))},e4=function(e,t){return void 0===t&&(t=[]),t.push(e),e.parentNode&&e4(e.parentNode.host||e.parentNode,t),t},e5=function(e,t){for(var n=e4(e),r=e4(t),s=0;s<n.length;s+=1){var i=n[s];if(r.indexOf(i)>=0)return i}return!1},e8=function(e,t,n){var r=eb(e),s=eb(t),i=r[0],o=!1;return s.filter(Boolean).forEach(function(e){o=e5(o||e,e)||o,n.filter(Boolean).forEach(function(e){var t=e5(i,e);t&&(o=!o||eq(t,o)?t:e5(t,o))})}),o},e9=function(e,t){return e.reduce(function(e,n){return e.concat(eL(ey(n.querySelectorAll("[".concat("data-autofocus-inside","]"))).map(function(e){return e$([e])}).reduce(function(e,t){return e.concat(t)},[]),t))},[])},e7=function(e,t){var n=new Map;return t.forEach(function(e){return n.set(e.node,e)}),e.map(function(e){return n.get(e)}).filter(ej)},te=function(e,t){var n=eW(eb(e).length>0?document:ev(e).ownerDocument),r=eJ(e).filter(eC),s=e8(n||e,e,r),i=new Map,o=eD(r,i),a=o.filter(function(e){return eC(e.node)});if(a[0]){var l=eD([s],i).map(function(e){return e.node}),u=e7(l,a),c=u.map(function(e){return e.node}),d=u.filter(function(e){return e.tabIndex>=0}).map(function(e){return e.node}),h=e6(c,d,l,n,t);if(h===e2){var f=e3(o,d,e9(r,i))||e3(o,c,e9(r,i));return f?{node:f}:void console.warn("focus-lock: cannot find any node to move focus into")}return void 0===h?h:u[h]}},tt=0,tn=!1,tr=function(e,t,n){void 0===n&&(n={});var r=te(e,t);if(!tn&&r){if(tt>2){console.error("FocusLock: focus-fighting detected. Only one focus management system could be active. See https://github.com/theKashey/focus-lock/#focus-fighting"),tn=!0,setTimeout(function(){tn=!1},1);return}tt++,eX(r.node,n.focusOptions),tt--}};function ts(e){if(!e)return null;if("undefined"==typeof WeakRef)return function(){return e||null};var t=e?new WeakRef(e):null;return function(){return(null==t?void 0:t.deref())||null}}var ti=function(e){if(!e)return null;for(var t=[],n=e;n&&n!==document.body;)t.push({current:ts(n),parent:ts(n.parentElement),left:ts(n.previousElementSibling),right:ts(n.nextElementSibling)}),n=n.parentElement;return{element:ts(e),stack:t,ownerDocument:e.ownerDocument}},to=function(e){if(e)for(var t,n,r,s,i,o=e.stack,a=e.ownerDocument,l=new Map,u=0;u<o.length;u++){var c=o[u],d=null===(t=c.parent)||void 0===t?void 0:t.call(c);if(d&&a.contains(d)){for(var h=null===(n=c.left)||void 0===n?void 0:n.call(c),f=c.current(),p=d.contains(f)?f:void 0,m=null===(r=c.right)||void 0===r?void 0:r.call(c),g=eB([d],l),y=null!==(i=null!==(s=null!=p?p:null==h?void 0:h.nextElementSibling)&&void 0!==s?s:m)&&void 0!==i?i:h;y;){for(var b=0;b<g.length;b++){var v=g[b];if(null==y?void 0:y.contains(v.node))return v.node}y=y.nextElementSibling}if(g.length)return g[0].node}}},ta=function(e){var t=ti(e);return function(){return to(t)}},tl=function(e){var t=eJ(e).filter(eC),n=eO(e$([e8(e,e,t)],!0),!0,!0),r=e$(t,!1);return n.map(function(e){var t=e.node;return{node:t,index:e.index,lockItem:r.indexOf(t)>=0,guard:ez(t)}})},tu=function(e,t,n){if(!e||!t)return console.error("no element or scope given"),{};var r=eb(t);if(r.every(function(t){return!eq(t,e)}))return console.error("Active element is not contained in the scope"),{};var s=n?eB(r,new Map):eD(r,new Map),i=s.findIndex(function(t){return t.node===e});if(-1!==i)return{prev:s[i-1],next:s[i+1],first:s[0],last:s[s.length-1]}},tc=function(e,t){var n=t?eB(eb(e),new Map):eD(eb(e),new Map);return{first:n[0],last:n[n.length-1]}},td=function(e,t,n){void 0===t&&(t={});var r,s=(r=t,Object.assign({scope:document.body,cycle:!0,onlyTabbable:!0},r)),i=tu(e,s.scope,s.onlyTabbable);if(i){var o=n(i,s.cycle);o&&eX(o.node,s.focusOptions)}},th=function(e,t,n){var r,s=tc(e,null===(r=t.onlyTabbable)||void 0===r||r)[n];s&&eX(s.node,t.focusOptions)};function tf(e){setTimeout(e,1)}var tp=function(e){return e&&"current"in e?e.current:e},tm=function(){return document&&document.activeElement===document.body},tg=null,ty=null,tb=function(){return null},tv=null,t_=!1,tw=!1,tx=function(e,t){tv={observerNode:e,portaledElement:t}};function tk(e,t,n,r){var s=null,i=e;do{var o=r[i];if(o.guard)o.node.dataset.focusAutoGuard&&(s=o);else if(o.lockItem){if(i!==e)return;s=null}else break}while((i+=n)!==t);s&&(s.node.tabIndex=0)}var tS=function(e){return eD(e,new Map)},tA=function(){var e=!1;if(tg){var t=tg,n=t.observed,r=t.persistentFocus,s=t.autoFocus,i=t.shards,o=t.crossFrame,a=t.focusOptions,l=t.noFocusGuards,u=n||tv&&tv.portaledElement;if(tm()&&ty&&ty!==document.body&&(!document.body.contains(ty)||!tS([(h=ty).parentNode]).some(function(e){return e.node===h}))){var c=tb();c&&c.focus()}var d=document&&document.activeElement;if(u){var h,f=[u].concat(i.map(tp).filter(Boolean));if((!d||(tg.whiteList||function(){return!0})(d))&&(r||function(){if(!(o?!!t_:"meanwhile"===t_)||!l||!ty||tw)return!1;var e=tS(f),t=e.findIndex(function(e){return e.node===ty});return 0===t||t===e.length-1}()||!(tm()||eH())||!ty&&s)&&(u&&!(eK(f)||d&&f.some(function(e){return function e(t,n,r){return n&&(n.host===t&&(!n.activeElement||r.contains(n.activeElement))||n.parentNode&&e(t,n.parentNode,r))}(d,e,e)})||tv&&tv.portaledElement===d)&&(document&&!ty&&d&&!s?(d.blur&&d.blur(),document.body.focus()):(e=tr(f,ty,{focusOptions:a}),tv={})),(ty=document&&document.activeElement)!==document.body&&(tb=ta(ty)),t_=!1),document&&d!==document.activeElement&&document.querySelector("[data-focus-auto-guard]")){var p=document&&document.activeElement,m=tl(f),g=m.map(function(e){return e.node}).indexOf(p);g>-1&&(m.filter(function(e){var t=e.guard,n=e.node;return t&&n.dataset.focusAutoGuard}).forEach(function(e){return e.node.removeAttribute("tabIndex")}),tk(g,m.length,1,m),tk(g,-1,-1,m))}}}return e},tI=function(e){tA()&&e&&(e.stopPropagation(),e.preventDefault())},tE=function(){return tf(tA)},tT=function(){tw=!0},tz=function(){tw=!1,t_="just",tf(function(){t_="meanwhile"})},tC=function(){document.addEventListener("focusin",tI),document.addEventListener("focusout",tE),window.addEventListener("focus",tT),window.addEventListener("blur",tz)},tj=function(){document.removeEventListener("focusin",tI),document.removeEventListener("focusout",tE),window.removeEventListener("focus",tT),window.removeEventListener("blur",tz)},tN={moveFocusInside:tr,focusInside:eK,focusNextElement:function(e,t){void 0===t&&(t={}),td(e,t,function(e,t){var n=e.next,r=e.first;return n||t&&r})},focusPrevElement:function(e,t){void 0===t&&(t={}),td(e,t,function(e,t){var n=e.prev,r=e.last;return n||t&&r})},focusFirstElement:function(e,t){void 0===t&&(t={}),th(e,t,"first")},focusLastElement:function(e,t){void 0===t&&(t={}),th(e,t,"last")},captureFocusRestore:ta};el.assignSyncMedium(function(e){var t=e.target,n=e.currentTarget;n.contains(t)||tx(n,t)}),eu.assignMedium(tE),ec.assignMedium(function(e){return e(tN)});var tO=(s=function(e){return e.filter(function(e){return!e.disabled})},i=function(e){var t=e.slice(-1)[0];t&&!tg&&tC();var n=tg,r=n&&t&&t.id===n.id;tg=t,!n||r||(n.onDeactivation(),e.filter(function(e){return e.id===n.id}).length||n.returnFocus(!t)),t?(ty=null,r&&n.observed===t.observed||t.onActivation(tN),tA(!0),tf(tA)):(tj(),ty=null)},function(e){var t,n,r,o,a=[];function l(){i(o=s(a.map(function(e){return e.props})))}var u=function(t){function n(){return t.apply(this,arguments)||this}n.prototype=Object.create(t.prototype),n.prototype.constructor=n,em(n,t),n.peek=function(){return o};var r=n.prototype;return r.componentDidMount=function(){a.push(this),l()},r.componentDidUpdate=function(){l()},r.componentWillUnmount=function(){var e=a.indexOf(this);a.splice(e,1),l()},r.render=function(){return h.createElement(e,this.props)},n}(h.PureComponent);return t="displayName",n="SideEffect("+(e.displayName||e.name||"Component")+")",(r=function(e,t){if("object"!=eg(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=eg(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==eg(r)?r:r+"")in u)?Object.defineProperty(u,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):u[t]=n,u})(function(){return null}),tP=(0,h.forwardRef)(function(e,t){return h.createElement(ep,(0,es.Z)({sideCar:tO,ref:t},e))}),tR=ep.propTypes||{};tR.sideCar,function(e,t){if(null!=e){var n={};for(var r in e)if(({}).hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}}}(tR,["sideCar"]),tP.propTypes={};var tM=n(9670);let tU=e=>e.hasAttribute("tabindex"),t$=e=>e.offsetWidth>0&&e.offsetHeight>0,tL=tP.default??tP,tF=e=>{let{initialFocusRef:t,finalFocusRef:n,contentRef:r,restoreFocus:s,children:i,isDisabled:o,autoFocus:l,persistentFocus:u,lockFocusAcrossFrames:c}=e,d=(0,h.useCallback)(()=>{t?.current?t.current.focus():r?.current&&0===function(e){let t=Array.from(e.querySelectorAll("input:not(:disabled):not([disabled]),select:not(:disabled):not([disabled]),textarea:not(:disabled):not([disabled]),embed,iframe,object,a[href],area[href],button:not(:disabled):not([disabled]),[tabindex],audio[controls],video[controls],*[tabindex]:not([aria-disabled]),*[contenteditable]"));return t.unshift(e),t.filter(e=>(function(e){if(!(0,tM.Re)(e)||(0,tM.oI)(e)||(0,tM.nV)(e))return!1;let{localName:t}=e;if(["input","select","textarea","button"].indexOf(t)>=0)return!0;let n={a:()=>e.hasAttribute("href"),audio:()=>e.hasAttribute("controls"),video:()=>e.hasAttribute("controls")};return t in n?n[t]():!!(0,tM.iU)(e)||tU(e)})(e)&&t$(e))}(r.current).length&&requestAnimationFrame(()=>{r.current?.focus()})},[t,r]),f=(0,h.useCallback)(()=>{n?.current?.focus()},[n]),p=s&&!n;return(0,a.jsx)(tL,{crossFrame:c,persistentFocus:u,autoFocus:l,disabled:o,onActivation:d,onDeactivation:f,returnFocus:p,children:i})};function tB(e){let{autoFocus:t,trapFocus:n,dialogRef:r,initialFocusRef:s,blockScrollOnMount:i,allowPinchZoom:o,finalFocusRef:l,returnFocusOnClose:u,preserveScrollBarGap:f,lockFocusAcrossFrames:p,isOpen:m}=(0,c.vR)(),[g,y]=(0,d.oO)();(0,h.useEffect)(()=>{!g&&y&&setTimeout(y)},[g,y]);let b=(0,er.$)(r,m);return(0,a.jsx)(tF,{autoFocus:t,isDisabled:!n,initialFocusRef:s,finalFocusRef:l,restoreFocus:u,contentRef:r,lockFocusAcrossFrames:p,children:(0,a.jsx)(en,{removeScrollBar:!f,allowPinchZoom:o,enabled:1===b&&i,forwardProps:!0,children:e.children})})}tF.displayName="FocusLock";var tD=n(3546),tq=n(6955),tV=n(3170);let tW={initial:"initial",animate:"enter",exit:"exit",variants:{initial:({offsetX:e,offsetY:t,transition:n,transitionEnd:r,delay:s})=>({opacity:0,x:e,y:t,transition:n?.exit??tV.p$.exit(tV.Sh.exit,s),transitionEnd:r?.exit}),enter:({transition:e,transitionEnd:t,delay:n})=>({opacity:1,x:0,y:0,transition:e?.enter??tV.p$.enter(tV.Sh.enter,n),transitionEnd:t?.enter}),exit:({offsetY:e,offsetX:t,transition:n,transitionEnd:r,reverse:s,delay:i})=>{let o={x:t,y:e};return{opacity:0,transition:n?.exit??tV.p$.exit(tV.Sh.exit,i),...s?{...o,transitionEnd:r?.exit}:{transitionEnd:{...o,...r?.exit}}}}}};(0,h.forwardRef)(function(e,t){let{unmountOnExit:n,in:r,reverse:s=!0,className:i,offsetX:o=0,offsetY:l=8,transition:c,transitionEnd:d,delay:h,animatePresenceProps:f,...p}=e,m=!n||r&&n,g=r||n?"enter":"exit",y={offsetX:o,offsetY:l,reverse:s,transition:c,transitionEnd:d,delay:h};return(0,a.jsx)(tq.M,{...f,custom:y,children:m&&(0,a.jsx)(tD.E.div,{ref:t,className:(0,u.cx)("chakra-offset-slide",i),custom:y,...tW,animate:g,...p})})}).displayName="SlideFade";let tH={initial:"exit",animate:"enter",exit:"exit",variants:{exit:({reverse:e,initialScale:t,transition:n,transitionEnd:r,delay:s})=>({opacity:0,...e?{scale:t,transitionEnd:r?.exit}:{transitionEnd:{scale:t,...r?.exit}},transition:n?.exit??tV.p$.exit(tV.Sh.exit,s)}),enter:({transitionEnd:e,transition:t,delay:n})=>({opacity:1,scale:1,transition:t?.enter??tV.p$.enter(tV.Sh.enter,n),transitionEnd:e?.enter})}};(0,h.forwardRef)(function(e,t){let{unmountOnExit:n,in:r,reverse:s=!0,initialScale:i=.95,className:o,transition:l,transitionEnd:c,delay:d,animatePresenceProps:h,...f}=e,p=!n||r&&n,m=r||n?"enter":"exit",g={initialScale:i,reverse:s,transition:l,transitionEnd:c,delay:d};return(0,a.jsx)(tq.M,{...h,custom:g,children:p&&(0,a.jsx)(tD.E.div,{ref:t,className:(0,u.cx)("chakra-offset-slide",o),...tH,animate:m,custom:g,...f})})}).displayName="ScaleFade";var tG=n(6205);let tZ={slideInBottom:{...tW,custom:{offsetY:16,reverse:!0}},slideInRight:{...tW,custom:{offsetX:16,reverse:!0}},slideInTop:{...tW,custom:{offsetY:-16,reverse:!0}},slideInLeft:{...tW,custom:{offsetX:-16,reverse:!0}},scale:{...tH,custom:{initialScale:.95,reverse:!0}},none:{}},tJ=(0,tG.m)(tD.E.section),tK=e=>tZ[e||"none"],tX=(0,h.forwardRef)((e,t)=>{let{preset:n,motionProps:r=tK(n),...s}=e;return(0,a.jsx)(tJ,{ref:t,...r,...s})});tX.displayName="ModalTransition";let tY=(0,n(1886).G)((e,t)=>{let{className:n,children:r,containerProps:s,motionProps:i,...o}=e,{getDialogProps:d,getDialogContainerProps:h}=(0,c.vR)(),f=d(o,t),p=h(s),m=(0,u.cx)("chakra-modal__content",n),g=(0,c.I_)(),y=(0,l.k0)({display:"flex",flexDirection:"column",position:"relative",width:"100%",outline:0,...g.dialog}),b=(0,l.k0)({display:"flex",width:"100vw",height:"$100vh",position:"fixed",left:0,top:0,...g.dialogContainer}),{motionPreset:v}=(0,c.vR)();return(0,a.jsx)(tB,{children:(0,a.jsx)(tG.m.div,{...p,className:"chakra-modal__content-container",tabIndex:-1,__css:b,children:(0,a.jsx)(tX,{preset:v,motionProps:i,className:m,...f,__css:y,children:r})})})});tY.displayName="ModalContent"},4475:function(e,t,n){"use strict";n.d(t,{m:function(){return u}});var r=n(2676),s=n(4719),i=n(5558),o=n(5861),a=n(1886),l=n(6205);let u=(0,a.G)((e,t)=>{let{className:n,...a}=e,u=(0,i.cx)("chakra-modal__footer",n),c=(0,o.I_)(),d=(0,s.k0)({display:"flex",alignItems:"center",justifyContent:"flex-end",...c.footer});return(0,r.jsx)(l.m.footer,{ref:t,...a,__css:d,className:u})});u.displayName="ModalFooter"},7617:function(e,t,n){"use strict";n.d(t,{x:function(){return c}});var r=n(2676),s=n(4719),i=n(5558),o=n(5271),a=n(5861),l=n(1886),u=n(6205);let c=(0,l.G)((e,t)=>{let{className:n,...l}=e,{headerId:c,setHeaderMounted:d}=(0,a.vR)();(0,o.useEffect)(()=>(d(!0),()=>d(!1)),[d]);let h=(0,i.cx)("chakra-modal__header",n),f=(0,a.I_)(),p=(0,s.k0)({flex:0,...f.header});return(0,r.jsx)(u.m.header,{ref:t,className:h,id:c,...l,__css:p})});c.displayName="ModalHeader"},4149:function(e,t,n){"use strict";n.d(t,{$:function(){return u},m:function(){return l}});var r=n(5271),s=Object.defineProperty,i=(e,t,n)=>t in e?s(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,o=(e,t,n)=>(i(e,"symbol"!=typeof t?t+"":t,n),n);class a{constructor(){o(this,"modals"),this.modals=new Set}add(e){return this.modals.add(e),this.modals.size}remove(e){this.modals.delete(e)}isTopModal(e){return!!e&&e===Array.from(this.modals)[this.modals.size-1]}}let l=new a;function u(e,t){let[n,s]=(0,r.useState)(0);return(0,r.useEffect)(()=>{let n=e.current;if(n)return t&&s(l.add(n)),()=>{l.remove(n),s(0)}},[t,e]),n}},1147:function(e,t,n){"use strict";n.d(t,{Z:function(){return p}});var r=n(2676),s=n(5558),i=n(3546),o=n(5861),a=n(6955),l=n(5271),u=n(3170);let c={initial:"exit",animate:"enter",exit:"exit",variants:{enter:({transition:e,transitionEnd:t,delay:n}={})=>({opacity:1,transition:e?.enter??u.p$.enter(u.Sh.enter,n),transitionEnd:t?.enter}),exit:({transition:e,transitionEnd:t,delay:n}={})=>({opacity:0,transition:e?.exit??u.p$.exit(u.Sh.exit,n),transitionEnd:t?.exit})}};(0,l.forwardRef)(function(e,t){let{unmountOnExit:n,in:o,className:l,transition:u,transitionEnd:d,delay:h,animatePresenceProps:f,...p}=e,m=o||n?"enter":"exit",g=!n||o&&n,y={transition:u,transitionEnd:d,delay:h};return(0,r.jsx)(a.M,{...f,custom:y,children:g&&(0,r.jsx)(i.E.div,{ref:t,className:(0,s.cx)("chakra-fade",l),custom:y,...c,animate:m,...p})})}).displayName="Fade";var d=n(6205),h=n(1886);let f=(0,d.m)(i.E.div),p=(0,h.G)((e,t)=>{let{className:n,transition:i,motionProps:a,...l}=e,u=(0,s.cx)("chakra-modal__overlay",n),d={pos:"fixed",left:"0",top:"0",w:"100vw",h:"100vh",...(0,o.I_)().overlay},{motionPreset:h}=(0,o.vR)(),p="none"===h?{}:c;return(0,r.jsx)(f,{...a||p,__css:d,ref:t,className:u,...l})});p.displayName="ModalOverlay"},5861:function(e,t,n){"use strict";n.d(t,{u_:function(){return k},vR:function(){return x},I_:function(){return _}});var r=n(2676),s=n(4242),i=n(6955),o=n(8483),a=n(5631),l=new WeakMap,u=new WeakMap,c={},d=0,h=function(e){return e&&(e.host||h(e.parentNode))},f=function(e,t,n,r){var s=(Array.isArray(e)?e:[e]).map(function(e){if(t.contains(e))return e;var n=h(e);return n&&t.contains(n)?n:(console.error("aria-hidden",e,"in not contained inside",t,". Doing nothing"),null)}).filter(function(e){return!!e});c[n]||(c[n]=new WeakMap);var i=c[n],o=[],a=new Set,f=new Set(s),p=function(e){!e||a.has(e)||(a.add(e),p(e.parentNode))};s.forEach(p);var m=function(e){!e||f.has(e)||Array.prototype.forEach.call(e.children,function(e){if(a.has(e))m(e);else try{var t=e.getAttribute(r),s=null!==t&&"false"!==t,c=(l.get(e)||0)+1,d=(i.get(e)||0)+1;l.set(e,c),i.set(e,d),o.push(e),1===c&&s&&u.set(e,!0),1===d&&e.setAttribute(n,"true"),s||e.setAttribute(r,"true")}catch(t){console.error("aria-hidden: cannot operate on ",e,t)}})};return m(t),a.clear(),d++,function(){o.forEach(function(e){var t=l.get(e)-1,s=i.get(e)-1;l.set(e,t),i.set(e,s),t||(u.has(e)||e.removeAttribute(r),u.delete(e)),s||e.removeAttribute(n)}),--d||(l=new WeakMap,l=new WeakMap,u=new WeakMap,c={})}},p=function(e,t,n){void 0===n&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),s=t||("undefined"==typeof document?null:(Array.isArray(e)?e[0]:e).ownerDocument.body);return s?(r.push.apply(r,Array.from(s.querySelectorAll("[aria-live], script"))),f(r,s,n,"aria-hidden")):function(){return null}},m=n(5271),g=n(4149),y=n(6511),b=n(3357);let[v,_]=(0,s.k)({name:"ModalStylesContext",errorMessage:"useModalStyles returned is 'undefined'. Seems you forgot to wrap the components in \"<Modal />\" "}),[w,x]=(0,s.k)({strict:!0,name:"ModalContext",errorMessage:"useModalContext: `context` is undefined. Seems you forgot to wrap modal components in `<Modal />`"}),k=e=>{let t={scrollBehavior:"outside",autoFocus:!0,trapFocus:!0,returnFocusOnClose:!0,blockScrollOnMount:!0,allowPinchZoom:!1,preserveScrollBarGap:!0,motionPreset:"scale",...e,lockFocusAcrossFrames:e.lockFocusAcrossFrames??!0},{portalProps:n,children:s,autoFocus:l,trapFocus:u,initialFocusRef:c,finalFocusRef:d,returnFocusOnClose:h,blockScrollOnMount:f,allowPinchZoom:_,preserveScrollBarGap:x,motionPreset:k,lockFocusAcrossFrames:S,animatePresenceProps:A,onCloseComplete:I}=t,E=(0,b.j)("Modal",t),T={...function(e){let{isOpen:t,onClose:n,id:r,closeOnOverlayClick:s=!0,closeOnEsc:i=!0,useInert:l=!0,onOverlayClick:u,onEsc:c}=e,d=(0,m.useRef)(null),h=(0,m.useRef)(null),[f,y,b]=function(e,...t){let n=(0,m.useId)(),r=e||n;return(0,m.useMemo)(()=>t.map(e=>`${e}-${r}`),[r,t])}(r,"chakra-modal","chakra-modal--header","chakra-modal--body");!function(e,t){let n=e.current;(0,m.useEffect)(()=>{if(e.current&&t)return p(e.current)},[t,e,n])}(d,t&&l);let v=(0,g.$)(d,t),_=(0,m.useRef)(null),w=(0,m.useCallback)(e=>{_.current=e.target},[]),x=(0,m.useCallback)(e=>{"Escape"===e.key&&(e.stopPropagation(),i&&n?.(),c?.())},[i,n,c]),[k,S]=(0,m.useState)(!1),[A,I]=(0,m.useState)(!1),E=(0,m.useCallback)((e={},t=null)=>({role:"dialog",...e,ref:(0,o.lq)(t,d),id:f,tabIndex:-1,"aria-modal":!0,"aria-labelledby":k?y:void 0,"aria-describedby":A?b:void 0,onClick:(0,a.v)(e.onClick,e=>e.stopPropagation())}),[b,A,f,y,k]),T=(0,m.useCallback)(e=>{e.stopPropagation(),_.current===e.target&&g.m.isTopModal(d.current)&&(s&&n?.(),u?.())},[n,s,u]),z=(0,m.useCallback)((e={},t=null)=>({...e,ref:(0,o.lq)(t,h),onClick:(0,a.v)(e.onClick,T),onKeyDown:(0,a.v)(e.onKeyDown,x),onMouseDown:(0,a.v)(e.onMouseDown,w)}),[x,w,T]);return{isOpen:t,onClose:n,headerId:y,bodyId:b,setBodyMounted:I,setHeaderMounted:S,dialogRef:d,overlayRef:h,getDialogProps:E,getDialogContainerProps:z,index:v}}(t),autoFocus:l,trapFocus:u,initialFocusRef:c,finalFocusRef:d,returnFocusOnClose:h,blockScrollOnMount:f,allowPinchZoom:_,preserveScrollBarGap:x,motionPreset:k,lockFocusAcrossFrames:S};return(0,r.jsx)(w,{value:T,children:(0,r.jsx)(v,{value:E,children:(0,r.jsx)(i.M,{...A,onExitComplete:I,children:T.isOpen&&(0,r.jsx)(y.h,{...n,children:s})})})})};k.displayName="Modal"},2612:function(e,t,n){"use strict";n.d(t,{g:function(){return h}});var r=n(2676),s=n(1902),i=n(8117),o=n(5558),a=n(1342),l=n(1886),u=n(3357),c=n(6205);let d=["h","minH","height","minHeight"],h=(0,l.G)((e,t)=>{let n=(0,u.m)("Textarea",e),{className:l,rows:h,...f}=(0,s.L)(e),p=(0,a.Y)(f),m=h?(0,i.C)(n,d):n;return(0,r.jsx)(c.m.textarea,{ref:t,rows:h,...p,className:(0,o.cx)("chakra-textarea",l),__css:m})});h.displayName="Textarea"},3170:function(e,t,n){"use strict";n.d(t,{Lj:function(){return r},Sh:function(){return s},p$:function(){return i}});let r={ease:[.25,.1,.25,1],easeIn:[.4,0,1,1],easeOut:[0,0,.2,1],easeInOut:[.4,0,.2,1]},s={enter:{duration:.2,ease:r.easeOut},exit:{duration:.1,ease:r.easeIn}},i={enter:(e,t)=>({...e,delay:"number"==typeof t?t:t?.enter}),exit:(e,t)=>({...e,delay:"number"==typeof t?t:t?.exit})}},7470:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});let r=e=>{let{condition:t,message:n}=e}},2923:function(e,t,n){"use strict";var r,s,i=n(939),o=n(2244),a=n(858);"function"==typeof SuppressedError&&SuppressedError;var l=n(5313).lW,u=void 0!==l&&l.from?function(e){return l.from(e,"utf8")}:e=>new TextEncoder().encode(e);!function(){function e(){this.crc32=new c}e.prototype.update=function(e){("string"==typeof e?0===e.length:0===e.byteLength)||this.crc32.update(e instanceof Uint8Array?e:"string"==typeof e?u(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e))},e.prototype.digest=function(){var e,t,n,r;return e=this,t=void 0,n=void 0,r=function(){return function(e,t){var n,r,s,i={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=a(0),o.throw=a(1),o.return=a(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(l){return function(a){if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(i=0)),i;)try{if(n=1,r&&(s=2&a[0]?r.return:a[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,a[1])).done)return s;switch(r=0,s&&(a=[2&a[0],s.value]),a[0]){case 0:case 1:s=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(s=(s=i.trys).length>0&&s[s.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!s||a[1]>s[0]&&a[1]<s[3])){i.label=a[1];break}if(6===a[0]&&i.label<s[1]){i.label=s[1],s=a;break}if(s&&i.label<s[2]){i.label=s[2],i.ops.push(a);break}s[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=s=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}}(this,function(e){var t;return[2,new Uint8Array([(4278190080&(t=this.crc32.digest()))>>24,(16711680&t)>>16,(65280&t)>>8,255&t])]})},new(n||(n=Promise))(function(s,i){function o(e){try{l(r.next(e))}catch(e){i(e)}}function a(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?s(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(o,a)}l((r=r.apply(e,t||[])).next())})},e.prototype.reset=function(){this.crc32=new c}}();var c=function(){function e(){this.checksum=4294967295}return e.prototype.update=function(e){var t,n;try{for(var r=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),s=r.next();!s.done;s=r.next()){var i=s.value;this.checksum=this.checksum>>>8^d[(this.checksum^i)&255]}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return this},e.prototype.digest=function(){return(4294967295^this.checksum)>>>0},e}(),d=function(e){if(!Uint32Array.from){for(var t=new Uint32Array(e.length),n=0;n<e.length;)t[n]=e[n],n+=1;return t}return Uint32Array.from(e)}([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]);let h={},f={};for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();1===t.length&&(t=`0${t}`),h[e]=t,f[t]=e}function p(e){let t="";for(let n=0;n<e.byteLength;n++)t+=h[e[n]];return t}class m{constructor(e){if(this.bytes=e,8!==e.byteLength)throw Error("Int64 buffers must be exactly 8 bytes")}static fromNumber(e){if(e>0x7fffffffffffffff||e<-0x8000000000000000)throw Error(`${e} is too large (or, if negative, too small) to represent as an Int64`);let t=new Uint8Array(8);for(let n=7,r=Math.abs(Math.round(e));n>-1&&r>0;n--,r/=256)t[n]=r;return e<0&&g(t),new m(t)}valueOf(){let e=this.bytes.slice(0),t=128&e[0];return t&&g(e),parseInt(p(e),16)*(t?-1:1)}toString(){return String(this.valueOf())}}function g(e){for(let t=0;t<8;t++)e[t]^=255;for(let t=7;t>-1&&(e[t]++,0===e[t]);t--);}class y{constructor(e,t){this.toUtf8=e,this.fromUtf8=t}format(e){let t=[];for(let n of Object.keys(e)){let r=this.fromUtf8(n);t.push(Uint8Array.from([r.byteLength]),r,this.formatHeaderValue(e[n]))}let n=new Uint8Array(t.reduce((e,t)=>e+t.byteLength,0)),r=0;for(let e of t)n.set(e,r),r+=e.byteLength;return n}formatHeaderValue(e){switch(e.type){case"boolean":return Uint8Array.from([e.value?0:1]);case"byte":return Uint8Array.from([2,e.value]);case"short":let t=new DataView(new ArrayBuffer(3));return t.setUint8(0,3),t.setInt16(1,e.value,!1),new Uint8Array(t.buffer);case"integer":let n=new DataView(new ArrayBuffer(5));return n.setUint8(0,4),n.setInt32(1,e.value,!1),new Uint8Array(n.buffer);case"long":let r=new Uint8Array(9);return r[0]=5,r.set(e.value.bytes,1),r;case"binary":let s=new DataView(new ArrayBuffer(3+e.value.byteLength));s.setUint8(0,6),s.setUint16(1,e.value.byteLength,!1);let i=new Uint8Array(s.buffer);return i.set(e.value,3),i;case"string":let o=this.fromUtf8(e.value),a=new DataView(new ArrayBuffer(3+o.byteLength));a.setUint8(0,7),a.setUint16(1,o.byteLength,!1);let l=new Uint8Array(a.buffer);return l.set(o,3),l;case"timestamp":let u=new Uint8Array(9);return u[0]=8,u.set(m.fromNumber(e.value.valueOf()).bytes,1),u;case"uuid":if(!E.test(e.value))throw Error(`Invalid UUID received: ${e.value}`);let c=new Uint8Array(17);return c[0]=9,c.set(function(e){if(e.length%2!=0)throw Error("Hex encoded strings must have an even number length");let t=new Uint8Array(e.length/2);for(let n=0;n<e.length;n+=2){let r=e.slice(n,n+2).toLowerCase();if(r in f)t[n/2]=f[r];else throw Error(`Cannot decode unrecognized sequence ${r} as hexadecimal`)}return t}(e.value.replace(/\-/g,"")),1),c}}parse(e){let t={},n=0;for(;n<e.byteLength;){let r=e.getUint8(n++),s=this.toUtf8(new Uint8Array(e.buffer,e.byteOffset+n,r));switch(n+=r,e.getUint8(n++)){case 0:t[s]={type:b,value:!0};break;case 1:t[s]={type:b,value:!1};break;case 2:t[s]={type:v,value:e.getInt8(n++)};break;case 3:t[s]={type:_,value:e.getInt16(n,!1)},n+=2;break;case 4:t[s]={type:w,value:e.getInt32(n,!1)},n+=4;break;case 5:t[s]={type:x,value:new m(new Uint8Array(e.buffer,e.byteOffset+n,8))},n+=8;break;case 6:let i=e.getUint16(n,!1);n+=2,t[s]={type:k,value:new Uint8Array(e.buffer,e.byteOffset+n,i)},n+=i;break;case 7:let o=e.getUint16(n,!1);n+=2,t[s]={type:S,value:this.toUtf8(new Uint8Array(e.buffer,e.byteOffset+n,o))},n+=o;break;case 8:t[s]={type:A,value:new Date(new m(new Uint8Array(e.buffer,e.byteOffset+n,8)).valueOf())},n+=8;break;case 9:let a=new Uint8Array(e.buffer,e.byteOffset+n,16);n+=16,t[s]={type:I,value:`${p(a.subarray(0,4))}-${p(a.subarray(4,6))}-${p(a.subarray(6,8))}-${p(a.subarray(8,10))}-${p(a.subarray(10))}`};break;default:throw Error("Unrecognized header type tag")}}return t}}(r=s||(s={}))[r.boolTrue=0]="boolTrue",r[r.boolFalse=1]="boolFalse",r[r.byte=2]="byte",r[r.short=3]="short",r[r.integer=4]="integer",r[r.long=5]="long",r[r.byteArray=6]="byteArray",r[r.string=7]="string",r[r.timestamp=8]="timestamp",r[r.uuid=9]="uuid";let b="boolean",v="byte",_="short",w="integer",x="long",k="binary",S="string",A="timestamp",I="uuid",E=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/;class T{constructor(e,t){this.headerMarshaller=new y(e,t),this.messageBuffer=[],this.isEndOfStream=!1}feed(e){this.messageBuffer.push(this.decode(e))}endOfStream(){this.isEndOfStream=!0}getMessage(){let e=this.messageBuffer.pop(),t=this.isEndOfStream;return{getMessage:()=>e,isEndOfStream:()=>t}}getAvailableMessages(){let e=this.messageBuffer;this.messageBuffer=[];let t=this.isEndOfStream;return{getMessages:()=>e,isEndOfStream:()=>t}}encode({headers:e,body:t}){let n=this.headerMarshaller.format(e),r=n.byteLength+t.byteLength+16,s=new Uint8Array(r),i=new DataView(s.buffer,s.byteOffset,s.byteLength),o=new c;return i.setUint32(0,r,!1),i.setUint32(4,n.byteLength,!1),i.setUint32(8,o.update(s.subarray(0,8)).digest(),!1),s.set(n,12),s.set(t,n.byteLength+12),i.setUint32(r-4,o.update(s.subarray(8,r-4)).digest(),!1),s}decode(e){let{headers:t,body:n}=function({byteLength:e,byteOffset:t,buffer:n}){if(e<16)throw Error("Provided message too short to accommodate event stream message overhead");let r=new DataView(n,t,e),s=r.getUint32(0,!1);if(e!==s)throw Error("Reported message length does not match received message length");let i=r.getUint32(4,!1),o=r.getUint32(8,!1),a=r.getUint32(e-4,!1),l=new c().update(new Uint8Array(n,t,8));if(o!==l.digest())throw Error(`The prelude checksum specified in the message (${o}) does not match the calculated CRC32 checksum (${l.digest()})`);if(l.update(new Uint8Array(n,t+8,e-12)),a!==l.digest())throw Error(`The message checksum (${l.digest()}) did not match the expected value of ${a}`);return{headers:new DataView(n,t+8+4,i),body:new Uint8Array(n,t+8+4+i,s-i-16)}}(e);return{headers:this.headerMarshaller.parse(t),body:n}}formatHeaders(e){return this.headerMarshaller.format(e)}}let z=e=>{if("string"==typeof e)return e;if("object"!=typeof e||"number"!=typeof e.byteOffset||"number"!=typeof e.byteLength)throw Error("@smithy/util-utf8: toUtf8 encoder function only accepts string | Uint8Array.");return new TextDecoder("utf-8").decode(e)},C=e=>new TextEncoder().encode(e),j=new TextEncoder,N={appstream2:"appstream",cloudhsmv2:"cloudhsm",email:"ses",marketplace:"aws-marketplace",mobile:"AWSMobileHubService",pinpoint:"mobiletargeting",queue:"sqs","git-codecommit":"codecommit","mturk-requester-sandbox":"mturk-requester","personalize-runtime":"personalize"},O=new Set(["authorization","content-type","content-length","user-agent","presigned-expires","expect","x-amzn-trace-id","range","connection"]);class P{constructor({method:e,url:t,headers:n,body:r,accessKeyId:s,secretAccessKey:i,sessionToken:o,service:a,region:l,cache:u,datetime:c,signQuery:d,appendSessionToken:h,allHeaders:f,singleEncode:p}){let m,g;if(null==t)throw TypeError("url is a required option");if(null==s)throw TypeError("accessKeyId is a required option");if(null==i)throw TypeError("secretAccessKey is a required option");this.method=e||(r?"POST":"GET"),this.url=new URL(t),this.headers=new Headers(n||{}),this.body=r,this.accessKeyId=s,this.secretAccessKey=i,this.sessionToken=o,a&&l||([m,g]=function(e,t){let{hostname:n,pathname:r}=e;if(n.endsWith(".on.aws")){let e=n.match(/^[^.]{1,63}\.lambda-url\.([^.]{1,63})\.on\.aws$/);return null!=e?["lambda",e[1]||""]:["",""]}if(n.endsWith(".r2.cloudflarestorage.com"))return["s3","auto"];if(n.endsWith(".backblazeb2.com")){let e=n.match(/^(?:[^.]{1,63}\.)?s3\.([^.]{1,63})\.backblazeb2\.com$/);return null!=e?["s3",e[1]||""]:["",""]}let s=n.replace("dualstack.","").match(/([^.]{1,63})\.(?:([^.]{0,63})\.)?amazonaws\.com(?:\.cn)?$/),i=s&&s[1]||"",o=s&&s[2];if("us-gov"===o)o="us-gov-west-1";else if("s3"===o||"s3-accelerate"===o)o="us-east-1",i="s3";else if("iot"===i)i=n.startsWith("iot.")?"execute-api":n.startsWith("data.jobs.iot.")?"iot-jobs-data":"/mqtt"===r?"iotdevicegateway":"iotdata";else if("autoscaling"===i){let e=(t.get("X-Amz-Target")||"").split(".")[0];"AnyScaleFrontendService"===e?i="application-autoscaling":"AnyScaleScalingPlannerFrontendService"===e&&(i="autoscaling-plans")}else null==o&&i.startsWith("s3-")?(o=i.slice(3).replace(/^fips-|^external-1/,""),i="s3"):i.endsWith("-fips")?i=i.slice(0,-5):o&&/-\d$/.test(i)&&!/-\d$/.test(o)&&([i,o]=[o,i]);return[N[i]||i,o||""]}(this.url,this.headers)),this.service=a||m||"",this.region=l||g||"us-east-1",this.cache=u||new Map,this.datetime=c||new Date().toISOString().replace(/[:-]|\.\d{3}/g,""),this.signQuery=d,this.appendSessionToken=h||"iotdevicegateway"===this.service,this.headers.delete("Host"),"s3"!==this.service||this.signQuery||this.headers.has("X-Amz-Content-Sha256")||this.headers.set("X-Amz-Content-Sha256","UNSIGNED-PAYLOAD");let y=this.signQuery?this.url.searchParams:this.headers;if(y.set("X-Amz-Date",this.datetime),this.sessionToken&&!this.appendSessionToken&&y.set("X-Amz-Security-Token",this.sessionToken),this.signableHeaders=["host",...this.headers.keys()].filter(e=>f||!O.has(e)).sort(),this.signedHeaders=this.signableHeaders.join(";"),this.canonicalHeaders=this.signableHeaders.map(e=>e+":"+("host"===e?this.url.host:(this.headers.get(e)||"").replace(/\s+/g," "))).join("\n"),this.credentialString=[this.datetime.slice(0,8),this.region,this.service,"aws4_request"].join("/"),this.signQuery&&("s3"!==this.service||y.has("X-Amz-Expires")||y.set("X-Amz-Expires","86400"),y.set("X-Amz-Algorithm","AWS4-HMAC-SHA256"),y.set("X-Amz-Credential",this.accessKeyId+"/"+this.credentialString),y.set("X-Amz-SignedHeaders",this.signedHeaders)),"s3"===this.service)try{this.encodedPath=decodeURIComponent(this.url.pathname.replace(/\+/g," "))}catch(e){this.encodedPath=this.url.pathname}else this.encodedPath=this.url.pathname.replace(/\/+/g,"/");p||(this.encodedPath=encodeURIComponent(this.encodedPath).replace(/%2F/g,"/")),this.encodedPath=L(this.encodedPath);let b=new Set;this.encodedSearch=[...this.url.searchParams].filter(([e])=>{if(!e)return!1;if("s3"===this.service){if(b.has(e))return!1;b.add(e)}return!0}).map(e=>e.map(e=>L(encodeURIComponent(e)))).sort(([e,t],[n,r])=>e<n?-1:e>n?1:t<r?-1:t>r?1:0).map(e=>e.join("=")).join("&")}async sign(){return this.signQuery?(this.url.searchParams.set("X-Amz-Signature",await this.signature()),this.sessionToken&&this.appendSessionToken&&this.url.searchParams.set("X-Amz-Security-Token",this.sessionToken)):this.headers.set("Authorization",await this.authHeader()),{method:this.method,url:this.url,headers:this.headers,body:this.body}}async authHeader(){return["AWS4-HMAC-SHA256 Credential="+this.accessKeyId+"/"+this.credentialString,"SignedHeaders="+this.signedHeaders,"Signature="+await this.signature()].join(", ")}async signature(){let e=this.datetime.slice(0,8),t=[this.secretAccessKey,e,this.region,this.service].join(),n=this.cache.get(t);if(!n){let r=await R("AWS4"+this.secretAccessKey,e),s=await R(r,this.region),i=await R(s,this.service);n=await R(i,"aws4_request"),this.cache.set(t,n)}return $(await R(n,await this.stringToSign()))}async stringToSign(){return["AWS4-HMAC-SHA256",this.datetime,this.credentialString,$(await M(await this.canonicalString()))].join("\n")}async canonicalString(){return[this.method.toUpperCase(),this.encodedPath,this.encodedSearch,this.canonicalHeaders+"\n",this.signedHeaders,await this.hexBodyHash()].join("\n")}async hexBodyHash(){let e=this.headers.get("X-Amz-Content-Sha256")||("s3"===this.service&&this.signQuery?"UNSIGNED-PAYLOAD":null);if(null==e){if(this.body&&"string"!=typeof this.body&&!("byteLength"in this.body))throw Error("body must be a string, ArrayBuffer or ArrayBufferView, unless you include the X-Amz-Content-Sha256 header");e=$(await M(this.body||""))}return e}}async function R(e,t){let n=await crypto.subtle.importKey("raw","string"==typeof e?j.encode(e):e,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);return crypto.subtle.sign("HMAC",n,j.encode(t))}async function M(e){return crypto.subtle.digest("SHA-256","string"==typeof e?j.encode(e):e)}let U=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function $(e){let t=new Uint8Array(e),n="";for(let e=0;e<t.length;e++){let r=t[e];n+=U[r>>>4&15]+U[15&r]}return n}function L(e){return e.replace(/[!'()*]/g,e=>"%"+e.charCodeAt(0).toString(16).toUpperCase())}var F={cachePoint:{type:"default"}},B=a.z.object({message:a.z.string(),type:a.z.string().nullish()}),D=e=>async({response:t})=>{let n=(0,i.kb)(t);if(null==t.body)throw new o.g8({});let r=new T(z,C),s=new Uint8Array(0),a=new TextDecoder;return{responseHeaders:n,value:t.body.pipeThrough(new TransformStream({transform(t,n){var o,l;let u=new Uint8Array(s.length+t.length);for(u.set(s),u.set(t,s.length),s=u;s.length>=4;){let t=new DataView(s.buffer,s.byteOffset,s.byteLength).getUint32(0,!1);if(s.length<t)break;try{let u=s.subarray(0,t),c=r.decode(u);if(s=s.slice(t),(null==(o=c.headers[":message-type"])?void 0:o.value)==="event"){let t=a.decode(c.body),r=(0,i.NX)({text:t});if(!r.success){n.enqueue(r);break}delete r.value.p;let s={[null==(l=c.headers[":event-type"])?void 0:l.value]:r.value},o=(0,i.pW)({value:s,schema:e});o.success?n.enqueue({success:!0,value:o.value,rawValue:s}):n.enqueue(o)}}catch(e){break}}}}))}},q=(0,i.bF)({prefix:"file",size:16});function V(e){var t;return null==(t=null==e?void 0:e.bedrock)?void 0:t.cachePoint}function W(e,t,n,r){return e&&t&&n?r.trim():r}function H(e){switch(e){case"stop_sequence":case"end_turn":return"stop";case"max_tokens":return"length";case"content_filtered":case"guardrail_intervened":return"content-filter";case"tool_use":return"tool-calls";default:return"unknown"}}var G=class{constructor(e,t,n){this.modelId=e,this.settings=t,this.config=n,this.specificationVersion="v1",this.provider="amazon-bedrock",this.defaultObjectGenerationMode="tool",this.supportsImageUrls=!1}getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:s,topK:a,frequencyPenalty:l,presencePenalty:u,stopSequences:c,responseFormat:d,seed:h,providerMetadata:f}){var p,m,g,y,b,v,_;let w=e.type,x=[];null!=l&&x.push({type:"unsupported-setting",setting:"frequencyPenalty"}),null!=u&&x.push({type:"unsupported-setting",setting:"presencePenalty"}),null!=h&&x.push({type:"unsupported-setting",setting:"seed"}),null!=a&&x.push({type:"unsupported-setting",setting:"topK"}),null!=d&&"text"!==d.type&&x.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});let{system:k,messages:S}=function(e){var t,n,r,s,a;let l=function(e){let t;let n=[];for(let r of e){let{role:e}=r;switch(e){case"system":(null==t?void 0:t.type)!=="system"&&(t={type:"system",messages:[]},n.push(t)),t.messages.push(r);break;case"assistant":(null==t?void 0:t.type)!=="assistant"&&(t={type:"assistant",messages:[]},n.push(t)),t.messages.push(r);break;case"user":case"tool":(null==t?void 0:t.type)!=="user"&&(t={type:"user",messages:[]},n.push(t)),t.messages.push(r);break;default:throw Error(`Unsupported role: ${e}`)}}return n}(e),u=[],c=[];for(let e=0;e<l.length;e++){let d=l[e],h=e===l.length-1,f=d.type;switch(f){case"system":if(c.length>0)throw new o.A_({functionality:"Multiple system messages that are separated by user/assistant messages"});for(let e of d.messages)u.push({text:e.content}),V(e.providerMetadata)&&u.push(F);break;case"user":{let e=[];for(let l of d.messages){let{role:u,content:c,providerMetadata:d}=l;switch(u){case"user":for(let l=0;l<c.length;l++){let u=c[l];switch(u.type){case"text":e.push({text:u.text});break;case"image":if(u.image instanceof URL)throw new o.A_({functionality:"Image URLs in user messages"});e.push({image:{format:null==(n=null==(t=u.mimeType)?void 0:t.split("/"))?void 0:n[1],source:{bytes:(0,i.k0)(null!=(r=u.image)?r:u.image)}}});break;case"file":if(u.data instanceof URL)throw new o.A_({functionality:"File URLs in user messages"});e.push({document:{format:null==(a=null==(s=u.mimeType)?void 0:s.split("/"))?void 0:a[1],name:q(),source:{bytes:u.data}}})}}break;case"tool":for(let t=0;t<c.length;t++){let n=c[t],r=void 0!=n.content?n.content.map(e=>{switch(e.type){case"text":return{text:e.text};case"image":if(!e.mimeType)throw Error("Image mime type is required in tool result part content");let t=e.mimeType.split("/")[1];if(!["jpeg","png","gif"].includes(t))throw Error(`Unsupported image format: ${t}`);return{image:{format:t,source:{bytes:e.data}}}}}):[{text:JSON.stringify(n.result)}];e.push({toolResult:{toolUseId:n.toolCallId,content:r}})}break;default:throw Error(`Unsupported role: ${u}`)}V(d)&&e.push(F)}c.push({role:"user",content:e});break}case"assistant":{let e=[];for(let t=0;t<d.messages.length;t++){let n=d.messages[t],r=t===d.messages.length-1,{content:s}=n;for(let t=0;t<s.length;t++){let n=s[t],i=t===s.length-1;switch(n.type){case"text":e.push({text:W(h,r,i,n.text)});break;case"reasoning":e.push({reasoningContent:{reasoningText:{text:W(h,r,i,n.text),signature:n.signature}}});break;case"redacted-reasoning":e.push({reasoningContent:{redactedReasoning:{data:n.data}}});break;case"tool-call":e.push({toolUse:{toolUseId:n.toolCallId,name:n.toolName,input:n.args}})}}V(n.providerMetadata)&&e.push(F)}c.push({role:"assistant",content:e});break}default:throw Error(`Unsupported type: ${f}`)}}return{system:u,messages:c}}(t),A=Z.safeParse(null==(p=null==f?void 0:f.bedrock)?void 0:p.reasoning_config);if(!A.success)throw new o.RU({argument:"providerOptions.bedrock.reasoning_config",message:"invalid reasoning configuration options",cause:A.error});let I=(null==(m=A.data)?void 0:m.type)==="enabled",E=null!=(b=null==(g=A.data)?void 0:g.budgetTokens)?b:null==(y=A.data)?void 0:y.budget_tokens,T={...null!=n&&{maxTokens:n},...null!=r&&{temperature:r},...null!=s&&{topP:s},...null!=c&&{stopSequences:c}};I&&null!=E&&(null!=T.maxTokens?T.maxTokens+=E:T.maxTokens=E+4096,this.settings.additionalModelRequestFields={...this.settings.additionalModelRequestFields,reasoning_config:{type:null==(v=A.data)?void 0:v.type,budget_tokens:E}}),I&&null!=T.temperature&&(delete T.temperature,x.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported when thinking is enabled"})),I&&null!=T.topP&&(delete T.topP,x.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported when thinking is enabled"}));let z={system:k,additionalModelRequestFields:this.settings.additionalModelRequestFields,...Object.keys(T).length>0&&{inferenceConfig:T},messages:S,...null==f?void 0:f.bedrock};switch(w){case"regular":{let{toolConfig:t,toolWarnings:n}=function(e){var t;let n=(null==(t=e.tools)?void 0:t.length)?e.tools:void 0;if(null==n)return{toolConfig:{tools:void 0,toolChoice:void 0},toolWarnings:[]};let r=[],s=[];for(let e of n)"provider-defined"===e.type?r.push({type:"unsupported-tool",tool:e}):s.push({toolSpec:{name:e.name,description:e.description,inputSchema:{json:e.parameters}}});let i=e.toolChoice;if(null==i)return{toolConfig:{tools:s,toolChoice:void 0},toolWarnings:r};let a=i.type;switch(a){case"auto":return{toolConfig:{tools:s,toolChoice:{auto:{}}},toolWarnings:r};case"required":return{toolConfig:{tools:s,toolChoice:{any:{}}},toolWarnings:r};case"none":return{toolConfig:{tools:void 0,toolChoice:void 0},toolWarnings:r};case"tool":return{toolConfig:{tools:s,toolChoice:{tool:{name:i.toolName}}},toolWarnings:r};default:throw new o.A_({functionality:`Unsupported tool choice type: ${a}`})}}(e);return{command:{...z,...(null==(_=t.tools)?void 0:_.length)?{toolConfig:t}:{}},warnings:[...x,...n]}}case"object-json":throw new o.A_({functionality:"json-mode object generation"});case"object-tool":return{command:{...z,toolConfig:{tools:[{toolSpec:{name:e.tool.name,description:e.tool.description,inputSchema:{json:e.tool.parameters}}}],toolChoice:{tool:{name:e.tool.name}}}},warnings:x};default:throw Error(`Unsupported type: ${w}`)}}async doGenerate(e){var t,n,r,s,o,a,l,u,c,d,h,f,p,m,g,y;let{command:b,warnings:v}=this.getArgs(e),_=`${this.getUrl(this.modelId)}/converse`,{value:w,responseHeaders:x}=await (0,i.A8)({url:_,headers:(0,i.NF)(await (0,i.DB)(this.config.headers),e.headers),body:b,failedResponseHandler:(0,i.Sq)({errorSchema:B,errorToMessage:e=>{var t;return`${null!=(t=e.message)?t:"Unknown error"}`}}),successfulResponseHandler:(0,i.tc)(Q),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:k,...S}=b,A=w.trace||w.usage?{bedrock:{...w.trace&&"object"==typeof w.trace?{trace:w.trace}:{},...w.usage&&{usage:{cacheReadInputTokens:null!=(n=null==(t=w.usage)?void 0:t.cacheReadInputTokens)?n:Number.NaN,cacheWriteInputTokens:null!=(s=null==(r=w.usage)?void 0:r.cacheWriteInputTokens)?s:Number.NaN}}}}:void 0,I=w.output.message.content.filter(e=>e.reasoningContent).map(e=>{var t;return e.reasoningContent&&"reasoningText"in e.reasoningContent?{type:"text",text:e.reasoningContent.reasoningText.text,...e.reasoningContent.reasoningText.signature&&{signature:e.reasoningContent.reasoningText.signature}}:e.reasoningContent&&"redactedReasoning"in e.reasoningContent?{type:"redacted",data:null!=(t=e.reasoningContent.redactedReasoning.data)?t:""}:void 0}).filter(e=>void 0!==e);return{text:null!=(u=null==(l=null==(a=null==(o=w.output)?void 0:o.message)?void 0:a.content)?void 0:l.map(e=>{var t;return null!=(t=e.text)?t:""}).join(""))?u:void 0,toolCalls:null==(f=null==(h=null==(d=null==(c=w.output)?void 0:c.message)?void 0:d.content)?void 0:h.filter(e=>!!e.toolUse))?void 0:f.map(e=>{var t,n,r,s,i,o;return{toolCallType:"function",toolCallId:null!=(n=null==(t=e.toolUse)?void 0:t.toolUseId)?n:this.config.generateId(),toolName:null!=(s=null==(r=e.toolUse)?void 0:r.name)?s:`tool-${this.config.generateId()}`,args:JSON.stringify(null!=(o=null==(i=e.toolUse)?void 0:i.input)?o:"")}}),finishReason:H(w.stopReason),usage:{promptTokens:null!=(m=null==(p=w.usage)?void 0:p.inputTokens)?m:Number.NaN,completionTokens:null!=(y=null==(g=w.usage)?void 0:g.outputTokens)?y:Number.NaN},rawCall:{rawPrompt:k,rawSettings:S},rawResponse:{headers:x},warnings:v,reasoning:I.length>0?I:void 0,...A&&{providerMetadata:A}}}async doStream(e){let t;let{command:n,warnings:r}=this.getArgs(e),s=`${this.getUrl(this.modelId)}/converse-stream`,{value:o,responseHeaders:a}=await (0,i.A8)({url:s,headers:(0,i.NF)(await (0,i.DB)(this.config.headers),e.headers),body:n,failedResponseHandler:(0,i.Sq)({errorSchema:B,errorToMessage:e=>`${e.type}: ${e.message}`}),successfulResponseHandler:D(ee),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:l,...u}=n,c="unknown",d={promptTokens:Number.NaN,completionTokens:Number.NaN},h={};return{stream:o.pipeThrough(new TransformStream({transform(e,n){var r,s,i,o,a,l,u,f,p,m,g,y,b,v;function _(e){c="error",n.enqueue({type:"error",error:e})}if(!e.success){_(e.error);return}let w=e.value;if(w.internalServerException){_(w.internalServerException);return}if(w.modelStreamErrorException){_(w.modelStreamErrorException);return}if(w.throttlingException){_(w.throttlingException);return}if(w.validationException){_(w.validationException);return}if(w.messageStop&&(c=H(w.messageStop.stopReason)),w.metadata){d={promptTokens:null!=(s=null==(r=w.metadata.usage)?void 0:r.inputTokens)?s:Number.NaN,completionTokens:null!=(o=null==(i=w.metadata.usage)?void 0:i.outputTokens)?o:Number.NaN};let e=(null==(a=w.metadata.usage)?void 0:a.cacheReadInputTokens)!=null||(null==(l=w.metadata.usage)?void 0:l.cacheWriteInputTokens)!=null?{usage:{cacheReadInputTokens:null!=(f=null==(u=w.metadata.usage)?void 0:u.cacheReadInputTokens)?f:Number.NaN,cacheWriteInputTokens:null!=(m=null==(p=w.metadata.usage)?void 0:p.cacheWriteInputTokens)?m:Number.NaN}}:void 0,n=w.metadata.trace?{trace:w.metadata.trace}:void 0;(e||n)&&(t={bedrock:{...e,...n}})}if((null==(g=w.contentBlockDelta)?void 0:g.delta)&&"text"in w.contentBlockDelta.delta&&w.contentBlockDelta.delta.text&&n.enqueue({type:"text-delta",textDelta:w.contentBlockDelta.delta.text}),(null==(y=w.contentBlockDelta)?void 0:y.delta)&&"reasoningContent"in w.contentBlockDelta.delta&&w.contentBlockDelta.delta.reasoningContent){let e=w.contentBlockDelta.delta.reasoningContent;"text"in e&&e.text?n.enqueue({type:"reasoning",textDelta:e.text}):"signature"in e&&e.signature?n.enqueue({type:"reasoning-signature",signature:e.signature}):"data"in e&&e.data&&n.enqueue({type:"redacted-reasoning",data:e.data})}let x=w.contentBlockStart;if((null==(b=null==x?void 0:x.start)?void 0:b.toolUse)!=null){let e=x.start.toolUse;h[x.contentBlockIndex]={toolCallId:e.toolUseId,toolName:e.name,jsonText:""}}let k=w.contentBlockDelta;if((null==k?void 0:k.delta)&&"toolUse"in k.delta&&k.delta.toolUse){let e=h[k.contentBlockIndex],t=null!=(v=k.delta.toolUse.input)?v:"";n.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:e.toolCallId,toolName:e.toolName,argsTextDelta:t}),e.jsonText+=t}let S=w.contentBlockStop;if(null!=S){let e=S.contentBlockIndex,t=h[e];null!=t&&(n.enqueue({type:"tool-call",toolCallType:"function",toolCallId:t.toolCallId,toolName:t.toolName,args:t.jsonText}),delete h[e])}},flush(e){e.enqueue({type:"finish",finishReason:c,usage:d,...t&&{providerMetadata:t}})}})),rawCall:{rawPrompt:l,rawSettings:u},rawResponse:{headers:a},warnings:r}}getUrl(e){let t=encodeURIComponent(e);return`${this.config.baseUrl()}/model/${t}`}},Z=a.z.object({type:a.z.union([a.z.literal("enabled"),a.z.literal("disabled")]).nullish(),budget_tokens:a.z.number().nullish(),budgetTokens:a.z.number().nullish()}).nullish(),J=a.z.union([a.z.enum(["stop","stop_sequence","end_turn","length","max_tokens","content-filter","content_filtered","guardrail_intervened","tool-calls","tool_use"]),a.z.string()]),K=a.z.object({toolUseId:a.z.string(),name:a.z.string(),input:a.z.unknown()}),X=a.z.object({signature:a.z.string().nullish(),text:a.z.string()}),Y=a.z.object({data:a.z.string()}),Q=a.z.object({metrics:a.z.object({latencyMs:a.z.number()}).nullish(),output:a.z.object({message:a.z.object({content:a.z.array(a.z.object({text:a.z.string().nullish(),toolUse:K.nullish(),reasoningContent:a.z.union([a.z.object({reasoningText:X}),a.z.object({redactedReasoning:Y})]).nullish()})),role:a.z.string()})}),stopReason:J,trace:a.z.unknown().nullish(),usage:a.z.object({inputTokens:a.z.number(),outputTokens:a.z.number(),totalTokens:a.z.number(),cacheReadInputTokens:a.z.number().nullish(),cacheWriteInputTokens:a.z.number().nullish()})}),ee=a.z.object({contentBlockDelta:a.z.object({contentBlockIndex:a.z.number(),delta:a.z.union([a.z.object({text:a.z.string()}),a.z.object({toolUse:a.z.object({input:a.z.string()})}),a.z.object({reasoningContent:a.z.object({text:a.z.string()})}),a.z.object({reasoningContent:a.z.object({signature:a.z.string()})}),a.z.object({reasoningContent:a.z.object({data:a.z.string()})})]).nullish()}).nullish(),contentBlockStart:a.z.object({contentBlockIndex:a.z.number(),start:a.z.object({toolUse:K.nullish()}).nullish()}).nullish(),contentBlockStop:a.z.object({contentBlockIndex:a.z.number()}).nullish(),internalServerException:a.z.record(a.z.unknown()).nullish(),messageStop:a.z.object({additionalModelResponseFields:a.z.record(a.z.unknown()).nullish(),stopReason:J}).nullish(),metadata:a.z.object({trace:a.z.unknown().nullish(),usage:a.z.object({cacheReadInputTokens:a.z.number().nullish(),cacheWriteInputTokens:a.z.number().nullish(),inputTokens:a.z.number(),outputTokens:a.z.number()}).nullish()}).nullish(),modelStreamErrorException:a.z.record(a.z.unknown()).nullish(),throttlingException:a.z.record(a.z.unknown()).nullish(),validationException:a.z.record(a.z.unknown()).nullish()}),et=class{constructor(e,t,n){this.modelId=e,this.settings=t,this.config=n,this.specificationVersion="v1",this.provider="amazon-bedrock",this.maxEmbeddingsPerCall=void 0,this.supportsParallelCalls=!0}getUrl(e){let t=encodeURIComponent(e);return`${this.config.baseUrl()}/model/${t}/invoke`}async doEmbed({values:e,headers:t,abortSignal:n}){let r=async e=>{let r={inputText:e,dimensions:this.settings.dimensions,normalize:this.settings.normalize},s=this.getUrl(this.modelId),{value:o}=await (0,i.A8)({url:s,headers:await (0,i.DB)((0,i.NF)(await (0,i.DB)(this.config.headers),t)),body:r,failedResponseHandler:(0,i.Sq)({errorSchema:B,errorToMessage:e=>`${e.type}: ${e.message}`}),successfulResponseHandler:(0,i.tc)(en),fetch:this.config.fetch,abortSignal:n});return{embedding:o.embedding,inputTextTokenCount:o.inputTextTokenCount}};return(await Promise.all(e.map(r))).reduce((e,t)=>(e.embeddings.push(t.embedding),e.usage.tokens+=t.inputTextTokenCount,e),{embeddings:[],usage:{tokens:0}})}},en=a.z.object({embedding:a.z.array(a.z.number()),inputTextTokenCount:a.z.number()}),er={"amazon.nova-canvas-v1:0":5},es=class{constructor(e,t,n){this.modelId=e,this.settings=t,this.config=n,this.specificationVersion="v1",this.provider="amazon-bedrock"}get maxImagesPerCall(){var e,t;return null!=(t=null!=(e=this.settings.maxImagesPerCall)?e:er[this.modelId])?t:1}getUrl(e){let t=encodeURIComponent(e);return`${this.config.baseUrl()}/model/${t}/invoke`}async doGenerate({prompt:e,n:t,size:n,aspectRatio:r,seed:s,providerOptions:o,headers:a,abortSignal:l}){var u,c,d,h,f,p;let m=[],[g,y]=n?n.split("x").map(Number):[],b={taskType:"TEXT_IMAGE",textToImageParams:{text:e,...(null==(u=null==o?void 0:o.bedrock)?void 0:u.negativeText)?{negativeText:o.bedrock.negativeText}:{}},imageGenerationConfig:{...g?{width:g}:{},...y?{height:y}:{},...s?{seed:s}:{},...t?{numberOfImages:t}:{},...(null==(c=null==o?void 0:o.bedrock)?void 0:c.quality)?{quality:o.bedrock.quality}:{},...(null==(d=null==o?void 0:o.bedrock)?void 0:d.cfgScale)?{cfgScale:o.bedrock.cfgScale}:{}}};void 0!=r&&m.push({type:"unsupported-setting",setting:"aspectRatio",details:"This model does not support aspect ratio. Use `size` instead."});let v=null!=(p=null==(f=null==(h=this.config._internal)?void 0:h.currentDate)?void 0:f.call(h))?p:new Date,{value:_,responseHeaders:w}=await (0,i.A8)({url:this.getUrl(this.modelId),headers:await (0,i.DB)((0,i.NF)(await (0,i.DB)(this.config.headers),a)),body:b,failedResponseHandler:(0,i.Sq)({errorSchema:B,errorToMessage:e=>`${e.type}: ${e.message}`}),successfulResponseHandler:(0,i.tc)(ei),abortSignal:l,fetch:this.config.fetch});return{images:_.images,warnings:m,response:{timestamp:v,modelId:this.modelId,headers:w}}}},ei=a.z.object({images:a.z.array(a.z.string())});function eo(e){let t={};return e.forEach((e,n)=>{t[n.toLowerCase()]=e}),t}!function(e={}){let t=function(e,t=globalThis.fetch){return async(n,r)=>{var s,o;if((null==(s=null==r?void 0:r.method)?void 0:s.toUpperCase())!=="POST"||!(null==r?void 0:r.body))return t(n,r);let a="string"==typeof n?n:n instanceof URL?n.href:n.url,l=function(e){let t={};if(e){if(e instanceof Headers)t=eo(e);else if(Array.isArray(e))for(let[n,r]of e)t[n.toLowerCase()]=r;else t=Object.fromEntries(Object.entries(e).map(([e,t])=>[e.toLowerCase(),t]))}return t}(r.headers),u="string"==typeof(o=r.body)?o:o instanceof Uint8Array?new TextDecoder().decode(o):o instanceof ArrayBuffer?new TextDecoder().decode(new Uint8Array(o)):JSON.stringify(o),c=await e(),d=new P({url:a,method:"POST",headers:Object.entries((0,i.lP)(l)),body:u,region:c.region,accessKeyId:c.accessKeyId,secretAccessKey:c.secretAccessKey,sessionToken:c.sessionToken,service:"bedrock"}),h=eo((await d.sign()).headers);return t(n,{...r,body:u,headers:(0,i.lP)((0,i.NF)(l,h))})}}(async()=>{let t=(0,i.qU)({settingValue:e.region,settingName:"region",environmentVariableName:"AWS_REGION",description:"AWS region"});return e.credentialProvider?{...await e.credentialProvider(),region:t}:{region:t,accessKeyId:(0,i.qU)({settingValue:e.accessKeyId,settingName:"accessKeyId",environmentVariableName:"AWS_ACCESS_KEY_ID",description:"AWS access key ID"}),secretAccessKey:(0,i.qU)({settingValue:e.secretAccessKey,settingName:"secretAccessKey",environmentVariableName:"AWS_SECRET_ACCESS_KEY",description:"AWS secret access key"}),sessionToken:(0,i.P6)({settingValue:e.sessionToken,environmentVariableName:"AWS_SESSION_TOKEN"})}},e.fetch),n=()=>{var t,n;return null!=(n=(0,i.QT)(null!=(t=e.baseURL)?t:`https://bedrock-runtime.${(0,i.qU)({settingValue:e.region,settingName:"region",environmentVariableName:"AWS_REGION",description:"AWS region"})}.amazonaws.com`))?n:"https://bedrock-runtime.us-east-1.amazonaws.com"},r=(r,s={})=>{var o;return new G(r,s,{baseUrl:n,headers:null!=(o=e.headers)?o:{},fetch:t,generateId:i.Ox})},s=function(e,t){if(new.target)throw Error("The Amazon Bedrock model function cannot be called with the new keyword.");return r(e,t)},o=(r,s={})=>{var i;return new et(r,s,{baseUrl:n,headers:null!=(i=e.headers)?i:{},fetch:t})},a=(r,s={})=>{var i;return new es(r,s,{baseUrl:n,headers:null!=(i=e.headers)?i:{},fetch:t})};s.languageModel=r,s.embedding=o,s.textEmbedding=o,s.textEmbeddingModel=o,s.image=a,s.imageModel=a}()},6625:function(e,t,n){"use strict";var r=n(2244),s=n(939),i=n(858);function o(e){var t,n;return null!=(n=null==(t=null==e?void 0:e.content)?void 0:t.map(({token:e,logprob:t,top_logprobs:n})=>({token:e,logprob:t,topLogprobs:n?n.map(({token:e,logprob:t})=>({token:e,logprob:t})):[]})))?n:void 0}function a(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var l=i.z.object({error:i.z.object({message:i.z.string(),type:i.z.string().nullish(),param:i.z.any().nullish(),code:i.z.union([i.z.string(),i.z.number()]).nullish()})}),u=(0,s.Sq)({errorSchema:l,errorToMessage:e=>e.error.message});function c({id:e,model:t,created:n}){return{id:null!=e?e:void 0,modelId:null!=t?t:void 0,timestamp:null!=n?new Date(1e3*n):void 0}}var d=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get supportsStructuredOutputs(){var e;return null!=(e=this.settings.structuredOutputs)?e:m(this.modelId)}get defaultObjectGenerationMode(){return this.modelId.startsWith("gpt-4o-audio-preview")?"tool":this.supportsStructuredOutputs?"json":"tool"}get provider(){return this.config.provider}get supportsImageUrls(){return!this.settings.downloadImages}getArgs({mode:e,prompt:t,maxTokens:n,temperature:i,topP:o,topK:a,frequencyPenalty:l,presencePenalty:u,stopSequences:c,responseFormat:d,seed:h,providerMetadata:f}){var p,y,b,v,_,w,x,k,S,A,I;let E=e.type,T=[];null!=a&&T.push({type:"unsupported-setting",setting:"topK"}),(null==d?void 0:d.type)!=="json"||null==d.schema||this.supportsStructuredOutputs||T.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is only supported with structuredOutputs"});let z=this.settings.useLegacyFunctionCalling;if(z&&!0===this.settings.parallelToolCalls)throw new r.A_({functionality:"useLegacyFunctionCalling with parallelToolCalls"});if(z&&this.supportsStructuredOutputs)throw new r.A_({functionality:"structuredOutputs with useLegacyFunctionCalling"});let{messages:C,warnings:j}=function({prompt:e,useLegacyFunctionCalling:t=!1,systemMessageMode:n="system"}){let i=[],o=[];for(let{role:a,content:l}of e)switch(a){case"system":switch(n){case"system":i.push({role:"system",content:l});break;case"developer":i.push({role:"developer",content:l});break;case"remove":o.push({type:"other",message:"system messages are removed for this model"});break;default:throw Error(`Unsupported system message mode: ${n}`)}break;case"user":if(1===l.length&&"text"===l[0].type){i.push({role:"user",content:l[0].text});break}i.push({role:"user",content:l.map((e,t)=>{var n,i,o,a;switch(e.type){case"text":return{type:"text",text:e.text};case"image":return{type:"image_url",image_url:{url:e.image instanceof URL?e.image.toString():`data:${null!=(n=e.mimeType)?n:"image/jpeg"};base64,${(0,s.k0)(e.image)}`,detail:null==(o=null==(i=e.providerMetadata)?void 0:i.openai)?void 0:o.imageDetail}};case"file":if(e.data instanceof URL)throw new r.A_({functionality:"'File content parts with URL data' functionality not supported."});switch(e.mimeType){case"audio/wav":return{type:"input_audio",input_audio:{data:e.data,format:"wav"}};case"audio/mp3":case"audio/mpeg":return{type:"input_audio",input_audio:{data:e.data,format:"mp3"}};case"application/pdf":return{type:"file",file:{filename:null!=(a=e.filename)?a:`part-${t}.pdf`,file_data:`data:application/pdf;base64,${e.data}`}};default:throw new r.A_({functionality:`File content part type ${e.mimeType} in user messages`})}}})});break;case"assistant":{let e="",n=[];for(let t of l)switch(t.type){case"text":e+=t.text;break;case"tool-call":n.push({id:t.toolCallId,type:"function",function:{name:t.toolName,arguments:JSON.stringify(t.args)}})}if(t){if(n.length>1)throw new r.A_({functionality:"useLegacyFunctionCalling with multiple tool calls in one message"});i.push({role:"assistant",content:e,function_call:n.length>0?n[0].function:void 0})}else i.push({role:"assistant",content:e,tool_calls:n.length>0?n:void 0});break}case"tool":for(let e of l)t?i.push({role:"function",name:e.toolName,content:JSON.stringify(e.result)}):i.push({role:"tool",tool_call_id:e.toolCallId,content:JSON.stringify(e.result)});break;default:throw Error(`Unsupported role: ${a}`)}return{messages:i,warnings:o}}({prompt:t,useLegacyFunctionCalling:z,systemMessageMode:m(S=this.modelId)?null!=(I=null==(A=g[S])?void 0:A.systemMessageMode)?I:"developer":"system"});T.push(...j);let N={model:this.modelId,logit_bias:this.settings.logitBias,logprobs:!0===this.settings.logprobs||"number"==typeof this.settings.logprobs||void 0,top_logprobs:"number"==typeof this.settings.logprobs?this.settings.logprobs:"boolean"==typeof this.settings.logprobs&&this.settings.logprobs?0:void 0,user:this.settings.user,parallel_tool_calls:this.settings.parallelToolCalls,max_tokens:n,temperature:i,top_p:o,frequency_penalty:l,presence_penalty:u,response_format:(null==d?void 0:d.type)==="json"?this.supportsStructuredOutputs&&null!=d.schema?{type:"json_schema",json_schema:{schema:d.schema,strict:!0,name:null!=(p=d.name)?p:"response",description:d.description}}:{type:"json_object"}:void 0,stop:c,seed:h,max_completion_tokens:null==(y=null==f?void 0:f.openai)?void 0:y.maxCompletionTokens,store:null==(b=null==f?void 0:f.openai)?void 0:b.store,metadata:null==(v=null==f?void 0:f.openai)?void 0:v.metadata,prediction:null==(_=null==f?void 0:f.openai)?void 0:_.prediction,reasoning_effort:null!=(x=null==(w=null==f?void 0:f.openai)?void 0:w.reasoningEffort)?x:this.settings.reasoningEffort,messages:C};switch(m(this.modelId)?(null!=N.temperature&&(N.temperature=void 0,T.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),null!=N.top_p&&(N.top_p=void 0,T.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"})),null!=N.frequency_penalty&&(N.frequency_penalty=void 0,T.push({type:"unsupported-setting",setting:"frequencyPenalty",details:"frequencyPenalty is not supported for reasoning models"})),null!=N.presence_penalty&&(N.presence_penalty=void 0,T.push({type:"unsupported-setting",setting:"presencePenalty",details:"presencePenalty is not supported for reasoning models"})),null!=N.logit_bias&&(N.logit_bias=void 0,T.push({type:"other",message:"logitBias is not supported for reasoning models"})),null!=N.logprobs&&(N.logprobs=void 0,T.push({type:"other",message:"logprobs is not supported for reasoning models"})),null!=N.top_logprobs&&(N.top_logprobs=void 0,T.push({type:"other",message:"topLogprobs is not supported for reasoning models"})),null!=N.max_tokens&&(null==N.max_completion_tokens&&(N.max_completion_tokens=N.max_tokens),N.max_tokens=void 0)):(this.modelId.startsWith("gpt-4o-search-preview")||this.modelId.startsWith("gpt-4o-mini-search-preview"))&&null!=N.temperature&&(N.temperature=void 0,T.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for the search preview models and has been removed."})),E){case"regular":{let{tools:t,tool_choice:n,functions:s,function_call:i,toolWarnings:o}=function({mode:e,useLegacyFunctionCalling:t=!1,structuredOutputs:n}){var s;let i=(null==(s=e.tools)?void 0:s.length)?e.tools:void 0,o=[];if(null==i)return{tools:void 0,tool_choice:void 0,toolWarnings:o};let a=e.toolChoice;if(t){let e=[];for(let t of i)"provider-defined"===t.type?o.push({type:"unsupported-tool",tool:t}):e.push({name:t.name,description:t.description,parameters:t.parameters});if(null==a)return{functions:e,function_call:void 0,toolWarnings:o};switch(a.type){case"auto":case"none":case void 0:return{functions:e,function_call:void 0,toolWarnings:o};case"required":throw new r.A_({functionality:"useLegacyFunctionCalling and toolChoice: required"});default:return{functions:e,function_call:{name:a.toolName},toolWarnings:o}}}let l=[];for(let e of i)"provider-defined"===e.type?o.push({type:"unsupported-tool",tool:e}):l.push({type:"function",function:{name:e.name,description:e.description,parameters:e.parameters,strict:!!n||void 0}});if(null==a)return{tools:l,tool_choice:void 0,toolWarnings:o};let u=a.type;switch(u){case"auto":case"none":case"required":return{tools:l,tool_choice:u,toolWarnings:o};case"tool":return{tools:l,tool_choice:{type:"function",function:{name:a.toolName}},toolWarnings:o};default:throw new r.A_({functionality:`Unsupported tool choice type: ${u}`})}}({mode:e,useLegacyFunctionCalling:z,structuredOutputs:this.supportsStructuredOutputs});return{args:{...N,tools:t,tool_choice:n,functions:s,function_call:i},warnings:[...T,...o]}}case"object-json":return{args:{...N,response_format:this.supportsStructuredOutputs&&null!=e.schema?{type:"json_schema",json_schema:{schema:e.schema,strict:!0,name:null!=(k=e.name)?k:"response",description:e.description}}:{type:"json_object"}},warnings:T};case"object-tool":return{args:z?{...N,function_call:{name:e.tool.name},functions:[{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters}]}:{...N,tool_choice:{type:"function",function:{name:e.tool.name}},tools:[{type:"function",function:{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters,strict:!!this.supportsStructuredOutputs||void 0}}]},warnings:T};default:throw Error(`Unsupported type: ${E}`)}}async doGenerate(e){var t,n,r,i,l,d,h,p;let{args:m,warnings:g}=this.getArgs(e),{responseHeaders:y,value:b,rawValue:v}=await (0,s.A8)({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:(0,s.NF)(this.config.headers(),e.headers),body:m,failedResponseHandler:u,successfulResponseHandler:(0,s.tc)(f),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:_,...w}=m,x=b.choices[0],k=null==(t=b.usage)?void 0:t.completion_tokens_details,S=null==(n=b.usage)?void 0:n.prompt_tokens_details,A={openai:{}};return(null==k?void 0:k.reasoning_tokens)!=null&&(A.openai.reasoningTokens=null==k?void 0:k.reasoning_tokens),(null==k?void 0:k.accepted_prediction_tokens)!=null&&(A.openai.acceptedPredictionTokens=null==k?void 0:k.accepted_prediction_tokens),(null==k?void 0:k.rejected_prediction_tokens)!=null&&(A.openai.rejectedPredictionTokens=null==k?void 0:k.rejected_prediction_tokens),(null==S?void 0:S.cached_tokens)!=null&&(A.openai.cachedPromptTokens=null==S?void 0:S.cached_tokens),{text:null!=(r=x.message.content)?r:void 0,toolCalls:this.settings.useLegacyFunctionCalling&&x.message.function_call?[{toolCallType:"function",toolCallId:(0,s.Ox)(),toolName:x.message.function_call.name,args:x.message.function_call.arguments}]:null==(i=x.message.tool_calls)?void 0:i.map(e=>{var t;return{toolCallType:"function",toolCallId:null!=(t=e.id)?t:(0,s.Ox)(),toolName:e.function.name,args:e.function.arguments}}),finishReason:a(x.finish_reason),usage:{promptTokens:null!=(d=null==(l=b.usage)?void 0:l.prompt_tokens)?d:NaN,completionTokens:null!=(p=null==(h=b.usage)?void 0:h.completion_tokens)?p:NaN},rawCall:{rawPrompt:_,rawSettings:w},rawResponse:{headers:y,body:v},request:{body:JSON.stringify(m)},response:c(b),warnings:g,logprobs:o(x.logprobs),providerMetadata:A}}async doStream(e){let t;if(this.settings.simulateStreaming){let t=await this.doGenerate(e);return{stream:new ReadableStream({start(e){if(e.enqueue({type:"response-metadata",...t.response}),t.text&&e.enqueue({type:"text-delta",textDelta:t.text}),t.toolCalls)for(let n of t.toolCalls)e.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:n.toolCallId,toolName:n.toolName,argsTextDelta:n.args}),e.enqueue({type:"tool-call",...n});e.enqueue({type:"finish",finishReason:t.finishReason,usage:t.usage,logprobs:t.logprobs,providerMetadata:t.providerMetadata}),e.close()}}),rawCall:t.rawCall,rawResponse:t.rawResponse,warnings:t.warnings}}let{args:n,warnings:i}=this.getArgs(e),l={...n,stream:!0,stream_options:"strict"===this.config.compatibility?{include_usage:!0}:void 0},{responseHeaders:d,value:h}=await (0,s.A8)({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:(0,s.NF)(this.config.headers(),e.headers),body:l,failedResponseHandler:u,successfulResponseHandler:(0,s.cP)(p),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:f,...m}=n,g=[],y="unknown",b={promptTokens:void 0,completionTokens:void 0},v=!0,{useLegacyFunctionCalling:_}=this.settings,w={openai:{}};return{stream:h.pipeThrough(new TransformStream({transform(e,n){var i,l,u,d,h,f,p,m,x,k,S,A;if(!e.success){y="error",n.enqueue({type:"error",error:e.error});return}let I=e.value;if("error"in I){y="error",n.enqueue({type:"error",error:I.error});return}if(v&&(v=!1,n.enqueue({type:"response-metadata",...c(I)})),null!=I.usage){let{prompt_tokens:e,completion_tokens:t,prompt_tokens_details:n,completion_tokens_details:r}=I.usage;b={promptTokens:null!=e?e:void 0,completionTokens:null!=t?t:void 0},(null==r?void 0:r.reasoning_tokens)!=null&&(w.openai.reasoningTokens=null==r?void 0:r.reasoning_tokens),(null==r?void 0:r.accepted_prediction_tokens)!=null&&(w.openai.acceptedPredictionTokens=null==r?void 0:r.accepted_prediction_tokens),(null==r?void 0:r.rejected_prediction_tokens)!=null&&(w.openai.rejectedPredictionTokens=null==r?void 0:r.rejected_prediction_tokens),(null==n?void 0:n.cached_tokens)!=null&&(w.openai.cachedPromptTokens=null==n?void 0:n.cached_tokens)}let E=I.choices[0];if((null==E?void 0:E.finish_reason)!=null&&(y=a(E.finish_reason)),(null==E?void 0:E.delta)==null)return;let T=E.delta;null!=T.content&&n.enqueue({type:"text-delta",textDelta:T.content});let z=o(null==E?void 0:E.logprobs);(null==z?void 0:z.length)&&(void 0===t&&(t=[]),t.push(...z));let C=_&&null!=T.function_call?[{type:"function",id:(0,s.Ox)(),function:T.function_call,index:0}]:T.tool_calls;if(null!=C)for(let e of C){let t=e.index;if(null==g[t]){if("function"!==e.type)throw new r.Rt({data:e,message:"Expected 'function' type."});if(null==e.id)throw new r.Rt({data:e,message:"Expected 'id' to be a string."});if((null==(i=e.function)?void 0:i.name)==null)throw new r.Rt({data:e,message:"Expected 'function.name' to be a string."});g[t]={id:e.id,type:"function",function:{name:e.function.name,arguments:null!=(l=e.function.arguments)?l:""},hasFinished:!1};let o=g[t];(null==(u=o.function)?void 0:u.name)!=null&&(null==(d=o.function)?void 0:d.arguments)!=null&&(o.function.arguments.length>0&&n.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:o.id,toolName:o.function.name,argsTextDelta:o.function.arguments}),(0,s.Gr)(o.function.arguments)&&(n.enqueue({type:"tool-call",toolCallType:"function",toolCallId:null!=(h=o.id)?h:(0,s.Ox)(),toolName:o.function.name,args:o.function.arguments}),o.hasFinished=!0));continue}let o=g[t];!o.hasFinished&&((null==(f=e.function)?void 0:f.arguments)!=null&&(o.function.arguments+=null!=(m=null==(p=e.function)?void 0:p.arguments)?m:""),n.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:o.id,toolName:o.function.name,argsTextDelta:null!=(x=e.function.arguments)?x:""}),(null==(k=o.function)?void 0:k.name)!=null&&(null==(S=o.function)?void 0:S.arguments)!=null&&(0,s.Gr)(o.function.arguments)&&(n.enqueue({type:"tool-call",toolCallType:"function",toolCallId:null!=(A=o.id)?A:(0,s.Ox)(),toolName:o.function.name,args:o.function.arguments}),o.hasFinished=!0))}},flush(e){var n,r;e.enqueue({type:"finish",finishReason:y,logprobs:t,usage:{promptTokens:null!=(n=b.promptTokens)?n:NaN,completionTokens:null!=(r=b.completionTokens)?r:NaN},...null!=w?{providerMetadata:w}:{}})}})),rawCall:{rawPrompt:f,rawSettings:m},rawResponse:{headers:d},request:{body:JSON.stringify(l)},warnings:i}}},h=i.z.object({prompt_tokens:i.z.number().nullish(),completion_tokens:i.z.number().nullish(),prompt_tokens_details:i.z.object({cached_tokens:i.z.number().nullish()}).nullish(),completion_tokens_details:i.z.object({reasoning_tokens:i.z.number().nullish(),accepted_prediction_tokens:i.z.number().nullish(),rejected_prediction_tokens:i.z.number().nullish()}).nullish()}).nullish(),f=i.z.object({id:i.z.string().nullish(),created:i.z.number().nullish(),model:i.z.string().nullish(),choices:i.z.array(i.z.object({message:i.z.object({role:i.z.literal("assistant").nullish(),content:i.z.string().nullish(),function_call:i.z.object({arguments:i.z.string(),name:i.z.string()}).nullish(),tool_calls:i.z.array(i.z.object({id:i.z.string().nullish(),type:i.z.literal("function"),function:i.z.object({name:i.z.string(),arguments:i.z.string()})})).nullish()}),index:i.z.number(),logprobs:i.z.object({content:i.z.array(i.z.object({token:i.z.string(),logprob:i.z.number(),top_logprobs:i.z.array(i.z.object({token:i.z.string(),logprob:i.z.number()}))})).nullable()}).nullish(),finish_reason:i.z.string().nullish()})),usage:h}),p=i.z.union([i.z.object({id:i.z.string().nullish(),created:i.z.number().nullish(),model:i.z.string().nullish(),choices:i.z.array(i.z.object({delta:i.z.object({role:i.z.enum(["assistant"]).nullish(),content:i.z.string().nullish(),function_call:i.z.object({name:i.z.string().optional(),arguments:i.z.string().optional()}).nullish(),tool_calls:i.z.array(i.z.object({index:i.z.number(),id:i.z.string().nullish(),type:i.z.literal("function").nullish(),function:i.z.object({name:i.z.string().nullish(),arguments:i.z.string().nullish()})})).nullish()}).nullish(),logprobs:i.z.object({content:i.z.array(i.z.object({token:i.z.string(),logprob:i.z.number(),top_logprobs:i.z.array(i.z.object({token:i.z.string(),logprob:i.z.number()}))})).nullable()}).nullish(),finish_reason:i.z.string().nullish(),index:i.z.number()})),usage:h}),l]);function m(e){return e.startsWith("o")}var g={"o1-mini":{systemMessageMode:"remove"},"o1-mini-2024-09-12":{systemMessageMode:"remove"},"o1-preview":{systemMessageMode:"remove"},"o1-preview-2024-09-12":{systemMessageMode:"remove"},o3:{systemMessageMode:"developer"},"o3-2025-04-16":{systemMessageMode:"developer"},"o3-mini":{systemMessageMode:"developer"},"o3-mini-2025-01-31":{systemMessageMode:"developer"},"o4-mini":{systemMessageMode:"developer"},"o4-mini-2025-04-16":{systemMessageMode:"developer"}};function y(e){return null==e?void 0:e.tokens.map((t,n)=>({token:t,logprob:e.token_logprobs[n],topLogprobs:e.top_logprobs?Object.entries(e.top_logprobs[n]).map(([e,t])=>({token:e,logprob:t})):[]}))}var b=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0,this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}getArgs({mode:e,inputFormat:t,prompt:n,maxTokens:s,temperature:i,topP:o,topK:a,frequencyPenalty:l,presencePenalty:u,stopSequences:c,responseFormat:d,seed:h}){var f;let p=e.type,m=[];null!=a&&m.push({type:"unsupported-setting",setting:"topK"}),null!=d&&"text"!==d.type&&m.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});let{prompt:g,stopSequences:y}=function({prompt:e,inputFormat:t,user:n="user",assistant:s="assistant"}){if("prompt"===t&&1===e.length&&"user"===e[0].role&&1===e[0].content.length&&"text"===e[0].content[0].type)return{prompt:e[0].content[0].text};let i="";for(let{role:t,content:o}of("system"===e[0].role&&(i+=`${e[0].content}

`,e=e.slice(1)),e))switch(t){case"system":throw new r.Mt({message:"Unexpected system message in prompt: ${content}",prompt:e});case"user":{let e=o.map(e=>{switch(e.type){case"text":return e.text;case"image":throw new r.A_({functionality:"images"})}}).join("");i+=`${n}:
${e}

`;break}case"assistant":{let e=o.map(e=>{switch(e.type){case"text":return e.text;case"tool-call":throw new r.A_({functionality:"tool-call messages"})}}).join("");i+=`${s}:
${e}

`;break}case"tool":throw new r.A_({functionality:"tool messages"});default:throw Error(`Unsupported role: ${t}`)}return{prompt:i+=`${s}:
`,stopSequences:[`
${n}:`]}}({prompt:n,inputFormat:t}),b=[...null!=y?y:[],...null!=c?c:[]],v={model:this.modelId,echo:this.settings.echo,logit_bias:this.settings.logitBias,logprobs:"number"==typeof this.settings.logprobs?this.settings.logprobs:"boolean"==typeof this.settings.logprobs&&this.settings.logprobs?0:void 0,suffix:this.settings.suffix,user:this.settings.user,max_tokens:s,temperature:i,top_p:o,frequency_penalty:l,presence_penalty:u,seed:h,prompt:g,stop:b.length>0?b:void 0};switch(p){case"regular":if(null==(f=e.tools)?void 0:f.length)throw new r.A_({functionality:"tools"});if(e.toolChoice)throw new r.A_({functionality:"toolChoice"});return{args:v,warnings:m};case"object-json":throw new r.A_({functionality:"object-json mode"});case"object-tool":throw new r.A_({functionality:"object-tool mode"});default:throw Error(`Unsupported type: ${p}`)}}async doGenerate(e){let{args:t,warnings:n}=this.getArgs(e),{responseHeaders:r,value:i,rawValue:o}=await (0,s.A8)({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:(0,s.NF)(this.config.headers(),e.headers),body:t,failedResponseHandler:u,successfulResponseHandler:(0,s.tc)(v),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:l,...d}=t,h=i.choices[0];return{text:h.text,usage:{promptTokens:i.usage.prompt_tokens,completionTokens:i.usage.completion_tokens},finishReason:a(h.finish_reason),logprobs:y(h.logprobs),rawCall:{rawPrompt:l,rawSettings:d},rawResponse:{headers:r,body:o},response:c(i),warnings:n,request:{body:JSON.stringify(t)}}}async doStream(e){let t;let{args:n,warnings:r}=this.getArgs(e),i={...n,stream:!0,stream_options:"strict"===this.config.compatibility?{include_usage:!0}:void 0},{responseHeaders:o,value:l}=await (0,s.A8)({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:(0,s.NF)(this.config.headers(),e.headers),body:i,failedResponseHandler:u,successfulResponseHandler:(0,s.cP)(_),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:d,...h}=n,f="unknown",p={promptTokens:Number.NaN,completionTokens:Number.NaN},m=!0;return{stream:l.pipeThrough(new TransformStream({transform(e,n){if(!e.success){f="error",n.enqueue({type:"error",error:e.error});return}let r=e.value;if("error"in r){f="error",n.enqueue({type:"error",error:r.error});return}m&&(m=!1,n.enqueue({type:"response-metadata",...c(r)})),null!=r.usage&&(p={promptTokens:r.usage.prompt_tokens,completionTokens:r.usage.completion_tokens});let s=r.choices[0];(null==s?void 0:s.finish_reason)!=null&&(f=a(s.finish_reason)),(null==s?void 0:s.text)!=null&&n.enqueue({type:"text-delta",textDelta:s.text});let i=y(null==s?void 0:s.logprobs);(null==i?void 0:i.length)&&(void 0===t&&(t=[]),t.push(...i))},flush(e){e.enqueue({type:"finish",finishReason:f,logprobs:t,usage:p})}})),rawCall:{rawPrompt:d,rawSettings:h},rawResponse:{headers:o},warnings:r,request:{body:JSON.stringify(i)}}}},v=i.z.object({id:i.z.string().nullish(),created:i.z.number().nullish(),model:i.z.string().nullish(),choices:i.z.array(i.z.object({text:i.z.string(),finish_reason:i.z.string(),logprobs:i.z.object({tokens:i.z.array(i.z.string()),token_logprobs:i.z.array(i.z.number()),top_logprobs:i.z.array(i.z.record(i.z.string(),i.z.number())).nullable()}).nullish()})),usage:i.z.object({prompt_tokens:i.z.number(),completion_tokens:i.z.number()})}),_=i.z.union([i.z.object({id:i.z.string().nullish(),created:i.z.number().nullish(),model:i.z.string().nullish(),choices:i.z.array(i.z.object({text:i.z.string(),finish_reason:i.z.string().nullish(),index:i.z.number(),logprobs:i.z.object({tokens:i.z.array(i.z.string()),token_logprobs:i.z.array(i.z.number()),top_logprobs:i.z.array(i.z.record(i.z.string(),i.z.number())).nullable()}).nullish()})),usage:i.z.object({prompt_tokens:i.z.number(),completion_tokens:i.z.number()}).nullish()}),l]),w=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return null!=(e=this.settings.maxEmbeddingsPerCall)?e:2048}get supportsParallelCalls(){var e;return null==(e=this.settings.supportsParallelCalls)||e}async doEmbed({values:e,headers:t,abortSignal:n}){if(e.length>this.maxEmbeddingsPerCall)throw new r.ON({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});let{responseHeaders:i,value:o}=await (0,s.A8)({url:this.config.url({path:"/embeddings",modelId:this.modelId}),headers:(0,s.NF)(this.config.headers(),t),body:{model:this.modelId,input:e,encoding_format:"float",dimensions:this.settings.dimensions,user:this.settings.user},failedResponseHandler:u,successfulResponseHandler:(0,s.tc)(x),abortSignal:n,fetch:this.config.fetch});return{embeddings:o.data.map(e=>e.embedding),usage:o.usage?{tokens:o.usage.prompt_tokens}:void 0,rawResponse:{headers:i}}}},x=i.z.object({data:i.z.array(i.z.object({embedding:i.z.array(i.z.number())})),usage:i.z.object({prompt_tokens:i.z.number()}).nullish()}),k={"dall-e-3":1,"dall-e-2":10,"gpt-image-1":10},S=new Set(["gpt-image-1"]),A=class{constructor(e,t,n){this.modelId=e,this.settings=t,this.config=n,this.specificationVersion="v1"}get maxImagesPerCall(){var e,t;return null!=(t=null!=(e=this.settings.maxImagesPerCall)?e:k[this.modelId])?t:1}get provider(){return this.config.provider}async doGenerate({prompt:e,n:t,size:n,aspectRatio:r,seed:i,providerOptions:o,headers:a,abortSignal:l}){var c,d,h,f;let p=[];null!=r&&p.push({type:"unsupported-setting",setting:"aspectRatio",details:"This model does not support aspect ratio. Use `size` instead."}),null!=i&&p.push({type:"unsupported-setting",setting:"seed"});let m=null!=(h=null==(d=null==(c=this.config._internal)?void 0:c.currentDate)?void 0:d.call(c))?h:new Date,{value:g,responseHeaders:y}=await (0,s.A8)({url:this.config.url({path:"/images/generations",modelId:this.modelId}),headers:(0,s.NF)(this.config.headers(),a),body:{model:this.modelId,prompt:e,n:t,size:n,...null!=(f=o.openai)?f:{},...S.has(this.modelId)?{}:{response_format:"b64_json"}},failedResponseHandler:u,successfulResponseHandler:(0,s.tc)(I),abortSignal:l,fetch:this.config.fetch});return{images:g.data.map(e=>e.b64_json),warnings:p,response:{timestamp:m,modelId:this.modelId,headers:y}}}},I=i.z.object({data:i.z.array(i.z.object({b64_json:i.z.string()}))}),E=i.z.object({include:i.z.array(i.z.string()).nullish(),language:i.z.string().nullish(),prompt:i.z.string().nullish(),temperature:i.z.number().min(0).max(1).nullish().default(0),timestampGranularities:i.z.array(i.z.enum(["word","segment"])).nullish().default(["segment"])}),T={afrikaans:"af",arabic:"ar",armenian:"hy",azerbaijani:"az",belarusian:"be",bosnian:"bs",bulgarian:"bg",catalan:"ca",chinese:"zh",croatian:"hr",czech:"cs",danish:"da",dutch:"nl",english:"en",estonian:"et",finnish:"fi",french:"fr",galician:"gl",german:"de",greek:"el",hebrew:"he",hindi:"hi",hungarian:"hu",icelandic:"is",indonesian:"id",italian:"it",japanese:"ja",kannada:"kn",kazakh:"kk",korean:"ko",latvian:"lv",lithuanian:"lt",macedonian:"mk",malay:"ms",marathi:"mr",maori:"mi",nepali:"ne",norwegian:"no",persian:"fa",polish:"pl",portuguese:"pt",romanian:"ro",russian:"ru",serbian:"sr",slovak:"sk",slovenian:"sl",spanish:"es",swahili:"sw",swedish:"sv",tagalog:"tl",tamil:"ta",thai:"th",turkish:"tr",ukrainian:"uk",urdu:"ur",vietnamese:"vi",welsh:"cy"},z=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v1"}get provider(){return this.config.provider}getArgs({audio:e,mediaType:t,providerOptions:n}){var r,i,o,a,l;let u=(0,s.c1)({provider:"openai",providerOptions:n,schema:E}),c=new FormData,d=e instanceof Uint8Array?new Blob([e]):new Blob([(0,s.MS)(e)]);if(c.append("model",this.modelId),c.append("file",new File([d],"audio",{type:t})),u){let e={include:null!=(r=u.include)?r:void 0,language:null!=(i=u.language)?i:void 0,prompt:null!=(o=u.prompt)?o:void 0,temperature:null!=(a=u.temperature)?a:void 0,timestamp_granularities:null!=(l=u.timestampGranularities)?l:void 0};for(let t in e){let n=e[t];void 0!==n&&c.append(t,String(n))}}return{formData:c,warnings:[]}}async doGenerate(e){var t,n,r,i,o,a;let l=null!=(r=null==(n=null==(t=this.config._internal)?void 0:t.currentDate)?void 0:n.call(t))?r:new Date,{formData:c,warnings:d}=this.getArgs(e),{value:h,responseHeaders:f,rawValue:p}=await (0,s.do)({url:this.config.url({path:"/audio/transcriptions",modelId:this.modelId}),headers:(0,s.NF)(this.config.headers(),e.headers),formData:c,failedResponseHandler:u,successfulResponseHandler:(0,s.tc)(C),abortSignal:e.abortSignal,fetch:this.config.fetch}),m=null!=h.language&&h.language in T?T[h.language]:void 0;return{text:h.text,segments:null!=(o=null==(i=h.words)?void 0:i.map(e=>({text:e.word,startSecond:e.start,endSecond:e.end})))?o:[],language:m,durationInSeconds:null!=(a=h.duration)?a:void 0,warnings:d,response:{timestamp:l,modelId:this.modelId,headers:f,body:p}}}},C=i.z.object({text:i.z.string(),language:i.z.string().nullish(),duration:i.z.number().nullish(),words:i.z.array(i.z.object({word:i.z.string(),start:i.z.number(),end:i.z.number()})).nullish()});function j({finishReason:e,hasToolCalls:t}){switch(e){case void 0:case null:return t?"tool-calls":"stop";case"max_output_tokens":return"length";case"content_filter":return"content-filter";default:return t?"tool-calls":"unknown"}}i.z.object({instructions:i.z.string().nullish(),speed:i.z.number().min(.25).max(4).default(1).nullish()});var N=class{constructor(e,t){this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsStructuredOutputs=!0,this.modelId=e,this.config=t}get provider(){return this.config.provider}getArgs({mode:e,maxTokens:t,temperature:n,stopSequences:i,topP:o,topK:a,presencePenalty:l,frequencyPenalty:u,seed:c,prompt:d,providerMetadata:h,responseFormat:f}){var p,m,g,y;let b=[],v=(y=this.modelId).startsWith("o")?y.startsWith("o1-mini")||y.startsWith("o1-preview")?{isReasoningModel:!0,systemMessageMode:"remove",requiredAutoTruncation:!1}:{isReasoningModel:!0,systemMessageMode:"developer",requiredAutoTruncation:!1}:{isReasoningModel:!1,systemMessageMode:"system",requiredAutoTruncation:!1},_=e.type;null!=a&&b.push({type:"unsupported-setting",setting:"topK"}),null!=c&&b.push({type:"unsupported-setting",setting:"seed"}),null!=l&&b.push({type:"unsupported-setting",setting:"presencePenalty"}),null!=u&&b.push({type:"unsupported-setting",setting:"frequencyPenalty"}),null!=i&&b.push({type:"unsupported-setting",setting:"stopSequences"});let{messages:w,warnings:x}=function({prompt:e,systemMessageMode:t}){let n=[],i=[];for(let{role:o,content:a}of e)switch(o){case"system":switch(t){case"system":n.push({role:"system",content:a});break;case"developer":n.push({role:"developer",content:a});break;case"remove":i.push({type:"other",message:"system messages are removed for this model"});break;default:throw Error(`Unsupported system message mode: ${t}`)}break;case"user":n.push({role:"user",content:a.map((e,t)=>{var n,i,o,a;switch(e.type){case"text":return{type:"input_text",text:e.text};case"image":return{type:"input_image",image_url:e.image instanceof URL?e.image.toString():`data:${null!=(n=e.mimeType)?n:"image/jpeg"};base64,${(0,s.k0)(e.image)}`,detail:null==(o=null==(i=e.providerMetadata)?void 0:i.openai)?void 0:o.imageDetail};case"file":if(e.data instanceof URL)throw new r.A_({functionality:"File URLs in user messages"});if("application/pdf"===e.mimeType)return{type:"input_file",filename:null!=(a=e.filename)?a:`part-${t}.pdf`,file_data:`data:application/pdf;base64,${e.data}`};throw new r.A_({functionality:"Only PDF files are supported in user messages"})}})});break;case"assistant":for(let e of a)switch(e.type){case"text":n.push({role:"assistant",content:[{type:"output_text",text:e.text}]});break;case"tool-call":n.push({type:"function_call",call_id:e.toolCallId,name:e.toolName,arguments:JSON.stringify(e.args)})}break;case"tool":for(let e of a)n.push({type:"function_call_output",call_id:e.toolCallId,output:JSON.stringify(e.result)});break;default:throw Error(`Unsupported role: ${o}`)}return{messages:n,warnings:i}}({prompt:d,systemMessageMode:v.systemMessageMode});b.push(...x);let k=(0,s.c1)({provider:"openai",providerOptions:h,schema:q}),S=null==(p=null==k?void 0:k.strictSchemas)||p,A={model:this.modelId,input:w,temperature:n,top_p:o,max_output_tokens:t,...(null==f?void 0:f.type)==="json"&&{text:{format:null!=f.schema?{type:"json_schema",strict:S,name:null!=(m=f.name)?m:"response",description:f.description,schema:f.schema}:{type:"json_object"}}},metadata:null==k?void 0:k.metadata,parallel_tool_calls:null==k?void 0:k.parallelToolCalls,previous_response_id:null==k?void 0:k.previousResponseId,store:null==k?void 0:k.store,user:null==k?void 0:k.user,instructions:null==k?void 0:k.instructions,...v.isReasoningModel&&((null==k?void 0:k.reasoningEffort)!=null||(null==k?void 0:k.reasoningSummary)!=null)&&{reasoning:{...(null==k?void 0:k.reasoningEffort)!=null&&{effort:k.reasoningEffort},...(null==k?void 0:k.reasoningSummary)!=null&&{summary:k.reasoningSummary}}},...v.requiredAutoTruncation&&{truncation:"auto"}};switch(v.isReasoningModel&&(null!=A.temperature&&(A.temperature=void 0,b.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),null!=A.top_p&&(A.top_p=void 0,b.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"}))),_){case"regular":{let{tools:t,tool_choice:n,toolWarnings:s}=function({mode:e,strict:t}){var n;let s=(null==(n=e.tools)?void 0:n.length)?e.tools:void 0,i=[];if(null==s)return{tools:void 0,tool_choice:void 0,toolWarnings:i};let o=e.toolChoice,a=[];for(let e of s)switch(e.type){case"function":a.push({type:"function",name:e.name,description:e.description,parameters:e.parameters,strict:!!t||void 0});break;case"provider-defined":"openai.web_search_preview"===e.id?a.push({type:"web_search_preview",search_context_size:e.args.searchContextSize,user_location:e.args.userLocation}):i.push({type:"unsupported-tool",tool:e});break;default:i.push({type:"unsupported-tool",tool:e})}if(null==o)return{tools:a,tool_choice:void 0,toolWarnings:i};let l=o.type;switch(l){case"auto":case"none":case"required":return{tools:a,tool_choice:l,toolWarnings:i};case"tool":if("web_search_preview"===o.toolName)return{tools:a,tool_choice:{type:"web_search_preview"},toolWarnings:i};return{tools:a,tool_choice:{type:"function",name:o.toolName},toolWarnings:i};default:throw new r.A_({functionality:`Unsupported tool choice type: ${l}`})}}({mode:e,strict:S});return{args:{...A,tools:t,tool_choice:n},warnings:[...b,...s]}}case"object-json":return{args:{...A,text:{format:null!=e.schema?{type:"json_schema",strict:S,name:null!=(g=e.name)?g:"response",description:e.description,schema:e.schema}:{type:"json_object"}}},warnings:b};case"object-tool":return{args:{...A,tool_choice:{type:"function",name:e.tool.name},tools:[{type:"function",name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters,strict:S}]},warnings:b};default:throw Error(`Unsupported type: ${_}`)}}async doGenerate(e){var t,n,r,o,a,l,c;let{args:d,warnings:h}=this.getArgs(e),{responseHeaders:f,value:p,rawValue:m}=await (0,s.A8)({url:this.config.url({path:"/responses",modelId:this.modelId}),headers:(0,s.NF)(this.config.headers(),e.headers),body:d,failedResponseHandler:u,successfulResponseHandler:(0,s.tc)(i.z.object({id:i.z.string(),created_at:i.z.number(),model:i.z.string(),output:i.z.array(i.z.discriminatedUnion("type",[i.z.object({type:i.z.literal("message"),role:i.z.literal("assistant"),content:i.z.array(i.z.object({type:i.z.literal("output_text"),text:i.z.string(),annotations:i.z.array(i.z.object({type:i.z.literal("url_citation"),start_index:i.z.number(),end_index:i.z.number(),url:i.z.string(),title:i.z.string()}))}))}),i.z.object({type:i.z.literal("function_call"),call_id:i.z.string(),name:i.z.string(),arguments:i.z.string()}),i.z.object({type:i.z.literal("web_search_call")}),i.z.object({type:i.z.literal("computer_call")}),i.z.object({type:i.z.literal("reasoning"),summary:i.z.array(i.z.object({type:i.z.literal("summary_text"),text:i.z.string()}))})])),incomplete_details:i.z.object({reason:i.z.string()}).nullable(),usage:O})),abortSignal:e.abortSignal,fetch:this.config.fetch}),g=p.output.filter(e=>"message"===e.type).flatMap(e=>e.content).filter(e=>"output_text"===e.type),y=p.output.filter(e=>"function_call"===e.type).map(e=>({toolCallType:"function",toolCallId:e.call_id,toolName:e.name,args:e.arguments})),b=null!=(n=null==(t=p.output.find(e=>"reasoning"===e.type))?void 0:t.summary)?n:null;return{text:g.map(e=>e.text).join("\n"),sources:g.flatMap(e=>e.annotations.map(e=>{var t,n,r;return{sourceType:"url",id:null!=(r=null==(n=(t=this.config).generateId)?void 0:n.call(t))?r:(0,s.Ox)(),url:e.url,title:e.title}})),finishReason:j({finishReason:null==(r=p.incomplete_details)?void 0:r.reason,hasToolCalls:y.length>0}),toolCalls:y.length>0?y:void 0,reasoning:b?b.map(e=>({type:"text",text:e.text})):void 0,usage:{promptTokens:p.usage.input_tokens,completionTokens:p.usage.output_tokens},rawCall:{rawPrompt:void 0,rawSettings:{}},rawResponse:{headers:f,body:m},request:{body:JSON.stringify(d)},response:{id:p.id,timestamp:new Date(1e3*p.created_at),modelId:p.model},providerMetadata:{openai:{responseId:p.id,cachedPromptTokens:null!=(a=null==(o=p.usage.input_tokens_details)?void 0:o.cached_tokens)?a:null,reasoningTokens:null!=(c=null==(l=p.usage.output_tokens_details)?void 0:l.reasoning_tokens)?c:null}},warnings:h}}async doStream(e){let{args:t,warnings:n}=this.getArgs(e),{responseHeaders:r,value:i}=await (0,s.A8)({url:this.config.url({path:"/responses",modelId:this.modelId}),headers:(0,s.NF)(this.config.headers(),e.headers),body:{...t,stream:!0},failedResponseHandler:u,successfulResponseHandler:(0,s.cP)(D),abortSignal:e.abortSignal,fetch:this.config.fetch}),o=this,a="unknown",l=NaN,c=NaN,d=null,h=null,f=null,p={},m=!1;return{stream:i.pipeThrough(new TransformStream({transform(e,t){var n,r,i,u,g,y,b,v;if(!e.success){a="error",t.enqueue({type:"error",error:e.error});return}let _=e.value;if("response.output_item.added"===_.type)"function_call"===_.item.type&&(p[_.output_index]={toolName:_.item.name,toolCallId:_.item.call_id},t.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:_.item.call_id,toolName:_.item.name,argsTextDelta:_.item.arguments}));else if("response.function_call_arguments.delta"===_.type){let e=p[_.output_index];null!=e&&t.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:e.toolCallId,toolName:e.toolName,argsTextDelta:_.delta})}else"response.created"===_.type?(f=_.response.id,t.enqueue({type:"response-metadata",id:_.response.id,timestamp:new Date(1e3*_.response.created_at),modelId:_.response.model})):"response.output_text.delta"===_.type?t.enqueue({type:"text-delta",textDelta:_.delta}):"response.reasoning_summary_text.delta"===_.type?t.enqueue({type:"reasoning",textDelta:_.delta}):"response.output_item.done"===_.type&&"function_call"===_.item.type?(p[_.output_index]=void 0,m=!0,t.enqueue({type:"tool-call",toolCallType:"function",toolCallId:_.item.call_id,toolName:_.item.name,args:_.item.arguments})):"response.completed"===_.type||"response.incomplete"===_.type?(a=j({finishReason:null==(n=_.response.incomplete_details)?void 0:n.reason,hasToolCalls:m}),l=_.response.usage.input_tokens,c=_.response.usage.output_tokens,d=null!=(i=null==(r=_.response.usage.input_tokens_details)?void 0:r.cached_tokens)?i:d,h=null!=(g=null==(u=_.response.usage.output_tokens_details)?void 0:u.reasoning_tokens)?g:h):"response.output_text.annotation.added"===_.type&&t.enqueue({type:"source",source:{sourceType:"url",id:null!=(v=null==(b=(y=o.config).generateId)?void 0:b.call(y))?v:(0,s.Ox)(),url:_.annotation.url,title:_.annotation.title}})},flush(e){e.enqueue({type:"finish",finishReason:a,usage:{promptTokens:l,completionTokens:c},...(null!=d||null!=h)&&{providerMetadata:{openai:{responseId:f,cachedPromptTokens:d,reasoningTokens:h}}}})}})),rawCall:{rawPrompt:void 0,rawSettings:{}},rawResponse:{headers:r},request:{body:JSON.stringify(t)},warnings:n}}},O=i.z.object({input_tokens:i.z.number(),input_tokens_details:i.z.object({cached_tokens:i.z.number().nullish()}).nullish(),output_tokens:i.z.number(),output_tokens_details:i.z.object({reasoning_tokens:i.z.number().nullish()}).nullish()}),P=i.z.object({type:i.z.literal("response.output_text.delta"),delta:i.z.string()}),R=i.z.object({type:i.z.enum(["response.completed","response.incomplete"]),response:i.z.object({incomplete_details:i.z.object({reason:i.z.string()}).nullish(),usage:O})}),M=i.z.object({type:i.z.literal("response.created"),response:i.z.object({id:i.z.string(),created_at:i.z.number(),model:i.z.string()})}),U=i.z.object({type:i.z.literal("response.output_item.done"),output_index:i.z.number(),item:i.z.discriminatedUnion("type",[i.z.object({type:i.z.literal("message")}),i.z.object({type:i.z.literal("function_call"),id:i.z.string(),call_id:i.z.string(),name:i.z.string(),arguments:i.z.string(),status:i.z.literal("completed")})])}),$=i.z.object({type:i.z.literal("response.function_call_arguments.delta"),item_id:i.z.string(),output_index:i.z.number(),delta:i.z.string()}),L=i.z.object({type:i.z.literal("response.output_item.added"),output_index:i.z.number(),item:i.z.discriminatedUnion("type",[i.z.object({type:i.z.literal("message")}),i.z.object({type:i.z.literal("function_call"),id:i.z.string(),call_id:i.z.string(),name:i.z.string(),arguments:i.z.string()})])}),F=i.z.object({type:i.z.literal("response.output_text.annotation.added"),annotation:i.z.object({type:i.z.literal("url_citation"),url:i.z.string(),title:i.z.string()})}),B=i.z.object({type:i.z.literal("response.reasoning_summary_text.delta"),item_id:i.z.string(),output_index:i.z.number(),summary_index:i.z.number(),delta:i.z.string()}),D=i.z.union([P,R,M,U,$,L,F,B,i.z.object({type:i.z.string()}).passthrough()]),q=i.z.object({metadata:i.z.any().nullish(),parallelToolCalls:i.z.boolean().nullish(),previousResponseId:i.z.string().nullish(),store:i.z.boolean().nullish(),user:i.z.string().nullish(),reasoningEffort:i.z.string().nullish(),strictSchemas:i.z.boolean().nullish(),instructions:i.z.string().nullish(),reasoningSummary:i.z.string().nullish()});!function(e={}){var t;let n=()=>({"api-key":(0,s.pd)({apiKey:e.apiKey,environmentVariableName:"AZURE_API_KEY",description:"Azure OpenAI"}),...e.headers}),r=()=>(0,s.qU)({settingValue:e.resourceName,settingName:"resourceName",environmentVariableName:"AZURE_RESOURCE_NAME",description:"Azure OpenAI resource name"}),i=null!=(t=e.apiVersion)?t:"2025-03-01-preview",o=({path:t,modelId:n})=>"/responses"===t?e.baseURL?`${e.baseURL}${t}?api-version=${i}`:`https://${r()}.openai.azure.com/openai/responses?api-version=${i}`:e.baseURL?`${e.baseURL}/${n}${t}?api-version=${i}`:`https://${r()}.openai.azure.com/openai/deployments/${n}${t}?api-version=${i}`,a=(t,r={})=>new d(t,r,{provider:"azure-openai.chat",url:o,headers:n,compatibility:"strict",fetch:e.fetch}),l=(t,r={})=>new w(t,r,{provider:"azure-openai.embeddings",headers:n,url:o,fetch:e.fetch}),u=(t,r={})=>new A(t,r,{provider:"azure-openai.image",url:o,headers:n,fetch:e.fetch}),c=function(e,t){if(new.target)throw Error("The Azure OpenAI model function cannot be called with the new keyword.");return a(e,t)};c.languageModel=a,c.chat=a,c.completion=(t,r={})=>new b(t,r,{provider:"azure-openai.completion",url:o,compatibility:"strict",headers:n,fetch:e.fetch}),c.embedding=l,c.image=u,c.imageModel=u,c.textEmbedding=l,c.textEmbeddingModel=l,c.responses=t=>new N(t,{provider:"azure-openai.responses",url:o,headers:n,fetch:e.fetch}),c.transcription=t=>new z(t,{provider:"azure-openai.transcription",url:o,headers:n,fetch:e.fetch})}()},74:function(e,t,n){"use strict";var r=n(6076),s=n(2244),i=n(939),o=n(858),a={errorSchema:o.z.object({message:o.z.string(),type:o.z.string(),param:o.z.string(),code:o.z.string()}),errorToMessage:e=>e.message};!function(e={}){var t;let n=(0,i.QT)(null!=(t=e.baseURL)?t:"https://api.cerebras.ai/v1"),o=()=>({Authorization:`Bearer ${(0,i.pd)({apiKey:e.apiKey,environmentVariableName:"CEREBRAS_API_KEY",description:"Cerebras API key"})}`,...e.headers}),l=(t,s={})=>new r.IY(t,s,{provider:"cerebras.chat",url:({path:e})=>`${n}${e}`,headers:o,fetch:e.fetch,defaultObjectGenerationMode:"tool",errorStructure:a}),u=(e,t)=>l(e,t);u.languageModel=l,u.chat=l,u.textEmbeddingModel=e=>{throw new s.JJ({modelId:e,modelType:"textEmbeddingModel"})}}()},305:function(e,t,n){"use strict";var r=n(939),s=n(2244),i=n(858),o=i.z.object({message:i.z.string()}),a=(0,r.Sq)({errorSchema:o,errorToMessage:e=>e.message});function l(e){switch(e){case"COMPLETE":case"STOP_SEQUENCE":return"stop";case"MAX_TOKENS":return"length";case"ERROR":return"error";case"TOOL_CALL":return"tool-calls";default:return"unknown"}}var u=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:i,topK:o,frequencyPenalty:a,presencePenalty:l,stopSequences:u,responseFormat:c,seed:d}){var h;let f=e.type,p=function(e){let t=[];for(let{role:n,content:r}of e)switch(n){case"system":t.push({role:"system",content:r});break;case"user":t.push({role:"user",content:r.map(e=>{switch(e.type){case"text":return e.text;case"image":throw new s.A_({functionality:"image-part"})}}).join("")});break;case"assistant":{let e="",n=[];for(let t of r)switch(t.type){case"text":e+=t.text;break;case"tool-call":n.push({id:t.toolCallId,type:"function",function:{name:t.toolName,arguments:JSON.stringify(t.args)}})}t.push({role:"assistant",content:n.length>0?void 0:e,tool_calls:n.length>0?n:void 0,tool_plan:void 0});break}case"tool":t.push(...r.map(e=>({role:"tool",content:JSON.stringify(e.result),tool_call_id:e.toolCallId})));break;default:throw Error(`Unsupported role: ${n}`)}return t}(t),m={model:this.modelId,frequency_penalty:a,presence_penalty:l,max_tokens:n,temperature:r,p:i,k:o,seed:d,stop_sequences:u,response_format:(null==c?void 0:c.type)==="json"?{type:"json_object",json_schema:c.schema}:void 0,messages:p};switch(f){case"regular":{let{tools:t,toolChoice:n,toolWarnings:r}=function(e){var t;let n=(null==(t=e.tools)?void 0:t.length)?e.tools:void 0,r=[];if(null==n)return{tools:void 0,toolChoice:void 0,toolWarnings:r};let i=[];for(let e of n)"provider-defined"===e.type?r.push({type:"unsupported-tool",tool:e}):i.push({type:"function",function:{name:e.name,description:e.description,parameters:e.parameters}});let o=e.toolChoice;if(null==o)return{tools:i,toolChoice:void 0,toolWarnings:r};let a=o.type;switch(a){case"auto":return{tools:i,toolChoice:void 0,toolWarnings:r};case"none":return{tools:i,toolChoice:"NONE",toolWarnings:r};case"required":return{tools:i,toolChoice:"REQUIRED",toolWarnings:r};case"tool":return{tools:i.filter(e=>e.function.name===o.toolName),toolChoice:"REQUIRED",toolWarnings:r};default:throw new s.A_({functionality:`Unsupported tool choice type: ${a}`})}}(e);return{args:{...m,tools:t,tool_choice:n},warnings:r}}case"object-json":return{args:{...m,response_format:null==e.schema?{type:"json_object"}:{type:"json_object",json_schema:e.schema}},warnings:[]};case"object-tool":return{args:{...m,tools:[{type:"function",function:{name:e.tool.name,description:null!=(h=e.tool.description)?h:"",parameters:e.tool.parameters}}],tool_choice:"REQUIRED"},warnings:[]};default:throw new s.A_({functionality:`Unsupported mode: ${f}`})}}async doGenerate(e){var t,n,s,i;let{args:o,warnings:u}=this.getArgs(e),{responseHeaders:d,value:h,rawValue:f}=await (0,r.A8)({url:`${this.config.baseURL}/chat`,headers:(0,r.NF)(this.config.headers(),e.headers),body:o,failedResponseHandler:a,successfulResponseHandler:(0,r.tc)(c),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:p,...m}=o;return{text:null!=(s=null==(n=null==(t=h.message.content)?void 0:t[0])?void 0:n.text)?s:"",toolCalls:h.message.tool_calls?h.message.tool_calls.map(e=>({toolCallId:e.id,toolName:e.function.name,args:e.function.arguments.replace(/^null$/,"{}"),toolCallType:"function"})):[],finishReason:l(h.finish_reason),usage:{promptTokens:h.usage.tokens.input_tokens,completionTokens:h.usage.tokens.output_tokens},rawCall:{rawPrompt:{messages:p},rawSettings:m},response:{id:null!=(i=h.generation_id)?i:void 0},rawResponse:{headers:d,body:f},warnings:u,request:{body:JSON.stringify(o)}}}async doStream(e){let{args:t,warnings:n}=this.getArgs(e),{responseHeaders:s,value:i}=await (0,r.A8)({url:`${this.config.baseURL}/chat`,headers:(0,r.NF)(this.config.headers(),e.headers),body:{...t,stream:!0},failedResponseHandler:a,successfulResponseHandler:(0,r.cP)(d),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:o,...u}=t,c="unknown",h={promptTokens:Number.NaN,completionTokens:Number.NaN},f={toolCallId:"",toolName:"",argsTextDelta:""};return{stream:i.pipeThrough(new TransformStream({transform(e,t){var n,r;if(!e.success){c="error",t.enqueue({type:"error",error:e.error});return}let s=e.value;switch(s.type){case"content-delta":t.enqueue({type:"text-delta",textDelta:s.delta.message.content.text});return;case"tool-call-start":f={toolCallId:s.delta.message.tool_calls.id,toolName:s.delta.message.tool_calls.function.name,argsTextDelta:s.delta.message.tool_calls.function.arguments},t.enqueue({type:"tool-call-delta",toolCallId:f.toolCallId,toolName:f.toolName,toolCallType:"function",argsTextDelta:f.argsTextDelta});return;case"tool-call-delta":f.argsTextDelta+=s.delta.message.tool_calls.function.arguments,t.enqueue({type:"tool-call-delta",toolCallId:f.toolCallId,toolName:f.toolName,toolCallType:"function",argsTextDelta:s.delta.message.tool_calls.function.arguments});return;case"tool-call-end":t.enqueue({type:"tool-call",toolCallId:f.toolCallId,toolName:f.toolName,toolCallType:"function",args:JSON.stringify(JSON.parse((null==(n=f.argsTextDelta)?void 0:n.trim())||"{}"))}),f={toolCallId:"",toolName:"",argsTextDelta:""};return;case"message-start":t.enqueue({type:"response-metadata",id:null!=(r=s.id)?r:void 0});return;case"message-end":{c=l(s.delta.finish_reason);let e=s.delta.usage.tokens;h={promptTokens:e.input_tokens,completionTokens:e.output_tokens}}default:return}},flush(e){e.enqueue({type:"finish",finishReason:c,usage:h})}})),rawCall:{rawPrompt:{messages:o},rawSettings:u},rawResponse:{headers:s},warnings:n,request:{body:JSON.stringify({...t,stream:!0})}}}},c=i.z.object({generation_id:i.z.string().nullish(),message:i.z.object({role:i.z.string(),content:i.z.array(i.z.object({type:i.z.string(),text:i.z.string()})).nullish(),tool_plan:i.z.string().nullish(),tool_calls:i.z.array(i.z.object({id:i.z.string(),type:i.z.literal("function"),function:i.z.object({name:i.z.string(),arguments:i.z.string()})})).nullish()}),finish_reason:i.z.string(),usage:i.z.object({billed_units:i.z.object({input_tokens:i.z.number(),output_tokens:i.z.number()}),tokens:i.z.object({input_tokens:i.z.number(),output_tokens:i.z.number()})})}),d=i.z.discriminatedUnion("type",[i.z.object({type:i.z.literal("citation-start")}),i.z.object({type:i.z.literal("citation-end")}),i.z.object({type:i.z.literal("content-start")}),i.z.object({type:i.z.literal("content-delta"),delta:i.z.object({message:i.z.object({content:i.z.object({text:i.z.string()})})})}),i.z.object({type:i.z.literal("content-end")}),i.z.object({type:i.z.literal("message-start"),id:i.z.string().nullish()}),i.z.object({type:i.z.literal("message-end"),delta:i.z.object({finish_reason:i.z.string(),usage:i.z.object({tokens:i.z.object({input_tokens:i.z.number(),output_tokens:i.z.number()})})})}),i.z.object({type:i.z.literal("tool-plan-delta"),delta:i.z.object({message:i.z.object({tool_plan:i.z.string()})})}),i.z.object({type:i.z.literal("tool-call-start"),delta:i.z.object({message:i.z.object({tool_calls:i.z.object({id:i.z.string(),type:i.z.literal("function"),function:i.z.object({name:i.z.string(),arguments:i.z.string()})})})})}),i.z.object({type:i.z.literal("tool-call-delta"),delta:i.z.object({message:i.z.object({tool_calls:i.z.object({function:i.z.object({arguments:i.z.string()})})})})}),i.z.object({type:i.z.literal("tool-call-end")})]),h=class{constructor(e,t,n){this.specificationVersion="v1",this.maxEmbeddingsPerCall=96,this.supportsParallelCalls=!0,this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}async doEmbed({values:e,headers:t,abortSignal:n}){var i;if(e.length>this.maxEmbeddingsPerCall)throw new s.ON({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});let{responseHeaders:o,value:l}=await (0,r.A8)({url:`${this.config.baseURL}/embed`,headers:(0,r.NF)(this.config.headers(),t),body:{model:this.modelId,embedding_types:["float"],texts:e,input_type:null!=(i=this.settings.inputType)?i:"search_query",truncate:this.settings.truncate},failedResponseHandler:a,successfulResponseHandler:(0,r.tc)(f),abortSignal:n,fetch:this.config.fetch});return{embeddings:l.embeddings.float,usage:{tokens:l.meta.billed_units.input_tokens},rawResponse:{headers:o}}}},f=i.z.object({embeddings:i.z.object({float:i.z.array(i.z.array(i.z.number()))}),meta:i.z.object({billed_units:i.z.object({input_tokens:i.z.number()})})});!function(e={}){var t;let n=null!=(t=(0,r.QT)(e.baseURL))?t:"https://api.cohere.com/v2",s=()=>({Authorization:`Bearer ${(0,r.pd)({apiKey:e.apiKey,environmentVariableName:"COHERE_API_KEY",description:"Cohere"})}`,...e.headers}),i=(t,r={})=>new u(t,r,{provider:"cohere.chat",baseURL:n,headers:s,fetch:e.fetch}),o=(t,r={})=>new h(t,r,{provider:"cohere.textEmbedding",baseURL:n,headers:s,fetch:e.fetch}),a=function(e,t){if(new.target)throw Error("The Cohere model function cannot be called with the new keyword.");return i(e,t)};a.languageModel=i,a.embedding=o,a.textEmbeddingModel=o}()},4233:function(e,t,n){"use strict";var r=n(6076),s=n(939),i=n(858),o=class{constructor(e,t,n){this.modelId=e,this.settings=t,this.config=n,this.specificationVersion="v1"}get provider(){return this.config.provider}get maxImagesPerCall(){var e;return null!=(e=this.settings.maxImagesPerCall)?e:1}async doGenerate({prompt:e,n:t,size:n,aspectRatio:r,seed:i,providerOptions:o,headers:u,abortSignal:c}){var d,h,f,p;let m=null==n?void 0:n.split("x"),g=null!=(f=null==(h=null==(d=this.config._internal)?void 0:d.currentDate)?void 0:h.call(d))?f:new Date,{value:y,responseHeaders:b}=await (0,s.A8)({url:`${this.config.baseURL}/${this.modelId}`,headers:(0,s.NF)(this.config.headers(),u),body:{prompt:e,num_images:t,...r&&{aspect_ratio:r},...m&&{width:m[0],height:m[1]},...null!=i&&{seed:i},...null!=(p=o.deepinfra)?p:{}},failedResponseHandler:(0,s.Sq)({errorSchema:a,errorToMessage:e=>e.detail.error}),successfulResponseHandler:(0,s.tc)(l),abortSignal:c,fetch:this.config.fetch});return{images:y.images.map(e=>e.replace(/^data:image\/\w+;base64,/,"")),warnings:[],response:{timestamp:g,modelId:this.modelId,headers:b}}}},a=i.z.object({detail:i.z.object({error:i.z.string()})}),l=i.z.object({images:i.z.array(i.z.string())});!function(e={}){var t;let n=(0,s.QT)(null!=(t=e.baseURL)?t:"https://api.deepinfra.com/v1"),i=()=>({Authorization:`Bearer ${(0,s.pd)({apiKey:e.apiKey,environmentVariableName:"DEEPINFRA_API_KEY",description:"DeepInfra's API key"})}`,...e.headers}),a=t=>({provider:`deepinfra.${t}`,url:({path:e})=>`${n}/openai${e}`,headers:i,fetch:e.fetch}),l=(e,t={})=>new r.IY(e,t,{...a("chat"),defaultObjectGenerationMode:"json"}),u=(e,t={})=>new o(e,t,{...a("image"),baseURL:n?`${n}/inference`:"https://api.deepinfra.com/v1/inference"}),c=(e,t)=>l(e,t);c.completionModel=(e,t={})=>new r.qS(e,t,a("completion")),c.chatModel=l,c.image=u,c.imageModel=u,c.languageModel=l,c.textEmbeddingModel=(e,t={})=>new r.KC(e,t,a("embedding"))}()},8845:function(e,t,n){"use strict";var r=n(6076),s=n(2244),i=n(939),o=n(858),a=e=>{var t,n;return null==e?void 0:{deepseek:{promptCacheHitTokens:null!=(t=e.prompt_cache_hit_tokens)?t:NaN,promptCacheMissTokens:null!=(n=e.prompt_cache_miss_tokens)?n:NaN}}},l={extractMetadata:({parsedBody:e})=>{let t=(0,i.pW)({value:e,schema:c});return t.success&&null!=t.value.usage?a(t.value.usage):void 0},createStreamExtractor:()=>{let e;return{processChunk:t=>{var n,r;let s=(0,i.pW)({value:t,schema:d});s.success&&(null==(r=null==(n=s.value.choices)?void 0:n[0])?void 0:r.finish_reason)==="stop"&&s.value.usage&&(e=s.value.usage)},buildMetadata:()=>a(e)}}},u=o.z.object({prompt_cache_hit_tokens:o.z.number().nullish(),prompt_cache_miss_tokens:o.z.number().nullish()}),c=o.z.object({usage:u.nullish()}),d=o.z.object({choices:o.z.array(o.z.object({finish_reason:o.z.string().nullish()})).nullish(),usage:u.nullish()});!function(e={}){var t;let n=(0,i.QT)(null!=(t=e.baseURL)?t:"https://api.deepseek.com/v1"),o=()=>({Authorization:`Bearer ${(0,i.pd)({apiKey:e.apiKey,environmentVariableName:"DEEPSEEK_API_KEY",description:"DeepSeek API key"})}`,...e.headers}),a=(t,s={})=>new r.IY(t,s,{provider:"deepseek.chat",url:({path:e})=>`${n}${e}`,headers:o,fetch:e.fetch,defaultObjectGenerationMode:"json",metadataExtractor:l}),u=(e,t)=>a(e,t);u.languageModel=a,u.chat=a,u.textEmbeddingModel=e=>{throw new s.JJ({modelId:e,modelType:"textEmbeddingModel"})}}()},9036:function(e,t,n){"use strict";n(2244);var r=n(939),s=n(858),i=n(3656),o=s.z.object({detail:s.z.array(s.z.object({loc:s.z.array(s.z.string()),msg:s.z.string(),type:s.z.string()}))}),a=s.z.object({message:s.z.string()}),l=s.z.union([o,a]),u=s.z.object({url:s.z.string(),content_type:s.z.string()}),c=s.z.union([s.z.object({images:s.z.array(u)}),s.z.object({image:u})]),d=(0,r.Sq)({errorSchema:l,errorToMessage:e=>{var t;return o.safeParse(e).success?e.detail.map(e=>`${e.loc.join(".")}: ${e.msg}`).join("\n"):null!=(t=e.message)?t:"Unknown fal error"}}),h=s.z.object({error:s.z.object({message:s.z.string(),code:s.z.number()})});(0,r.Sq)({errorSchema:h,errorToMessage:e=>e.error.message}),s.z.object({language:s.z.union([s.z.enum(["en"]),s.z.string()]).nullish().default("en"),diarize:s.z.boolean().nullish().default(!0),chunkLevel:s.z.enum(["segment","word"]).nullish().default("segment"),version:s.z.enum(["3"]).nullish().default("3"),batchSize:s.z.number().nullish().default(64),numSpeakers:s.z.number().nullable().nullish()}),s.z.object({request_id:s.z.string().nullish()}),s.z.object({text:s.z.string(),chunks:s.z.array(s.z.object({text:s.z.string(),timestamp:s.z.array(s.z.number()).nullish()})).nullish(),inferred_languages:s.z.array(s.z.string()).nullish()}),!function(e={}){var t;(0,r.QT)(null!=(t=e.baseURL)?t:"https://fal.run")}()},4142:function(e,t,n){"use strict";var r=n(6076),s=n(939),i=n(858),o={"accounts/fireworks/models/flux-1-dev-fp8":{urlFormat:"workflows"},"accounts/fireworks/models/flux-1-schnell-fp8":{urlFormat:"workflows"},"accounts/fireworks/models/playground-v2-5-1024px-aesthetic":{urlFormat:"image_generation",supportsSize:!0},"accounts/fireworks/models/japanese-stable-diffusion-xl":{urlFormat:"image_generation",supportsSize:!0},"accounts/fireworks/models/playground-v2-1024px-aesthetic":{urlFormat:"image_generation",supportsSize:!0},"accounts/fireworks/models/stable-diffusion-xl-1024-v1-0":{urlFormat:"image_generation",supportsSize:!0},"accounts/fireworks/models/SSD-1B":{urlFormat:"image_generation",supportsSize:!0}},a=class{constructor(e,t,n){this.modelId=e,this.settings=t,this.config=n,this.specificationVersion="v1"}get provider(){return this.config.provider}get maxImagesPerCall(){var e;return null!=(e=this.settings.maxImagesPerCall)?e:1}async doGenerate({prompt:e,n:t,size:n,aspectRatio:r,seed:i,providerOptions:a,headers:l,abortSignal:u}){var c,d,h,f,p,m,g;let y=[],b=o[this.modelId];(null==b?void 0:b.supportsSize)||null==n||y.push({type:"unsupported-setting",setting:"size",details:"This model does not support the `size` option. Use `aspectRatio` instead."}),(null==b?void 0:b.supportsSize)&&null!=r&&y.push({type:"unsupported-setting",setting:"aspectRatio",details:"This model does not support the `aspectRatio` option."});let v=null==n?void 0:n.split("x"),_=null!=(h=null==(d=null==(c=this.config._internal)?void 0:c.currentDate)?void 0:d.call(c))?h:new Date,{value:w,responseHeaders:x}=await (0,s.A8)({url:(p=this.config.baseURL,(null==(g=o[m=this.modelId])?void 0:g.urlFormat)==="image_generation"?`${p}/image_generation/${m}`:`${p}/workflows/${m}/text_to_image`),headers:(0,s.NF)(this.config.headers(),l),body:{prompt:e,aspect_ratio:r,seed:i,samples:t,...v&&{width:v[0],height:v[1]},...null!=(f=a.fireworks)?f:{}},failedResponseHandler:(0,s.UL)(),successfulResponseHandler:(0,s.XH)(),abortSignal:u,fetch:this.config.fetch});return{images:[w],warnings:y,response:{timestamp:_,modelId:this.modelId,headers:x}}}},l={errorSchema:i.z.object({error:i.z.string()}),errorToMessage:e=>e.error},u="https://api.fireworks.ai/inference/v1";!function(e={}){var t;let n=(0,s.QT)(null!=(t=e.baseURL)?t:u),i=()=>({Authorization:`Bearer ${(0,s.pd)({apiKey:e.apiKey,environmentVariableName:"FIREWORKS_API_KEY",description:"Fireworks API key"})}`,...e.headers}),o=t=>({provider:`fireworks.${t}`,url:({path:e})=>`${n}${e}`,headers:i,fetch:e.fetch}),c=(e,t={})=>new r.IY(e,t,{...o("chat"),errorStructure:l,defaultObjectGenerationMode:"json"}),d=(e,t={})=>new a(e,t,{...o("image"),baseURL:null!=n?n:u}),h=(e,t)=>c(e,t);h.completionModel=(e,t={})=>new r.qS(e,t,{...o("completion"),errorStructure:l}),h.chatModel=c,h.languageModel=c,h.textEmbeddingModel=(e,t={})=>new r.KC(e,t,{...o("embedding"),errorStructure:l}),h.image=d,h.imageModel=d}()},6765:function(e,t,n){"use strict";var r=n(2244),s=n(939),i=n(858);function o({id:e,model:t,created:n}){return{id:null!=e?e:void 0,modelId:null!=t?t:void 0,timestamp:null!=n?new Date(1e3*n):void 0}}var a=i.z.object({error:i.z.object({message:i.z.string(),type:i.z.string()})}),l=(0,s.Sq)({errorSchema:a,errorToMessage:e=>e.error.message});function u(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var c=class{constructor(e,t,n){this.specificationVersion="v1",this.supportsStructuredOutputs=!1,this.defaultObjectGenerationMode="json",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get supportsImageUrls(){return!this.settings.downloadImages}getArgs({mode:e,prompt:t,maxTokens:n,temperature:o,topP:a,topK:l,frequencyPenalty:u,presencePenalty:c,stopSequences:d,responseFormat:h,seed:f,stream:p,providerMetadata:m}){let g=e.type,y=[];null!=l&&y.push({type:"unsupported-setting",setting:"topK"}),null!=h&&"json"===h.type&&null!=h.schema&&y.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is not supported"});let b=(0,s.c1)({provider:"groq",providerOptions:m,schema:i.z.object({reasoningFormat:i.z.enum(["parsed","raw","hidden"]).nullish()})}),v={model:this.modelId,user:this.settings.user,parallel_tool_calls:this.settings.parallelToolCalls,max_tokens:n,temperature:o,top_p:a,frequency_penalty:u,presence_penalty:c,stop:d,seed:f,response_format:!1===p&&(null==h?void 0:h.type)==="json"?{type:"json_object"}:void 0,reasoning_format:null==b?void 0:b.reasoningFormat,messages:function(e){let t=[];for(let{role:n,content:i}of e)switch(n){case"system":t.push({role:"system",content:i});break;case"user":if(1===i.length&&"text"===i[0].type){t.push({role:"user",content:i[0].text});break}t.push({role:"user",content:i.map(e=>{var t;switch(e.type){case"text":return{type:"text",text:e.text};case"image":return{type:"image_url",image_url:{url:e.image instanceof URL?e.image.toString():`data:${null!=(t=e.mimeType)?t:"image/jpeg"};base64,${(0,s.k0)(e.image)}`}};case"file":throw new r.A_({functionality:"File content parts in user messages"})}})});break;case"assistant":{let e="",n=[];for(let t of i)switch(t.type){case"text":e+=t.text;break;case"tool-call":n.push({id:t.toolCallId,type:"function",function:{name:t.toolName,arguments:JSON.stringify(t.args)}})}t.push({role:"assistant",content:e,tool_calls:n.length>0?n:void 0});break}case"tool":for(let e of i)t.push({role:"tool",tool_call_id:e.toolCallId,content:JSON.stringify(e.result)});break;default:throw Error(`Unsupported role: ${n}`)}return t}(t)};switch(g){case"regular":{let{tools:t,tool_choice:n,toolWarnings:s}=function({mode:e}){var t;let n=(null==(t=e.tools)?void 0:t.length)?e.tools:void 0,s=[];if(null==n)return{tools:void 0,tool_choice:void 0,toolWarnings:s};let i=e.toolChoice,o=[];for(let e of n)"provider-defined"===e.type?s.push({type:"unsupported-tool",tool:e}):o.push({type:"function",function:{name:e.name,description:e.description,parameters:e.parameters}});if(null==i)return{tools:o,tool_choice:void 0,toolWarnings:s};let a=i.type;switch(a){case"auto":case"none":case"required":return{tools:o,tool_choice:a,toolWarnings:s};case"tool":return{tools:o,tool_choice:{type:"function",function:{name:i.toolName}},toolWarnings:s};default:throw new r.A_({functionality:`Unsupported tool choice type: ${a}`})}}({mode:e});return{args:{...v,tools:t,tool_choice:n},warnings:[...y,...s]}}case"object-json":return{args:{...v,response_format:!1===p?{type:"json_object"}:void 0},warnings:y};case"object-tool":return{args:{...v,tool_choice:{type:"function",function:{name:e.tool.name}},tools:[{type:"function",function:{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters}}]},warnings:y};default:throw Error(`Unsupported type: ${g}`)}}async doGenerate(e){var t,n,r,i,a,c,h;let{args:f,warnings:p}=this.getArgs({...e,stream:!1}),m=JSON.stringify(f),{responseHeaders:g,value:y,rawValue:b}=await (0,s.A8)({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:(0,s.NF)(this.config.headers(),e.headers),body:f,failedResponseHandler:l,successfulResponseHandler:(0,s.tc)(d),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:v,..._}=f,w=y.choices[0];return{text:null!=(t=w.message.content)?t:void 0,reasoning:null!=(n=w.message.reasoning)?n:void 0,toolCalls:null==(r=w.message.tool_calls)?void 0:r.map(e=>{var t;return{toolCallType:"function",toolCallId:null!=(t=e.id)?t:(0,s.Ox)(),toolName:e.function.name,args:e.function.arguments}}),finishReason:u(w.finish_reason),usage:{promptTokens:null!=(a=null==(i=y.usage)?void 0:i.prompt_tokens)?a:NaN,completionTokens:null!=(h=null==(c=y.usage)?void 0:c.completion_tokens)?h:NaN},rawCall:{rawPrompt:v,rawSettings:_},rawResponse:{headers:g,body:b},response:o(y),warnings:p,request:{body:m}}}async doStream(e){let t;let{args:n,warnings:i}=this.getArgs({...e,stream:!0}),a=JSON.stringify({...n,stream:!0}),{responseHeaders:c,value:d}=await (0,s.A8)({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:(0,s.NF)(this.config.headers(),e.headers),body:{...n,stream:!0},failedResponseHandler:l,successfulResponseHandler:(0,s.cP)(h),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:f,...p}=n,m=[],g="unknown",y={promptTokens:void 0,completionTokens:void 0},b=!0;return{stream:d.pipeThrough(new TransformStream({transform(e,t){var n,i,a,l,c,d,h,f,p,v,_,w,x,k,S;if(!e.success){g="error",t.enqueue({type:"error",error:e.error});return}let A=e.value;if("error"in A){g="error",t.enqueue({type:"error",error:A.error});return}b&&(b=!1,t.enqueue({type:"response-metadata",...o(A)})),(null==(n=A.x_groq)?void 0:n.usage)!=null&&(y={promptTokens:null!=(i=A.x_groq.usage.prompt_tokens)?i:void 0,completionTokens:null!=(a=A.x_groq.usage.completion_tokens)?a:void 0});let I=A.choices[0];if((null==I?void 0:I.finish_reason)!=null&&(g=u(I.finish_reason)),(null==I?void 0:I.delta)==null)return;let E=I.delta;if(null!=E.reasoning&&E.reasoning.length>0&&t.enqueue({type:"reasoning",textDelta:E.reasoning}),null!=E.content&&E.content.length>0&&t.enqueue({type:"text-delta",textDelta:E.content}),null!=E.tool_calls)for(let e of E.tool_calls){let n=e.index;if(null==m[n]){if("function"!==e.type)throw new r.Rt({data:e,message:"Expected 'function' type."});if(null==e.id)throw new r.Rt({data:e,message:"Expected 'id' to be a string."});if((null==(l=e.function)?void 0:l.name)==null)throw new r.Rt({data:e,message:"Expected 'function.name' to be a string."});m[n]={id:e.id,type:"function",function:{name:e.function.name,arguments:null!=(c=e.function.arguments)?c:""},hasFinished:!1};let i=m[n];(null==(d=i.function)?void 0:d.name)!=null&&(null==(h=i.function)?void 0:h.arguments)!=null&&(i.function.arguments.length>0&&t.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:i.id,toolName:i.function.name,argsTextDelta:i.function.arguments}),(0,s.Gr)(i.function.arguments)&&(t.enqueue({type:"tool-call",toolCallType:"function",toolCallId:null!=(f=i.id)?f:(0,s.Ox)(),toolName:i.function.name,args:i.function.arguments}),i.hasFinished=!0));continue}let i=m[n];!i.hasFinished&&((null==(p=e.function)?void 0:p.arguments)!=null&&(i.function.arguments+=null!=(_=null==(v=e.function)?void 0:v.arguments)?_:""),t.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:i.id,toolName:i.function.name,argsTextDelta:null!=(w=e.function.arguments)?w:""}),(null==(x=i.function)?void 0:x.name)!=null&&(null==(k=i.function)?void 0:k.arguments)!=null&&(0,s.Gr)(i.function.arguments)&&(t.enqueue({type:"tool-call",toolCallType:"function",toolCallId:null!=(S=i.id)?S:(0,s.Ox)(),toolName:i.function.name,args:i.function.arguments}),i.hasFinished=!0))}},flush(e){var n,r;e.enqueue({type:"finish",finishReason:g,usage:{promptTokens:null!=(n=y.promptTokens)?n:NaN,completionTokens:null!=(r=y.completionTokens)?r:NaN},...null!=t?{providerMetadata:t}:{}})}})),rawCall:{rawPrompt:f,rawSettings:p},rawResponse:{headers:c},warnings:i,request:{body:a}}}},d=i.z.object({id:i.z.string().nullish(),created:i.z.number().nullish(),model:i.z.string().nullish(),choices:i.z.array(i.z.object({message:i.z.object({content:i.z.string().nullish(),reasoning:i.z.string().nullish(),tool_calls:i.z.array(i.z.object({id:i.z.string().nullish(),type:i.z.literal("function"),function:i.z.object({name:i.z.string(),arguments:i.z.string()})})).nullish()}),index:i.z.number(),finish_reason:i.z.string().nullish()})),usage:i.z.object({prompt_tokens:i.z.number().nullish(),completion_tokens:i.z.number().nullish()}).nullish()}),h=i.z.union([i.z.object({id:i.z.string().nullish(),created:i.z.number().nullish(),model:i.z.string().nullish(),choices:i.z.array(i.z.object({delta:i.z.object({content:i.z.string().nullish(),reasoning:i.z.string().nullish(),tool_calls:i.z.array(i.z.object({index:i.z.number(),id:i.z.string().nullish(),type:i.z.literal("function").optional(),function:i.z.object({name:i.z.string().nullish(),arguments:i.z.string().nullish()})})).nullish()}).nullish(),finish_reason:i.z.string().nullable().optional(),index:i.z.number()})),x_groq:i.z.object({usage:i.z.object({prompt_tokens:i.z.number().nullish(),completion_tokens:i.z.number().nullish()}).nullish()}).nullish()}),a]),f=i.z.object({language:i.z.string().nullish(),prompt:i.z.string().nullish(),responseFormat:i.z.string().nullish(),temperature:i.z.number().min(0).max(1).nullish(),timestampGranularities:i.z.array(i.z.string()).nullish()}),p=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v1"}get provider(){return this.config.provider}getArgs({audio:e,mediaType:t,providerOptions:n}){var r,i,o,a,l;let u=(0,s.c1)({provider:"groq",providerOptions:n,schema:f}),c=new FormData,d=e instanceof Uint8Array?new Blob([e]):new Blob([(0,s.MS)(e)]);if(c.append("model",this.modelId),c.append("file",new File([d],"audio",{type:t})),u){let e={language:null!=(r=u.language)?r:void 0,prompt:null!=(i=u.prompt)?i:void 0,response_format:null!=(o=u.responseFormat)?o:void 0,temperature:null!=(a=u.temperature)?a:void 0,timestamp_granularities:null!=(l=u.timestampGranularities)?l:void 0};for(let t in e){let n=e[t];void 0!==n&&c.append(t,String(n))}}return{formData:c,warnings:[]}}async doGenerate(e){var t,n,r,i,o;let a=null!=(r=null==(n=null==(t=this.config._internal)?void 0:t.currentDate)?void 0:n.call(t))?r:new Date,{formData:u,warnings:c}=this.getArgs(e),{value:d,responseHeaders:h,rawValue:f}=await (0,s.do)({url:this.config.url({path:"/audio/transcriptions",modelId:this.modelId}),headers:(0,s.NF)(this.config.headers(),e.headers),formData:u,failedResponseHandler:l,successfulResponseHandler:(0,s.tc)(m),abortSignal:e.abortSignal,fetch:this.config.fetch});return{text:d.text,segments:null!=(o=null==(i=d.segments)?void 0:i.map(e=>({text:e.text,startSecond:e.start,endSecond:e.end})))?o:[],language:d.language,durationInSeconds:d.duration,warnings:c,response:{timestamp:a,modelId:this.modelId,headers:h,body:f}}}},m=i.z.object({task:i.z.string(),language:i.z.string(),duration:i.z.number(),text:i.z.string(),segments:i.z.array(i.z.object({id:i.z.number(),seek:i.z.number(),start:i.z.number(),end:i.z.number(),text:i.z.string(),tokens:i.z.array(i.z.number()),temperature:i.z.number(),avg_logprob:i.z.number(),compression_ratio:i.z.number(),no_speech_prob:i.z.number()})),x_groq:i.z.object({id:i.z.string()})});!function(e={}){var t;let n=null!=(t=(0,s.QT)(e.baseURL))?t:"https://api.groq.com/openai/v1",i=()=>({Authorization:`Bearer ${(0,s.pd)({apiKey:e.apiKey,environmentVariableName:"GROQ_API_KEY",description:"Groq"})}`,...e.headers}),o=(t,r={})=>new c(t,r,{provider:"groq.chat",url:({path:e})=>`${n}${e}`,headers:i,fetch:e.fetch}),a=(e,t)=>{if(new.target)throw Error("The Groq model function cannot be called with the new keyword.");return o(e,t)},l=function(e,t){return a(e,t)};l.languageModel=a,l.chat=o,l.textEmbeddingModel=e=>{throw new r.JJ({modelId:e,modelType:"textEmbeddingModel"})},l.transcription=t=>new p(t,{provider:"groq.transcription",url:({path:e})=>`${n}${e}`,headers:i,fetch:e.fetch})}()},3376:function(e,t,n){"use strict";var r=n(2244),s=n(939),i=n(858),o=i.z.object({id:i.z.string(),state:i.z.enum(["queued","dreaming","completed","failed"]),failure_reason:i.z.string().nullish(),assets:i.z.object({image:i.z.string()}).nullish()}),a=i.z.object({detail:i.z.array(i.z.object({type:i.z.string(),loc:i.z.array(i.z.string()),msg:i.z.string(),input:i.z.string(),ctx:i.z.object({expected:i.z.string()}).nullish()}))});!function(e={}){var t;(0,s.QT)(null!=(t=e.baseURL)?t:"https://api.lumalabs.ai")}()},5796:function(e,t,n){"use strict";var r=n(939),s=n(858),i=n(2244);function o(e){switch(e){case"stop":return"stop";case"length":case"model_length":return"length";case"tool_calls":return"tool-calls";default:return"unknown"}}var a=s.z.object({object:s.z.literal("error"),message:s.z.string(),type:s.z.string(),param:s.z.string().nullable(),code:s.z.string().nullable()}),l=(0,r.Sq)({errorSchema:a,errorToMessage:e=>e.message});function u({id:e,model:t,created:n}){return{id:null!=e?e:void 0,modelId:null!=t?t:void 0,timestamp:null!=n?new Date(1e3*n):void 0}}var c=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsImageUrls=!1,this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}supportsUrl(e){return"https:"===e.protocol}getArgs({mode:e,prompt:t,maxTokens:n,temperature:s,topP:o,topK:a,frequencyPenalty:l,presencePenalty:u,stopSequences:c,responseFormat:d,seed:h,providerMetadata:f}){var p,m;let g=e.type,y=[];null!=a&&y.push({type:"unsupported-setting",setting:"topK"}),null!=l&&y.push({type:"unsupported-setting",setting:"frequencyPenalty"}),null!=u&&y.push({type:"unsupported-setting",setting:"presencePenalty"}),null!=c&&y.push({type:"unsupported-setting",setting:"stopSequences"}),null!=d&&"json"===d.type&&null!=d.schema&&y.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is not supported"});let b={model:this.modelId,safe_prompt:this.settings.safePrompt,max_tokens:n,temperature:s,top_p:o,random_seed:h,response_format:(null==d?void 0:d.type)==="json"?{type:"json_object"}:void 0,document_image_limit:null==(p=null==f?void 0:f.mistral)?void 0:p.documentImageLimit,document_page_limit:null==(m=null==f?void 0:f.mistral)?void 0:m.documentPageLimit,messages:function(e){let t=[];for(let n=0;n<e.length;n++){let{role:s,content:o}=e[n],a=n===e.length-1;switch(s){case"system":t.push({role:"system",content:o});break;case"user":t.push({role:"user",content:o.map(e=>{var t;switch(e.type){case"text":return{type:"text",text:e.text};case"image":return{type:"image_url",image_url:e.image instanceof URL?e.image.toString():`data:${null!=(t=e.mimeType)?t:"image/jpeg"};base64,${(0,r.k0)(e.image)}`};case"file":if(!(e.data instanceof URL))throw new i.A_({functionality:"File content parts in user messages"});if("application/pdf"===e.mimeType)return{type:"document_url",document_url:e.data.toString()};throw new i.A_({functionality:"Only PDF files are supported in user messages"})}})});break;case"assistant":{let e="",n=[];for(let t of o)switch(t.type){case"text":e+=t.text;break;case"tool-call":n.push({id:t.toolCallId,type:"function",function:{name:t.toolName,arguments:JSON.stringify(t.args)}})}t.push({role:"assistant",content:e,prefix:!!a||void 0,tool_calls:n.length>0?n:void 0});break}case"tool":for(let e of o)t.push({role:"tool",name:e.toolName,content:JSON.stringify(e.result),tool_call_id:e.toolCallId});break;default:throw Error(`Unsupported role: ${s}`)}}return t}(t)};switch(g){case"regular":{let{tools:t,tool_choice:n,toolWarnings:r}=function(e){var t;let n=(null==(t=e.tools)?void 0:t.length)?e.tools:void 0,r=[];if(null==n)return{tools:void 0,tool_choice:void 0,toolWarnings:r};let s=[];for(let e of n)"provider-defined"===e.type?r.push({type:"unsupported-tool",tool:e}):s.push({type:"function",function:{name:e.name,description:e.description,parameters:e.parameters}});let o=e.toolChoice;if(null==o)return{tools:s,tool_choice:void 0,toolWarnings:r};let a=o.type;switch(a){case"auto":case"none":return{tools:s,tool_choice:a,toolWarnings:r};case"required":return{tools:s,tool_choice:"any",toolWarnings:r};case"tool":return{tools:s.filter(e=>e.function.name===o.toolName),tool_choice:"any",toolWarnings:r};default:throw new i.A_({functionality:`Unsupported tool choice type: ${a}`})}}(e);return{args:{...b,tools:t,tool_choice:n},warnings:[...y,...r]}}case"object-json":return{args:{...b,response_format:{type:"json_object"}},warnings:y};case"object-tool":return{args:{...b,tool_choice:"any",tools:[{type:"function",function:e.tool}]},warnings:y};default:throw Error(`Unsupported type: ${g}`)}}async doGenerate(e){var t;let{args:n,warnings:s}=this.getArgs(e),{responseHeaders:i,value:a,rawValue:c}=await (0,r.A8)({url:`${this.config.baseURL}/chat/completions`,headers:(0,r.NF)(this.config.headers(),e.headers),body:n,failedResponseHandler:l,successfulResponseHandler:(0,r.tc)(f),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:h,...p}=n,m=a.choices[0],g=d(m.message.content),y=h[h.length-1];return"assistant"===y.role&&(null==g?void 0:g.startsWith(y.content))&&(g=g.slice(y.content.length)),{text:g,toolCalls:null==(t=m.message.tool_calls)?void 0:t.map(e=>({toolCallType:"function",toolCallId:e.id,toolName:e.function.name,args:e.function.arguments})),finishReason:o(m.finish_reason),usage:{promptTokens:a.usage.prompt_tokens,completionTokens:a.usage.completion_tokens},rawCall:{rawPrompt:h,rawSettings:p},rawResponse:{headers:i,body:c},request:{body:JSON.stringify(n)},response:u(a),warnings:s}}async doStream(e){let{args:t,warnings:n}=this.getArgs(e),s={...t,stream:!0},{responseHeaders:i,value:a}=await (0,r.A8)({url:`${this.config.baseURL}/chat/completions`,headers:(0,r.NF)(this.config.headers(),e.headers),body:s,failedResponseHandler:l,successfulResponseHandler:(0,r.cP)(p),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:c,...h}=t,f="unknown",m={promptTokens:Number.NaN,completionTokens:Number.NaN},g=0,y=!1;return{stream:a.pipeThrough(new TransformStream({transform(e,t){if(!e.success){t.enqueue({type:"error",error:e.error});return}g++;let n=e.value;1===g&&t.enqueue({type:"response-metadata",...u(n)}),null!=n.usage&&(m={promptTokens:n.usage.prompt_tokens,completionTokens:n.usage.completion_tokens});let r=n.choices[0];if((null==r?void 0:r.finish_reason)!=null&&(f=o(r.finish_reason)),(null==r?void 0:r.delta)==null)return;let s=r.delta,i=d(s.content);if(g<=2){let e=c[c.length-1];if("assistant"===e.role&&i===e.content.trimEnd()){i.length<e.content.length&&(y=!0);return}}if(null!=i&&(t.enqueue({type:"text-delta",textDelta:y?i.trimStart():i}),y=!1),null!=s.tool_calls)for(let e of s.tool_calls)t.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:e.id,toolName:e.function.name,argsTextDelta:e.function.arguments}),t.enqueue({type:"tool-call",toolCallType:"function",toolCallId:e.id,toolName:e.function.name,args:e.function.arguments})},flush(e){e.enqueue({type:"finish",finishReason:f,usage:m})}})),rawCall:{rawPrompt:c,rawSettings:h},rawResponse:{headers:i},request:{body:JSON.stringify(s)},warnings:n}}};function d(e){if("string"==typeof e)return e;if(null==e)return;let t=[];for(let n of e){let{type:e}=n;switch(e){case"text":t.push(n.text);break;case"image_url":case"reference":break;default:throw Error(`Unsupported type: ${e}`)}}return t.length?t.join(""):void 0}var h=s.z.union([s.z.string(),s.z.array(s.z.discriminatedUnion("type",[s.z.object({type:s.z.literal("text"),text:s.z.string()}),s.z.object({type:s.z.literal("image_url"),image_url:s.z.union([s.z.string(),s.z.object({url:s.z.string(),detail:s.z.string().nullable()})])}),s.z.object({type:s.z.literal("reference"),reference_ids:s.z.array(s.z.number())})]))]).nullish(),f=s.z.object({id:s.z.string().nullish(),created:s.z.number().nullish(),model:s.z.string().nullish(),choices:s.z.array(s.z.object({message:s.z.object({role:s.z.literal("assistant"),content:h,tool_calls:s.z.array(s.z.object({id:s.z.string(),function:s.z.object({name:s.z.string(),arguments:s.z.string()})})).nullish()}),index:s.z.number(),finish_reason:s.z.string().nullish()})),object:s.z.literal("chat.completion"),usage:s.z.object({prompt_tokens:s.z.number(),completion_tokens:s.z.number()})}),p=s.z.object({id:s.z.string().nullish(),created:s.z.number().nullish(),model:s.z.string().nullish(),choices:s.z.array(s.z.object({delta:s.z.object({role:s.z.enum(["assistant"]).optional(),content:h,tool_calls:s.z.array(s.z.object({id:s.z.string(),function:s.z.object({name:s.z.string(),arguments:s.z.string()})})).nullish()}),finish_reason:s.z.string().nullish(),index:s.z.number()})),usage:s.z.object({prompt_tokens:s.z.number(),completion_tokens:s.z.number()}).nullish()}),m=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return null!=(e=this.settings.maxEmbeddingsPerCall)?e:32}get supportsParallelCalls(){var e;return null!=(e=this.settings.supportsParallelCalls)&&e}async doEmbed({values:e,abortSignal:t,headers:n}){if(e.length>this.maxEmbeddingsPerCall)throw new i.ON({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});let{responseHeaders:s,value:o}=await (0,r.A8)({url:`${this.config.baseURL}/embeddings`,headers:(0,r.NF)(this.config.headers(),n),body:{model:this.modelId,input:e,encoding_format:"float"},failedResponseHandler:l,successfulResponseHandler:(0,r.tc)(g),abortSignal:t,fetch:this.config.fetch});return{embeddings:o.data.map(e=>e.embedding),usage:o.usage?{tokens:o.usage.prompt_tokens}:void 0,rawResponse:{headers:s}}}},g=s.z.object({data:s.z.array(s.z.object({embedding:s.z.array(s.z.number())})),usage:s.z.object({prompt_tokens:s.z.number()}).nullish()});!function(e={}){var t;let n=null!=(t=(0,r.QT)(e.baseURL))?t:"https://api.mistral.ai/v1",s=()=>({Authorization:`Bearer ${(0,r.pd)({apiKey:e.apiKey,environmentVariableName:"MISTRAL_API_KEY",description:"Mistral"})}`,...e.headers}),i=(t,r={})=>new c(t,r,{provider:"mistral.chat",baseURL:n,headers:s,fetch:e.fetch}),o=(t,r={})=>new m(t,r,{provider:"mistral.embedding",baseURL:n,headers:s,fetch:e.fetch}),a=function(e,t){if(new.target)throw Error("The Mistral model function cannot be called with the new keyword.");return i(e,t)};a.languageModel=i,a.chat=i,a.embedding=o,a.textEmbedding=o,a.textEmbeddingModel=o}()},6076:function(e,t,n){"use strict";n.d(t,{IY:function(){return c},KC:function(){return y},M6:function(){return v},qS:function(){return p}});var r=n(2244),s=n(939),i=n(858);function o(e){var t,n;return null!=(n=null==(t=null==e?void 0:e.providerMetadata)?void 0:t.openaiCompatible)?n:{}}function a({id:e,model:t,created:n}){return{id:null!=e?e:void 0,modelId:null!=t?t:void 0,timestamp:null!=n?new Date(1e3*n):void 0}}function l(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var u={errorSchema:i.z.object({error:i.z.object({message:i.z.string(),type:i.z.string().nullish(),param:i.z.any().nullish(),code:i.z.union([i.z.string(),i.z.number()]).nullish()})}),errorToMessage:e=>e.error.message},c=class{constructor(e,t,n){var r,i;this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n;let o=null!=(r=n.errorStructure)?r:u;this.chunkSchema=f(o.errorSchema),this.failedResponseHandler=(0,s.Sq)(o),this.supportsStructuredOutputs=null!=(i=n.supportsStructuredOutputs)&&i}get defaultObjectGenerationMode(){return this.config.defaultObjectGenerationMode}get provider(){return this.config.provider}get providerOptionsName(){return this.config.provider.split(".")[0].trim()}getArgs({mode:e,prompt:t,maxTokens:n,temperature:i,topP:a,topK:l,frequencyPenalty:u,presencePenalty:c,providerMetadata:d,stopSequences:h,responseFormat:f,seed:p}){var m,g,y,b,v;let _=e.type,w=[];null!=l&&w.push({type:"unsupported-setting",setting:"topK"}),(null==f?void 0:f.type)!=="json"||null==f.schema||this.supportsStructuredOutputs||w.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is only supported with structuredOutputs"});let x={model:this.modelId,user:this.settings.user,max_tokens:n,temperature:i,top_p:a,frequency_penalty:u,presence_penalty:c,response_format:(null==f?void 0:f.type)==="json"?!0===this.supportsStructuredOutputs&&null!=f.schema?{type:"json_schema",json_schema:{schema:f.schema,name:null!=(m=f.name)?m:"response",description:f.description}}:{type:"json_object"}:void 0,stop:h,seed:p,...null==d?void 0:d[this.providerOptionsName],reasoning_effort:null!=(b=null==(g=null==d?void 0:d[this.providerOptionsName])?void 0:g.reasoningEffort)?b:null==(y=null==d?void 0:d["openai-compatible"])?void 0:y.reasoningEffort,messages:function(e){let t=[];for(let{role:n,content:i,...a}of e){let e=o({...a});switch(n){case"system":t.push({role:"system",content:i,...e});break;case"user":if(1===i.length&&"text"===i[0].type){t.push({role:"user",content:i[0].text,...o(i[0])});break}t.push({role:"user",content:i.map(e=>{var t;let n=o(e);switch(e.type){case"text":return{type:"text",text:e.text,...n};case"image":return{type:"image_url",image_url:{url:e.image instanceof URL?e.image.toString():`data:${null!=(t=e.mimeType)?t:"image/jpeg"};base64,${(0,s.k0)(e.image)}`},...n};case"file":throw new r.A_({functionality:"File content parts in user messages"})}}),...e});break;case"assistant":{let n="",r=[];for(let e of i){let t=o(e);switch(e.type){case"text":n+=e.text;break;case"tool-call":r.push({id:e.toolCallId,type:"function",function:{name:e.toolName,arguments:JSON.stringify(e.args)},...t})}}t.push({role:"assistant",content:n,tool_calls:r.length>0?r:void 0,...e});break}case"tool":for(let e of i){let n=o(e);t.push({role:"tool",tool_call_id:e.toolCallId,content:JSON.stringify(e.result),...n})}break;default:throw Error(`Unsupported role: ${n}`)}}return t}(t)};switch(_){case"regular":{let{tools:t,tool_choice:n,toolWarnings:s}=function({mode:e,structuredOutputs:t}){var n;let s=(null==(n=e.tools)?void 0:n.length)?e.tools:void 0,i=[];if(null==s)return{tools:void 0,tool_choice:void 0,toolWarnings:i};let o=e.toolChoice,a=[];for(let e of s)"provider-defined"===e.type?i.push({type:"unsupported-tool",tool:e}):a.push({type:"function",function:{name:e.name,description:e.description,parameters:e.parameters}});if(null==o)return{tools:a,tool_choice:void 0,toolWarnings:i};let l=o.type;switch(l){case"auto":case"none":case"required":return{tools:a,tool_choice:l,toolWarnings:i};case"tool":return{tools:a,tool_choice:{type:"function",function:{name:o.toolName}},toolWarnings:i};default:throw new r.A_({functionality:`Unsupported tool choice type: ${l}`})}}({mode:e,structuredOutputs:this.supportsStructuredOutputs});return{args:{...x,tools:t,tool_choice:n},warnings:[...w,...s]}}case"object-json":return{args:{...x,response_format:!0===this.supportsStructuredOutputs&&null!=e.schema?{type:"json_schema",json_schema:{schema:e.schema,name:null!=(v=e.name)?v:"response",description:e.description}}:{type:"json_object"}},warnings:w};case"object-tool":return{args:{...x,tool_choice:{type:"function",function:{name:e.tool.name}},tools:[{type:"function",function:{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters}}]},warnings:w};default:throw Error(`Unsupported type: ${_}`)}}async doGenerate(e){var t,n,r,i,o,u,c,d,f,p,m;let{args:g,warnings:y}=this.getArgs({...e}),b=JSON.stringify(g),{responseHeaders:v,value:_,rawValue:w}=await (0,s.A8)({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:(0,s.NF)(this.config.headers(),e.headers),body:g,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:(0,s.tc)(h),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:x,...k}=g,S=_.choices[0],A={[this.providerOptionsName]:{},...null==(n=null==(t=this.config.metadataExtractor)?void 0:t.extractMetadata)?void 0:n.call(t,{parsedBody:w})},I=null==(r=_.usage)?void 0:r.completion_tokens_details,E=null==(i=_.usage)?void 0:i.prompt_tokens_details;return(null==I?void 0:I.reasoning_tokens)!=null&&(A[this.providerOptionsName].reasoningTokens=null==I?void 0:I.reasoning_tokens),(null==I?void 0:I.accepted_prediction_tokens)!=null&&(A[this.providerOptionsName].acceptedPredictionTokens=null==I?void 0:I.accepted_prediction_tokens),(null==I?void 0:I.rejected_prediction_tokens)!=null&&(A[this.providerOptionsName].rejectedPredictionTokens=null==I?void 0:I.rejected_prediction_tokens),(null==E?void 0:E.cached_tokens)!=null&&(A[this.providerOptionsName].cachedPromptTokens=null==E?void 0:E.cached_tokens),{text:null!=(o=S.message.content)?o:void 0,reasoning:null!=(u=S.message.reasoning_content)?u:void 0,toolCalls:null==(c=S.message.tool_calls)?void 0:c.map(e=>{var t;return{toolCallType:"function",toolCallId:null!=(t=e.id)?t:(0,s.Ox)(),toolName:e.function.name,args:e.function.arguments}}),finishReason:l(S.finish_reason),usage:{promptTokens:null!=(f=null==(d=_.usage)?void 0:d.prompt_tokens)?f:NaN,completionTokens:null!=(m=null==(p=_.usage)?void 0:p.completion_tokens)?m:NaN},providerMetadata:A,rawCall:{rawPrompt:x,rawSettings:k},rawResponse:{headers:v,body:w},response:a(_),warnings:y,request:{body:b}}}async doStream(e){var t;if(this.settings.simulateStreaming){let t=await this.doGenerate(e);return{stream:new ReadableStream({start(e){if(e.enqueue({type:"response-metadata",...t.response}),t.reasoning){if(Array.isArray(t.reasoning))for(let n of t.reasoning)"text"===n.type&&e.enqueue({type:"reasoning",textDelta:n.text});else e.enqueue({type:"reasoning",textDelta:t.reasoning})}if(t.text&&e.enqueue({type:"text-delta",textDelta:t.text}),t.toolCalls)for(let n of t.toolCalls)e.enqueue({type:"tool-call",...n});e.enqueue({type:"finish",finishReason:t.finishReason,usage:t.usage,logprobs:t.logprobs,providerMetadata:t.providerMetadata}),e.close()}}),rawCall:t.rawCall,rawResponse:t.rawResponse,warnings:t.warnings}}let{args:n,warnings:i}=this.getArgs({...e}),o={...n,stream:!0,stream_options:this.config.includeUsage?{include_usage:!0}:void 0},u=null==(t=this.config.metadataExtractor)?void 0:t.createStreamExtractor(),{responseHeaders:c,value:d}=await (0,s.A8)({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:(0,s.NF)(this.config.headers(),e.headers),body:o,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:(0,s.cP)(this.chunkSchema),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:h,...f}=n,p=[],m="unknown",g={completionTokens:void 0,completionTokensDetails:{reasoningTokens:void 0,acceptedPredictionTokens:void 0,rejectedPredictionTokens:void 0},promptTokens:void 0,promptTokensDetails:{cachedTokens:void 0}},y=!0,b=this.providerOptionsName;return{stream:d.pipeThrough(new TransformStream({transform(e,t){var n,i,o,c,d,h,f,b,v,_,w,x;if(!e.success){m="error",t.enqueue({type:"error",error:e.error});return}let k=e.value;if(null==u||u.processChunk(e.rawValue),"error"in k){m="error",t.enqueue({type:"error",error:k.error.message});return}if(y&&(y=!1,t.enqueue({type:"response-metadata",...a(k)})),null!=k.usage){let{prompt_tokens:e,completion_tokens:t,prompt_tokens_details:n,completion_tokens_details:r}=k.usage;g.promptTokens=null!=e?e:void 0,g.completionTokens=null!=t?t:void 0,(null==r?void 0:r.reasoning_tokens)!=null&&(g.completionTokensDetails.reasoningTokens=null==r?void 0:r.reasoning_tokens),(null==r?void 0:r.accepted_prediction_tokens)!=null&&(g.completionTokensDetails.acceptedPredictionTokens=null==r?void 0:r.accepted_prediction_tokens),(null==r?void 0:r.rejected_prediction_tokens)!=null&&(g.completionTokensDetails.rejectedPredictionTokens=null==r?void 0:r.rejected_prediction_tokens),(null==n?void 0:n.cached_tokens)!=null&&(g.promptTokensDetails.cachedTokens=null==n?void 0:n.cached_tokens)}let S=k.choices[0];if((null==S?void 0:S.finish_reason)!=null&&(m=l(S.finish_reason)),(null==S?void 0:S.delta)==null)return;let A=S.delta;if(null!=A.reasoning_content&&t.enqueue({type:"reasoning",textDelta:A.reasoning_content}),null!=A.content&&t.enqueue({type:"text-delta",textDelta:A.content}),null!=A.tool_calls)for(let e of A.tool_calls){let a=e.index;if(null==p[a]){if("function"!==e.type)throw new r.Rt({data:e,message:"Expected 'function' type."});if(null==e.id)throw new r.Rt({data:e,message:"Expected 'id' to be a string."});if((null==(n=e.function)?void 0:n.name)==null)throw new r.Rt({data:e,message:"Expected 'function.name' to be a string."});p[a]={id:e.id,type:"function",function:{name:e.function.name,arguments:null!=(i=e.function.arguments)?i:""},hasFinished:!1};let l=p[a];(null==(o=l.function)?void 0:o.name)!=null&&(null==(c=l.function)?void 0:c.arguments)!=null&&(l.function.arguments.length>0&&t.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:l.id,toolName:l.function.name,argsTextDelta:l.function.arguments}),(0,s.Gr)(l.function.arguments)&&(t.enqueue({type:"tool-call",toolCallType:"function",toolCallId:null!=(d=l.id)?d:(0,s.Ox)(),toolName:l.function.name,args:l.function.arguments}),l.hasFinished=!0));continue}let l=p[a];!l.hasFinished&&((null==(h=e.function)?void 0:h.arguments)!=null&&(l.function.arguments+=null!=(b=null==(f=e.function)?void 0:f.arguments)?b:""),t.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:l.id,toolName:l.function.name,argsTextDelta:null!=(v=e.function.arguments)?v:""}),(null==(_=l.function)?void 0:_.name)!=null&&(null==(w=l.function)?void 0:w.arguments)!=null&&(0,s.Gr)(l.function.arguments)&&(t.enqueue({type:"tool-call",toolCallType:"function",toolCallId:null!=(x=l.id)?x:(0,s.Ox)(),toolName:l.function.name,args:l.function.arguments}),l.hasFinished=!0))}},flush(e){var t,n;let r={[b]:{},...null==u?void 0:u.buildMetadata()};null!=g.completionTokensDetails.reasoningTokens&&(r[b].reasoningTokens=g.completionTokensDetails.reasoningTokens),null!=g.completionTokensDetails.acceptedPredictionTokens&&(r[b].acceptedPredictionTokens=g.completionTokensDetails.acceptedPredictionTokens),null!=g.completionTokensDetails.rejectedPredictionTokens&&(r[b].rejectedPredictionTokens=g.completionTokensDetails.rejectedPredictionTokens),null!=g.promptTokensDetails.cachedTokens&&(r[b].cachedPromptTokens=g.promptTokensDetails.cachedTokens),e.enqueue({type:"finish",finishReason:m,usage:{promptTokens:null!=(t=g.promptTokens)?t:NaN,completionTokens:null!=(n=g.completionTokens)?n:NaN},providerMetadata:r})}})),rawCall:{rawPrompt:h,rawSettings:f},rawResponse:{headers:c},warnings:i,request:{body:JSON.stringify(o)}}}},d=i.z.object({prompt_tokens:i.z.number().nullish(),completion_tokens:i.z.number().nullish(),prompt_tokens_details:i.z.object({cached_tokens:i.z.number().nullish()}).nullish(),completion_tokens_details:i.z.object({reasoning_tokens:i.z.number().nullish(),accepted_prediction_tokens:i.z.number().nullish(),rejected_prediction_tokens:i.z.number().nullish()}).nullish()}).nullish(),h=i.z.object({id:i.z.string().nullish(),created:i.z.number().nullish(),model:i.z.string().nullish(),choices:i.z.array(i.z.object({message:i.z.object({role:i.z.literal("assistant").nullish(),content:i.z.string().nullish(),reasoning_content:i.z.string().nullish(),tool_calls:i.z.array(i.z.object({id:i.z.string().nullish(),type:i.z.literal("function"),function:i.z.object({name:i.z.string(),arguments:i.z.string()})})).nullish()}),finish_reason:i.z.string().nullish()})),usage:d}),f=e=>i.z.union([i.z.object({id:i.z.string().nullish(),created:i.z.number().nullish(),model:i.z.string().nullish(),choices:i.z.array(i.z.object({delta:i.z.object({role:i.z.enum(["assistant"]).nullish(),content:i.z.string().nullish(),reasoning_content:i.z.string().nullish(),tool_calls:i.z.array(i.z.object({index:i.z.number(),id:i.z.string().nullish(),type:i.z.literal("function").nullish(),function:i.z.object({name:i.z.string().nullish(),arguments:i.z.string().nullish()})})).nullish()}).nullish(),finish_reason:i.z.string().nullish()})),usage:d}),e]),p=class{constructor(e,t,n){var r;this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0,this.modelId=e,this.settings=t,this.config=n;let i=null!=(r=n.errorStructure)?r:u;this.chunkSchema=g(i.errorSchema),this.failedResponseHandler=(0,s.Sq)(i)}get provider(){return this.config.provider}get providerOptionsName(){return this.config.provider.split(".")[0].trim()}getArgs({mode:e,inputFormat:t,prompt:n,maxTokens:s,temperature:i,topP:o,topK:a,frequencyPenalty:l,presencePenalty:u,stopSequences:c,responseFormat:d,seed:h,providerMetadata:f}){var p;let m=e.type,g=[];null!=a&&g.push({type:"unsupported-setting",setting:"topK"}),null!=d&&"text"!==d.type&&g.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});let{prompt:y,stopSequences:b}=function({prompt:e,inputFormat:t,user:n="user",assistant:s="assistant"}){if("prompt"===t&&1===e.length&&"user"===e[0].role&&1===e[0].content.length&&"text"===e[0].content[0].type)return{prompt:e[0].content[0].text};let i="";for(let{role:t,content:o}of("system"===e[0].role&&(i+=`${e[0].content}

`,e=e.slice(1)),e))switch(t){case"system":throw new r.Mt({message:"Unexpected system message in prompt: ${content}",prompt:e});case"user":{let e=o.map(e=>{switch(e.type){case"text":return e.text;case"image":throw new r.A_({functionality:"images"})}}).join("");i+=`${n}:
${e}

`;break}case"assistant":{let e=o.map(e=>{switch(e.type){case"text":return e.text;case"tool-call":throw new r.A_({functionality:"tool-call messages"})}}).join("");i+=`${s}:
${e}

`;break}case"tool":throw new r.A_({functionality:"tool messages"});default:throw Error(`Unsupported role: ${t}`)}return{prompt:i+=`${s}:
`,stopSequences:[`
${n}:`]}}({prompt:n,inputFormat:t}),v=[...null!=b?b:[],...null!=c?c:[]],_={model:this.modelId,echo:this.settings.echo,logit_bias:this.settings.logitBias,suffix:this.settings.suffix,user:this.settings.user,max_tokens:s,temperature:i,top_p:o,frequency_penalty:l,presence_penalty:u,seed:h,...null==f?void 0:f[this.providerOptionsName],prompt:y,stop:v.length>0?v:void 0};switch(m){case"regular":if(null==(p=e.tools)?void 0:p.length)throw new r.A_({functionality:"tools"});if(e.toolChoice)throw new r.A_({functionality:"toolChoice"});return{args:_,warnings:g};case"object-json":throw new r.A_({functionality:"object-json mode"});case"object-tool":throw new r.A_({functionality:"object-tool mode"});default:throw Error(`Unsupported type: ${m}`)}}async doGenerate(e){var t,n,r,i;let{args:o,warnings:u}=this.getArgs(e),{responseHeaders:c,value:d,rawValue:h}=await (0,s.A8)({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:(0,s.NF)(this.config.headers(),e.headers),body:o,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:(0,s.tc)(m),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:f,...p}=o,g=d.choices[0];return{text:g.text,usage:{promptTokens:null!=(n=null==(t=d.usage)?void 0:t.prompt_tokens)?n:NaN,completionTokens:null!=(i=null==(r=d.usage)?void 0:r.completion_tokens)?i:NaN},finishReason:l(g.finish_reason),rawCall:{rawPrompt:f,rawSettings:p},rawResponse:{headers:c,body:h},response:a(d),warnings:u,request:{body:JSON.stringify(o)}}}async doStream(e){let{args:t,warnings:n}=this.getArgs(e),r={...t,stream:!0,stream_options:this.config.includeUsage?{include_usage:!0}:void 0},{responseHeaders:i,value:o}=await (0,s.A8)({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:(0,s.NF)(this.config.headers(),e.headers),body:r,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:(0,s.cP)(this.chunkSchema),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:u,...c}=t,d="unknown",h={promptTokens:Number.NaN,completionTokens:Number.NaN},f=!0;return{stream:o.pipeThrough(new TransformStream({transform(e,t){if(!e.success){d="error",t.enqueue({type:"error",error:e.error});return}let n=e.value;if("error"in n){d="error",t.enqueue({type:"error",error:n.error});return}f&&(f=!1,t.enqueue({type:"response-metadata",...a(n)})),null!=n.usage&&(h={promptTokens:n.usage.prompt_tokens,completionTokens:n.usage.completion_tokens});let r=n.choices[0];(null==r?void 0:r.finish_reason)!=null&&(d=l(r.finish_reason)),(null==r?void 0:r.text)!=null&&t.enqueue({type:"text-delta",textDelta:r.text})},flush(e){e.enqueue({type:"finish",finishReason:d,usage:h})}})),rawCall:{rawPrompt:u,rawSettings:c},rawResponse:{headers:i},warnings:n,request:{body:JSON.stringify(r)}}}},m=i.z.object({id:i.z.string().nullish(),created:i.z.number().nullish(),model:i.z.string().nullish(),choices:i.z.array(i.z.object({text:i.z.string(),finish_reason:i.z.string()})),usage:i.z.object({prompt_tokens:i.z.number(),completion_tokens:i.z.number()}).nullish()}),g=e=>i.z.union([i.z.object({id:i.z.string().nullish(),created:i.z.number().nullish(),model:i.z.string().nullish(),choices:i.z.array(i.z.object({text:i.z.string(),finish_reason:i.z.string().nullish(),index:i.z.number()})),usage:i.z.object({prompt_tokens:i.z.number(),completion_tokens:i.z.number()}).nullish()}),e]),y=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return null!=(e=this.config.maxEmbeddingsPerCall)?e:2048}get supportsParallelCalls(){var e;return null==(e=this.config.supportsParallelCalls)||e}async doEmbed({values:e,headers:t,abortSignal:n}){var i;if(e.length>this.maxEmbeddingsPerCall)throw new r.ON({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});let{responseHeaders:o,value:a}=await (0,s.A8)({url:this.config.url({path:"/embeddings",modelId:this.modelId}),headers:(0,s.NF)(this.config.headers(),t),body:{model:this.modelId,input:e,encoding_format:"float",dimensions:this.settings.dimensions,user:this.settings.user},failedResponseHandler:(0,s.Sq)(null!=(i=this.config.errorStructure)?i:u),successfulResponseHandler:(0,s.tc)(b),abortSignal:n,fetch:this.config.fetch});return{embeddings:a.data.map(e=>e.embedding),usage:a.usage?{tokens:a.usage.prompt_tokens}:void 0,rawResponse:{headers:o}}}},b=i.z.object({data:i.z.array(i.z.object({embedding:i.z.array(i.z.number())})),usage:i.z.object({prompt_tokens:i.z.number()}).nullish()}),v=class{constructor(e,t,n){this.modelId=e,this.settings=t,this.config=n,this.specificationVersion="v1"}get maxImagesPerCall(){var e;return null!=(e=this.settings.maxImagesPerCall)?e:10}get provider(){return this.config.provider}async doGenerate({prompt:e,n:t,size:n,aspectRatio:r,seed:i,providerOptions:o,headers:a,abortSignal:l}){var c,d,h,f,p;let m=[];null!=r&&m.push({type:"unsupported-setting",setting:"aspectRatio",details:"This model does not support aspect ratio. Use `size` instead."}),null!=i&&m.push({type:"unsupported-setting",setting:"seed"});let g=null!=(h=null==(d=null==(c=this.config._internal)?void 0:c.currentDate)?void 0:d.call(c))?h:new Date,{value:y,responseHeaders:b}=await (0,s.A8)({url:this.config.url({path:"/images/generations",modelId:this.modelId}),headers:(0,s.NF)(this.config.headers(),a),body:{model:this.modelId,prompt:e,n:t,size:n,...null!=(f=o.openai)?f:{},response_format:"b64_json",...this.settings.user?{user:this.settings.user}:{}},failedResponseHandler:(0,s.Sq)(null!=(p=this.config.errorStructure)?p:u),successfulResponseHandler:(0,s.tc)(_),abortSignal:l,fetch:this.config.fetch});return{images:y.data.map(e=>e.b64_json),warnings:m,response:{timestamp:g,modelId:this.modelId,headers:b}}}},_=i.z.object({data:i.z.array(i.z.object({b64_json:i.z.string()}))})},3583:function(e,t,n){"use strict";var r=n(2244),s=n(939),i=n(858);function o(e){switch(e){case"stop":case"length":return e;default:return"unknown"}}var a=class{constructor(e,t){this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsStructuredOutputs=!0,this.supportsImageUrls=!1,this.provider="perplexity",this.modelId=e,this.config=t}getArgs({mode:e,prompt:t,maxTokens:n,temperature:s,topP:i,topK:o,frequencyPenalty:a,presencePenalty:l,stopSequences:u,responseFormat:c,seed:d,providerMetadata:h}){var f;let p=e.type,m=[];null!=o&&m.push({type:"unsupported-setting",setting:"topK"}),null!=u&&m.push({type:"unsupported-setting",setting:"stopSequences"}),null!=d&&m.push({type:"unsupported-setting",setting:"seed"});let g={model:this.modelId,frequency_penalty:a,max_tokens:n,presence_penalty:l,temperature:s,top_k:o,top_p:i,response_format:(null==c?void 0:c.type)==="json"?{type:"json_schema",json_schema:{schema:c.schema}}:void 0,...null!=(f=null==h?void 0:h.perplexity)?f:{},messages:function(e){let t=[];for(let{role:n,content:s}of e)switch(n){case"system":t.push({role:"system",content:s});break;case"user":case"assistant":t.push({role:n,content:s.filter(e=>"reasoning"!==e.type&&"redacted-reasoning"!==e.type).map(e=>{switch(e.type){case"text":return e.text;case"image":throw new r.A_({functionality:"Image content parts in user messages"});case"file":throw new r.A_({functionality:"File content parts in user messages"});case"tool-call":throw new r.A_({functionality:"Tool calls in assistant messages"});default:throw Error(`Unsupported part: ${e}`)}}).join("")});break;case"tool":throw new r.A_({functionality:"Tool messages"});default:throw Error(`Unsupported role: ${n}`)}return t}(t)};switch(p){case"regular":return{args:g,warnings:m};case"object-json":return{args:{...g,response_format:{type:"json_schema",json_schema:{schema:e.schema}}},warnings:m};case"object-tool":throw new r.A_({functionality:"tool-mode object generation"});default:throw Error(`Unsupported type: ${p}`)}}async doGenerate(e){var t,n,r,i,a,u,c,h,m,g,y;let{args:b,warnings:v}=this.getArgs(e),{responseHeaders:_,value:w,rawValue:x}=await (0,s.A8)({url:`${this.config.baseURL}/chat/completions`,headers:(0,s.NF)(this.config.headers(),e.headers),body:b,failedResponseHandler:(0,s.Sq)({errorSchema:f,errorToMessage:p}),successfulResponseHandler:(0,s.tc)(d),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:k,...S}=b,A=w.choices[0];return{text:A.message.content,toolCalls:[],finishReason:o(A.finish_reason),usage:{promptTokens:null!=(n=null==(t=w.usage)?void 0:t.prompt_tokens)?n:Number.NaN,completionTokens:null!=(i=null==(r=w.usage)?void 0:r.completion_tokens)?i:Number.NaN},rawCall:{rawPrompt:k,rawSettings:S},rawResponse:{headers:_,body:x},request:{body:JSON.stringify(b)},response:l(w),warnings:v,sources:null==(a=w.citations)?void 0:a.map(e=>({sourceType:"url",id:this.config.generateId(),url:e})),providerMetadata:{perplexity:{images:null!=(c=null==(u=w.images)?void 0:u.map(e=>({imageUrl:e.image_url,originUrl:e.origin_url,height:e.height,width:e.width})))?c:null,usage:{citationTokens:null!=(m=null==(h=w.usage)?void 0:h.citation_tokens)?m:null,numSearchQueries:null!=(y=null==(g=w.usage)?void 0:g.num_search_queries)?y:null}}}}}async doStream(e){let{args:t,warnings:n}=this.getArgs(e),r={...t,stream:!0},{responseHeaders:i,value:a}=await (0,s.A8)({url:`${this.config.baseURL}/chat/completions`,headers:(0,s.NF)(this.config.headers(),e.headers),body:r,failedResponseHandler:(0,s.Sq)({errorSchema:f,errorToMessage:p}),successfulResponseHandler:(0,s.cP)(h),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:u,...c}=t,d="unknown",m={promptTokens:Number.NaN,completionTokens:Number.NaN},g={perplexity:{usage:{citationTokens:null,numSearchQueries:null},images:null}},y=!0,b=this;return{stream:a.pipeThrough(new TransformStream({transform(e,t){var n,r,s;if(!e.success){t.enqueue({type:"error",error:e.error});return}let i=e.value;y&&(t.enqueue({type:"response-metadata",...l(i)}),null==(n=i.citations)||n.forEach(e=>{t.enqueue({type:"source",source:{sourceType:"url",id:b.config.generateId(),url:e}})}),y=!1),null!=i.usage&&(m={promptTokens:i.usage.prompt_tokens,completionTokens:i.usage.completion_tokens},g.perplexity.usage={citationTokens:null!=(r=i.usage.citation_tokens)?r:null,numSearchQueries:null!=(s=i.usage.num_search_queries)?s:null}),null!=i.images&&(g.perplexity.images=i.images.map(e=>({imageUrl:e.image_url,originUrl:e.origin_url,height:e.height,width:e.width})));let a=i.choices[0];if((null==a?void 0:a.finish_reason)!=null&&(d=o(a.finish_reason)),(null==a?void 0:a.delta)==null)return;let u=a.delta.content;null!=u&&t.enqueue({type:"text-delta",textDelta:u})},flush(e){e.enqueue({type:"finish",finishReason:d,usage:m,providerMetadata:g})}})),rawCall:{rawPrompt:u,rawSettings:c},rawResponse:{headers:i},request:{body:JSON.stringify(r)},warnings:n}}};function l({id:e,model:t,created:n}){return{id:e,modelId:t,timestamp:new Date(1e3*n)}}var u=i.z.object({prompt_tokens:i.z.number(),completion_tokens:i.z.number(),citation_tokens:i.z.number().nullish(),num_search_queries:i.z.number().nullish()}),c=i.z.object({image_url:i.z.string(),origin_url:i.z.string(),height:i.z.number(),width:i.z.number()}),d=i.z.object({id:i.z.string(),created:i.z.number(),model:i.z.string(),choices:i.z.array(i.z.object({message:i.z.object({role:i.z.literal("assistant"),content:i.z.string()}),finish_reason:i.z.string().nullish()})),citations:i.z.array(i.z.string()).nullish(),images:i.z.array(c).nullish(),usage:u.nullish()}),h=i.z.object({id:i.z.string(),created:i.z.number(),model:i.z.string(),choices:i.z.array(i.z.object({delta:i.z.object({role:i.z.literal("assistant"),content:i.z.string()}),finish_reason:i.z.string().nullish()})),citations:i.z.array(i.z.string()).nullish(),images:i.z.array(c).nullish(),usage:u.nullish()}),f=i.z.object({error:i.z.object({code:i.z.number(),message:i.z.string().nullish(),type:i.z.string().nullish()})}),p=e=>{var t,n;return null!=(n=null!=(t=e.error.message)?t:e.error.type)?n:"unknown error"};!function(e={}){let t=()=>({Authorization:`Bearer ${(0,s.pd)({apiKey:e.apiKey,environmentVariableName:"PERPLEXITY_API_KEY",description:"Perplexity"})}`,...e.headers}),n=n=>{var r;return new a(n,{baseURL:(0,s.QT)(null!=(r=e.baseURL)?r:"https://api.perplexity.ai"),headers:t,generateId:s.Ox,fetch:e.fetch})},i=e=>n(e);i.languageModel=n,i.textEmbeddingModel=e=>{throw new r.JJ({modelId:e,modelType:"textEmbeddingModel"})}}()},939:function(e,t,n){"use strict";n.d(t,{A8:function(){return A},DB:function(){return T},Gr:function(){return x},MS:function(){return M},NF:function(){return a},NX:function(){return w},Ox:function(){return d},P6:function(){return y},QT:function(){return $},Sq:function(){return z},UL:function(){return O},XH:function(){return N},bF:function(){return c},c1:function(){return k},cP:function(){return C},do:function(){return I},gw:function(){return l},hb:function(){return m},k0:function(){return U},kb:function(){return u},lP:function(){return h},pW:function(){return _},pd:function(){return g},qU:function(){return b},tc:function(){return j}});var r=n(2244),s=n(8794),i=n(318),o=n(3656);function a(...e){return e.reduce((e,t)=>({...e,...null!=t?t:{}}),{})}async function l(e){return null==e?Promise.resolve():new Promise(t=>setTimeout(t,e))}function u(e){let t={};return e.headers.forEach((e,n)=>{t[n]=e}),t}var c=({prefix:e,size:t=16,alphabet:n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:i="-"}={})=>{let o=(0,s.k)(n,t);if(null==e)return o;if(n.includes(i))throw new r.RU({argument:"separator",message:`The separator "${i}" must not be part of the alphabet "${n}".`});return t=>`${e}${i}${o(t)}`},d=c();function h(e){return Object.fromEntries(Object.entries(e).filter(([e,t])=>null!=t))}function f(e){return e instanceof Error&&("AbortError"===e.name||"TimeoutError"===e.name)}var p=()=>globalThis.fetch,m=async({url:e,headers:t={},successfulResponseHandler:n,failedResponseHandler:s,abortSignal:i,fetch:o=p()})=>{try{let a=await o(e,{method:"GET",headers:h(t),signal:i}),l=u(a);if(!a.ok){let t;try{t=await s({response:a,url:e,requestBodyValues:{}})}catch(t){if(f(t)||r.w.isInstance(t))throw t;throw new r.w({message:"Failed to process error response",cause:t,statusCode:a.status,url:e,responseHeaders:l,requestBodyValues:{}})}throw t.value}try{return await n({response:a,url:e,requestBodyValues:{}})}catch(t){if(t instanceof Error&&(f(t)||r.w.isInstance(t)))throw t;throw new r.w({message:"Failed to process successful response",cause:t,statusCode:a.status,url:e,responseHeaders:l,requestBodyValues:{}})}}catch(t){if(f(t))throw t;if(t instanceof TypeError&&"fetch failed"===t.message){let n=t.cause;if(null!=n)throw new r.w({message:`Cannot connect to API: ${n.message}`,cause:n,url:e,isRetryable:!0,requestBodyValues:{}})}throw t}};function g({apiKey:e,environmentVariableName:t,apiKeyParameterName:n="apiKey",description:s}){if("string"==typeof e)return e;if(null!=e)throw new r.tZ({message:`${s} API key must be a string.`});if(void 0===o)throw new r.tZ({message:`${s} API key is missing. Pass it using the '${n}' parameter. Environment variables is not supported in this environment.`});if(null==(e=o.env[t]))throw new r.tZ({message:`${s} API key is missing. Pass it using the '${n}' parameter or the ${t} environment variable.`});if("string"!=typeof e)throw new r.tZ({message:`${s} API key must be a string. The value of the ${t} environment variable is not a string.`});return e}function y({settingValue:e,environmentVariableName:t}){if("string"==typeof e||null==e&&void 0!==o&&null!=(e=o.env[t])&&"string"==typeof e)return e}function b({settingValue:e,environmentVariableName:t,settingName:n,description:s}){if("string"==typeof e)return e;if(null!=e)throw new r.AU({message:`${s} setting must be a string.`});if(void 0===o)throw new r.AU({message:`${s} setting is missing. Pass it using the '${n}' parameter. Environment variables is not supported in this environment.`});if(null==(e=o.env[t]))throw new r.AU({message:`${s} setting is missing. Pass it using the '${n}' parameter or the ${t} environment variable.`});if("string"!=typeof e)throw new r.AU({message:`${s} setting must be a string. The value of the ${t} environment variable is not a string.`});return e}var v=Symbol.for("vercel.ai.validator");function _({value:e,schema:t}){let n="object"==typeof t&&null!==t&&v in t&&!0===t[v]&&"validate"in t?t:{[v]:!0,validate:e=>{let n=t.safeParse(e);return n.success?{success:!0,value:n.data}:{success:!1,error:n.error}}};try{if(null==n.validate)return{success:!0,value:e};let t=n.validate(e);if(t.success)return t;return{success:!1,error:r.Gz.wrap({value:e,cause:t.error})}}catch(t){return{success:!1,error:r.Gz.wrap({value:e,cause:t})}}}function w({text:e,schema:t}){try{let n=i.parse(e);if(null==t)return{success:!0,value:n,rawValue:n};let r=_({value:n,schema:t});return r.success?{...r,rawValue:n}:r}catch(t){return{success:!1,error:r.xU.isInstance(t)?t:new r.xU({text:e,cause:t})}}}function x(e){try{return i.parse(e),!0}catch(e){return!1}}function k({provider:e,providerOptions:t,schema:n}){if((null==t?void 0:t[e])==null)return;let s=_({value:t[e],schema:n});if(!s.success)throw new r.RU({argument:"providerOptions",message:`invalid ${e} provider options`,cause:s.error});return s.value}var S=()=>globalThis.fetch,A=async({url:e,headers:t,body:n,failedResponseHandler:r,successfulResponseHandler:s,abortSignal:i,fetch:o})=>E({url:e,headers:{"Content-Type":"application/json",...t},body:{content:JSON.stringify(n),values:n},failedResponseHandler:r,successfulResponseHandler:s,abortSignal:i,fetch:o}),I=async({url:e,headers:t,formData:n,failedResponseHandler:r,successfulResponseHandler:s,abortSignal:i,fetch:o})=>E({url:e,headers:t,body:{content:n,values:Object.fromEntries(n.entries())},failedResponseHandler:r,successfulResponseHandler:s,abortSignal:i,fetch:o}),E=async({url:e,headers:t={},body:n,successfulResponseHandler:s,failedResponseHandler:i,abortSignal:o,fetch:a=S()})=>{try{let l=await a(e,{method:"POST",headers:h(t),body:n.content,signal:o}),c=u(l);if(!l.ok){let t;try{t=await i({response:l,url:e,requestBodyValues:n.values})}catch(t){if(f(t)||r.w.isInstance(t))throw t;throw new r.w({message:"Failed to process error response",cause:t,statusCode:l.status,url:e,responseHeaders:c,requestBodyValues:n.values})}throw t.value}try{return await s({response:l,url:e,requestBodyValues:n.values})}catch(t){if(t instanceof Error&&(f(t)||r.w.isInstance(t)))throw t;throw new r.w({message:"Failed to process successful response",cause:t,statusCode:l.status,url:e,responseHeaders:c,requestBodyValues:n.values})}}catch(t){if(f(t))throw t;if(t instanceof TypeError&&"fetch failed"===t.message){let s=t.cause;if(null!=s)throw new r.w({message:`Cannot connect to API: ${s.message}`,cause:s,url:e,requestBodyValues:n.values,isRetryable:!0})}throw t}};async function T(e){return"function"==typeof e&&(e=e()),Promise.resolve(e)}var z=({errorSchema:e,errorToMessage:t,isRetryable:n})=>async({response:s,url:o,requestBodyValues:a})=>{let l=await s.text(),c=u(s);if(""===l.trim())return{responseHeaders:c,value:new r.w({message:s.statusText,url:o,requestBodyValues:a,statusCode:s.status,responseHeaders:c,responseBody:l,isRetryable:null==n?void 0:n(s)})};try{let u=function({text:e,schema:t}){try{let n=i.parse(e);if(null==t)return n;return function({value:e,schema:t}){let n=_({value:e,schema:t});if(!n.success)throw r.Gz.wrap({value:e,cause:n.error});return n.value}({value:n,schema:t})}catch(t){if(r.xU.isInstance(t)||r.Gz.isInstance(t))throw t;throw new r.xU({text:e,cause:t})}}({text:l,schema:e});return{responseHeaders:c,value:new r.w({message:t(u),url:o,requestBodyValues:a,statusCode:s.status,responseHeaders:c,responseBody:l,data:u,isRetryable:null==n?void 0:n(s,u)})}}catch(e){return{responseHeaders:c,value:new r.w({message:s.statusText,url:o,requestBodyValues:a,statusCode:s.status,responseHeaders:c,responseBody:l,isRetryable:null==n?void 0:n(s)})}}},C=e=>async({response:t})=>{let n=u(t);if(null==t.body)throw new r.g8({});return{responseHeaders:n,value:t.body.pipeThrough(new TextDecoderStream).pipeThrough(function(){let e,t,n,r="",s=[];function i(e,t){if(""===e){o(t);return}if(e.startsWith(":"))return;let n=e.indexOf(":");if(-1===n){a(e,"");return}let r=e.slice(0,n),s=n+1;a(r,s<e.length&&" "===e[s]?e.slice(s+1):e.slice(s))}function o(r){s.length>0&&(r.enqueue({event:e,data:s.join("\n"),id:t,retry:n}),s=[],e=void 0,n=void 0)}function a(r,i){switch(r){case"event":e=i;break;case"data":s.push(i);break;case"id":t=i;break;case"retry":let o=parseInt(i,10);isNaN(o)||(n=o)}}return new TransformStream({transform(e,t){let{lines:n,incompleteLine:s}=function(e,t){let n=[],r=e;for(let e=0;e<t.length;){let s=t[e++];"\n"===s?(n.push(r),r=""):"\r"===s?(n.push(r),r="","\n"===t[e]&&e++):r+=s}return{lines:n,incompleteLine:r}}(r,e);r=s;for(let e=0;e<n.length;e++)i(n[e],t)},flush(e){i(r,e),o(e)}})}()).pipeThrough(new TransformStream({transform({data:t},n){"[DONE]"!==t&&n.enqueue(w({text:t,schema:e}))}}))}},j=e=>async({response:t,url:n,requestBodyValues:s})=>{let i=await t.text(),o=w({text:i,schema:e}),a=u(t);if(!o.success)throw new r.w({message:"Invalid JSON response",cause:o.error,statusCode:t.status,responseHeaders:a,responseBody:i,url:n,requestBodyValues:s});return{responseHeaders:a,value:o.value,rawValue:o.rawValue}},N=()=>async({response:e,url:t,requestBodyValues:n})=>{let s=u(e);if(!e.body)throw new r.w({message:"Response body is empty",url:t,requestBodyValues:n,statusCode:e.status,responseHeaders:s,responseBody:void 0});try{let t=await e.arrayBuffer();return{responseHeaders:s,value:new Uint8Array(t)}}catch(i){throw new r.w({message:"Failed to read response as array buffer",url:t,requestBodyValues:n,statusCode:e.status,responseHeaders:s,responseBody:void 0,cause:i})}},O=()=>async({response:e,url:t,requestBodyValues:n})=>{let s=u(e),i=await e.text();return{responseHeaders:s,value:new r.w({message:e.statusText,url:t,requestBodyValues:n,statusCode:e.status,responseHeaders:s,responseBody:i})}},{btoa:P,atob:R}=globalThis;function M(e){let t=R(e.replace(/-/g,"+").replace(/_/g,"/"));return Uint8Array.from(t,e=>e.codePointAt(0))}function U(e){let t="";for(let n=0;n<e.length;n++)t+=String.fromCodePoint(e[n]);return P(t)}function $(e){return null==e?void 0:e.replace(/\/$/,"")}},2244:function(e,t,n){"use strict";n.d(t,{AU:function(){return Y},AX:function(){return v},A_:function(){return em},Gz:function(){return ed},JJ:function(){return en},Mt:function(){return M},ON:function(){return eo},RU:function(){return N},Rt:function(){return F},g8:function(){return E},tZ:function(){return Z},w:function(){return k},xU:function(){return V}});var r,s,i,o,a,l,u,c,d,h,f,p,m,g="vercel.ai.error",y=Symbol.for(g),b=class e extends Error{constructor({name:e,message:t,cause:n}){super(t),this[r]=!0,this.name=e,this.cause=n}static isInstance(t){return e.hasMarker(t,g)}static hasMarker(e,t){let n=Symbol.for(t);return null!=e&&"object"==typeof e&&n in e&&"boolean"==typeof e[n]&&!0===e[n]}};r=y;var v=b,_="AI_APICallError",w=`vercel.ai.error.${_}`,x=Symbol.for(w),k=class extends v{constructor({message:e,url:t,requestBodyValues:n,statusCode:r,responseHeaders:i,responseBody:o,cause:a,isRetryable:l=null!=r&&(408===r||409===r||429===r||r>=500),data:u}){super({name:_,message:e,cause:a}),this[s]=!0,this.url=t,this.requestBodyValues=n,this.statusCode=r,this.responseHeaders=i,this.responseBody=o,this.isRetryable=l,this.data=u}static isInstance(e){return v.hasMarker(e,w)}};s=x;var S="AI_EmptyResponseBodyError",A=`vercel.ai.error.${S}`,I=Symbol.for(A),E=class extends v{constructor({message:e="Empty response body"}={}){super({name:S,message:e}),this[i]=!0}static isInstance(e){return v.hasMarker(e,A)}};function T(e){return null==e?"unknown error":"string"==typeof e?e:e instanceof Error?e.message:JSON.stringify(e)}i=I;var z="AI_InvalidArgumentError",C=`vercel.ai.error.${z}`,j=Symbol.for(C),N=class extends v{constructor({message:e,cause:t,argument:n}){super({name:z,message:e,cause:t}),this[o]=!0,this.argument=n}static isInstance(e){return v.hasMarker(e,C)}};o=j;var O="AI_InvalidPromptError",P=`vercel.ai.error.${O}`,R=Symbol.for(P),M=class extends v{constructor({prompt:e,message:t,cause:n}){super({name:O,message:`Invalid prompt: ${t}`,cause:n}),this[a]=!0,this.prompt=e}static isInstance(e){return v.hasMarker(e,P)}};a=R;var U="AI_InvalidResponseDataError",$=`vercel.ai.error.${U}`,L=Symbol.for($),F=class extends v{constructor({data:e,message:t=`Invalid response data: ${JSON.stringify(e)}.`}){super({name:U,message:t}),this[l]=!0,this.data=e}static isInstance(e){return v.hasMarker(e,$)}};l=L;var B="AI_JSONParseError",D=`vercel.ai.error.${B}`,q=Symbol.for(D),V=class extends v{constructor({text:e,cause:t}){super({name:B,message:`JSON parsing failed: Text: ${e}.
Error message: ${T(t)}`,cause:t}),this[u]=!0,this.text=e}static isInstance(e){return v.hasMarker(e,D)}};u=q;var W="AI_LoadAPIKeyError",H=`vercel.ai.error.${W}`,G=Symbol.for(H),Z=class extends v{constructor({message:e}){super({name:W,message:e}),this[c]=!0}static isInstance(e){return v.hasMarker(e,H)}};c=G;var J="AI_LoadSettingError",K=`vercel.ai.error.${J}`,X=Symbol.for(K),Y=class extends v{constructor({message:e}){super({name:J,message:e}),this[d]=!0}static isInstance(e){return v.hasMarker(e,K)}};d=X,Symbol.for("vercel.ai.error.AI_NoContentGeneratedError");var Q="AI_NoSuchModelError",ee=`vercel.ai.error.${Q}`,et=Symbol.for(ee),en=class extends v{constructor({errorName:e=Q,modelId:t,modelType:n,message:r=`No such ${n}: ${t}`}){super({name:e,message:r}),this[h]=!0,this.modelId=t,this.modelType=n}static isInstance(e){return v.hasMarker(e,ee)}};h=et;var er="AI_TooManyEmbeddingValuesForCallError",es=`vercel.ai.error.${er}`,ei=Symbol.for(es),eo=class extends v{constructor(e){super({name:er,message:`Too many values for a single embedding call. The ${e.provider} model "${e.modelId}" can only embed up to ${e.maxEmbeddingsPerCall} values per call, but ${e.values.length} values were provided.`}),this[f]=!0,this.provider=e.provider,this.modelId=e.modelId,this.maxEmbeddingsPerCall=e.maxEmbeddingsPerCall,this.values=e.values}static isInstance(e){return v.hasMarker(e,es)}};f=ei;var ea="AI_TypeValidationError",el=`vercel.ai.error.${ea}`,eu=Symbol.for(el),ec=class e extends v{constructor({value:e,cause:t}){super({name:ea,message:`Type validation failed: Value: ${JSON.stringify(e)}.
Error message: ${T(t)}`,cause:t}),this[p]=!0,this.value=e}static isInstance(e){return v.hasMarker(e,el)}static wrap({value:t,cause:n}){return e.isInstance(n)&&n.value===t?n:new e({value:t,cause:n})}};p=eu;var ed=ec,eh="AI_UnsupportedFunctionalityError",ef=`vercel.ai.error.${eh}`,ep=Symbol.for(ef),em=class extends v{constructor({functionality:e,message:t=`'${e}' functionality not supported.`}){super({name:eh,message:t}),this[m]=!0,this.functionality=e}static isInstance(e){return v.hasMarker(e,ef)}};m=ep},9122:function(e,t,n){"use strict";var r=n(6076),s=n(939),i=n(858),o=class{constructor(e,t,n){this.modelId=e,this.settings=t,this.config=n,this.specificationVersion="v1"}get provider(){return this.config.provider}get maxImagesPerCall(){var e;return null!=(e=this.settings.maxImagesPerCall)?e:1}async doGenerate({prompt:e,n:t,size:n,seed:r,providerOptions:i,headers:o,abortSignal:u}){var c,d,h,f;let p=[];null!=n&&p.push({type:"unsupported-setting",setting:"aspectRatio",details:"This model does not support the `aspectRatio` option. Use `size` instead."});let m=null!=(h=null==(d=null==(c=this.config._internal)?void 0:c.currentDate)?void 0:d.call(c))?h:new Date,g=null==n?void 0:n.split("x"),{value:y,responseHeaders:b}=await (0,s.A8)({url:`${this.config.baseURL}/images/generations`,headers:(0,s.NF)(this.config.headers(),o),body:{model:this.modelId,prompt:e,seed:r,n:t,...g&&{width:parseInt(g[0]),height:parseInt(g[1])},response_format:"base64",...null!=(f=i.togetherai)?f:{}},failedResponseHandler:(0,s.Sq)({errorSchema:l,errorToMessage:e=>e.error.message}),successfulResponseHandler:(0,s.tc)(a),abortSignal:u,fetch:this.config.fetch});return{images:y.data.map(e=>e.b64_json),warnings:p,response:{timestamp:m,modelId:this.modelId,headers:b}}}},a=i.z.object({data:i.z.array(i.z.object({b64_json:i.z.string()}))}),l=i.z.object({error:i.z.object({message:i.z.string()})});!function(e={}){var t;let n=(0,s.QT)(null!=(t=e.baseURL)?t:"https://api.together.xyz/v1/"),i=()=>({Authorization:`Bearer ${(0,s.pd)({apiKey:e.apiKey,environmentVariableName:"TOGETHER_AI_API_KEY",description:"TogetherAI"})}`,...e.headers}),a=t=>({provider:`togetherai.${t}`,url:({path:e})=>`${n}${e}`,headers:i,fetch:e.fetch}),l=(e,t={})=>new r.IY(e,t,{...a("chat"),defaultObjectGenerationMode:"tool"}),u=(e,t={})=>new o(e,t,{...a("image"),baseURL:null!=n?n:"https://api.together.xyz/v1/"}),c=(e,t)=>l(e,t);c.completionModel=(e,t={})=>new r.qS(e,t,a("completion")),c.languageModel=l,c.chatModel=l,c.textEmbeddingModel=(e,t={})=>new r.KC(e,t,a("embedding")),c.image=u,c.imageModel=u}()},8290:function(e,t,n){"use strict";var r=n(2244),s=n(6076),i=n(939),o=n(858),a={errorSchema:o.z.object({code:o.z.string(),error:o.z.string()}),errorToMessage:e=>e.error};!function(e={}){var t;let n=(0,i.QT)(null!=(t=e.baseURL)?t:"https://api.x.ai/v1"),o=()=>({Authorization:`Bearer ${(0,i.pd)({apiKey:e.apiKey,environmentVariableName:"XAI_API_KEY",description:"xAI API key"})}`,...e.headers}),l=(t,r={})=>{let i=["grok-3","grok-3-beta","grok-3-latest","grok-3-fast","grok-3-fast-beta","grok-3-fast-latest","grok-3-mini","grok-3-mini-beta","grok-3-mini-latest","grok-3-mini-fast","grok-3-mini-fast-beta","grok-3-mini-fast-latest","grok-2-1212","grok-2-vision-1212"].includes(t);return new s.IY(t,r,{provider:"xai.chat",url:({path:e})=>`${n}${e}`,headers:o,fetch:e.fetch,defaultObjectGenerationMode:i?"json":"tool",errorStructure:a,supportsStructuredOutputs:i,includeUsage:!0})},u=(t,r={})=>new s.M6(t,r,{provider:"xai.image",url:({path:e})=>`${n}${e}`,headers:o,fetch:e.fetch,errorStructure:a}),c=(e,t)=>l(e,t);c.languageModel=l,c.chat=l,c.textEmbeddingModel=e=>{throw new r.JJ({modelId:e,modelType:"textEmbeddingModel"})},c.imageModel=u,c.image=u}()},7442:function(e,t,n){"use strict";let r,s,i,o,a,l,u;n.d(t,{YU:function(){return tM}});let c="0.37.0",d=!1;class h{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}s||function(e,t={auto:!1}){if(d)throw Error(`you must \`import '@anthropic-ai/sdk/shims/${e.kind}'\` before importing anything else from @anthropic-ai/sdk`);if(s)throw Error(`can't \`import '@anthropic-ai/sdk/shims/${e.kind}'\` after \`import '@anthropic-ai/sdk/shims/${s}'\``);d=t.auto,s=e.kind,i=e.fetch,e.Request,e.Response,e.Headers,e.FormData,e.Blob,o=e.File,a=e.ReadableStream,e.getMultipartRequestOptions,l=e.getDefaultAgent,u=e.fileFromPath,e.isFsReadStream}(function({manuallyImported:e}={}){let t,n,r,s;let i=e?"You may need to use polyfills":`Add one of these imports before your first \`import  from '@anthropic-ai/sdk'\`:
- \`import '@anthropic-ai/sdk/shims/node'\` (if you're running on Node)
- \`import '@anthropic-ai/sdk/shims/web'\` (otherwise)
`;try{t=fetch,n=Request,r=Response,s=Headers}catch(e){throw Error(`this environment is missing the following Web Fetch API type: ${e.message}. ${i}`)}return{kind:"web",fetch:t,Request:n,Response:r,Headers:s,FormData:"undefined"!=typeof FormData?FormData:class{constructor(){throw Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${i}`)}},Blob:"undefined"!=typeof Blob?Blob:class{constructor(){throw Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${i}`)}},File:"undefined"!=typeof File?File:class{constructor(){throw Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${i}`)}},ReadableStream:"undefined"!=typeof ReadableStream?ReadableStream:class{constructor(){throw Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${i}`)}},getMultipartRequestOptions:async(e,t)=>({...t,body:new h(e)}),getDefaultAgent:e=>void 0,fileFromPath:()=>{throw Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/anthropics/anthropic-sdk-typescript#file-uploads")},isFsReadStream:e=>!1}}(),{auto:!0});class f extends Error{}class p extends f{constructor(e,t,n,r){super(`${p.makeMessage(e,t,n)}`),this.status=e,this.headers=r,this.request_id=r?.["request-id"],this.error=t}static makeMessage(e,t,n){let r=t?.message?"string"==typeof t.message?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&r?`${e} ${r}`:e?`${e} status code (no body)`:r||"(no status code or body)"}static generate(e,t,n,r){return e&&r?400===e?new b(e,t,n,r):401===e?new v(e,t,n,r):403===e?new _(e,t,n,r):404===e?new w(e,t,n,r):409===e?new x(e,t,n,r):422===e?new k(e,t,n,r):429===e?new S(e,t,n,r):e>=500?new A(e,t,n,r):new p(e,t,n,r):new g({message:n,cause:e5(t)})}}class m extends p{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class g extends p{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class y extends g{constructor({message:e}={}){super({message:e??"Request timed out."})}}class b extends p{}class v extends p{}class _ extends p{}class w extends p{}class x extends p{}class k extends p{}class S extends p{}class A extends p{}var I,E,T,z,C,j,N,O,P,R,M,U,$,L,F,B,D,q,V,W,H,G,Z,J,K,X,Y,Q,ee,et,en,er,es,ei,eo,ea,el,eu,ec,ed,eh,ef,ep,em,eg,ey,eb=n(5313).lW,ev=function(e,t,n,r,s){if("m"===r)throw TypeError("Private method is not writable");if("a"===r&&!s)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n},e_=function(e,t,n,r){if("a"===n&&!r)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};class ew{constructor(){I.set(this,void 0),this.buffer=new Uint8Array,ev(this,I,null,"f")}decode(e){let t;if(null==e)return[];let n=e instanceof ArrayBuffer?new Uint8Array(e):"string"==typeof e?new TextEncoder().encode(e):e,r=new Uint8Array(this.buffer.length+n.length);r.set(this.buffer),r.set(n,this.buffer.length),this.buffer=r;let s=[];for(;null!=(t=function(e,t){for(let n=t??0;n<e.length;n++){if(10===e[n])return{preceding:n,index:n+1,carriage:!1};if(13===e[n])return{preceding:n,index:n+1,carriage:!0}}return null}(this.buffer,e_(this,I,"f")));){if(t.carriage&&null==e_(this,I,"f")){ev(this,I,t.index,"f");continue}if(null!=e_(this,I,"f")&&(t.index!==e_(this,I,"f")+1||t.carriage)){s.push(this.decodeText(this.buffer.slice(0,e_(this,I,"f")-1))),this.buffer=this.buffer.slice(e_(this,I,"f")),ev(this,I,null,"f");continue}let e=null!==e_(this,I,"f")?t.preceding-1:t.preceding,n=this.decodeText(this.buffer.slice(0,e));s.push(n),this.buffer=this.buffer.slice(t.index),ev(this,I,null,"f")}return s}decodeText(e){if(null==e)return"";if("string"==typeof e)return e;if(void 0!==eb){if(e instanceof eb)return e.toString();if(e instanceof Uint8Array)return eb.from(e).toString();throw new f(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if("undefined"!=typeof TextDecoder){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new f(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new f("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){return this.buffer.length?this.decode("\n"):[]}}function ex(e){if(e[Symbol.asyncIterator])return e;let t=e.getReader();return{async next(){try{let e=await t.read();return e?.done&&t.releaseLock(),e}catch(e){throw t.releaseLock(),e}},async return(){let e=t.cancel();return t.releaseLock(),await e,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}I=new WeakMap,ew.NEWLINE_CHARS=new Set(["\n","\r"]),ew.NEWLINE_REGEXP=/\r\n|[\n\r]/g;class ek{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let n=!1;return new ek(async function*(){if(n)throw Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let r=!1;try{for await(let n of eS(e,t)){if("completion"===n.event)try{yield JSON.parse(n.data)}catch(e){throw console.error("Could not parse message into JSON:",n.data),console.error("From chunk:",n.raw),e}if("message_start"===n.event||"message_delta"===n.event||"message_stop"===n.event||"content_block_start"===n.event||"content_block_delta"===n.event||"content_block_stop"===n.event)try{yield JSON.parse(n.data)}catch(e){throw console.error("Could not parse message into JSON:",n.data),console.error("From chunk:",n.raw),e}if("ping"!==n.event&&"error"===n.event)throw p.generate(void 0,`SSE Error: ${n.data}`,n.data,eZ(e.headers))}r=!0}catch(e){if(e instanceof Error&&"AbortError"===e.name)return;throw e}finally{r||t.abort()}},t)}static fromReadableStream(e,t){let n=!1;async function*r(){let t=new ew;for await(let n of ex(e))for(let e of t.decode(n))yield e;for(let e of t.flush())yield e}return new ek(async function*(){if(n)throw Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let e=!1;try{for await(let t of r())!e&&t&&(yield JSON.parse(t));e=!0}catch(e){if(e instanceof Error&&"AbortError"===e.name)return;throw e}finally{e||t.abort()}},t)}[Symbol.asyncIterator](){return this.iterator()}tee(){let e=[],t=[],n=this.iterator(),r=r=>({next:()=>{if(0===r.length){let r=n.next();e.push(r),t.push(r)}return r.shift()}});return[new ek(()=>r(e),this.controller),new ek(()=>r(t),this.controller)]}toReadableStream(){let e;let t=this,n=new TextEncoder;return new a({async start(){e=t[Symbol.asyncIterator]()},async pull(t){try{let{value:r,done:s}=await e.next();if(s)return t.close();let i=n.encode(JSON.stringify(r)+"\n");t.enqueue(i)}catch(e){t.error(e)}},async cancel(){await e.return?.()}})}}async function*eS(e,t){if(!e.body)throw t.abort(),new f("Attempted to iterate over a response with no body");let n=new eI,r=new ew;for await(let t of eA(ex(e.body)))for(let e of r.decode(t)){let t=n.decode(e);t&&(yield t)}for(let e of r.flush()){let t=n.decode(e);t&&(yield t)}}async function*eA(e){let t=new Uint8Array;for await(let n of e){let e;if(null==n)continue;let r=n instanceof ArrayBuffer?new Uint8Array(n):"string"==typeof n?new TextEncoder().encode(n):n,s=new Uint8Array(t.length+r.length);for(s.set(t),s.set(r,t.length),t=s;-1!==(e=function(e){for(let t=0;t<e.length-1;t++){if(10===e[t]&&10===e[t+1]||13===e[t]&&13===e[t+1])return t+2;if(13===e[t]&&10===e[t+1]&&t+3<e.length&&13===e[t+2]&&10===e[t+3])return t+4}return -1}(t));)yield t.slice(0,e),t=t.slice(e)}t.length>0&&(yield t)}class eI{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;let e={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],e}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,r]=function(e,t){let n=e.indexOf(":");return -1!==n?[e.substring(0,n),":",e.substring(n+t.length)]:[e,"",""]}(e,":");return r.startsWith(" ")&&(r=r.substring(1)),"event"===t?this.event=r:"data"===t&&this.data.push(r),null}}var eE=n(5313).lW;let eT=e=>null!=e&&"object"==typeof e&&"string"==typeof e.url&&"function"==typeof e.blob,ez=e=>null!=e&&"object"==typeof e&&"string"==typeof e.name&&"number"==typeof e.lastModified&&eC(e),eC=e=>null!=e&&"object"==typeof e&&"number"==typeof e.size&&"string"==typeof e.type&&"function"==typeof e.text&&"function"==typeof e.slice&&"function"==typeof e.arrayBuffer,ej=e=>ez(e)||eT(e)||isFsReadStream(e);async function eN(e,t,n){var r;if(ez(e=await e))return e;if(eT(e)){let r=await e.blob();t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()??"unknown_file");let s=eC(r)?[await r.arrayBuffer()]:[r];return new o(s,t,n)}let s=await eO(e);if(t||(t=(eP((r=e).name)||eP(r.filename)||eP(r.path)?.split(/[\\/]/).pop())??"unknown_file"),!n?.type){let e=s[0]?.type;"string"==typeof e&&(n={...n,type:e})}return new o(s,t,n)}async function eO(e){let t=[];if("string"==typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)t.push(e);else if(eC(e))t.push(await e.arrayBuffer());else if(eR(e))for await(let n of e)t.push(n);else throw Error(`Unexpected data type: ${typeof e}; constructor: ${e?.constructor?.name}; props: ${function(e){let t=Object.getOwnPropertyNames(e);return`[${t.map(e=>`"${e}"`).join(", ")}]`}(e)}`);return t}let eP=e=>"string"==typeof e?e:void 0!==eE&&e instanceof eE?String(e):void 0,eR=e=>null!=e&&"object"==typeof e&&"function"==typeof e[Symbol.asyncIterator],eM=e=>e&&"object"==typeof e&&e.body&&"MultipartBody"===e[Symbol.toStringTag],eU=e=>{if(ej(e))return!0;if(Array.isArray(e))return e.some(eU);if(e&&"object"==typeof e){for(let t in e)if(eU(e[t]))return!0}return!1};var e$=n(5313).lW,eL=n(3656),eF=function(e,t,n,r,s){if("m"===r)throw TypeError("Private method is not writable");if("a"===r&&!s)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n},eB=function(e,t,n,r){if("a"===n&&!r)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};async function eD(e){let{response:t}=e;if(e.options.stream)return(tt("response",t.status,t.url,t.headers,t.body),e.options.__streamClass)?e.options.__streamClass.fromSSEResponse(t,e.controller):ek.fromSSEResponse(t,e.controller);if(204===t.status)return null;if(e.options.__binaryResponse)return t;let n=t.headers.get("content-type");if(n?.includes("application/json")||n?.includes("application/vnd.api+json")){let e=await t.json();return tt("response",t.status,t.url,t.headers,e),eq(e,t)}let r=await t.text();return tt("response",t.status,t.url,t.headers,r),r}function eq(e,t){return!e||"object"!=typeof e||Array.isArray(e)?e:Object.defineProperty(e,"_request_id",{value:t.headers.get("request-id"),enumerable:!1})}class eV extends Promise{constructor(e,t=eD){super(e=>{e(null)}),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new eV(this.responsePromise,async t=>eq(e(await this.parseResponse(t),t),t.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){let[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class eW{constructor({baseURL:e,maxRetries:t=2,timeout:n=6e5,httpAgent:r,fetch:s}){this.baseURL=e,this.maxRetries=e4("maxRetries",t),this.timeout=e4("timeout",n),this.httpAgent=r,this.fetch=s??i}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...e0(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${tn()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then(async n=>{let r=n&&eC(n?.body)?new DataView(await n.body.arrayBuffer()):n?.body instanceof DataView?n.body:n?.body instanceof ArrayBuffer?new DataView(n.body):n&&ArrayBuffer.isView(n?.body)?new DataView(n.body.buffer):n?.body;return{method:e,path:t,...n,body:r}}))}getAPIList(e,t,n){return this.requestAPIList(t,{method:"get",path:e,...n})}calculateContentLength(e){if("string"==typeof e){if(void 0!==e$)return e$.byteLength(e,"utf8").toString();if("undefined"!=typeof TextEncoder)return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:t=0}={}){let{method:n,path:r,query:s,headers:i={}}=e={...e},o=ArrayBuffer.isView(e.body)||e.__binaryRequest&&"string"==typeof e.body?e.body:eM(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,a=this.calculateContentLength(o),u=this.buildURL(r,s);"timeout"in e&&e4("timeout",e.timeout),e.timeout=e.timeout??this.timeout;let c=e.httpAgent??this.httpAgent??l(u),d=e.timeout+1e3;"number"==typeof c?.options?.timeout&&d>(c.options.timeout??0)&&(c.options.timeout=d),this.idempotencyHeader&&"get"!==n&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),i[this.idempotencyHeader]=e.idempotencyKey);let h=this.buildHeaders({options:e,headers:i,contentLength:a,retryCount:t});return{req:{method:n,...o&&{body:o},headers:h,...c&&{agent:c},signal:e.signal??null},url:u,timeout:e.timeout}}buildHeaders({options:e,headers:t,contentLength:n,retryCount:r}){let i={};n&&(i["content-length"]=n);let o=this.defaultHeaders(e);return te(i,o),te(i,t),eM(e.body)&&"node"!==s&&delete i["content-type"],void 0===ti(o,"x-stainless-retry-count")&&void 0===ti(t,"x-stainless-retry-count")&&(i["x-stainless-retry-count"]=String(r)),void 0===ti(o,"x-stainless-timeout")&&void 0===ti(t,"x-stainless-timeout")&&e.timeout&&(i["x-stainless-timeout"]=String(e.timeout)),this.validateHeaders(i,t),i}_calculateNonstreamingTimeout(e){if(3600*e/128e3>600)throw new f("Streaming is strongly recommended for operations that may take longer than 10 minutes. See https://github.com/anthropics/anthropic-sdk-python#streaming-responses for more details");return 6e5}async prepareOptions(e){}async prepareRequest(e,{url:t,options:n}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(e=>[...e])):{...e}:{}}makeStatusError(e,t,n,r){return p.generate(e,t,n,r)}request(e,t=null){return new eV(this.makeRequest(e,t))}async makeRequest(e,t){let n=await e,r=n.maxRetries??this.maxRetries;null==t&&(t=r),await this.prepareOptions(n);let{req:s,url:i,timeout:o}=this.buildRequest(n,{retryCount:r-t});if(await this.prepareRequest(s,{url:i,options:n}),tt("request",i,n,s.headers),n.signal?.aborted)throw new m;let a=new AbortController,l=await this.fetchWithTimeout(i,s,o,a).catch(e5);if(l instanceof Error){if(n.signal?.aborted)throw new m;if(t)return this.retryRequest(n,t);if("AbortError"===l.name)throw new y;throw new g({cause:l})}let u=eZ(l.headers);if(!l.ok){if(t&&this.shouldRetry(l)){let e=`retrying, ${t} attempts remaining`;return tt(`response (error; ${e})`,l.status,i,u),this.retryRequest(n,t,u)}let e=await l.text().catch(e=>e5(e).message),r=e1(e),s=r?void 0:e,o=t?"(error; no more retries left)":"(error; not retryable)";throw tt(`response (error; ${o})`,l.status,i,u,s),this.makeStatusError(l.status,r,s,u)}return{response:l,options:n,controller:a}}requestAPIList(e,t){return new eG(this,this.makeRequest(t,null),e)}buildURL(e,t){let n=new URL(e6(e)?e:this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),r=this.defaultQuery();return e9(r)||(t={...r,...t}),"object"==typeof t&&t&&!Array.isArray(t)&&(n.search=this.stringifyQuery(t)),n.toString()}stringifyQuery(e){return Object.entries(e).filter(([e,t])=>void 0!==t).map(([e,t])=>{if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return`${encodeURIComponent(e)}=${encodeURIComponent(t)}`;if(null===t)return`${encodeURIComponent(e)}=`;throw new f(`Cannot stringify type ${typeof t}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,t,n,r){let{signal:s,...i}=t||{};s&&s.addEventListener("abort",()=>r.abort());let o=setTimeout(()=>r.abort(),n),a={signal:r.signal,...i};a.method&&(a.method=a.method.toUpperCase());let l=setTimeout(()=>{if(a&&a?.agent?.sockets)for(let e of Object.values(a?.agent?.sockets).flat())e?.setKeepAlive&&e.setKeepAlive(!0,6e4)},6e4);return this.fetch.call(void 0,e,a).finally(()=>{clearTimeout(o),clearTimeout(l)})}shouldRetry(e){let t=e.headers.get("x-should-retry");return"true"===t||"false"!==t&&(408===e.status||409===e.status||429===e.status||e.status>=500)}async retryRequest(e,t,n){let r;let s=n?.["retry-after-ms"];if(s){let e=parseFloat(s);Number.isNaN(e)||(r=e)}let i=n?.["retry-after"];if(i&&!r){let e=parseFloat(i);r=Number.isNaN(e)?Date.parse(i)-Date.now():1e3*e}if(!(r&&0<=r&&r<6e4)){let n=e.maxRetries??this.maxRetries;r=this.calculateDefaultRetryTimeoutMillis(t,n)}return await e3(r),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){return Math.min(.5*Math.pow(2,t-e),8)*(1-.25*Math.random())*1e3}getUserAgent(){return`${this.constructor.name}/JS ${c}`}}class eH{constructor(e,t,n,r){E.set(this,void 0),eF(this,E,e,"f"),this.options=r,this.response=t,this.body=n}hasNextPage(){return!!this.getPaginatedItems().length&&null!=this.nextPageInfo()}async getNextPage(){let e=this.nextPageInfo();if(!e)throw new f("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");let t={...this.options};if("params"in e&&"object"==typeof t.query)t.query={...t.query,...e.params};else if("url"in e){for(let[n,r]of[...Object.entries(t.query||{}),...e.url.searchParams.entries()])e.url.searchParams.set(n,r);t.query=void 0,t.path=e.url.toString()}return await eB(this,E,"f").requestAPIList(this.constructor,t)}async *iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async *[(E=new WeakMap,Symbol.asyncIterator)](){for await(let e of this.iterPages())for(let t of e.getPaginatedItems())yield t}}class eG extends eV{constructor(e,t,n){super(t,async t=>new n(e,t.response,await eD(t),t.options))}async *[Symbol.asyncIterator](){for await(let e of(await this))yield e}}let eZ=e=>new Proxy(Object.fromEntries(e.entries()),{get(e,t){let n=t.toString();return e[n.toLowerCase()]||e[n]}}),eJ={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},eK=e=>"object"==typeof e&&null!==e&&!e9(e)&&Object.keys(e).every(e=>e7(eJ,e)),eX=()=>{if("undefined"!=typeof Deno&&null!=Deno.build)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":c,"X-Stainless-OS":eQ(Deno.build.os),"X-Stainless-Arch":eY(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":"string"==typeof Deno.version?Deno.version:Deno.version?.deno??"unknown"};if("undefined"!=typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":c,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":eL.version};if("[object process]"===Object.prototype.toString.call(void 0!==eL?eL:0))return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":c,"X-Stainless-OS":eQ(eL.platform),"X-Stainless-Arch":eY(eL.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":eL.version};let e=function(){if("undefined"==typeof navigator||!navigator)return null;for(let{key:e,pattern:t}of[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}]){let n=t.exec(navigator.userAgent);if(n){let t=n[1]||0,r=n[2]||0,s=n[3]||0;return{browser:e,version:`${t}.${r}.${s}`}}}return null}();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":c,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":c,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}},eY=e=>"x32"===e?"x32":"x86_64"===e||"x64"===e?"x64":"arm"===e?"arm":"aarch64"===e||"arm64"===e?"arm64":e?`other:${e}`:"unknown",eQ=e=>(e=e.toLowerCase()).includes("ios")?"iOS":"android"===e?"Android":"darwin"===e?"MacOS":"win32"===e?"Windows":"freebsd"===e?"FreeBSD":"openbsd"===e?"OpenBSD":"linux"===e?"Linux":e?`Other:${e}`:"Unknown",e0=()=>r??(r=eX()),e1=e=>{try{return JSON.parse(e)}catch(e){return}},e2=/^[a-z][a-z0-9+.-]*:/i,e6=e=>e2.test(e),e3=e=>new Promise(t=>setTimeout(t,e)),e4=(e,t)=>{if("number"!=typeof t||!Number.isInteger(t))throw new f(`${e} must be an integer`);if(t<0)throw new f(`${e} must be a positive integer`);return t},e5=e=>{if(e instanceof Error)return e;if("object"==typeof e&&null!==e)try{return Error(JSON.stringify(e))}catch{}return Error(String(e))},e8=e=>void 0!==eL?eL.env?.[e]?.trim()??void 0:"undefined"!=typeof Deno?Deno.env?.get?.(e)?.trim():void 0;function e9(e){if(!e)return!0;for(let t in e)return!1;return!0}function e7(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function te(e,t){for(let n in t){if(!e7(t,n))continue;let r=n.toLowerCase();if(!r)continue;let s=t[n];null===s?delete e[r]:void 0!==s&&(e[r]=s)}}function tt(e,...t){void 0!==eL&&eL?.env?.DEBUG==="true"&&console.log(`Anthropic:DEBUG:${e}`,...t)}let tn=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}),tr=()=>"undefined"!=typeof window&&void 0!==window.document&&"undefined"!=typeof navigator,ts=e=>"function"==typeof e?.get,ti=(e,t)=>{let n=t.toLowerCase();if(ts(e)){let r=t[0]?.toUpperCase()+t.substring(1).replace(/([^\w])(\w)/g,(e,t,n)=>t+n.toUpperCase());for(let s of[t,n,t.toUpperCase(),r]){let t=e.get(s);if(t)return t}}for(let[r,s]of Object.entries(e))if(r.toLowerCase()===n){if(Array.isArray(s)){if(s.length<=1)return s[0];return console.warn(`Received ${s.length} entries for the ${t} header, using the first entry.`),s[0]}return s}};class to{constructor(e){this._client=e}}class ta extends to{create(e,t){return this._client.post("/v1/complete",{body:e,timeout:this._client._options.timeout??6e5,...t,stream:e.stream??!1})}}class tl extends eH{constructor(e,t,n,r){super(e,t,n,r),this.data=n.data||[],this.has_more=n.has_more||!1,this.first_id=n.first_id||null,this.last_id=n.last_id||null}getPaginatedItems(){return this.data??[]}hasNextPage(){return!1!==this.has_more&&super.hasNextPage()}nextPageParams(){let e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;let t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){if(this.options.query?.before_id){let e=this.first_id;return e?{params:{before_id:e}}:null}let e=this.last_id;return e?{params:{after_id:e}}:null}}class tu{constructor(e,t){this.iterator=e,this.controller=t}async *decoder(){let e=new ew;for await(let t of this.iterator)for(let n of e.decode(t))yield JSON.parse(n);for(let t of e.flush())yield JSON.parse(t)}[Symbol.asyncIterator](){return this.decoder()}static fromResponse(e,t){if(!e.body)throw t.abort(),new f("Attempted to iterate over a response with no body");return new tu(ex(e.body),t)}}class tc extends to{create(e,t){return this._client.post("/v1/messages/batches",{body:e,...t})}retrieve(e,t){return this._client.get(`/v1/messages/batches/${e}`,t)}list(e={},t){return eK(e)?this.list({},e):this._client.getAPIList("/v1/messages/batches",td,{query:e,...t})}delete(e,t){return this._client.delete(`/v1/messages/batches/${e}`,t)}cancel(e,t){return this._client.post(`/v1/messages/batches/${e}/cancel`,t)}async results(e,t){let n=await this.retrieve(e);if(!n.results_url)throw new f(`No batch \`results_url\`; Has it finished processing? ${n.processing_status} - ${n.id}`);return this._client.get(n.results_url,{...t,headers:{Accept:"application/binary",...t?.headers},__binaryResponse:!0})._thenUnwrap((e,t)=>tu.fromResponse(t.response,t.controller))}}class td extends tl{}tc.MessageBatchesPage=td;let th=e=>{let t=0,n=[];for(;t<e.length;){let r=e[t];if("\\"===r){t++;continue}if("{"===r){n.push({type:"brace",value:"{"}),t++;continue}if("}"===r){n.push({type:"brace",value:"}"}),t++;continue}if("["===r){n.push({type:"paren",value:"["}),t++;continue}if("]"===r){n.push({type:"paren",value:"]"}),t++;continue}if(":"===r){n.push({type:"separator",value:":"}),t++;continue}if(","===r){n.push({type:"delimiter",value:","}),t++;continue}if('"'===r){let s="",i=!1;for(r=e[++t];'"'!==r;){if(t===e.length){i=!0;break}if("\\"===r){if(++t===e.length){i=!0;break}s+=r+e[t],r=e[++t]}else s+=r,r=e[++t]}r=e[++t],i||n.push({type:"string",value:s});continue}let s=/\s/;if(r&&s.test(r)){t++;continue}let i=/[0-9]/;if(r&&i.test(r)||"-"===r||"."===r){let s="";for("-"===r&&(s+=r,r=e[++t]);r&&i.test(r)||"."===r;)s+=r,r=e[++t];n.push({type:"number",value:s});continue}let o=/[a-z]/i;if(r&&o.test(r)){let s="";for(;r&&o.test(r)&&t!==e.length;)s+=r,r=e[++t];"true"==s||"false"==s||"null"===s?n.push({type:"name",value:s}):t++;continue}t++}return n},tf=e=>{if(0===e.length)return e;let t=e[e.length-1];switch(t.type){case"separator":return tf(e=e.slice(0,e.length-1));case"number":let n=t.value[t.value.length-1];if("."===n||"-"===n)return tf(e=e.slice(0,e.length-1));case"string":let r=e[e.length-2];if(r?.type==="delimiter"||r?.type==="brace"&&"{"===r.value)return tf(e=e.slice(0,e.length-1));break;case"delimiter":return tf(e=e.slice(0,e.length-1))}return e},tp=e=>{let t=[];return e.map(e=>{"brace"===e.type&&("{"===e.value?t.push("}"):t.splice(t.lastIndexOf("}"),1)),"paren"===e.type&&("["===e.value?t.push("]"):t.splice(t.lastIndexOf("]"),1))}),t.length>0&&t.reverse().map(t=>{"}"===t?e.push({type:"brace",value:"}"}):"]"===t&&e.push({type:"paren",value:"]"})}),e},tm=e=>{let t="";return e.map(e=>{"string"===e.type?t+='"'+e.value+'"':t+=e.value}),t},tg=e=>JSON.parse(tm(tp(tf(th(e)))));var ty=function(e,t,n,r,s){if("m"===r)throw TypeError("Private method is not writable");if("a"===r&&!s)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n},tb=function(e,t,n,r){if("a"===n&&!r)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};let tv="__json_buf";class t_{constructor(){T.add(this),this.messages=[],this.receivedMessages=[],z.set(this,void 0),this.controller=new AbortController,C.set(this,void 0),j.set(this,()=>{}),N.set(this,()=>{}),O.set(this,void 0),P.set(this,()=>{}),R.set(this,()=>{}),M.set(this,{}),U.set(this,!1),$.set(this,!1),L.set(this,!1),F.set(this,!1),B.set(this,void 0),D.set(this,void 0),W.set(this,e=>{if(ty(this,$,!0,"f"),e instanceof Error&&"AbortError"===e.name&&(e=new m),e instanceof m)return ty(this,L,!0,"f"),this._emit("abort",e);if(e instanceof f)return this._emit("error",e);if(e instanceof Error){let t=new f(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new f(String(e)))}),ty(this,C,new Promise((e,t)=>{ty(this,j,e,"f"),ty(this,N,t,"f")}),"f"),ty(this,O,new Promise((e,t)=>{ty(this,P,e,"f"),ty(this,R,t,"f")}),"f"),tb(this,C,"f").catch(()=>{}),tb(this,O,"f").catch(()=>{})}get response(){return tb(this,B,"f")}get request_id(){return tb(this,D,"f")}async withResponse(){let e=await tb(this,C,"f");if(!e)throw Error("Could not resolve a `Response` object");return{data:this,response:e,request_id:e.headers.get("request-id")}}static fromReadableStream(e){let t=new t_;return t._run(()=>t._fromReadableStream(e)),t}static createMessage(e,t,n){let r=new t_;for(let e of t.messages)r._addMessageParam(e);return r._run(()=>r._createMessage(e,{...t,stream:!0},{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}})),r}_run(e){e().then(()=>{this._emitFinal(),this._emit("end")},tb(this,W,"f"))}_addMessageParam(e){this.messages.push(e)}_addMessage(e,t=!0){this.receivedMessages.push(e),t&&this._emit("message",e)}async _createMessage(e,t,n){let r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),tb(this,T,"m",H).call(this);let{response:s,data:i}=await e.create({...t,stream:!0},{...n,signal:this.controller.signal}).withResponse();for await(let e of(this._connected(s),i))tb(this,T,"m",G).call(this,e);if(i.controller.signal?.aborted)throw new m;tb(this,T,"m",Z).call(this)}_connected(e){this.ended||(ty(this,B,e,"f"),ty(this,D,e?.headers.get("request-id"),"f"),tb(this,j,"f").call(this,e),this._emit("connect"))}get ended(){return tb(this,U,"f")}get errored(){return tb(this,$,"f")}get aborted(){return tb(this,L,"f")}abort(){this.controller.abort()}on(e,t){return(tb(this,M,"f")[e]||(tb(this,M,"f")[e]=[])).push({listener:t}),this}off(e,t){let n=tb(this,M,"f")[e];if(!n)return this;let r=n.findIndex(e=>e.listener===t);return r>=0&&n.splice(r,1),this}once(e,t){return(tb(this,M,"f")[e]||(tb(this,M,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,n)=>{ty(this,F,!0,"f"),"error"!==e&&this.once("error",n),this.once(e,t)})}async done(){ty(this,F,!0,"f"),await tb(this,O,"f")}get currentMessage(){return tb(this,z,"f")}async finalMessage(){return await this.done(),tb(this,T,"m",q).call(this)}async finalText(){return await this.done(),tb(this,T,"m",V).call(this)}_emit(e,...t){if(tb(this,U,"f"))return;"end"===e&&(ty(this,U,!0,"f"),tb(this,P,"f").call(this));let n=tb(this,M,"f")[e];if(n&&(tb(this,M,"f")[e]=n.filter(e=>!e.once),n.forEach(({listener:e})=>e(...t))),"abort"===e){let e=t[0];tb(this,F,"f")||n?.length||Promise.reject(e),tb(this,N,"f").call(this,e),tb(this,R,"f").call(this,e),this._emit("end");return}if("error"===e){let e=t[0];tb(this,F,"f")||n?.length||Promise.reject(e),tb(this,N,"f").call(this,e),tb(this,R,"f").call(this,e),this._emit("end")}}_emitFinal(){this.receivedMessages.at(-1)&&this._emit("finalMessage",tb(this,T,"m",q).call(this))}async _fromReadableStream(e,t){let n=t?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),tb(this,T,"m",H).call(this),this._connected(null);let r=ek.fromReadableStream(e,this.controller);for await(let e of r)tb(this,T,"m",G).call(this,e);if(r.controller.signal?.aborted)throw new m;tb(this,T,"m",Z).call(this)}[(z=new WeakMap,C=new WeakMap,j=new WeakMap,N=new WeakMap,O=new WeakMap,P=new WeakMap,R=new WeakMap,M=new WeakMap,U=new WeakMap,$=new WeakMap,L=new WeakMap,F=new WeakMap,B=new WeakMap,D=new WeakMap,W=new WeakMap,T=new WeakSet,q=function(){if(0===this.receivedMessages.length)throw new f("stream ended without producing a Message with role=assistant");return this.receivedMessages.at(-1)},V=function(){if(0===this.receivedMessages.length)throw new f("stream ended without producing a Message with role=assistant");let e=this.receivedMessages.at(-1).content.filter(e=>"text"===e.type).map(e=>e.text);if(0===e.length)throw new f("stream ended without producing a content block with type=text");return e.join(" ")},H=function(){this.ended||ty(this,z,void 0,"f")},G=function(e){if(this.ended)return;let t=tb(this,T,"m",J).call(this,e);switch(this._emit("streamEvent",e,t),e.type){case"content_block_delta":{let n=t.content.at(-1);switch(e.delta.type){case"text_delta":"text"===n.type&&this._emit("text",e.delta.text,n.text||"");break;case"citations_delta":"text"===n.type&&this._emit("citation",e.delta.citation,n.citations??[]);break;case"input_json_delta":"tool_use"===n.type&&n.input&&this._emit("inputJson",e.delta.partial_json,n.input);break;case"thinking_delta":"thinking"===n.type&&this._emit("thinking",e.delta.thinking,n.thinking);break;case"signature_delta":"thinking"===n.type&&this._emit("signature",n.signature);break;default:e.delta}break}case"message_stop":this._addMessageParam(t),this._addMessage(t,!0);break;case"content_block_stop":this._emit("contentBlock",t.content.at(-1));break;case"message_start":ty(this,z,t,"f")}},Z=function(){if(this.ended)throw new f("stream has ended, this shouldn't happen");let e=tb(this,z,"f");if(!e)throw new f("request ended without sending any chunks");return ty(this,z,void 0,"f"),e},J=function(e){let t=tb(this,z,"f");if("message_start"===e.type){if(t)throw new f(`Unexpected event order, got ${e.type} before receiving "message_stop"`);return e.message}if(!t)throw new f(`Unexpected event order, got ${e.type} before "message_start"`);switch(e.type){case"message_stop":case"content_block_stop":return t;case"message_delta":return t.stop_reason=e.delta.stop_reason,t.stop_sequence=e.delta.stop_sequence,t.usage.output_tokens=e.usage.output_tokens,t;case"content_block_start":return t.content.push(e.content_block),t;case"content_block_delta":{let n=t.content.at(e.index);switch(e.delta.type){case"text_delta":n?.type==="text"&&(n.text+=e.delta.text);break;case"citations_delta":n?.type==="text"&&(n.citations??(n.citations=[]),n.citations.push(e.delta.citation));break;case"input_json_delta":if(n?.type==="tool_use"){let t=n[tv]||"";Object.defineProperty(n,tv,{value:t+=e.delta.partial_json,enumerable:!1,writable:!0}),t&&(n.input=tg(t))}break;case"thinking_delta":n?.type==="thinking"&&(n.thinking+=e.delta.thinking);break;case"signature_delta":n?.type==="thinking"&&(n.signature=e.delta.signature);break;default:e.delta}return t}}},Symbol.asyncIterator)](){let e=[],t=[],n=!1;return this.on("streamEvent",n=>{let r=t.shift();r?r.resolve(n):e.push(n)}),this.on("end",()=>{for(let e of(n=!0,t))e.resolve(void 0);t.length=0}),this.on("abort",e=>{for(let r of(n=!0,t))r.reject(e);t.length=0}),this.on("error",e=>{for(let r of(n=!0,t))r.reject(e);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((e,n)=>t.push({resolve:e,reject:n})).then(e=>e?{value:e,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new ek(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}class tw extends to{constructor(){super(...arguments),this.batches=new tc(this._client)}create(e,t){return e.model in tx&&console.warn(`The model '${e.model}' is deprecated and will reach end-of-life on ${tx[e.model]}
Please migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.`),this._client.post("/v1/messages",{body:e,timeout:this._client._options.timeout??(e.stream?6e5:this._client._calculateNonstreamingTimeout(e.max_tokens)),...t,stream:e.stream??!1})}stream(e,t){return t_.createMessage(this,e,t)}countTokens(e,t){return this._client.post("/v1/messages/count_tokens",{body:e,...t})}}let tx={"claude-1.3":"November 6th, 2024","claude-1.3-100k":"November 6th, 2024","claude-instant-1.1":"November 6th, 2024","claude-instant-1.1-100k":"November 6th, 2024","claude-instant-1.2":"November 6th, 2024","claude-3-sonnet-20240229":"July 21st, 2025","claude-2.1":"July 21st, 2025","claude-2.0":"July 21st, 2025"};tw.Batches=tc,tw.MessageBatchesPage=td;class tk extends to{retrieve(e,t){return this._client.get(`/v1/models/${e}`,t)}list(e={},t){return eK(e)?this.list({},e):this._client.getAPIList("/v1/models",tS,{query:e,...t})}}class tS extends tl{}tk.ModelInfosPage=tS;class tA extends to{retrieve(e,t){return this._client.get(`/v1/models/${e}?beta=true`,t)}list(e={},t){return eK(e)?this.list({},e):this._client.getAPIList("/v1/models?beta=true",tI,{query:e,...t})}}class tI extends tl{}tA.BetaModelInfosPage=tI;class tE extends to{create(e,t){let{betas:n,...r}=e;return this._client.post("/v1/messages/batches?beta=true",{body:r,...t,headers:{"anthropic-beta":[...n??[],"message-batches-2024-09-24"].toString(),...t?.headers}})}retrieve(e,t={},n){if(eK(t))return this.retrieve(e,{},t);let{betas:r}=t;return this._client.get(`/v1/messages/batches/${e}?beta=true`,{...n,headers:{"anthropic-beta":[...r??[],"message-batches-2024-09-24"].toString(),...n?.headers}})}list(e={},t){if(eK(e))return this.list({},e);let{betas:n,...r}=e;return this._client.getAPIList("/v1/messages/batches?beta=true",tT,{query:r,...t,headers:{"anthropic-beta":[...n??[],"message-batches-2024-09-24"].toString(),...t?.headers}})}delete(e,t={},n){if(eK(t))return this.delete(e,{},t);let{betas:r}=t;return this._client.delete(`/v1/messages/batches/${e}?beta=true`,{...n,headers:{"anthropic-beta":[...r??[],"message-batches-2024-09-24"].toString(),...n?.headers}})}cancel(e,t={},n){if(eK(t))return this.cancel(e,{},t);let{betas:r}=t;return this._client.post(`/v1/messages/batches/${e}/cancel?beta=true`,{...n,headers:{"anthropic-beta":[...r??[],"message-batches-2024-09-24"].toString(),...n?.headers}})}async results(e,t={},n){if(eK(t))return this.results(e,{},t);let r=await this.retrieve(e);if(!r.results_url)throw new f(`No batch \`results_url\`; Has it finished processing? ${r.processing_status} - ${r.id}`);let{betas:s}=t;return this._client.get(r.results_url,{...n,headers:{"anthropic-beta":[...s??[],"message-batches-2024-09-24"].toString(),Accept:"application/binary",...n?.headers},__binaryResponse:!0})._thenUnwrap((e,t)=>tu.fromResponse(t.response,t.controller))}}class tT extends tl{}tE.BetaMessageBatchesPage=tT;var tz=function(e,t,n,r,s){if("m"===r)throw TypeError("Private method is not writable");if("a"===r&&!s)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n},tC=function(e,t,n,r){if("a"===n&&!r)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};let tj="__json_buf";class tN{constructor(){K.add(this),this.messages=[],this.receivedMessages=[],X.set(this,void 0),this.controller=new AbortController,Y.set(this,void 0),Q.set(this,()=>{}),ee.set(this,()=>{}),et.set(this,void 0),en.set(this,()=>{}),er.set(this,()=>{}),es.set(this,{}),ei.set(this,!1),eo.set(this,!1),ea.set(this,!1),el.set(this,!1),eu.set(this,void 0),ec.set(this,void 0),ef.set(this,e=>{if(tz(this,eo,!0,"f"),e instanceof Error&&"AbortError"===e.name&&(e=new m),e instanceof m)return tz(this,ea,!0,"f"),this._emit("abort",e);if(e instanceof f)return this._emit("error",e);if(e instanceof Error){let t=new f(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new f(String(e)))}),tz(this,Y,new Promise((e,t)=>{tz(this,Q,e,"f"),tz(this,ee,t,"f")}),"f"),tz(this,et,new Promise((e,t)=>{tz(this,en,e,"f"),tz(this,er,t,"f")}),"f"),tC(this,Y,"f").catch(()=>{}),tC(this,et,"f").catch(()=>{})}get response(){return tC(this,eu,"f")}get request_id(){return tC(this,ec,"f")}async withResponse(){let e=await tC(this,Y,"f");if(!e)throw Error("Could not resolve a `Response` object");return{data:this,response:e,request_id:e.headers.get("request-id")}}static fromReadableStream(e){let t=new tN;return t._run(()=>t._fromReadableStream(e)),t}static createMessage(e,t,n){let r=new tN;for(let e of t.messages)r._addMessageParam(e);return r._run(()=>r._createMessage(e,{...t,stream:!0},{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}})),r}_run(e){e().then(()=>{this._emitFinal(),this._emit("end")},tC(this,ef,"f"))}_addMessageParam(e){this.messages.push(e)}_addMessage(e,t=!0){this.receivedMessages.push(e),t&&this._emit("message",e)}async _createMessage(e,t,n){let r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),tC(this,K,"m",ep).call(this);let{response:s,data:i}=await e.create({...t,stream:!0},{...n,signal:this.controller.signal}).withResponse();for await(let e of(this._connected(s),i))tC(this,K,"m",em).call(this,e);if(i.controller.signal?.aborted)throw new m;tC(this,K,"m",eg).call(this)}_connected(e){this.ended||(tz(this,eu,e,"f"),tz(this,ec,e?.headers.get("request-id"),"f"),tC(this,Q,"f").call(this,e),this._emit("connect"))}get ended(){return tC(this,ei,"f")}get errored(){return tC(this,eo,"f")}get aborted(){return tC(this,ea,"f")}abort(){this.controller.abort()}on(e,t){return(tC(this,es,"f")[e]||(tC(this,es,"f")[e]=[])).push({listener:t}),this}off(e,t){let n=tC(this,es,"f")[e];if(!n)return this;let r=n.findIndex(e=>e.listener===t);return r>=0&&n.splice(r,1),this}once(e,t){return(tC(this,es,"f")[e]||(tC(this,es,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,n)=>{tz(this,el,!0,"f"),"error"!==e&&this.once("error",n),this.once(e,t)})}async done(){tz(this,el,!0,"f"),await tC(this,et,"f")}get currentMessage(){return tC(this,X,"f")}async finalMessage(){return await this.done(),tC(this,K,"m",ed).call(this)}async finalText(){return await this.done(),tC(this,K,"m",eh).call(this)}_emit(e,...t){if(tC(this,ei,"f"))return;"end"===e&&(tz(this,ei,!0,"f"),tC(this,en,"f").call(this));let n=tC(this,es,"f")[e];if(n&&(tC(this,es,"f")[e]=n.filter(e=>!e.once),n.forEach(({listener:e})=>e(...t))),"abort"===e){let e=t[0];tC(this,el,"f")||n?.length||Promise.reject(e),tC(this,ee,"f").call(this,e),tC(this,er,"f").call(this,e),this._emit("end");return}if("error"===e){let e=t[0];tC(this,el,"f")||n?.length||Promise.reject(e),tC(this,ee,"f").call(this,e),tC(this,er,"f").call(this,e),this._emit("end")}}_emitFinal(){this.receivedMessages.at(-1)&&this._emit("finalMessage",tC(this,K,"m",ed).call(this))}async _fromReadableStream(e,t){let n=t?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),tC(this,K,"m",ep).call(this),this._connected(null);let r=ek.fromReadableStream(e,this.controller);for await(let e of r)tC(this,K,"m",em).call(this,e);if(r.controller.signal?.aborted)throw new m;tC(this,K,"m",eg).call(this)}[(X=new WeakMap,Y=new WeakMap,Q=new WeakMap,ee=new WeakMap,et=new WeakMap,en=new WeakMap,er=new WeakMap,es=new WeakMap,ei=new WeakMap,eo=new WeakMap,ea=new WeakMap,el=new WeakMap,eu=new WeakMap,ec=new WeakMap,ef=new WeakMap,K=new WeakSet,ed=function(){if(0===this.receivedMessages.length)throw new f("stream ended without producing a Message with role=assistant");return this.receivedMessages.at(-1)},eh=function(){if(0===this.receivedMessages.length)throw new f("stream ended without producing a Message with role=assistant");let e=this.receivedMessages.at(-1).content.filter(e=>"text"===e.type).map(e=>e.text);if(0===e.length)throw new f("stream ended without producing a content block with type=text");return e.join(" ")},ep=function(){this.ended||tz(this,X,void 0,"f")},em=function(e){if(this.ended)return;let t=tC(this,K,"m",ey).call(this,e);switch(this._emit("streamEvent",e,t),e.type){case"content_block_delta":{let n=t.content.at(-1);switch(e.delta.type){case"text_delta":"text"===n.type&&this._emit("text",e.delta.text,n.text||"");break;case"citations_delta":"text"===n.type&&this._emit("citation",e.delta.citation,n.citations??[]);break;case"input_json_delta":"tool_use"===n.type&&n.input&&this._emit("inputJson",e.delta.partial_json,n.input);break;case"thinking_delta":"thinking"===n.type&&this._emit("thinking",e.delta.thinking,n.thinking);break;case"signature_delta":"thinking"===n.type&&this._emit("signature",n.signature);break;default:e.delta}break}case"message_stop":this._addMessageParam(t),this._addMessage(t,!0);break;case"content_block_stop":this._emit("contentBlock",t.content.at(-1));break;case"message_start":tz(this,X,t,"f")}},eg=function(){if(this.ended)throw new f("stream has ended, this shouldn't happen");let e=tC(this,X,"f");if(!e)throw new f("request ended without sending any chunks");return tz(this,X,void 0,"f"),e},ey=function(e){let t=tC(this,X,"f");if("message_start"===e.type){if(t)throw new f(`Unexpected event order, got ${e.type} before receiving "message_stop"`);return e.message}if(!t)throw new f(`Unexpected event order, got ${e.type} before "message_start"`);switch(e.type){case"message_stop":case"content_block_stop":return t;case"message_delta":return t.stop_reason=e.delta.stop_reason,t.stop_sequence=e.delta.stop_sequence,t.usage.output_tokens=e.usage.output_tokens,t;case"content_block_start":return t.content.push(e.content_block),t;case"content_block_delta":{let n=t.content.at(e.index);switch(e.delta.type){case"text_delta":n?.type==="text"&&(n.text+=e.delta.text);break;case"citations_delta":n?.type==="text"&&(n.citations??(n.citations=[]),n.citations.push(e.delta.citation));break;case"input_json_delta":if(n?.type==="tool_use"){let t=n[tj]||"";Object.defineProperty(n,tj,{value:t+=e.delta.partial_json,enumerable:!1,writable:!0}),t&&(n.input=tg(t))}break;case"thinking_delta":n?.type==="thinking"&&(n.thinking+=e.delta.thinking);break;case"signature_delta":n?.type==="thinking"&&(n.signature=e.delta.signature);break;default:e.delta}return t}}},Symbol.asyncIterator)](){let e=[],t=[],n=!1;return this.on("streamEvent",n=>{let r=t.shift();r?r.resolve(n):e.push(n)}),this.on("end",()=>{for(let e of(n=!0,t))e.resolve(void 0);t.length=0}),this.on("abort",e=>{for(let r of(n=!0,t))r.reject(e);t.length=0}),this.on("error",e=>{for(let r of(n=!0,t))r.reject(e);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((e,n)=>t.push({resolve:e,reject:n})).then(e=>e?{value:e,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new ek(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}let tO={"claude-1.3":"November 6th, 2024","claude-1.3-100k":"November 6th, 2024","claude-instant-1.1":"November 6th, 2024","claude-instant-1.1-100k":"November 6th, 2024","claude-instant-1.2":"November 6th, 2024","claude-3-sonnet-20240229":"July 21st, 2025","claude-2.1":"July 21st, 2025","claude-2.0":"July 21st, 2025"};class tP extends to{constructor(){super(...arguments),this.batches=new tE(this._client)}create(e,t){let{betas:n,...r}=e;return r.model in tO&&console.warn(`The model '${r.model}' is deprecated and will reach end-of-life on ${tO[r.model]}
Please migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.`),this._client.post("/v1/messages?beta=true",{body:r,timeout:this._client._options.timeout??(r.stream?6e5:this._client._calculateNonstreamingTimeout(r.max_tokens)),...t,headers:{...n?.toString()!=null?{"anthropic-beta":n?.toString()}:void 0,...t?.headers},stream:e.stream??!1})}stream(e,t){return tN.createMessage(this,e,t)}countTokens(e,t){let{betas:n,...r}=e;return this._client.post("/v1/messages/count_tokens?beta=true",{body:r,...t,headers:{"anthropic-beta":[...n??[],"token-counting-2024-11-01"].toString(),...t?.headers}})}}tP.Batches=tE,tP.BetaMessageBatchesPage=tT;class tR extends to{constructor(){super(...arguments),this.models=new tA(this._client),this.messages=new tP(this._client)}}tR.Models=tA,tR.BetaModelInfosPage=tI,tR.Messages=tP;class tM extends eW{constructor({baseURL:e=e8("ANTHROPIC_BASE_URL"),apiKey:t=e8("ANTHROPIC_API_KEY")??null,authToken:n=e8("ANTHROPIC_AUTH_TOKEN")??null,...r}={}){let s={apiKey:t,authToken:n,...r,baseURL:e||"https://api.anthropic.com"};if(!s.dangerouslyAllowBrowser&&tr())throw new f("It looks like you're running in a browser-like environment.\n\nThis is disabled by default, as it risks exposing your secret API credentials to attackers.\nIf you understand the risks and have appropriate mitigations in place,\nyou can set the `dangerouslyAllowBrowser` option to `true`, e.g.,\n\nnew Anthropic({ apiKey, dangerouslyAllowBrowser: true });\n");super({baseURL:s.baseURL,timeout:s.timeout??6e5,httpAgent:s.httpAgent,maxRetries:s.maxRetries,fetch:s.fetch}),this.completions=new ta(this),this.messages=new tw(this),this.models=new tk(this),this.beta=new tR(this),this._options=s,this.apiKey=t,this.authToken=n}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),...this._options.dangerouslyAllowBrowser?{"anthropic-dangerous-direct-browser-access":"true"}:void 0,"anthropic-version":"2023-06-01",...this._options.defaultHeaders}}validateHeaders(e,t){if((!this.apiKey||!e["x-api-key"])&&null!==t["x-api-key"]&&(!this.authToken||!e.authorization)&&null!==t.authorization)throw Error('Could not resolve authentication method. Expected either apiKey or authToken to be set. Or for one of the "X-Api-Key" or "Authorization" headers to be explicitly omitted')}authHeaders(e){let t=this.apiKeyAuth(e),n=this.bearerAuth(e);return null==t||e9(t)?null==n||e9(n)?{}:n:t}apiKeyAuth(e){return null==this.apiKey?{}:{"X-Api-Key":this.apiKey}}bearerAuth(e){return null==this.authToken?{}:{Authorization:`Bearer ${this.authToken}`}}}tM.Anthropic=tM,tM.HUMAN_PROMPT="\n\nHuman:",tM.AI_PROMPT="\n\nAssistant:",tM.DEFAULT_TIMEOUT=6e5,tM.AnthropicError=f,tM.APIError=p,tM.APIConnectionError=g,tM.APIConnectionTimeoutError=y,tM.APIUserAbortError=m,tM.NotFoundError=w,tM.ConflictError=x,tM.RateLimitError=S,tM.BadRequestError=b,tM.AuthenticationError=v,tM.InternalServerError=A,tM.PermissionDeniedError=_,tM.UnprocessableEntityError=k,tM.toFile=eN,tM.fileFromPath=u,tM.Completions=ta,tM.Messages=tw,tM.Models=tk,tM.ModelInfosPage=tS,tM.Beta=tR;let{HUMAN_PROMPT:tU,AI_PROMPT:t$}=tM},7678:function(e,t,n){"use strict";let r,s,i,o,a,l,u,c,d,h,f,p,m,g,y,b,v,_,w,x,k,S,A,I,E,T;var z,C,j,N,O="vercel.ai.error",P=Symbol.for(O),R=class e extends Error{constructor({name:e,message:t,cause:n}){super(t),this[J]=!0,this.name=e,this.cause=n}static isInstance(t){return e.hasMarker(t,O)}static hasMarker(e,t){let n=Symbol.for(t);return null!=e&&"object"==typeof e&&n in e&&"boolean"==typeof e[n]&&!0===e[n]}toJSON(){return{name:this.name,message:this.message}}};J=P;var M=R,U=(Symbol.for("vercel.ai.error.AI_APICallError"),Symbol.for("vercel.ai.error.AI_EmptyResponseBodyError"),Symbol.for("vercel.ai.error.AI_InvalidPromptError"),Symbol.for("vercel.ai.error.AI_InvalidResponseDataError"),Symbol.for("vercel.ai.error.AI_JSONParseError"),Symbol.for("vercel.ai.error.AI_LoadAPIKeyError"),"AI_LoadSettingError"),$=`vercel.ai.error.${U}`;K=Symbol.for($),Symbol.for("vercel.ai.error.AI_NoContentGeneratedError"),Symbol.for("vercel.ai.error.AI_TooManyEmbeddingValuesForCallError"),Symbol.for("vercel.ai.error.AI_TypeValidationError");var L="AI_UnsupportedFunctionalityError",F=`vercel.ai.error.${L}`;X=Symbol.for(F);var B=n(2259),D="undefined"!=typeof self?self:{};function q(e){e:{for(var t=["CLOSURE_FLAGS"],n=D,r=0;r<t.length;r++)if(null==(n=n[t[r]])){t=null;break e}t=n}return null!=(e=t&&t[e])&&e}function V(){throw Error("Invalid UTF8")}function W(e,t){return t=String.fromCharCode.apply(null,t),null==e?t:e+t}let H="undefined"!=typeof TextDecoder,G="undefined"!=typeof TextEncoder;function Z(e){if(G)e=(i||=new TextEncoder).encode(e);else{let n=0,r=new Uint8Array(3*e.length);for(let s=0;s<e.length;s++){var t=e.charCodeAt(s);if(128>t)r[n++]=t;else{if(2048>t)r[n++]=t>>6|192;else{if(55296<=t&&57343>=t){if(56319>=t&&s<e.length){let i=e.charCodeAt(++s);if(56320<=i&&57343>=i){t=1024*(t-55296)+i-56320+65536,r[n++]=t>>18|240,r[n++]=t>>12&63|128,r[n++]=t>>6&63|128,r[n++]=63&t|128;continue}s--}t=65533}r[n++]=t>>12|224,r[n++]=t>>6&63|128}r[n++]=63&t|128}}e=n===r.length?r:r.subarray(0,n)}return e}var J,K,X,Y,Q=q(610401301),ee=q(188588736);let et=D.navigator;function en(e){return!!Q&&!!Y&&Y.brands.some(({brand:t})=>t&&-1!=t.indexOf(e))}function er(e){var t;return(t=D.navigator)&&(t=t.userAgent)||(t=""),-1!=t.indexOf(e)}function es(){return!!Q&&!!Y&&0<Y.brands.length}function ei(){return es()?en("Chromium"):(er("Chrome")||er("CriOS"))&&!(!es()&&er("Edge"))||er("Silk")}Y=et&&et.userAgentData||null;var eo=!es()&&(er("Trident")||er("MSIE"));er("Android")&&ei(),ei(),er("Safari")&&(ei()||!es()&&er("Coast")||!es()&&er("Opera")||!es()&&er("Edge")||(es()?en("Microsoft Edge"):er("Edg/"))||es()&&en("Opera"));var ea={},el=null;function eu(){if(!el){el={};for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),t=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++){var r=e.concat(t[n].split(""));ea[n]=r;for(var s=0;s<r.length;s++){var i=r[s];void 0===el[i]&&(el[i]=s)}}}}var ec="undefined"!=typeof Uint8Array,ed=!eo&&"function"==typeof btoa;function eh(e){if(!ed){void 0===t&&(t=0),eu(),t=ea[t];var t,n=Array(Math.floor(e.length/3)),r=t[64]||"";let l=0,u=0;for(;l<e.length-2;l+=3){var s=e[l],i=e[l+1],o=e[l+2],a=t[s>>2];s=t[(3&s)<<4|i>>4],i=t[(15&i)<<2|o>>6],o=t[63&o],n[u++]=a+s+i+o}switch(a=0,o=r,e.length-l){case 2:o=t[(15&(a=e[l+1]))<<2]||r;case 1:e=e[l],n[u]=t[e>>2]+t[(3&e)<<4|a>>4]+o+r}return n.join("")}for(t="",n=0,r=e.length-10240;n<r;)t+=String.fromCharCode.apply(null,e.subarray(n,n+=10240));return btoa(t+=String.fromCharCode.apply(null,n?e.subarray(n):e))}let ef=/[-_.]/g,ep={"-":"+",_:"/",".":"="};function em(e){return ep[e]||""}function eg(e){if(!ed){var t,n,r,s,i;return(r=3*(n=(t=e).length)/4)%3?r=Math.floor(r):-1!="=.".indexOf(t[n-1])&&(r=-1!="=.".indexOf(t[n-2])?r-2:r-1),s=new Uint8Array(r),i=0,function(e,t){function n(t){for(;r<e.length;){var n=e.charAt(r++),s=el[n];if(null!=s)return s;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return t}eu();for(var r=0;;){var s=n(-1),i=n(0),o=n(64),a=n(64);if(64===a&&-1===s)break;t(s<<2|i>>4),64!=o&&(t(i<<4&240|o>>2),64!=a&&t(o<<6&192|a))}}(t,function(e){s[i++]=e}),i!==r?s.subarray(0,i):s}ef.test(e)&&(e=e.replace(ef,em));let o=new Uint8Array((e=atob(e)).length);for(let t=0;t<e.length;t++)o[t]=e.charCodeAt(t);return o}function ey(e){return ec&&null!=e&&e instanceof Uint8Array}function eb(){return o||=new Uint8Array(0)}var ev={};function e_(e){if(e!==ev)throw Error("illegal external caller")}function ew(){return a||=new ek(null,ev)}function ex(e){e_(ev);var t=e.g;return null==(t=null==t||ey(t)?t:"string"==typeof t?eg(t):null)?t:e.g=t}var ek=class{constructor(e,t){if(e_(t),this.g=e,null!=e&&0===e.length)throw Error("ByteString should be constructed with non-empty values")}i(){let e=ex(this);return e?new Uint8Array(e):eb()}};function eS(e,t){return Error(`Invalid wire type: ${e} (at position ${t})`)}function eA(){return Error("Failed to read varint, encoding is invalid.")}function eI(e,t){return Error(`Tried to read past the end of the data ${t} > ${e}`)}function eE(e){if("string"==typeof e)return{buffer:eg(e),A:!1};if(Array.isArray(e))return{buffer:new Uint8Array(e),A:!1};if(e.constructor===Uint8Array)return{buffer:e,A:!1};if(e.constructor===ArrayBuffer)return{buffer:new Uint8Array(e),A:!1};if(e.constructor===ek)return{buffer:ex(e)||eb(),A:!0};if(e instanceof Uint8Array)return{buffer:new Uint8Array(e.buffer,e.byteOffset,e.byteLength),A:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}function eT(){return"function"==typeof BigInt}let ez="function"==typeof Uint8Array.prototype.slice,eC,ej=0,eN=0;function eO(e){let t=0>e,n=(e=Math.abs(e))>>>0;if(e=Math.floor((e-n)/4294967296),t){let[t,r]=eF(n,e);e=r,n=t}ej=n>>>0,eN=e>>>0}function eP(e){let t=eC||=new DataView(new ArrayBuffer(8));t.setFloat32(0,+e,!0),eN=0,ej=t.getUint32(0,!0)}function eR(e,t){return 4294967296*t+(e>>>0)}function eM(e,t){let n=2147483648&t;return n&&(t=~t>>>0,0==(e=1+~e>>>0)&&(t=t+1>>>0)),e=eR(e,t),n?-e:e}function eU(e,t){if(e>>>=0,2097151>=(t>>>=0))var n=""+(4294967296*t+e);else eT()?n=""+(BigInt(t)<<BigInt(32)|BigInt(e)):(e=(16777215&e)+6777216*(n=16777215&(e>>>24|t<<8))+6710656*(t=t>>16&65535),n+=8147497*t,t*=2,1e7<=e&&(n+=Math.floor(e/1e7),e%=1e7),1e7<=n&&(t+=Math.floor(n/1e7),n%=1e7),n=t+e$(n)+e$(e));return n}function e$(e){return e=String(e),"0000000".slice(e.length)+e}function eL(e){if(16>e.length)eO(Number(e));else if(eT())ej=Number((e=BigInt(e))&BigInt(4294967295))>>>0,eN=Number(e>>BigInt(32)&BigInt(4294967295));else{let t=+("-"===e[0]);eN=ej=0;let n=e.length;for(let r=t,s=(n-t)%6+t;s<=n;r=s,s+=6){let t=Number(e.slice(r,s));eN*=1e6,4294967296<=(ej=1e6*ej+t)&&(eN+=Math.trunc(ej/4294967296),eN>>>=0,ej>>>=0)}if(t){let[e,t]=eF(ej,eN);ej=e,eN=t}}}function eF(e,t){return t=~t,e?e=1+~e:t+=1,[e,t]}function eB(e,t){let n,r=0,s=0,i=0,o=e.i,a=e.g;do r|=(127&(n=o[a++]))<<i,i+=7;while(32>i&&128&n);for(32<i&&(s|=(127&n)>>4),i=3;32>i&&128&n;i+=7)s|=(127&(n=o[a++]))<<i;if(eG(e,a),128>n)return t(r>>>0,s>>>0);throw eA()}function eD(e){let t=0,n=e.g,r=n+10,s=e.i;for(;n<r;){let r=s[n++];if(t|=r,0==(128&r))return eG(e,n),!!(127&t)}throw eA()}function eq(e){let t=e.i,n=e.g,r=t[n++],s=127&r;if(128&r&&(s|=(127&(r=t[n++]))<<7,128&r&&(s|=(127&(r=t[n++]))<<14,128&r&&(s|=(127&(r=t[n++]))<<21,128&r&&(s|=(r=t[n++])<<28,128&r&&128&t[n++]&&128&t[n++]&&128&t[n++]&&128&t[n++]&&128&t[n++])))))throw eA();return eG(e,n),s}function eV(e){var t=e.i;let n=e.g;var r=t[n],s=t[n+1];let i=t[n+2];return t=t[n+3],eG(e,e.g+4),e=2*((s=(r<<0|s<<8|i<<16|t<<24)>>>0)>>31)+1,r=s>>>23&255,s&=8388607,255==r?s?NaN:1/0*e:0==r?1401298464324817e-60*e*s:e*Math.pow(2,r-150)*(s+8388608)}function eW(e){return eq(e)}function eH(e,t,{D:n=!1}={}){e.D=n,t&&(t=eE(t),e.i=t.buffer,e.m=t.A,e.s=0,e.j=e.i.length,e.g=e.s)}function eG(e,t){if(e.g=t,t>e.j)throw eI(e.j,t)}function eZ(e,t){if(0>t)throw Error(`Tried to read a negative byte length: ${t}`);let n=e.g,r=n+t;if(r>e.j)throw eI(t,e.j-n);return e.g=r,n}function eJ(e,t){if(0==t)return ew();var n=eZ(e,t);return e.D&&e.m?n=e.i.subarray(n,n+t):(e=e.i,n=n===(t=n+t)?eb():ez?e.slice(n,t):new Uint8Array(e.subarray(n,t))),0==n.length?ew():new ek(n,ev)}var eK=[];function eX(e){var t=e.g;if(t.g==t.j)return!1;e.j=e.g.g;var n=eq(e.g)>>>0;if(t=n>>>3,!(0<=(n&=7)&&5>=n))throw eS(n,e.j);if(1>t)throw Error(`Invalid field number: ${t} (at position ${e.j})`);return e.m=t,e.i=n,!0}function eY(e,t,n){let r=e.g.j,s=eq(e.g)>>>0,i=e.g.g+s,o=i-r;if(0>=o&&(e.g.j=i,n(t,e,void 0,void 0,void 0),o=i-e.g.g),o)throw Error(`Message parsing ended unexpectedly. Expected to read ${s} bytes, instead read ${s-o} bytes, either the data ended unexpectedly or the message misreported its own length`);e.g.g=i,e.g.j=r}function eQ(e){var t=eq(e.g)>>>0,n=eZ(e=e.g,t);if(e=e.i,H){var i,o=e;(i=s)||(i=s=new TextDecoder("utf-8",{fatal:!0})),t=n+t,o=0===n&&t===o.length?o:o.subarray(n,t);try{var a=i.decode(o)}catch(e){if(void 0===r){try{i.decode(new Uint8Array([128]))}catch(e){}try{i.decode(new Uint8Array([97])),r=!0}catch(e){r=!1}}throw r||(s=void 0),e}}else{t=(a=n)+t,n=[];let r,s=null;for(;a<t;){var l=e[a++];128>l?n.push(l):224>l?a>=t?V():(r=e[a++],194>l||128!=(192&r)?(a--,V()):n.push((31&l)<<6|63&r)):240>l?a>=t-1?V():128!=(192&(r=e[a++]))||224===l&&160>r||237===l&&160<=r||128!=(192&(i=e[a++]))?(a--,V()):n.push((15&l)<<12|(63&r)<<6|63&i):244>=l?a>=t-2?V():128!=(192&(r=e[a++]))||0!=r-144+(l<<28)>>30||128!=(192&(i=e[a++]))||128!=(192&(o=e[a++]))?(a--,V()):(l=((7&l)<<18|(63&r)<<12|(63&i)<<6|63&o)-65536,n.push(55296+(l>>10&1023),56320+(1023&l))):V(),8192<=n.length&&(s=W(s,n),n.length=0)}a=W(s,n)}return a}function e0(e){let t=eq(e.g)>>>0;return eJ(e.g,t)}function e1(e,t,n){var r=eq(e.g)>>>0;for(r=e.g.g+r;e.g.g<r;)n.push(t(e.g))}var e2=[];function e6(e){return e?/^\d+$/.test(e)?(eL(e),new e3(ej,eN)):null:l||=new e3(0,0)}var e3=class{constructor(e,t){this.i=e>>>0,this.g=t>>>0}};function e4(e){return e?/^-?\d+$/.test(e)?(eL(e),new e5(ej,eN)):null:u||=new e5(0,0)}var e5=class{constructor(e,t){this.i=e>>>0,this.g=t>>>0}};function e8(e,t,n){for(;0<n||127<t;)e.g.push(127&t|128),t=(t>>>7|n<<25)>>>0,n>>>=7;e.g.push(t)}function e9(e,t){for(;127<t;)e.g.push(127&t|128),t>>>=7;e.g.push(t)}function e7(e,t){if(0<=t)e9(e,t);else{for(let n=0;9>n;n++)e.g.push(127&t|128),t>>=7;e.g.push(1)}}function te(e){var t=ej;e.g.push(t>>>0&255),e.g.push(t>>>8&255),e.g.push(t>>>16&255),e.g.push(t>>>24&255)}function tt(e,t){0!==t.length&&(e.j.push(t),e.i+=t.length)}function tn(e,t,n){e9(e.g,8*t+n)}function tr(e,t){return tn(e,t,2),t=e.g.end(),tt(e,t),t.push(e.i),t}function ts(e,t){var n=t.pop();for(n=e.i+e.g.length()-n;127<n;)t.push(127&n|128),n>>>=7,e.i++;t.push(n),e.i++}function ti(e,t,n){tn(e,t,2),e9(e.g,n.length),tt(e,e.g.end()),tt(e,n)}class to{constructor(e,t,n,r){this.g=e,this.i=t,this.j=n,this.H=r}}function ta(e){return Array.prototype.slice.call(e)}function tl(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol()?Symbol():e}var tu=tl(),tc=tl("2ex"),td=tl("0dg"),th=tu?(e,t)=>{e[tu]|=t}:(e,t)=>{void 0!==e.g?e.g|=t:Object.defineProperties(e,{g:{value:t,configurable:!0,writable:!0,enumerable:!1}})},tf=tu?(e,t)=>{e[tu]&=~t}:(e,t)=>{void 0!==e.g&&(e.g&=~t)};function tp(e,t,n){return n?e|t:e&~t}var tm=tu?e=>0|e[tu]:e=>0|e.g,tg=tu?e=>e[tu]:e=>e.g,ty=tu?(e,t)=>(e[tu]=t,e):(e,t)=>(void 0!==e.g?e.g=t:Object.defineProperties(e,{g:{value:t,configurable:!0,writable:!0,enumerable:!1}}),e);function tb(e,t){ty(t,-14591&(0|e))}function tv(e,t){ty(t,-14557&(34|e))}function t_(e){return 0==(e=e>>14&1023)?536870912:e}var tw,tx={},tk={};function tS(e){return!(!e||"object"!=typeof e||e.g!==tk)}function tA(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)&&e.constructor===Object}function tI(e,t,n){if(null!=e){if("string"==typeof e)e=e?new ek(e,ev):ew();else if(e.constructor!==ek){if(ey(e))e=e.length?new ek(n?e:new Uint8Array(e),ev):ew();else{if(!t)throw Error();e=void 0}}}return e}function tE(e,t,n){if(!Array.isArray(e)||e.length)return!1;let r=tm(e);return!!(1&r)||!(!t||!(Array.isArray(t)?t.includes(n):t.has(n)))&&(ty(e,1|r),!0)}let tT=[];function tz(e){if(2&e)throw Error()}function tC(e,t){(t=c?t[c]:void 0)&&(e[c]=ta(t))}function tj(e,t){e.__closure__error__context__984382||(e.__closure__error__context__984382={}),e.__closure__error__context__984382.severity=t}function tN(){let e=Error();tj(e,"incident"),D.setTimeout(()=>{throw e},0)}function tO(e){return null==e||"number"==typeof e?e:"NaN"===e||"Infinity"===e||"-Infinity"===e?Number(e):void 0}function tP(e){if(null!=e&&"boolean"!=typeof e){var t=typeof e;throw Error(`Expected boolean but got ${"object"!=t?t:e?Array.isArray(e)?"array":t:"null"}: ${e}`)}return e}ty(tT,55),tw=Object.freeze(tT),Object.freeze(new class{}),Object.freeze(new class{});let tR=/^-?([1-9][0-9]*|0)(\.[0-9]+)?$/;function tM(e){let t=typeof e;return"number"===t?Number.isFinite(e):"string"===t&&tR.test(e)}function tU(e){if(null==e)return e;if("string"==typeof e){if(!e)return;e=+e}return"number"==typeof e&&Number.isFinite(e)?0|e:void 0}function t$(e){return"-"!==e[0]&&(20>e.length||20===e.length&&184467>Number(e.substring(0,6)))}function tL(e){return Number.isSafeInteger(e=Math.trunc(e))||(eO(e),e=eM(ej,eN)),e}function tF(e){var t=Math.trunc(Number(e));if(Number.isSafeInteger(t))return String(t);if(-1!==(t=e.indexOf("."))&&(e=e.substring(0,t)),!("-"===e[0]?20>e.length||20===e.length&&-922337<Number(e.substring(0,7)):19>e.length||19===e.length&&922337>Number(e.substring(0,6)))){if(eL(e),e=ej,2147483648&(t=eN)){if(eT())e=""+(BigInt(0|t)<<BigInt(32)|BigInt(e>>>0));else{let[n,r]=eF(e,t);e="-"+eU(n,r)}}else e=eU(e,t)}return e}function tB(e){if("string"!=typeof e)throw Error();return e}function tD(e){if(null!=e&&"string"!=typeof e)throw Error();return e}function tq(e){return null==e||"string"==typeof e?e:void 0}function tV(e,t,n){if(null!=e&&"object"==typeof e&&e.C===tx)return e;if(Array.isArray(e)){var r=tm(e),s=r;return 0===s&&(s|=32&n),(s|=2&n)!==r&&ty(e,s),new t(e)}}function tW(e){switch(typeof e){case"boolean":return p||=[0,void 0,!0];case"number":return 0<e?void 0:0===e?m||=[0,void 0]:[-e,void 0];case"string":return[0,e];case"object":return e}}function tH(e,t,n){if(null==e&&(e=f),f=void 0,null==e){var r=96;n?(e=[n],r|=512):e=[],t&&(r=-16760833&r|(1023&t)<<14)}else{if(!Array.isArray(e))throw Error("narr");if(2048&(r=tm(e)))throw Error("farr");if(64&r)return e;if(r|=64,n&&(r|=512,n!==e[0]))throw Error("mid");e:{let s=(n=e).length;if(s){let e=s-1;if(tA(n[e])){if(1024<=(t=e-(+!!(512&(r|=256))-1)))throw Error("pvtlmt");r=-16760833&r|(1023&t)<<14;break e}}if(t){if(1024<(t=Math.max(t,s-(+!!(512&r)-1))))throw Error("spvt");r=-16760833&r|(1023&t)<<14}}}return ty(e,r),e}function tG(e,t,n,r,s){let i=r||n?tm(e):0;r=r?!!(32&i):void 0;let o=ta(e);for(let e=0;e<o.length;e++)o[e]=function e(t,n,r,s,i){if(null!=t){if(Array.isArray(t))t=tE(t,void 0,0)?void 0:i&&2&tm(t)?t:tG(t,n,r,void 0!==s,i);else if(tA(t)){let o={};for(let a in t)o[a]=e(t[a],n,r,s,i);t=o}else t=n(t,s);return t}}(o[e],t,n,r,s);return n&&(tC(o,e),n(i,o)),o}function tZ(e){return e.C===tx?e.toJSON():function(e){switch(typeof e){case"number":return isFinite(e)?e:String(e);case"boolean":return e?1:0;case"object":if(e){if(Array.isArray(e)){if(tE(e,void 0,0))return}else{if(ey(e))return eh(e);if(e instanceof ek){let t=e.g;return null==t?"":"string"==typeof t?t:e.g=eh(t)}}}}return e}(e)}function tJ(e){let t=e.l;return tK(e,t,tg(t),!1)}function tK(e,t,n,r){return e=e.constructor,f=t=tX(t,n,r),t=new e(t),f=void 0,t}function tX(e,t,n){let r=n||2&t?tv:tb,s=!!(32&t);return th(e=function(e,t,n){let r=ta(e);var s=r.length;let i=256&t?r[s-1]:void 0;for(s+=i?-1:0,t=512&t?1:0;t<s;t++)r[t]=n(r[t]);if(i)for(let e in t=r[t]={},i)t[e]=n(i[e]);return tC(r,e),r}(e,t,e=>(function e(t,n,r=tv){if(null!=t){if(ec&&t instanceof Uint8Array)return n?t:new Uint8Array(t);if(Array.isArray(t)){var s=tm(t);return 2&s||(n&&=0===s||!!(32&s)&&!(64&s||!(16&s)),t=n?ty(t,-12293&(34|s)):tG(t,e,4&s?tv:r,!0,!0)),t}return t.C===tx&&(t=2&(s=tg(r=t.l))?t:tK(t,r,s,!0)),t}})(e,s,r)),32|(n?2:0)),e}function tY(e){let t=e.l,n=tg(t);return 2&n?tK(e,t,n,!1):e}function tQ(e,t,n,r){return!(4&t)||null!=n&&(!r&&0===n&&(4096&t||8192&t)&&5>(e.constructor[td]=1+(0|e.constructor[td]))&&tN(),0!==n&&!(n&t))}function t0(e,t){return t2(e=e.l,tg(e),t)}function t1(e,t,n,r){if(!(0>(t=r+(+!!(512&t)-1))||t>=e.length||t>=n))return e[t]}function t2(e,t,n,r){if(-1===n)return null;let s=t_(t);if(!(n>=s)){var i=e.length;return r&&256&t&&null!=(r=e[i-1][n])?(t1(e,t,s,n)&&null!=tc&&(4<=(t=(e=h??={})[tc]||0)||(e[tc]=t+1,tN())),r):t1(e,t,s,n)}return 256&t?e[e.length-1][n]:void 0}function t6(e,t,n,r){let s=e.l,i=tg(s);return tz(i),t3(s,i,t,n,r),e}function t3(e,t,n,r,s){let i=t_(t);if(n>=i||s){let o=t;if(256&t)s=e[e.length-1];else{if(null==r)return o;s=e[i+(+!!(512&t)-1)]={},o|=256}return s[n]=r,n<i&&(e[n+(+!!(512&t)-1)]=void 0),o!==t&&ty(e,o),o}return e[n+(+!!(512&t)-1)]=r,256&t&&n in(e=e[e.length-1])&&delete e[n],t}function t4(e,t,n,r,s){var i=2&t;let o=t2(e,t,n,s);Array.isArray(o)||(o=tw);let a=!(2&r);r=!(1&r);let l=!!(32&t),u=tm(o);return 0!==u||!l||i||a?1&u||ty(o,u|=1):ty(o,u|=33),i?(e=!1,2&u||(th(o,34),e=!!(4&u)),(r||e)&&Object.freeze(o)):(i=!!(2&u)||!!(2048&u),r&&i?(o=ta(o),r=1,l&&!a&&(r|=32),ty(o,r),t3(e,t,n,o,s)):a&&32&u&&!i&&tf(o,32)),o}function t5(e){let t=tg(e=e.l),n=t2(e,t,1),r=tI(n,!0,!!(34&t));return null!=r&&r!==n&&t3(e,t,1,r),r}function t8(e,t){return Array.isArray(e=t2(e,t,1))?e:tw}function t9(e,t){return 0===e&&(e=nf(e,t)),tp(e,1,!0)}function t7(e){return!!(2&e)&&!!(4&e)||!!(2048&e)}function ne(e,t,n){{let a=e.l,l=tg(a);if(tz(l),null==n)t3(a,l,t);else{var r,s=tm(n),i=s,o=!!(2&s)||Object.isFrozen(n);if((r=!o)&&(r=!1),tQ(e,s))for(s=21,o&&(n=ta(n),i=0,s=np(s=nf(s,l),l,!0)),e=0;e<n.length;e++)n[e]=tB(n[e]);r&&(n=ta(n),i=0,s=np(s=nf(s,l),l,!0)),s!==i&&ty(n,s),t3(a,l,t,n)}}}function nt(e,t){let n=tg(e=e.l);tz(n),t3(e,n,2,""===t?void 0:t)}function nn(e,t,n,r){let s=tg(e);tz(s),r=n(r,!!(4&(t=tm(e=t4(e,s,t,2))))&&!!(4096&t)),e.push(r)}function nr(e){return e}function ns(e,t){return ni(e=e.l,tg(e),rZ)===t?t:-1}function ni(e,t,n){let r=0;for(let s=0;s<n.length;s++){let i=n[s];null!=t2(e,t,i)&&(0!==r&&(t=t3(e,t,r)),r=i)}return r}function no(e,t,n,r){let s,i=tg(e);tz(i);let o=t2(e,i,n,r);if(null!=o&&o.C===tx)return(t=tY(o))!==o&&t3(e,i,n,t,r),t.l;if(Array.isArray(o)){let e=tm(o);s=tH(s=2&e?tX(o,e,!1):o,t[0],t[1])}else s=tH(void 0,t[0],t[1]);return s!==o&&t3(e,i,n,s,r),s}function na(e,t,n,r){let s=tg(e=e.l),i=t2(e,s,n,r);return(t=tV(i,t,s))!==i&&null!=t&&t3(e,s,n,t,r),t}function nl(e,t,n){if(null==(t=na(e,t,n,!1)))return t;let r=tg(e=e.l);if(!(2&r)){let s=tY(t);s!==t&&t3(e,r,n,t=s,!1)}return t}function nu(e,t,n,r,s){var i=!!(2&t);let o=i?1:2;r=!!r,s&&=!i;var a=tm(i=t8(e,t));let l=!!(4&a);if(!l){var u=i,c=t;let e=!!(2&(a=t9(a,t)));e&&(c=tp(c,2,!0));let r=!e,s=!0,o=0,l=0;for(;o<u.length;o++){let t=tV(u[o],n,c);if(t instanceof n){if(!e){let e=!!(2&tm(t.l));r&&=!e,s&&=e}u[l++]=t}}l<o&&(u.length=l),a=tp(a,4,!0),a=tp(a,16,s),ty(u,a=tp(a,8,r)),e&&Object.freeze(u)}if(s&&!(8&a||!i.length&&(1===o||4===o&&32&a))){for(t7(a)&&(i=ta(i),a=nf(a,t),t=t3(e,t,1,i)),n=i,s=a,u=0;u<n.length;u++)(a=n[u])!==(c=tY(a))&&(n[u]=c);s=tp(s,8,!0),s=tp(s,16,!n.length),ty(n,s),a=s}return t7(a)||(n=a,(a=(s=1===o||4===o&&!!(32&a))?tp(a,!i.length||16&a&&(!l||32&a)?2:2048,!0):np(a,t,r))!==n&&ty(i,a),s&&Object.freeze(i)),2===o&&t7(a)&&(ty(i=ta(i),a=np(a=nf(a,t),t,r)),t3(e,t,1,i)),i}function nc(e,t){let n=tg(e=e.l);return nu(e,n,t,!1,!(2&n))}function nd(e,t,n,r,s){return null==r&&(r=void 0),t6(e,n,r,s)}function nh(e,t,n){var r=r2;null==n&&(n=void 0);let s=tg(e=e.l);tz(s),(r=ni(e,s,r))&&r!==t&&null!=n&&(s=t3(e,s,r)),t3(e,s,t,n)}function nf(e,t){return e=tp(e,2,!!(2&t)),e=tp(e,32,!0),tp(e,2048,!1)}function np(e,t,n){return 32&t&&n||(e=tp(e,32,!1)),e}function nm(e,t){let n=tg(e=e.l);tz(n),e=nu(e,n,rC,!0),t=null!=t?t:new rC,e.push(t),2&tm(t.l)?tf(e,8):tf(e,16)}function ng(e){return null==(e=t0(e,2))?e:tM(e)?"number"==typeof e?tL(e):tF(e):void 0}function ny(e,t,n){nn(e.l,t,tB,n)}function nb(e,t,n){t.g?t.j(e,t.g,t.i,n,!0):t.j(e,t.i,n,!0)}var nv=class{constructor(e,t){this.l=tH(e,t)}toJSON(){return n_(this,tG(this.l,tZ,void 0,void 0,!1),!0)}A(){return!!(2&tm(this.l))}};function n_(e,t,n){let r,s;var i=ee?void 0:e.constructor.v;let o=tg(n?e.l:t);if(!(e=t.length))return t;if(tA(n=t[e-1])){e:{var a=n;let e={},t=!1;for(var l in a){let n=a[l];if(Array.isArray(n)){let e=n;(tE(n,i,+l)||tS(n)&&0===n.size)&&(n=null),n!=e&&(t=!0)}null!=n?e[l]=n:t=!0}if(t){for(var u in e){a=e;break e}a=null}}a!=n&&(r=!0),e--}for(l=+!!(512&o)-1;0<e&&(n=t[u=e-1],u-=l,null==n||tE(n,i,u)||tS(n)&&0===n.size);e--)s=!0;return(r||s)&&(t=Array.prototype.slice.call(t,0,e),a&&t.push(a)),t}function nw(e){return Array.isArray(e)?e[0]instanceof to?e:[rs,e]:[e,void 0]}function nx(e,t){if(Array.isArray(t)){var n=tm(t);if(4&n)return t;for(var r=0,s=0;r<t.length;r++){let n=e(t[r]);null!=n&&(t[s++]=n)}return s<r&&(t.length=s),ty(t,-12289&(5|n)),2&n&&Object.freeze(t),t}}nv.prototype.C=tx,nv.prototype.toString=function(){return n_(this,this.l,!1).toString()};let nk=Symbol();function nS(e){let t=e[nk];if(!t){let n=nz(e),r=nB(e),s=r.j;t=s?(e,t)=>s(e,t,r):(e,t)=>{for(;eX(t)&&4!=t.i;){var s=t.m,i=r[s];if(!i){var o=r.F;o&&(o=o[s])&&(i=r[s]=function(e){let t=(e=nw(e))[0].g;if(e=e[1]){let n=nS(e),r=nB(e).B;return(e,s,i)=>t(e,s,i,r,n)}return t}(o))}i&&i(t,e,s)||(s=(i=t).j,function e(t){switch(t.i){case 0:0!=t.i?e(t):eD(t.g);break;case 1:eG(t=t.g,t.g+8);break;case 2:if(2!=t.i)e(t);else{var n=eq(t.g)>>>0;eG(t=t.g,t.g+n)}break;case 5:eG(t=t.g,t.g+4);break;case 3:for(n=t.m;;){if(!eX(t))throw Error("Unmatched start-group tag: stream EOF");if(4==t.i){if(t.m!=n)throw Error("Unmatched end-group tag");break}e(t)}break;default:throw eS(t.i,t.j)}}(i),i.G?i=void 0:(o=i.g.g-s,i.g.g=s,i=eJ(i.g,o)),s=e,i&&(c||=Symbol(),(o=s[c])?o.push(i):s[c]=[i]))}n===g||n===y||n.s||(e[d||=Symbol()]=n)},e[nk]=t}return t}class nA{}let nI=Symbol();function nE(e,t,n){let r;let s=n[1];if(s){let n=s[nI];r=n?n.B:tW(s[0]),e[t]=n??s}r&&r===p?(e.g||(e.g=new Set)).add(t):n[0]&&(e.i||(e.i=new Set)).add(t)}function nT(e,t){return[e.j,!t||0<t[0]?void 0:t]}function nz(e){var t=e[nI];if(t)return t;if(!(t=nj(e,e[nI]=new nA,nT,nT,nE)).F&&!t.i&&!t.g){let n=!0;for(let e in t)isNaN(e)||(n=!1);n?(tW(e[0])===p?y?t=y:((t=new nA).B=tW(!0),t=y=t):t=g||=new nA,t=e[nI]=t):t.s=!0}return t}function nC(e,t,n){e[t]=n}function nj(e,t,n,r,s=nC){t.B=tW(e[0]);let i=0;var o=e[++i];o&&o.constructor===Object&&(t.F=o,"function"==typeof(o=e[++i])&&(t.j=o,t.m=e[++i],o=e[++i]));let a={};for(;Array.isArray(o)&&"number"==typeof o[0]&&0<o[0];){for(var l=0;l<o.length;l++)a[o[l]]=o;o=e[++i]}for(l=1;void 0!==o;){let d;"number"==typeof o&&(l+=o,o=e[++i]);var u=void 0;if(o instanceof to?d=o:(d=ri,i--),d.H){o=e[++i],u=e;var c=i;"function"==typeof o&&(o=o(),u[c]=o),u=o}for(c=l+1,"number"==typeof(o=e[++i])&&0>o&&(c-=o,o=e[++i]);l<c;l++){let e=a[l];s(t,l,u?r(d,u,e):n(d,e))}}return t}let nN=Symbol();function nO(e){let t=e[nN];if(!t){let n=nU(e);t=(e,t)=>nV(e,t,n),e[nN]=t}return t}let nP=Symbol();function nR(e){return e.i}function nM(e,t){let n,r;let s=e.i;return(e,i,o)=>s(e,i,o,r||=nU(t).B,n||=nO(t))}function nU(e){let t=e[nP];return t||(t=nj(e,e[nP]={},nR,nM),nD(e),t)}let n$=Symbol();function nL(e,t){let n=e.g;return t?(e,r,s)=>n(e,r,s,t):n}function nF(e,t,n){let r,s;let i=e.g;return(e,o,a)=>i(e,o,a,s||=nB(t).B,r||=nS(t),n)}function nB(e){let t=e[n$];return t||(nz(e),t=nj(e,e[n$]={},nL,nF),nD(e),t)}function nD(e){n$ in e&&nI in e&&nP in e&&(e.length=0)}function nq(e,t){var n=e[t];if(n)return n;if((n=e.F)&&(n=n[t])){var r=(n=nw(n))[0].i;if(n=n[1]){let t=nO(n),s=nU(n).B;n=(n=e.m)?n(s,t):(e,n,i)=>r(e,n,i,s,t)}else n=r;return e[t]=n}}function nV(e,t,n){for(var r=tg(e),s=+!!(512&r)-1,i=e.length,o=512&r?1:0,a=i+(256&r?-1:0);o<a;o++){let r=e[o];if(null==r)continue;let i=o-s,a=nq(n,i);a&&a(t,r,i)}if(256&r)for(let o in r=e[i-1])Number.isNaN(s=+o)||null!=(i=r[o])&&(a=nq(n,s))&&a(t,i,s);if(e=c?e[c]:void 0)for(tt(t,t.g.end()),n=0;n<e.length;n++)tt(t,ex(e[n])||eb())}function nW(e,t){return new to(e,t,!1,!1)}function nH(e,t){return new to(e,t,!0,!1)}function nG(e,t,n){t3(e,tg(e),t,n)}function nZ(e,t,n){e:if(null!=t){if(tM(t)){if("string"==typeof t){t=tF(t);break e}if("number"==typeof t){t=tL(t);break e}}t=void 0}null!=t&&("string"==typeof t&&e4(t),null!=t&&(tn(e,n,0),"number"==typeof t?(e=e.g,eO(t),e8(e,ej,eN)):(n=e4(t),e8(e.g,n.i,n.g))))}function nJ(e,t,n){null!=(t=tU(t))&&null!=t&&(tn(e,n,0),e7(e.g,t))}function nK(e,t,n){null!=(t=null==t||"boolean"==typeof t?t:"number"==typeof t?!!t:void 0)&&(tn(e,n,0),e.g.g.push(t?1:0))}function nX(e,t,n){null!=(t=tq(t))&&ti(e,n,Z(t))}function nY(e,t,n,r,s){null!=(t=t instanceof nv?t.l:Array.isArray(t)?tH(t,r[0],r[1]):void 0)&&(n=tr(e,n),s(t,e),ts(e,n))}function nQ(e,t,n){null!=(t=null==t||"string"==typeof t||ey(t)||t instanceof ek?t:void 0)&&ti(e,n,eE(t).buffer)}var n0,n1=nW(function(e,t,n){return 5===e.i&&(nG(t,n,eV(e.g)),!0)},function(e,t,n){null!=(t=tO(t))&&(tn(e,n,5),e=e.g,eP(t),te(e))}),n2=nH(function(e,t,n){return(5===e.i||2===e.i)&&(t=t4(t,tg(t),n,2,!1),2==e.i?e1(e,eV,t):t.push(eV(e.g)),!0)},function(e,t,n){if(null!=(t=nx(tO,t))&&t.length){tn(e,n,2),e9(e.g,4*t.length);for(let r=0;r<t.length;r++)n=e.g,eP(t[r]),te(n)}}),n6=nW(function(e,t,n){return 0===e.i&&(nG(t,n,eB(e.g,eM)),!0)},nZ),n3=nW(function(e,t,n){return 0===e.i&&(nG(t,n,0===(e=eB(e.g,eM))?void 0:e),!0)},nZ),n4=nW(function(e,t,n){return 0===e.i&&(nG(t,n,eB(e.g,eR)),!0)},function(e,t,n){e:if(null!=t){if(tM(t)){if("string"==typeof t){var r=Math.trunc(Number(t));Number.isSafeInteger(r)&&0<=r?t=String(r):(-1!==(r=t.indexOf("."))&&(t=t.substring(0,r)),t$(t)||(eL(t),t=eU(ej,eN)));break e}if("number"==typeof t){t=0<=(t=Math.trunc(t))&&Number.isSafeInteger(t)?t:function(e){if(0>e){eO(e);let t=eU(ej,eN);return Number.isSafeInteger(e=Number(t))?e:t}return t$(String(e))?e:(eO(e),eR(ej,eN))}(t);break e}}t=void 0}null!=t&&("string"==typeof t&&e6(t),null!=t&&(tn(e,n,0),"number"==typeof t?(e=e.g,eO(t),e8(e,ej,eN)):(n=e6(t),e8(e.g,n.i,n.g))))}),n5=nW(function(e,t,n){return 0===e.i&&(nG(t,n,eq(e.g)),!0)},nJ),n8=nH(function(e,t,n){return(0===e.i||2===e.i)&&(t=t4(t,tg(t),n,2,!1),2==e.i?e1(e,eq,t):t.push(eq(e.g)),!0)},function(e,t,n){if(null!=(t=nx(tU,t))&&t.length){n=tr(e,n);for(let n=0;n<t.length;n++)e7(e.g,t[n]);ts(e,n)}}),n9=nW(function(e,t,n){return 0===e.i&&(nG(t,n,0===(e=eq(e.g))?void 0:e),!0)},nJ),n7=nW(function(e,t,n){return 0===e.i&&(nG(t,n,eD(e.g)),!0)},nK),re=nW(function(e,t,n){return 0===e.i&&(nG(t,n,!1===(e=eD(e.g))?void 0:e),!0)},nK),rt=nH(function(e,t,n){return 2===e.i&&(nn(t,n,nr,e=eQ(e)),!0)},function(e,t,n){if(null!=(t=nx(tq,t)))for(let s=0;s<t.length;s++){var r=t[s];null!=r&&ti(e,n,Z(r))}}),rn=nW(function(e,t,n){return 2===e.i&&(nG(t,n,""===(e=eQ(e))?void 0:e),!0)},nX),rr=nW(function(e,t,n){return 2===e.i&&(nG(t,n,eQ(e)),!0)},nX),rs=new to(function(e,t,n,r,s){return 2===e.i&&(eY(e,no(t,r,n,!0),s),!0)},nY,!1,!0),ri=new to(function(e,t,n,r,s){return 2===e.i&&(eY(e,no(t,r,n),s),!0)},nY,!1,!0);n0=new to(function(e,t,n,r,s){if(2!==e.i)return!1;r=tH(void 0,r[0],r[1]);let i=tg(t);tz(i);let o=t4(t,i,n,3);return i=tg(t),4&tm(o)&&(ty(o=ta(o),-2079&(1|tm(o))),t3(t,i,n,o)),o.push(r),eY(e,r,s),!0},function(e,t,n,r,s){if(Array.isArray(t))for(let i=0;i<t.length;i++)nY(e,t[i],n,r,s)},!0,!0);var ro=new to(function(e,t,n,r,s,i){if(2!==e.i)return!1;let o=tg(t);return tz(o),(i=ni(t,o,i))&&n!==i&&t3(t,o,i),eY(e,t=no(t,r,n),s),!0},nY,!1,!0),ra=nW(function(e,t,n){return 2===e.i&&(nG(t,n,e0(e)),!0)},nQ),rl=nW(function(e,t,n){return 0===e.i&&(nG(t,n,eq(e.g)),!0)},function(e,t,n){null!=(t=tU(t))&&(t=parseInt(t,10),tn(e,n,0),e7(e.g,t))}),ru=nH(function(e,t,n){return(0===e.i||2===e.i)&&(t=t4(t,tg(t),n,2,!1),2==e.i?e1(e,eW,t):t.push(eq(e.g)),!0)},function(e,t,n){if(null!=(t=nx(tU,t))&&t.length){n=tr(e,n);for(let n=0;n<t.length;n++)e7(e.g,t[n]);ts(e,n)}});class rc{constructor(e,t){this.i=e,this.g=t,this.j=nd,this.defaultValue=void 0}}function rd(e,t){return(n,r)=>{if(e2.length){let e=e2.pop();e.o(r),eH(e.g,n,r),n=e}else n=new class{constructor(e,t){if(eK.length){let n=eK.pop();eH(n,e,t),e=n}else e=new class{constructor(e,t){this.i=null,this.m=!1,this.g=this.j=this.s=0,eH(this,e,t)}clear(){this.i=null,this.m=!1,this.g=this.j=this.s=0,this.D=!1}}(e,t);this.g=e,this.j=this.g.g,this.i=this.m=-1,this.o(t)}o({G:e=!1}={}){this.G=e}}(n,r);try{let r=new e,i=r.l;nS(t)(i,n);var s=r}finally{n.g.clear(),n.m=-1,n.i=-1,100>e2.length&&e2.push(n)}return s}}var rh=[0,rn,nW(function(e,t,n){return 2===e.i&&(nG(t,n,(e=e0(e))===ew()?void 0:e),!0)},function(e,t,n){if(null!=t){if(t instanceof nv){let r=t.N;return void(r&&null!=(t=r(t))&&ti(e,n,eE(t).buffer))}if(Array.isArray(t))return}nQ(e,t,n)})],rf=[0,rr],rp=[0,n5,rl,n7,-1,n8,rl,-1],rm=[0,n7,-1],rg=class extends nv{constructor(){super()}};rg.v=[6];var ry=[0,n7,rr,n7,rl,-1,ru,rr,-1,rm,rl],rb=[0,rr,-2],rv=class extends nv{constructor(){super()}},r_=[0],rw=[0,n5,n7,-4],rx=class extends nv{constructor(e){super(e,2)}},rk={},rS=[-2,rk,n7];rk[336783863]=[0,rr,n7,-1,n5,[0,[1,2,3,4,5,6],ro,r_,ro,ry,ro,rb,ro,rw,ro,rp,ro,[0,rr]],rf,n7,[0,[1,3],[2,4],ro,[0,n8],-1,ro,[0,rt],-1,n0,[0,rr,-1]],rr];var rA=[0,n3,-1,re,-3,n3,n8,rn,n9,n3,-1,re,n9,re,-2,rn],rI=[-1,{}],rE=[0,rr,1,rI],rT=[0,rr,rt,rI];function rz(e){ny(e,3,"TEXT:text_in")}var rC=class extends nv{constructor(e){super(e,500)}o(e){return nd(this,0,7,e)}};rC.v=[3,4,5,6,8,13,17,1005];var rj=[-500,rn,-1,rt,-3,rS,n0,rh,n9,-1,rE,rT,n0,[0,rn,re],rn,rA,n9,rt,987,rt],rN=[-500,rr,-1,[-1,{}],998,rr],rO=[-500,rr,rt,-1,[-2,{},n7],997,rt,-1],rP=[-500,rr,rt,rI,998,rt];function rR(e){ny(e,10,"text_in")}var rM,rU=class extends nv{constructor(){super(void 0,500)}o(e){return nd(this,0,1001,e)}};rU.v=[1,6,7,9,10,15,16,17,14,1002],rU.prototype.g=(rM=[-500,n0,rj,4,n0,rN,n0,rO,n9,n0,rP,rt,n9,rE,rT,n0,[0,rn,-1,rI],rt,-2,rA,rn,-1,re,979,rI,n0,rh],function(){let e=new class{constructor(){this.j=[],this.i=0,this.g=new class{constructor(){this.g=[]}length(){return this.g.length}end(){let e=this.g;return this.g=[],e}}}};nV(this.l,e,nU(rM)),tt(e,e.g.end());let t=new Uint8Array(e.i),n=e.j,r=n.length,s=0;for(let e=0;e<r;e++){let r=n[e];t.set(r,s),s+=r.length}return e.j=[t],t});var r$=class extends nv{constructor(e){super(e)}},rL=[0,n5,n1,rr,-1],rF=class extends nv{constructor(e){super(e)}g(){return nc(this,r$)}};rF.v=[1];var rB=class extends nv{constructor(e){super(e)}},rD=[0,1,n5,rr,[0,n0,rL]],rq=class extends nv{constructor(e){super(e)}};rq.v=[1];var rV=rd(rq,[0,n0,rD,n6]),rW=class extends nv{constructor(e){super(e)}};rW.v=[1];var rH=class extends nv{constructor(e){super(e)}I(){let e=t5(this);return null==e?ew():e}},rG=class extends nv{constructor(e){super(e)}},rZ=[1,2],rJ=[0,rZ,ro,[0,n2],ro,[0,ra],n5,rr],rK=class extends nv{constructor(e){super(e)}};rK.v=[1];var rX=rd(rK,[0,n0,rJ,n6]),rY=class extends nv{constructor(e){super(e)}};rY.v=[4,5];var rQ=class extends nv{constructor(e){super(e)}},r0=[0,n7,-1],r1=class extends nv{constructor(e){super(e)}},r2=[1,2,3,4,5],r6=class extends nv{constructor(e){super(e)}g(){return null!=t5(this)}i(){return null!=tq(t0(this,2))}},r3=class extends nv{constructor(e){super(e)}},r4=[0,[0,ra,rr,[0,n5,n6,-1],[0,n4,n6]],n7,[0,r2,ro,rw,ro,ry,ro,rp,ro,r_,ro,rb],rl],r5=class extends nv{constructor(e){super(e)}},r8=new rc(462704549,r5);rk[462704549]=[0,r4,[0,rr,n5,n1,rt,-1]];var r9=class extends nv{constructor(e){super(e)}},r7=new rc(477589892,r9);function se(e,t){if(t=t?tJ(t):new rY,void 0!==e.displayNamesLocale?t6(t,1,tD(e.displayNamesLocale)):void 0===e.displayNamesLocale&&t6(t,1),void 0!==e.maxResults){var n=e.maxResults;if(null!=n){if("number"!=typeof n||!Number.isFinite(n))throw function(){let e=Error("int32");return tj(e,"warning"),e}();n|=0}t6(t,2,n)}else"maxResults"in e&&t6(t,2);if(void 0!==e.scoreThreshold){if(null!=(n=e.scoreThreshold)&&"number"!=typeof n)throw Error(`Value of float/double field must be a number, found ${typeof n}: ${n}`);t6(t,3,n)}else"scoreThreshold"in e&&t6(t,3);return void 0!==e.categoryAllowlist?ne(t,4,e.categoryAllowlist):"categoryAllowlist"in e&&t6(t,4),void 0!==e.categoryDenylist?ne(t,5,e.categoryDenylist):"categoryDenylist"in e&&t6(t,5),t}function st(e){let t={classifications:nc(e,rB).map(e=>(function(e,t=-1,n=""){return{categories:e.map(e=>{var t=tU(t0(e,1))??0??-1;let n=e.l,r=tg(n),s=t2(n,r,2),i=tO(s);return null!=i&&i!==s&&t3(n,r,2,i),{index:t,score:i??0??0,categoryName:tq(t0(e,3))??""??"",displayName:tq(t0(e,4))??""??""}}),headIndex:t,headName:n}})(nl(e,rF,4)?.g()??[],tU(t0(e,2))??0,tq(t0(e,3))??""))};return null!=ng(e)&&(t.timestampMs=ng(e)??0),t}function sn(e){return Array.from(e,e=>127<e?e-256:e)}function sr(e,t){if(e.length!==t.length)throw Error(`Cannot compute cosine similarity between embeddings of different sizes (${e.length} vs. ${t.length}).`);let n=0,r=0,s=0;for(let i=0;i<e.length;i++)n+=e[i]*t[i],r+=e[i]*e[i],s+=t[i]*t[i];if(0>=r||0>=s)throw Error("Cannot compute cosine similarity on embedding with 0 norm.");return n/Math.sqrt(r*s)}rk[477589892]=[0,r4,r0];let ss=new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11]);async function si(){if(void 0===b)try{await WebAssembly.instantiate(ss),b=!0}catch{b=!1}return b}async function so(e,t=""){let n=await si()?"wasm_internal":"wasm_nosimd_internal";return{wasmLoaderPath:`${t}/${e}_${n}.js`,wasmBinaryPath:`${t}/${e}_${n}.wasm`}}var sa=class{};async function sl(e){if("function"!=typeof importScripts){let t=document.createElement("script");return t.src=e.toString(),t.crossOrigin="anonymous",new Promise((e,n)=>{t.addEventListener("load",()=>{e()},!1),t.addEventListener("error",e=>{n(e)},!1),document.body.appendChild(t)})}importScripts(e.toString())}function su(e,t,n){e.m||console.error("No wasm multistream support detected: ensure dependency inclusion of :gl_graph_runner_internal_multi_input target"),n(t=e.h.stringToNewUTF8(t)),e.h._free(t)}function sc(e,t,n){e.m||console.error("No wasm multistream support detected: ensure dependency inclusion of :gl_graph_runner_internal_multi_input target");let r=new Uint32Array(t.length);for(let n=0;n<t.length;n++)r[n]=e.h.stringToNewUTF8(t[n]);for(let s of(t=e.h._malloc(4*r.length),e.h.HEAPU32.set(r,t>>2),n(t),r))e.h._free(s);e.h._free(t)}function sd(e,t,n){e.h.simpleListeners=e.h.simpleListeners||{},e.h.simpleListeners[t]=n}function sh(e,t,n){let r=[];e.h.simpleListeners=e.h.simpleListeners||{},e.h.simpleListeners[t]=(e,t,s)=>{t?(n(r,s),r=[]):r.push(e)}}sa.forVisionTasks=function(e){return so("vision",e)},sa.forTextTasks=function(e){return so("text",e)},sa.forGenAiExperimentalTasks=function(e){return so("genai_experimental",e)},sa.forGenAiTasks=function(e){return so("genai",e)},sa.forAudioTasks=function(e){return so("audio",e)},sa.isSimdSupported=function(){return si()};let sf=(sz=class{constructor(e,t){var n;this.j=!0,this.h=e,this.g=null,this.i=0,this.m="function"==typeof this.h._addIntToInputStream,void 0!==t?this.h.canvas=t:(n=navigator,"undefined"!=typeof OffscreenCanvas&&(!function(e=navigator){return(e=e.userAgent).includes("Safari")&&!e.includes("Chrome")}(n)||(n=n.userAgent.match(/Version\/([\d]+).*Safari/))&&1<=n.length&&17<=Number(n[1])))?this.h.canvas=new OffscreenCanvas(1,1):(console.warn("OffscreenCanvas not supported and GraphRunner constructor glCanvas parameter is undefined. Creating backup canvas."),this.h.canvas=document.createElement("canvas"))}async initializeGraph(e){let t=await (await fetch(e)).arrayBuffer();e=!(e.endsWith(".pbtxt")||e.endsWith(".textproto")),this.setGraph(new Uint8Array(t),e)}setGraphFromString(e){this.setGraph((new TextEncoder).encode(e),!1)}setGraph(e,t){let n=e.length,r=this.h._malloc(n);this.h.HEAPU8.set(e,r),t?this.h._changeBinaryGraph(n,r):this.h._changeTextGraph(n,r),this.h._free(r)}configureAudio(e,t,n,r,s){this.h._configureAudio||console.warn('Attempting to use configureAudio without support for input audio. Is build dep ":gl_graph_runner_audio" missing?'),su(this,r||"input_audio",r=>{su(this,s=s||"audio_header",s=>{this.h._configureAudio(r,s,e,t,n)})})}setAutoResizeCanvas(e){this.j=e}setAutoRenderToScreen(e){this.h._setAutoRenderToScreen(e)}setGpuBufferVerticalFlip(e){this.h.gpuOriginForWebTexturesIsBottomLeft=e}attachErrorListener(e){this.h.errorListener=e}attachEmptyPacketListener(e,t){this.h.emptyPacketListeners=this.h.emptyPacketListeners||{},this.h.emptyPacketListeners[e]=t}addAudioToStream(e,t,n){this.addAudioToStreamWithShape(e,0,0,t,n)}addAudioToStreamWithShape(e,t,n,r,s){let i=4*e.length;this.i!==i&&(this.g&&this.h._free(this.g),this.g=this.h._malloc(i),this.i=i),this.h.HEAPF32.set(e,this.g/4),su(this,r,e=>{this.h._addAudioToInputStream(this.g,t,n,e,s)})}addGpuBufferToStream(e,t,n){su(this,t,t=>{if(!this.h.canvas)throw Error("No OpenGL canvas configured.");t?this.h._bindTextureToStream(t):this.h._bindTextureToCanvas();let r=this.h.canvas.getContext("webgl2")||this.h.canvas.getContext("webgl");if(!r)throw Error("Failed to obtain WebGL context from the provided canvas. `getContext()` should only be invoked with `webgl` or `webgl2`.");this.h.gpuOriginForWebTexturesIsBottomLeft&&r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!0),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,e),this.h.gpuOriginForWebTexturesIsBottomLeft&&r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!1);let[s,i]=void 0!==e.videoWidth?[e.videoWidth,e.videoHeight]:void 0!==e.naturalWidth?[e.naturalWidth,e.naturalHeight]:void 0!==e.displayWidth?[e.displayWidth,e.displayHeight]:[e.width,e.height];this.j&&(s!==this.h.canvas.width||i!==this.h.canvas.height)&&(this.h.canvas.width=s,this.h.canvas.height=i);let[o,a]=[s,i];this.h._addBoundTextureToStream(t,o,a,n)})}addBoolToStream(e,t,n){su(this,t,t=>{this.h._addBoolToInputStream(e,t,n)})}addDoubleToStream(e,t,n){su(this,t,t=>{this.h._addDoubleToInputStream(e,t,n)})}addFloatToStream(e,t,n){su(this,t,t=>{this.h._addFloatToInputStream(e,t,n)})}addIntToStream(e,t,n){su(this,t,t=>{this.h._addIntToInputStream(e,t,n)})}addUintToStream(e,t,n){su(this,t,t=>{this.h._addUintToInputStream(e,t,n)})}addStringToStream(e,t,n){su(this,t,t=>{su(this,e,e=>{this.h._addStringToInputStream(e,t,n)})})}addStringRecordToStream(e,t,n){su(this,t,t=>{sc(this,Object.keys(e),r=>{sc(this,Object.values(e),s=>{this.h._addFlatHashMapToInputStream(r,s,Object.keys(e).length,t,n)})})})}addProtoToStream(e,t,n,r){su(this,n,n=>{su(this,t,t=>{let s=this.h._malloc(e.length);this.h.HEAPU8.set(e,s),this.h._addProtoToInputStream(s,e.length,t,n,r),this.h._free(s)})})}addEmptyPacketToStream(e,t){su(this,e,e=>{this.h._addEmptyPacketToInputStream(e,t)})}addBoolVectorToStream(e,t,n){su(this,t,t=>{let r=this.h._allocateBoolVector(e.length);if(!r)throw Error("Unable to allocate new bool vector on heap.");for(let t of e)this.h._addBoolVectorEntry(r,t);this.h._addBoolVectorToInputStream(r,t,n)})}addDoubleVectorToStream(e,t,n){su(this,t,t=>{let r=this.h._allocateDoubleVector(e.length);if(!r)throw Error("Unable to allocate new double vector on heap.");for(let t of e)this.h._addDoubleVectorEntry(r,t);this.h._addDoubleVectorToInputStream(r,t,n)})}addFloatVectorToStream(e,t,n){su(this,t,t=>{let r=this.h._allocateFloatVector(e.length);if(!r)throw Error("Unable to allocate new float vector on heap.");for(let t of e)this.h._addFloatVectorEntry(r,t);this.h._addFloatVectorToInputStream(r,t,n)})}addIntVectorToStream(e,t,n){su(this,t,t=>{let r=this.h._allocateIntVector(e.length);if(!r)throw Error("Unable to allocate new int vector on heap.");for(let t of e)this.h._addIntVectorEntry(r,t);this.h._addIntVectorToInputStream(r,t,n)})}addUintVectorToStream(e,t,n){su(this,t,t=>{let r=this.h._allocateUintVector(e.length);if(!r)throw Error("Unable to allocate new unsigned int vector on heap.");for(let t of e)this.h._addUintVectorEntry(r,t);this.h._addUintVectorToInputStream(r,t,n)})}addStringVectorToStream(e,t,n){su(this,t,t=>{let r=this.h._allocateStringVector(e.length);if(!r)throw Error("Unable to allocate new string vector on heap.");for(let t of e)su(this,t,e=>{this.h._addStringVectorEntry(r,e)});this.h._addStringVectorToInputStream(r,t,n)})}addBoolToInputSidePacket(e,t){su(this,t,t=>{this.h._addBoolToInputSidePacket(e,t)})}addDoubleToInputSidePacket(e,t){su(this,t,t=>{this.h._addDoubleToInputSidePacket(e,t)})}addFloatToInputSidePacket(e,t){su(this,t,t=>{this.h._addFloatToInputSidePacket(e,t)})}addIntToInputSidePacket(e,t){su(this,t,t=>{this.h._addIntToInputSidePacket(e,t)})}addUintToInputSidePacket(e,t){su(this,t,t=>{this.h._addUintToInputSidePacket(e,t)})}addStringToInputSidePacket(e,t){su(this,t,t=>{su(this,e,e=>{this.h._addStringToInputSidePacket(e,t)})})}addProtoToInputSidePacket(e,t,n){su(this,n,n=>{su(this,t,t=>{let r=this.h._malloc(e.length);this.h.HEAPU8.set(e,r),this.h._addProtoToInputSidePacket(r,e.length,t,n),this.h._free(r)})})}addBoolVectorToInputSidePacket(e,t){su(this,t,t=>{let n=this.h._allocateBoolVector(e.length);if(!n)throw Error("Unable to allocate new bool vector on heap.");for(let t of e)this.h._addBoolVectorEntry(n,t);this.h._addBoolVectorToInputSidePacket(n,t)})}addDoubleVectorToInputSidePacket(e,t){su(this,t,t=>{let n=this.h._allocateDoubleVector(e.length);if(!n)throw Error("Unable to allocate new double vector on heap.");for(let t of e)this.h._addDoubleVectorEntry(n,t);this.h._addDoubleVectorToInputSidePacket(n,t)})}addFloatVectorToInputSidePacket(e,t){su(this,t,t=>{let n=this.h._allocateFloatVector(e.length);if(!n)throw Error("Unable to allocate new float vector on heap.");for(let t of e)this.h._addFloatVectorEntry(n,t);this.h._addFloatVectorToInputSidePacket(n,t)})}addIntVectorToInputSidePacket(e,t){su(this,t,t=>{let n=this.h._allocateIntVector(e.length);if(!n)throw Error("Unable to allocate new int vector on heap.");for(let t of e)this.h._addIntVectorEntry(n,t);this.h._addIntVectorToInputSidePacket(n,t)})}addUintVectorToInputSidePacket(e,t){su(this,t,t=>{let n=this.h._allocateUintVector(e.length);if(!n)throw Error("Unable to allocate new unsigned int vector on heap.");for(let t of e)this.h._addUintVectorEntry(n,t);this.h._addUintVectorToInputSidePacket(n,t)})}addStringVectorToInputSidePacket(e,t){su(this,t,t=>{let n=this.h._allocateStringVector(e.length);if(!n)throw Error("Unable to allocate new string vector on heap.");for(let t of e)su(this,t,e=>{this.h._addStringVectorEntry(n,e)});this.h._addStringVectorToInputSidePacket(n,t)})}attachBoolListener(e,t){sd(this,e,t),su(this,e,e=>{this.h._attachBoolListener(e)})}attachBoolVectorListener(e,t){sh(this,e,t),su(this,e,e=>{this.h._attachBoolVectorListener(e)})}attachIntListener(e,t){sd(this,e,t),su(this,e,e=>{this.h._attachIntListener(e)})}attachIntVectorListener(e,t){sh(this,e,t),su(this,e,e=>{this.h._attachIntVectorListener(e)})}attachUintListener(e,t){sd(this,e,t),su(this,e,e=>{this.h._attachUintListener(e)})}attachUintVectorListener(e,t){sh(this,e,t),su(this,e,e=>{this.h._attachUintVectorListener(e)})}attachDoubleListener(e,t){sd(this,e,t),su(this,e,e=>{this.h._attachDoubleListener(e)})}attachDoubleVectorListener(e,t){sh(this,e,t),su(this,e,e=>{this.h._attachDoubleVectorListener(e)})}attachFloatListener(e,t){sd(this,e,t),su(this,e,e=>{this.h._attachFloatListener(e)})}attachFloatVectorListener(e,t){sh(this,e,t),su(this,e,e=>{this.h._attachFloatVectorListener(e)})}attachStringListener(e,t){sd(this,e,t),su(this,e,e=>{this.h._attachStringListener(e)})}attachStringVectorListener(e,t){sh(this,e,t),su(this,e,e=>{this.h._attachStringVectorListener(e)})}attachProtoListener(e,t,n){sd(this,e,t),su(this,e,e=>{this.h._attachProtoListener(e,n||!1)})}attachProtoVectorListener(e,t,n){sh(this,e,t),su(this,e,e=>{this.h._attachProtoVectorListener(e,n||!1)})}attachAudioListener(e,t,n){this.h._attachAudioListener||console.warn('Attempting to use attachAudioListener without support for output audio. Is build dep ":gl_graph_runner_audio_out" missing?'),sd(this,e,(e,n)=>{t(e=new Float32Array(e.buffer,e.byteOffset,e.length/4),n)}),su(this,e,e=>{this.h._attachAudioListener(e,n||!1)})}finishProcessing(){this.h._waitUntilIdle()}closeGraph(){this.h._closeGraph(),this.h.simpleListeners=void 0,this.h.emptyPacketListeners=void 0}},class extends sz{M(){this.h._registerModelResourcesGraphService()}});var sp=class extends sf{};async function sm(e,t,n){return e=await (async(e,t,n,r)=>{if(t&&await sl(t),!self.ModuleFactory||n&&(await sl(n),!self.ModuleFactory))throw Error("ModuleFactory not set.");return self.Module&&r&&((t=self.Module).locateFile=r.locateFile,r.mainScriptUrlOrBlob&&(t.mainScriptUrlOrBlob=r.mainScriptUrlOrBlob)),r=await self.ModuleFactory(self.Module||r),self.ModuleFactory=self.Module=void 0,new e(r,null)})(e,t.wasmLoaderPath,t.assetLoaderPath,{locateFile:e=>e.endsWith(".wasm")?t.wasmBinaryPath.toString():t.assetBinaryPath&&e.endsWith(".data")?t.assetBinaryPath.toString():e}),await e.o(n),e}async function sg(e,t,n){return sm(e,t,n)}function sy(e,t){let n=nl(e.baseOptions,r6,1)||new r6;"string"==typeof t?(t6(n,2,tD(t)),t6(n,1)):t instanceof Uint8Array&&(t6(n,1,tI(t,!1,!1)),t6(n,2)),nd(e.baseOptions,0,1,n)}function sb(e,t){let n=t.baseOptions||{};if(t.baseOptions?.modelAssetBuffer&&t.baseOptions?.modelAssetPath)throw Error("Cannot set both baseOptions.modelAssetPath and baseOptions.modelAssetBuffer");if(!(nl(e.baseOptions,r6,1)?.g()||nl(e.baseOptions,r6,1)?.i()||t.baseOptions?.modelAssetBuffer||t.baseOptions?.modelAssetPath))throw Error("Either baseOptions.modelAssetPath or baseOptions.modelAssetBuffer must be set");if(function(e,t){let n=nl(e.baseOptions,r1,3);if(!n){var r=n=new r1;nh(r,4,new rv)}"delegate"in t&&("GPU"===t.delegate?nh(t=n,2,r=new rg):nh(t=n,4,r=new rv)),nd(e.baseOptions,0,3,n)}(e,n),n.modelAssetPath)return fetch(n.modelAssetPath.toString()).then(e=>{if(e.ok)return e.arrayBuffer();throw Error(`Failed to fetch model: ${n.modelAssetPath} (${e.status})`)}).then(t=>{try{e.g.h.FS_unlink("/model.dat")}catch{}e.g.h.FS_createDataFile("/","model.dat",new Uint8Array(t),!0,!1,!1),sy(e,"/model.dat"),e.s()});if(n.modelAssetBuffer instanceof Uint8Array)sy(e,n.modelAssetBuffer);else if(n.modelAssetBuffer)return(async function(e){let t=[];for(var n=0;;){let{done:r,value:s}=await e.read();if(r)break;t.push(s),n+=s.length}if(0===t.length)return new Uint8Array(0);if(1===t.length)return t[0];for(let r of(e=new Uint8Array(n),n=0,t))e.set(r,n),n+=r.length;return e})(n.modelAssetBuffer).then(t=>{sy(e,t),e.s()});return e.s(),Promise.resolve()}function sv(e){try{let t=e.m.length;if(1===t)throw Error(e.m[0].message);if(1<t)throw Error("Encountered multiple errors: "+e.m.map(e=>e.message).join(", "))}finally{e.m=[]}}function s_(e,t){e.j=Math.max(e.j,t)}var sw=class{constructor(e){this.g=e,this.m=[],this.j=0,this.g.setAutoRenderToScreen(!1)}setGraph(e,t){this.g.attachErrorListener((e,t)=>{this.m.push(Error(t))}),this.g.M(),this.g.setGraph(e,t),sv(this)}finishProcessing(){this.g.finishProcessing(),sv(this)}close(){this.g.closeGraph()}};sw.prototype.close=sw.prototype.close,function(e,t){e=e.split(".");var n,r=D;for((e[0]in r)||void 0===r.execScript||r.execScript("var "+e[0]);e.length&&(n=e.shift());)e.length||void 0===t?r=r[n]&&r[n]!==Object.prototype[n]?r[n]:r[n]={}:r[n]=t}("TaskRunner",sw);var sx=class extends sw{constructor(e,t){super(new sp(e,t)),this.u={languages:[]},nd(e=this.i=new r5,0,1,t=new r3)}o(e){return nd(this.i,0,2,se(e,nl(this.i,rY,2))),sb(this,e)}get baseOptions(){return nl(this.i,r3,1)}set baseOptions(e){nd(this.i,0,1,e)}K(e){return this.u={languages:[]},this.g.addStringToStream(e,"text_in",this.j+1),this.finishProcessing(),this.u}s(){var e=new rU;rR(e),ny(e,15,"classifications_out");let t=new rx;nb(t,r8,this.i);let n=new rC;nt(n,tD("mediapipe.tasks.text.text_classifier.TextClassifierGraph")),rz(n),ny(n,4,"CLASSIFICATIONS:classifications_out"),n.o(t),nm(e,n),this.g.attachProtoListener("classifications_out",(e,t)=>{if({classifications:e}=st(rV(e)),1!==e.length)throw Error(`Expected 1 classification head, got ${e.length}`);this.u.languages=e[0].categories.map(e=>({languageCode:e.categoryName,probability:e.score})),s_(this,t)}),this.g.attachEmptyPacketListener("classifications_out",e=>{s_(this,e)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};sx.prototype.detect=sx.prototype.K,sx.prototype.setOptions=sx.prototype.o,sx.createFromModelPath=function(e,t){return sg(sx,e,{baseOptions:{modelAssetPath:t}})},sx.createFromModelBuffer=function(e,t){return sg(sx,e,{baseOptions:{modelAssetBuffer:t}})},sx.createFromOptions=function(e,t){return sg(sx,e,t)};var sk=class extends sw{constructor(e,t){super(new sp(e,t)),this.u={classifications:[]},nd(e=this.i=new r5,0,1,t=new r3)}o(e){return nd(this.i,0,2,se(e,nl(this.i,rY,2))),sb(this,e)}get baseOptions(){return nl(this.i,r3,1)}set baseOptions(e){nd(this.i,0,1,e)}J(e){return this.u={classifications:[]},this.g.addStringToStream(e,"text_in",this.j+1),this.finishProcessing(),this.u}s(){var e=new rU;rR(e),ny(e,15,"classifications_out");let t=new rx;nb(t,r8,this.i);let n=new rC;nt(n,tD("mediapipe.tasks.text.text_classifier.TextClassifierGraph")),rz(n),ny(n,4,"CLASSIFICATIONS:classifications_out"),n.o(t),nm(e,n),this.g.attachProtoListener("classifications_out",(e,t)=>{this.u=st(rV(e)),s_(this,t)}),this.g.attachEmptyPacketListener("classifications_out",e=>{s_(this,e)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};sk.prototype.classify=sk.prototype.J,sk.prototype.setOptions=sk.prototype.o,sk.createFromModelPath=function(e,t){return sg(sk,e,{baseOptions:{modelAssetPath:t}})},sk.createFromModelBuffer=function(e,t){return sg(sk,e,{baseOptions:{modelAssetBuffer:t}})},sk.createFromOptions=function(e,t){return sg(sk,e,t)};var sS=class extends sw{constructor(e,t){super(new sp(e,t)),this.u={embeddings:[]},nd(e=this.i=new r9,0,1,t=new r3)}o(e){var t=this.i,n=nl(this.i,rQ,2);return n=n?tJ(n):new rQ,void 0!==e.l2Normalize?t6(n,1,tP(e.l2Normalize)):"l2Normalize"in e&&t6(n,1),void 0!==e.quantize?t6(n,2,tP(e.quantize)):"quantize"in e&&t6(n,2),nd(t,0,2,n),sb(this,e)}get baseOptions(){return nl(this.i,r3,1)}set baseOptions(e){nd(this.i,0,1,e)}L(e){return this.g.addStringToStream(e,"text_in",this.j+1),this.finishProcessing(),this.u}s(){var e=new rU;rR(e),ny(e,15,"embeddings_out");let t=new rx;nb(t,r7,this.i);let n=new rC;nt(n,tD("mediapipe.tasks.text.text_embedder.TextEmbedderGraph")),rz(n),ny(n,4,"EMBEDDINGS:embeddings_out"),n.o(t),nm(e,n),this.g.attachProtoListener("embeddings_out",(e,t)=>{var n;e=rX(e),this.u={embeddings:nc(n=e,rG).map(e=>{let t={headIndex:tU(t0(e,3))??0??-1,headName:tq(t0(e,4))??""??""};if(void 0!==na(e,rW,ns(e,1))){var n=nl(e,rW,ns(e,1)),r=tg(e=n.l);let o=2&r?1:2,a=t8(e,r);var s=tm(a);if(tQ(n,s,void 0,!1)){(4&s||Object.isFrozen(a))&&(a=ta(a),s=nf(s,r),r=t3(e,r,1,a));for(var i=n=0;n<a.length;n++){let e=tO(a[n]);null!=e&&(a[i++]=e)}i<n&&(a.length=i),s=tp(s=t9(s,r),20,!0),s=tp(s,4096,!1),ty(a,s=tp(s,8192,!1)),2&s&&Object.freeze(a)}t7(s)||(n=s,(s=(i=1===o||4===o&&!!(32&s))?tp(s,2,!0):np(s,r,!1))!==n&&ty(a,s),i&&Object.freeze(a)),2===o&&t7(s)&&(ty(a=ta(a),s=np(s=nf(s,r),r,!1)),t3(e,r,1,a)),t.floatEmbedding=a.slice()}else r=new Uint8Array(0),t.quantizedEmbedding=nl(e,rH,ns(e,2))?.I()?.i()??r;return t}),timestampMs:ng(n)??0},s_(this,t)}),this.g.attachEmptyPacketListener("embeddings_out",e=>{s_(this,e)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};sS.cosineSimilarity=function(e,t){if(e.floatEmbedding&&t.floatEmbedding)e=sr(e.floatEmbedding,t.floatEmbedding);else{if(!e.quantizedEmbedding||!t.quantizedEmbedding)throw Error("Cannot compute cosine similarity between quantized and float embeddings.");e=sr(sn(e.quantizedEmbedding),sn(t.quantizedEmbedding))}return e},sS.prototype.embed=sS.prototype.L,sS.prototype.setOptions=sS.prototype.o,sS.createFromModelPath=function(e,t){return sg(sS,e,{baseOptions:{modelAssetPath:t}})},sS.createFromModelBuffer=function(e,t){return sg(sS,e,{baseOptions:{modelAssetBuffer:t}})},sS.createFromOptions=function(e,t){return sg(sS,e,t)};var sA="undefined"!=typeof self?self:{};function sI(e){e:{for(var t=["CLOSURE_FLAGS"],n=sA,r=0;r<t.length;r++)if(null==(n=n[t[r]])){t=null;break e}t=n}return null!=(e=t&&t[e])&&e}let sE="undefined"!=typeof TextEncoder;function sT(e){if(sE)e=(v||=new TextEncoder).encode(e);else{let n=0,r=new Uint8Array(3*e.length);for(let s=0;s<e.length;s++){var t=e.charCodeAt(s);if(128>t)r[n++]=t;else{if(2048>t)r[n++]=t>>6|192;else{if(55296<=t&&57343>=t){if(56319>=t&&s<e.length){let i=e.charCodeAt(++s);if(56320<=i&&57343>=i){t=1024*(t-55296)+i-56320+65536,r[n++]=t>>18|240,r[n++]=t>>12&63|128,r[n++]=t>>6&63|128,r[n++]=63&t|128;continue}s--}t=65533}r[n++]=t>>12|224,r[n++]=t>>6&63|128}r[n++]=63&t|128}}e=n===r.length?r:r.subarray(0,n)}return e}var sz,sC,sj=sI(610401301),sN=sI(188588736);let sO=sA.navigator;function sP(e){return!!sj&&!!sC&&sC.brands.some(({brand:t})=>t&&-1!=t.indexOf(e))}function sR(e){var t;return(t=sA.navigator)&&(t=t.userAgent)||(t=""),-1!=t.indexOf(e)}function sM(){return!!sj&&!!sC&&0<sC.brands.length}function sU(){return sM()?sP("Chromium"):(sR("Chrome")||sR("CriOS"))&&!(!sM()&&sR("Edge"))||sR("Silk")}sC=sO&&sO.userAgentData||null;var s$=!sM()&&(sR("Trident")||sR("MSIE"));sR("Android")&&sU(),sU(),sR("Safari")&&(sU()||!sM()&&sR("Coast")||!sM()&&sR("Opera")||!sM()&&sR("Edge")||(sM()?sP("Microsoft Edge"):sR("Edg/"))||sM()&&sP("Opera"));var sL={},sF=null;function sB(){if(!sF){sF={};for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),t=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++){var r=e.concat(t[n].split(""));sL[n]=r;for(var s=0;s<r.length;s++){var i=r[s];void 0===sF[i]&&(sF[i]=s)}}}}var sD="undefined"!=typeof Uint8Array,sq=!s$&&"function"==typeof btoa;function sV(e){if(!sq){void 0===t&&(t=0),sB(),t=sL[t];var t,n=Array(Math.floor(e.length/3)),r=t[64]||"";let l=0,u=0;for(;l<e.length-2;l+=3){var s=e[l],i=e[l+1],o=e[l+2],a=t[s>>2];s=t[(3&s)<<4|i>>4],i=t[(15&i)<<2|o>>6],o=t[63&o],n[u++]=a+s+i+o}switch(a=0,o=r,e.length-l){case 2:o=t[(15&(a=e[l+1]))<<2]||r;case 1:e=e[l],n[u]=t[e>>2]+t[(3&e)<<4|a>>4]+o+r}return n.join("")}for(t="",n=0,r=e.length-10240;n<r;)t+=String.fromCharCode.apply(null,e.subarray(n,n+=10240));return btoa(t+=String.fromCharCode.apply(null,n?e.subarray(n):e))}let sW=/[-_.]/g,sH={"-":"+",_:"/",".":"="};function sG(e){return sH[e]||""}function sZ(e){if(!sq){var t,n,r,s,i;return(r=3*(n=(t=e).length)/4)%3?r=Math.floor(r):-1!="=.".indexOf(t[n-1])&&(r=-1!="=.".indexOf(t[n-2])?r-2:r-1),s=new Uint8Array(r),i=0,function(e,t){function n(t){for(;r<e.length;){var n=e.charAt(r++),s=sF[n];if(null!=s)return s;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return t}sB();for(var r=0;;){var s=n(-1),i=n(0),o=n(64),a=n(64);if(64===a&&-1===s)break;t(s<<2|i>>4),64!=o&&(t(i<<4&240|o>>2),64!=a&&t(o<<6&192|a))}}(t,function(e){s[i++]=e}),i!==r?s.subarray(0,i):s}sW.test(e)&&(e=e.replace(sW,sG));let o=new Uint8Array((e=atob(e)).length);for(let t=0;t<e.length;t++)o[t]=e.charCodeAt(t);return o}function sJ(e){return sD&&null!=e&&e instanceof Uint8Array}var sK={};function sX(e){if(e!==sK)throw Error("illegal external caller")}function sY(){return w||=new sQ(null,sK)}var sQ=class{constructor(e,t){if(sX(t),this.i=e,null!=e&&0===e.length)throw Error("ByteString should be constructed with non-empty values")}};function s0(e){if("string"==typeof e)return{buffer:sZ(e),v:!1};if(Array.isArray(e))return{buffer:new Uint8Array(e),v:!1};if(e.constructor===Uint8Array)return{buffer:e,v:!1};if(e.constructor===ArrayBuffer)return{buffer:new Uint8Array(e),v:!1};if(e.constructor===sQ){sX(sK);var t=e.i;return{buffer:(null==(t=null==t||sJ(t)?t:"string"==typeof t?sZ(t):null)?t:e.i=t)||(_||=new Uint8Array(0)),v:!0}}if(e instanceof Uint8Array)return{buffer:new Uint8Array(e.buffer,e.byteOffset,e.byteLength),v:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}function s1(){return"function"==typeof BigInt}let s2,s6=0,s3=0;function s4(e){let t=0>e,n=(e=Math.abs(e))>>>0;if(e=Math.floor((e-n)/4294967296),t){let[t,r]=s7(n,e);e=r,n=t}s6=n>>>0,s3=e>>>0}function s5(e,t){if(e>>>=0,2097151>=(t>>>=0))var n=""+(4294967296*t+e);else s1()?n=""+(BigInt(t)<<BigInt(32)|BigInt(e)):(e=(16777215&e)+6777216*(n=16777215&(e>>>24|t<<8))+6710656*(t=t>>16&65535),n+=8147497*t,t*=2,1e7<=e&&(n+=Math.floor(e/1e7),e%=1e7),1e7<=n&&(t+=Math.floor(n/1e7),n%=1e7),n=t+s8(n)+s8(e));return n}function s8(e){return e=String(e),"0000000".slice(e.length)+e}function s9(e){if(16>e.length)s4(Number(e));else if(s1())s6=Number((e=BigInt(e))&BigInt(4294967295))>>>0,s3=Number(e>>BigInt(32)&BigInt(4294967295));else{let t=+("-"===e[0]);s3=s6=0;let n=e.length;for(let r=t,s=(n-t)%6+t;s<=n;r=s,s+=6){let t=Number(e.slice(r,s));s3*=1e6,4294967296<=(s6=1e6*s6+t)&&(s3+=Math.trunc(s6/4294967296),s3>>>=0,s6>>>=0)}if(t){let[e,t]=s7(s6,s3);s6=e,s3=t}}}function s7(e,t){return t=~t,e?e=1+~e:t+=1,[e,t]}function ie(e){return e?/^\d+$/.test(e)?(s9(e),new it(s6,s3)):null:x||=new it(0,0)}var it=class{constructor(e,t){this.j=e>>>0,this.i=t>>>0}};function ir(e){return e?/^-?\d+$/.test(e)?(s9(e),new is(s6,s3)):null:k||=new is(0,0)}var is=class{constructor(e,t){this.j=e>>>0,this.i=t>>>0}};function ii(e,t,n){for(;0<n||127<t;)e.i.push(127&t|128),t=(t>>>7|n<<25)>>>0,n>>>=7;e.i.push(t)}function io(e,t){for(;127<t;)e.i.push(127&t|128),t>>>=7;e.i.push(t)}function ia(e,t){if(0<=t)io(e,t);else{for(let n=0;9>n;n++)e.i.push(127&t|128),t>>=7;e.i.push(1)}}function il(e,t){0!==t.length&&(e.l.push(t),e.j+=t.length)}function iu(e,t){return io(e.i,8*t+2),t=e.i.end(),il(e,t),t.push(e.j),t}function ic(e,t){var n=t.pop();for(n=e.j+e.i.length()-n;127<n;)t.push(127&n|128),n>>>=7,e.j++;t.push(n),e.j++}function id(e,t,n){io(e.i,8*t+2),io(e.i,n.length),il(e,e.i.end()),il(e,n)}class ih{constructor(e,t){this.i=e,this.N=t}}function ip(e){return Array.prototype.slice.call(e)}function im(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol()?Symbol():e}var ig=im(),iy=im("2ex"),ib=im("0dg"),iv=ig?(e,t)=>{e[ig]|=t}:(e,t)=>{void 0!==e.i?e.i|=t:Object.defineProperties(e,{i:{value:t,configurable:!0,writable:!0,enumerable:!1}})},i_=ig?(e,t)=>{e[ig]&=~t}:(e,t)=>{void 0!==e.i&&(e.i&=~t)};function iw(e,t,n){return n?e|t:e&~t}var ix=ig?e=>0|e[ig]:e=>0|e.i,ik=ig?e=>e[ig]:e=>e.i,iS=ig?(e,t)=>(e[ig]=t,e):(e,t)=>(void 0!==e.i?e.i=t:Object.defineProperties(e,{i:{value:t,configurable:!0,writable:!0,enumerable:!1}}),e);function iA(e,t){iS(t,-14591&(0|e))}function iI(e,t){iS(t,-14557&(34|e))}function iE(e){return 0==(e=e>>14&1023)?536870912:e}var iT,iz={},iC={};function ij(e){return!(!e||"object"!=typeof e||e.i!==iC)}function iN(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)&&e.constructor===Object}function iO(e,t,n){if(!Array.isArray(e)||e.length)return!1;let r=ix(e);return!!(1&r)||!(!t||!(Array.isArray(t)?t.includes(n):t.has(n)))&&(iS(e,1|r),!0)}let iP=[];function iR(e){if(2&e)throw Error()}function iM(e,t){e.__closure__error__context__984382||(e.__closure__error__context__984382={}),e.__closure__error__context__984382.severity=t}function iU(){let e=Error();iM(e,"incident"),sA.setTimeout(()=>{throw e},0)}function i$(e){return iM(e=Error(e),"warning"),e}function iL(e){if(null!=e&&"number"!=typeof e)throw Error(`Value of float/double field must be a number, found ${typeof e}: ${e}`);return e}iS(iP,55),iT=Object.freeze(iP),Object.freeze(new class{}),Object.freeze(new class{});let iF=/^-?([1-9][0-9]*|0)(\.[0-9]+)?$/;function iB(e){let t=typeof e;return"number"===t?Number.isFinite(e):"string"===t&&iF.test(e)}function iD(e){if("number"!=typeof e||!Number.isFinite(e))throw i$("int32");return 0|e}function iq(e){return null==e?e:iD(e)}function iV(e){if(null==e)return e;if("string"==typeof e){if(!e)return;e=+e}return"number"==typeof e&&Number.isFinite(e)?0|e:void 0}function iW(e){if(null!=e){if("number"!=typeof e||!Number.isFinite(e))throw i$("uint32");e>>>=0}return e}function iH(e){if(null==e)return e;if("string"==typeof e){if(!e)return;e=+e}return"number"==typeof e&&Number.isFinite(e)?e>>>0:void 0}function iG(e){return"-"!==e[0]&&(20>e.length||20===e.length&&184467>Number(e.substring(0,6)))}function iZ(e){return null==e||"string"==typeof e?e:void 0}function iJ(e,t,n){if(null!=e&&"object"==typeof e&&e.K===iz)return e;if(Array.isArray(e)){var r=ix(e),s=r;return 0===s&&(s|=32&n),(s|=2&n)!==r&&iS(e,s),new t(e)}}function iK(e,t,n){if(null==e&&(e=A),A=void 0,null==e){var r=96;n?(e=[n],r|=512):e=[],t&&(r=-16760833&r|(1023&t)<<14)}else{if(!Array.isArray(e))throw Error("narr");if(2048&(r=ix(e)))throw Error("farr");if(64&r)return e;if(r|=64,n&&(r|=512,n!==e[0]))throw Error("mid");e:{let s=(n=e).length;if(s){let e=s-1;if(iN(n[e])){if(1024<=(t=e-(+!!(512&(r|=256))-1)))throw Error("pvtlmt");r=-16760833&r|(1023&t)<<14;break e}}if(t){if(1024<(t=Math.max(t,s-(+!!(512&r)-1))))throw Error("spvt");r=-16760833&r|(1023&t)<<14}}}return iS(e,r),e}function iX(e,t,n,r,s){let i=r||n?ix(e):0;r=r?!!(32&i):void 0,e=ip(e);for(let i=0;i<e.length;i++)e[i]=function e(t,n,r,s,i){if(null!=t){if(Array.isArray(t))t=iO(t,void 0,0)?void 0:i&&2&ix(t)?t:iX(t,n,r,void 0!==s,i);else if(iN(t)){let o={};for(let a in t)o[a]=e(t[a],n,r,s,i);t=o}else t=n(t,s);return t}}(e[i],t,n,r,s);return n&&n(i,e),e}function iY(e){return e.K===iz?e.toJSON():function(e){switch(typeof e){case"number":return isFinite(e)?e:String(e);case"boolean":return e?1:0;case"object":if(e){if(Array.isArray(e)){if(iO(e,void 0,0))return}else{if(sJ(e))return sV(e);if(e instanceof sQ){let t=e.i;return null==t?"":"string"==typeof t?t:e.i=sV(t)}}}}return e}(e)}function iQ(e){let t=e.m,n=ik(t);return 2&n?function e(t,n,r,s){return t=t.constructor,A=n=function(t,n,r){let s=r||2&n?iI:iA,i=!!(32&n);return iv(t=function(e,t,n){var r=(e=ip(e)).length;let s=256&t?e[r-1]:void 0;for(r+=s?-1:0,t=512&t?1:0;t<r;t++)e[t]=n(e[t]);if(s)for(let r in t=e[t]={},s)t[r]=n(s[r]);return e}(t,n,t=>(function t(n,r,s=iI){if(null!=n){if(sD&&n instanceof Uint8Array)return r?n:new Uint8Array(n);if(Array.isArray(n)){var i=ix(n);return 2&i||(r&&=0===i||!!(32&i)&&!(64&i||!(16&i)),n=r?iS(n,-12293&(34|i)):iX(n,t,4&i?iI:s,!0,!0)),n}return n.K===iz&&(n=2&(i=ik(s=n.m))?n:e(n,s,i,!0)),n}})(t,i,s)),32|(r?2:0)),t}(n,r,s),n=new t(n),A=void 0,n}(e,t,n,!1):e}function i0(e,t,n,r){return!(4&t)||null!=n&&(!r&&0===n&&(4096&t||8192&t)&&5>(e.constructor[ib]=1+(0|e.constructor[ib]))&&iU(),0!==n&&!(n&t))}function i1(e){return i6(e=e.m,ik(e),2)}function i2(e,t,n,r){if(!(0>(t=r+(+!!(512&t)-1))||t>=e.length||t>=n))return e[t]}function i6(e,t,n,r){if(-1===n)return null;let s=iE(t);if(!(n>=s)){var i=e.length;return r&&256&t&&null!=(r=e[i-1][n])?(i2(e,t,s,n)&&null!=iy&&(4<=(t=(e=S??={})[iy]||0)||(e[iy]=t+1,iU())),r):i2(e,t,s,n)}return 256&t?e[e.length-1][n]:void 0}function i3(e,t,n){let r=e.m,s=ik(r);return iR(s),i4(r,s,t,n),e}function i4(e,t,n,r,s){let i=iE(t);if(n>=i||s){let o=t;if(256&t)s=e[e.length-1];else{if(null==r)return o;s=e[i+(+!!(512&t)-1)]={},o|=256}return s[n]=r,n<i&&(e[n+(+!!(512&t)-1)]=void 0),o!==t&&iS(e,o),o}return e[n+(+!!(512&t)-1)]=r,256&t&&n in(e=e[e.length-1])&&delete e[n],t}function i5(e,t,n){return Array.isArray(e=i6(e,t,n))?e:iT}function i8(e,t){return 0===e&&(e=or(e,t)),iw(e,1,!0)}function i9(e){return!!(2&e)&&!!(4&e)||!!(2048&e)}function i7(e,t,n){{let a=e.m,l=ik(a);if(iR(l),null==n)i4(a,l,t);else{var r,s=ix(n),i=s,o=!!(2&s)||Object.isFrozen(n);if((r=!o)&&(r=!1),i0(e,s))for(s=21,o&&(n=ip(n),i=0,s=os(s=or(s,l),l,!0)),e=0;e<n.length;e++)n[e]=iD(n[e]);r&&(n=ip(n),i=0,s=os(s=or(s,l),l,!0)),s!==i&&iS(n,s),i4(a,l,t,n)}}}function oe(e,t,n,r){let s=ik(e=e.m);iR(s),i4(e,s,t,("0"===r?0===Number(n):n===r)?void 0:n)}function ot(e,t,n){var r=e.m,s=ik(r),i=i6(r,s,n,!1);return(t=iJ(i,t,s))!==i&&null!=t&&i4(r,s,n,t,!1),null==(r=t)||2&(s=ik(e=e.m))||(i=iQ(r))!==r&&i4(e,s,n,r=i,!1),r}function on(e,t,n){return null==n&&(n=void 0),i3(e,t,n)}function or(e,t){return e=iw(e,2,!!(2&t)),e=iw(e,32,!0),iw(e,2048,!1)}function os(e,t,n){return 32&t&&n||(e=iw(e,32,!1)),e}function oi(e,t,n,r){var s=ik(e=e.m);iR(s);var i=!!(2&s);let o=i?1:2;h&&=!i;var a=ix(i=i5(e,s,t));let l=!!(4&a);if(!l){var u=i,c=s,d=!!(2&(a=i8(a,s)));d&&(c=iw(c,2,!0));let e=!d,t=!0,r=0,o=0;for(;r<u.length;r++){let s=iJ(u[r],n,c);if(s instanceof n){if(!d){let n=!!(2&ix(s.m));e&&=!n,t&&=n}u[o++]=s}}o<r&&(u.length=o),a=iw(a,4,!0),a=iw(a,16,t),iS(u,a=iw(a,8,e)),d&&Object.freeze(u)}if(h&&!(8&a||!i.length&&(1===o||4===o&&32&a))){i9(a)&&(i=ip(i),a=or(a,s),s=i4(e,s,t,i));var h=i;for(u=a,a=0;a<h.length;a++)(c=h[a])!==(d=iQ(c))&&(h[a]=d);u=iw(u,8,!0),u=iw(u,16,!h.length),iS(h,u),a=u}i9(a)||(h=a,(a=(u=1===o||4===o&&!!(32&a))?iw(a,!i.length||16&a&&(!l||32&a)?2:2048,!0):os(a,s,!0))!==h&&iS(i,a),u&&Object.freeze(i)),2===o&&i9(a)&&(iS(i=ip(i),a=os(a=or(a,s),s,!0)),i4(e,s,t,i)),t=i,n=null!=r?r:new n,t.push(n),2&ix(n.m)?i_(t,8):i_(t,16)}function oo(e,t,n){oe(e,t,iq(n),0)}function oa(e,t,n){if(null!=n&&"string"!=typeof n)throw Error();oe(e,t,n,"")}function ol(e,t,n){let r=ik(e=e.m);iR(r);var s=2&r;let i=i6(e,r,t);Array.isArray(i)||(i=iT);let o=!!(32&r),a=ix(i);if(0===a&&o&&!s?iS(i,a|=33):1&a||iS(i,a|=1),s?(2&a||iv(i,34),Object.freeze(i)):(2&a||2048&a)&&(i=ip(i),s=1,o&&(s|=32),iS(i,s),i4(e,r,t,i)),"string"!=typeof n)throw Error();i.push(n)}var ou=class{constructor(e,t){this.m=iK(e,t)}toJSON(){return oc(this,iX(this.m,iY,void 0,void 0,!1),!0)}v(){return!!(2&ix(this.m))}};function oc(e,t,n){let r,s;var i=sN?void 0:e.constructor.A;let o=ik(n?e.m:t);if(!(e=t.length))return t;if(iN(n=t[e-1])){e:{var a=n;let e={},t=!1;for(var l in a){let n=a[l];if(Array.isArray(n)){let e=n;(iO(n,i,+l)||ij(n)&&0===n.size)&&(n=null),n!=e&&(t=!0)}null!=n?e[l]=n:t=!0}if(t){for(var u in e){a=e;break e}a=null}}a!=n&&(r=!0),e--}for(l=+!!(512&o)-1;0<e&&(n=t[u=e-1],u-=l,null==n||iO(n,i,u)||ij(n)&&0===n.size);e--)s=!0;return(r||s)&&(t=Array.prototype.slice.call(t,0,e),a&&t.push(a)),t}function od(e,t){if(Array.isArray(t)){var n=ix(t);if(4&n)return t;for(var r=0,s=0;r<t.length;r++){let n=e(t[r]);null!=n&&(t[s++]=n)}return s<r&&(t.length=s),iS(t,-12289&(5|n)),2&n&&Object.freeze(t),t}}ou.prototype.K=iz,ou.prototype.toString=function(){return oc(this,this.m,!1).toString()};let oh=Symbol(),of=Symbol();function op(e){let t=e[of];if(!t){let n=og(e);t=(e,t)=>ov(e,t,n),e[of]=t}return t}let om=Symbol();function og(e){var t=e[om];if(t)return t;(t=e[om]={}).i=function(e){switch(typeof e){case"boolean":return I||=[0,void 0,!0];case"number":return 0<e?void 0:0===e?E||=[0,void 0]:[-e,void 0];case"string":return[0,e];case"object":return e}}(e[0]);let n=0;var r=e[++n];r&&r.constructor===Object&&(t.R=r,"function"==typeof(r=e[++n])&&(t.l=r,t.j=e[++n],r=e[++n]));let s={};for(;Array.isArray(r)&&"number"==typeof r[0]&&0<r[0];){for(var i=0;i<r.length;i++)s[r[i]]=r;r=e[++n]}for(i=1;void 0!==r;){let c;"number"==typeof r&&(i+=r,r=e[++n]);var o=void 0;if(r instanceof ih?c=r:(c=oB,n--),c.N){r=e[++n],o=e;var a=n;"function"==typeof r&&(r=r(),o[a]=r),o=r}let d=i+1;for("number"==typeof(r=e[++n])&&0>r&&(d-=r,r=e[++n]);i<d;i++){var l=s[i];a=t;var u=i;l=o?function(e,t){let n,r;let s=e.i;return(e,i,o)=>s(e,i,o,r||=og(t).i,n||=op(t))}(c,o):c.i,a[u]=l}}return oy in e&&oh in e&&om in e&&(e.length=0),t}let oy=Symbol();function ob(e,t){var n=e[t];if(n)return n;if((n=e.R)&&(n=n[t])){var r=(n=Array.isArray(n)?n[0]instanceof ih?n:[oF,n]:[n,void 0])[0].i;if(n=n[1]){let t=op(n),s=og(n).i;n=(n=e.j)?n(s,t):(e,n,i)=>r(e,n,i,s,t)}else n=r;return e[t]=n}}function ov(e,t,n){var r=ik(e),s=+!!(512&r)-1,i=e.length,o=512&r?1:0;let a=i+(256&r?-1:0);for(;o<a;o++){let r=e[o];if(null==r)continue;let i=o-s,a=ob(n,i);a&&a(t,r,i)}if(256&r)for(let o in e=e[i-1])Number.isNaN(r=+o)||null!=(s=e[o])&&(i=ob(n,r))&&i(t,s,r)}function o_(e){return new ih(e,!1)}function ow(e,t,n){null!=(t=iV(t))&&null!=t&&(io(e.i,8*n),ia(e.i,t))}function ox(e,t,n){null!=(t=null==t||"boolean"==typeof t?t:"number"==typeof t?!!t:void 0)&&(io(e.i,8*n),e.i.i.push(t?1:0))}function ok(e,t,n){null!=(t=iZ(t))&&id(e,n,sT(t))}function oS(e,t,n,r,s){null!=(t=t instanceof ou?t.m:Array.isArray(t)?iK(t,r[0],r[1]):void 0)&&(n=iu(e,n),s(t,e),ic(e,n))}function oA(e,t,n){null!=(t=iV(t))&&(t=parseInt(t,10),io(e.i,8*n),ia(e.i,t))}var oI,oE=o_(function(e,t,n){null!=(t=null==t||"number"==typeof t?t:"NaN"===t||"Infinity"===t||"-Infinity"===t?Number(t):void 0)&&(io(e.i,8*n+5),e=e.i,(n=s2||=new DataView(new ArrayBuffer(8))).setFloat32(0,+t,!0),s3=0,t=s6=n.getUint32(0,!0),e.i.push(t>>>0&255),e.i.push(t>>>8&255),e.i.push(t>>>16&255),e.i.push(t>>>24&255))}),oT=o_(function(e,t,n){e:if(null!=t){if(iB(t)){if("string"==typeof t){var r=Math.trunc(Number(t));if(Number.isSafeInteger(r))t=String(r);else if(-1!==(r=t.indexOf("."))&&(t=t.substring(0,r)),!("-"===t[0]?20>t.length||20===t.length&&-922337<Number(t.substring(0,7)):19>t.length||19===t.length&&922337>Number(t.substring(0,6)))){if(s9(t),t=s6,2147483648&(r=s3)){if(s1())t=""+(BigInt(0|r)<<BigInt(32)|BigInt(t>>>0));else{let[e,n]=s7(t,r);t="-"+s5(e,n)}}else t=s5(t,r)}break e}if("number"==typeof t){if(!Number.isSafeInteger(t=Math.trunc(t))){s4(t),r=s6;var s=s3;(t=2147483648&s)&&(s=~s>>>0,0==(r=1+~r>>>0)&&(s=s+1>>>0)),r=4294967296*s+(r>>>0),t=t?-r:r}break e}}t=void 0}null!=t&&("string"==typeof t&&ir(t),null!=t&&(io(e.i,8*n),"number"==typeof t?(e=e.i,s4(t),ii(e,s6,s3)):(n=ir(t),ii(e.i,n.j,n.i))))}),oz=o_(function(e,t,n){e:if(null!=t){if(iB(t)){if("string"==typeof t){var r=Math.trunc(Number(t));Number.isSafeInteger(r)&&0<=r?t=String(r):(-1!==(r=t.indexOf("."))&&(t=t.substring(0,r)),iG(t)||(s9(t),t=s5(s6,s3)));break e}if("number"==typeof t){t=0<=(t=Math.trunc(t))&&Number.isSafeInteger(t)?t:function(e){if(0>e){s4(e);let t=s5(s6,s3);return Number.isSafeInteger(e=Number(t))?e:t}return iG(String(e))?e:(s4(e),4294967296*s3+(s6>>>0))}(t);break e}}t=void 0}null!=t&&("string"==typeof t&&ie(t),null!=t&&(io(e.i,8*n),"number"==typeof t?(e=e.i,s4(t),ii(e,s6,s3)):(n=ie(t),ii(e.i,n.j,n.i))))}),oC=o_(ow),oj=new ih(function(e,t,n){if(null!=(t=od(iV,t))&&t.length){n=iu(e,n);for(let n=0;n<t.length;n++)ia(e.i,t[n]);ic(e,n)}},!1),oN=o_(ow),oO=o_(ow),oP=o_(ox),oR=o_(ox),oM=new ih(function(e,t,n){if(null!=(t=od(iZ,t)))for(let s=0;s<t.length;s++){var r=t[s];null!=r&&id(e,n,sT(r))}},!1),oU=o_(ok),o$=o_(ok),oL=o_(ok),oF=new ih(oS,!0),oB=new ih(oS,!0);oI=new ih(function(e,t,n,r,s){if(Array.isArray(t))for(let i=0;i<t.length;i++)oS(e,t[i],n,r,s)},!0);var oD=new ih(oS,!0),oq=o_(oA),oV=new ih(function(e,t,n){if(null!=(t=od(iV,t))&&t.length){n=iu(e,n);for(let n=0;n<t.length;n++)ia(e.i,t[n]);ic(e,n)}},!1),oW=o_(oA);function oH(e){return function(){let t=new class{constructor(){this.l=[],this.j=0,this.i=new class{constructor(){this.i=[]}length(){return this.i.length}end(){let e=this.i;return this.i=[],e}}}};ov(this.m,t,og(e)),il(t,t.i.end());let n=new Uint8Array(t.j),r=t.l,s=r.length,i=0;for(let e=0;e<s;e++){let t=r[e];n.set(t,i),i+=t.length}return t.l=[n],n}}function oG(e,t){if(null!=t){if(Array.isArray(t))i3(e,2,iX(t,iY,void 0,void 0,!1));else{if(!("string"==typeof t||t instanceof sQ||sJ(t)))throw Error("invalid value in Any.value field: "+t+" expected a ByteString, a base64 encoded string, a Uint8Array or a jspb array");if(null!=t){if("string"==typeof t)t=t?new sQ(t,sK):sY();else if(t.constructor!==sQ){if(!sJ(t))throw Error();t=t.length?new sQ(new Uint8Array(t),sK):sY()}}oe(e,2,t,sY())}}}var oZ=class extends ou{constructor(e){super(e)}},oJ=[0,oU,o_(function(e,t,n){if(null!=t){if(t instanceof ou){let r=t.Y;return void(r&&null!=(t=r(t))&&id(e,n,s0(t).buffer))}if(Array.isArray(t))return}null!=(t=null==t||"string"==typeof t||sJ(t)||t instanceof sQ?t:void 0)&&id(e,n,s0(t).buffer)})],oK={};oK[336783863]=[0,oL,oP,-1,oC,[0,[1,2,3,4,5,6],oD,[0],oD,[0,oP,oL,oP,oq,-1,oV,oL,-1,[0,oP,-1],oq],oD,[0,oL,-2],oD,[0,oC,oP,-4],oD,[0,oC,oq,oP,-1,oj,oq,-1],oD,[0,oL]],[0,oL],oP,[0,[1,3],[2,4],oD,[0,oj],-1,oD,[0,oM],-1,oI,[0,oL,-1]],oL];var oX=class extends ou{constructor(e){super(e)}},oY=[0,oU,oR],oQ=[0,oT,-1,oR,-3,oT,oj,oU,oN,oT,-1,oR,oN,oR,-2,oU],o0=[-1,{}],o1=[0,oL,1,o0],o2=[0,oL,oM,o0],o6=class extends ou{constructor(e){super(e,500)}J(e){return on(this,7,e)}};o6.A=[3,4,5,6,8,13,17,1005];var o3=[-500,oU,-1,oM,-3,[-2,oK,oP],oI,oJ,oN,-1,o1,o2,oI,oY,oU,oQ,oN,oM,987,oM],o4=[0,oU,-1,o0],o5=[-500,oL,-1,[-1,{}],998,oL],o8=[-500,oL,oM,-1,[-2,{},oP],997,oM,-1],o9=[-500,oL,oM,o0,998,oM];function o7(e,t){oi(e,1,o6,t)}var ae=class extends ou{constructor(){super(void 0,500)}J(e){return on(this,1001,e)}};ae.A=[1,6,7,9,10,15,16,17,14,1002],ae.prototype.i=oH([-500,oI,o3,4,oI,o5,oI,o8,oN,oI,o9,oM,oN,o1,o2,oI,o4,oM,-2,oQ,oU,-1,oR,979,o0,oI,oJ]);var at=class extends ou{constructor(e){super(e)}};let an=new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11]);async function ar(){if(void 0===T)try{await WebAssembly.instantiate(an),T=!0}catch{T=!1}return T}async function as(e,t=""){let n=await ar()?"wasm_internal":"wasm_nosimd_internal";return{wasmLoaderPath:`${t}/${e}_${n}.js`,wasmBinaryPath:`${t}/${e}_${n}.wasm`}}var ai=class{};async function ao(e){if("function"!=typeof importScripts){let t=document.createElement("script");return t.src=e.toString(),t.crossOrigin="anonymous",new Promise((e,n)=>{t.addEventListener("load",()=>{e()},!1),t.addEventListener("error",e=>{n(e)},!1),document.body.appendChild(t)})}importScripts(e.toString())}function aa(e,t,n){e.o||console.error("No wasm multistream support detected: ensure dependency inclusion of :gl_graph_runner_internal_multi_input target"),n(t=e.h.stringToNewUTF8(t)),e.h._free(t)}function al(e,t,n){e.o||console.error("No wasm multistream support detected: ensure dependency inclusion of :gl_graph_runner_internal_multi_input target");let r=new Uint32Array(t.length);for(let n=0;n<t.length;n++)r[n]=e.h.stringToNewUTF8(t[n]);for(let s of(t=e.h._malloc(4*r.length),e.h.HEAPU32.set(r,t>>2),n(t),r))e.h._free(s);e.h._free(t)}function au(e,t,n){e.h.simpleListeners=e.h.simpleListeners||{},e.h.simpleListeners[t]=n}function ac(e,t,n){let r=[];e.h.simpleListeners=e.h.simpleListeners||{},e.h.simpleListeners[t]=(e,t,s)=>{t?(n(r,s),r=[]):r.push(e)}}ai.forVisionTasks=function(e){return as("vision",e)},ai.forTextTasks=function(e){return as("text",e)},ai.forGenAiExperimentalTasks=function(e){return as("genai_experimental",e)},ai.forGenAiTasks=function(e){return as("genai",e)},ai.forAudioTasks=function(e){return as("audio",e)},ai.isSimdSupported=function(){return ar()};let ad=(N=class{constructor(e,t){var n;this.l=!0,this.h=e,this.i=null,this.j=0,this.o="function"==typeof this.h._addIntToInputStream,void 0!==t?this.h.canvas=t:(n=navigator,"undefined"!=typeof OffscreenCanvas&&(!function(e=navigator){return(e=e.userAgent).includes("Safari")&&!e.includes("Chrome")}(n)||(n=n.userAgent.match(/Version\/([\d]+).*Safari/))&&1<=n.length&&17<=Number(n[1])))?this.h.canvas=new OffscreenCanvas(1,1):(console.warn("OffscreenCanvas not supported and GraphRunner constructor glCanvas parameter is undefined. Creating backup canvas."),this.h.canvas=document.createElement("canvas"))}async initializeGraph(e){let t=await (await fetch(e)).arrayBuffer();e=!(e.endsWith(".pbtxt")||e.endsWith(".textproto")),this.setGraph(new Uint8Array(t),e)}setGraphFromString(e){this.setGraph((new TextEncoder).encode(e),!1)}setGraph(e,t){let n=e.length,r=this.h._malloc(n);this.h.HEAPU8.set(e,r),t?this.h._changeBinaryGraph(n,r):this.h._changeTextGraph(n,r),this.h._free(r)}configureAudio(e,t,n,r,s){this.h._configureAudio||console.warn('Attempting to use configureAudio without support for input audio. Is build dep ":gl_graph_runner_audio" missing?'),aa(this,r||"input_audio",r=>{aa(this,s=s||"audio_header",s=>{this.h._configureAudio(r,s,e,t,n)})})}setAutoResizeCanvas(e){this.l=e}setAutoRenderToScreen(e){this.h._setAutoRenderToScreen(e)}setGpuBufferVerticalFlip(e){this.h.gpuOriginForWebTexturesIsBottomLeft=e}attachErrorListener(e){this.h.errorListener=e}attachEmptyPacketListener(e,t){this.h.emptyPacketListeners=this.h.emptyPacketListeners||{},this.h.emptyPacketListeners[e]=t}addAudioToStream(e,t,n){this.addAudioToStreamWithShape(e,0,0,t,n)}addAudioToStreamWithShape(e,t,n,r,s){let i=4*e.length;this.j!==i&&(this.i&&this.h._free(this.i),this.i=this.h._malloc(i),this.j=i),this.h.HEAPF32.set(e,this.i/4),aa(this,r,e=>{this.h._addAudioToInputStream(this.i,t,n,e,s)})}addGpuBufferToStream(e,t,n){aa(this,t,t=>{if(!this.h.canvas)throw Error("No OpenGL canvas configured.");t?this.h._bindTextureToStream(t):this.h._bindTextureToCanvas();let r=this.h.canvas.getContext("webgl2")||this.h.canvas.getContext("webgl");if(!r)throw Error("Failed to obtain WebGL context from the provided canvas. `getContext()` should only be invoked with `webgl` or `webgl2`.");this.h.gpuOriginForWebTexturesIsBottomLeft&&r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!0),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,e),this.h.gpuOriginForWebTexturesIsBottomLeft&&r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!1);let[s,i]=void 0!==e.videoWidth?[e.videoWidth,e.videoHeight]:void 0!==e.naturalWidth?[e.naturalWidth,e.naturalHeight]:void 0!==e.displayWidth?[e.displayWidth,e.displayHeight]:[e.width,e.height];this.l&&(s!==this.h.canvas.width||i!==this.h.canvas.height)&&(this.h.canvas.width=s,this.h.canvas.height=i);let[o,a]=[s,i];this.h._addBoundTextureToStream(t,o,a,n)})}addBoolToStream(e,t,n){aa(this,t,t=>{this.h._addBoolToInputStream(e,t,n)})}addDoubleToStream(e,t,n){aa(this,t,t=>{this.h._addDoubleToInputStream(e,t,n)})}addFloatToStream(e,t,n){aa(this,t,t=>{this.h._addFloatToInputStream(e,t,n)})}addIntToStream(e,t,n){aa(this,t,t=>{this.h._addIntToInputStream(e,t,n)})}addUintToStream(e,t,n){aa(this,t,t=>{this.h._addUintToInputStream(e,t,n)})}addStringToStream(e,t,n){aa(this,t,t=>{aa(this,e,e=>{this.h._addStringToInputStream(e,t,n)})})}addStringRecordToStream(e,t,n){aa(this,t,t=>{al(this,Object.keys(e),r=>{al(this,Object.values(e),s=>{this.h._addFlatHashMapToInputStream(r,s,Object.keys(e).length,t,n)})})})}addProtoToStream(e,t,n,r){aa(this,n,n=>{aa(this,t,t=>{let s=this.h._malloc(e.length);this.h.HEAPU8.set(e,s),this.h._addProtoToInputStream(s,e.length,t,n,r),this.h._free(s)})})}addEmptyPacketToStream(e,t){aa(this,e,e=>{this.h._addEmptyPacketToInputStream(e,t)})}addBoolVectorToStream(e,t,n){aa(this,t,t=>{let r=this.h._allocateBoolVector(e.length);if(!r)throw Error("Unable to allocate new bool vector on heap.");for(let t of e)this.h._addBoolVectorEntry(r,t);this.h._addBoolVectorToInputStream(r,t,n)})}addDoubleVectorToStream(e,t,n){aa(this,t,t=>{let r=this.h._allocateDoubleVector(e.length);if(!r)throw Error("Unable to allocate new double vector on heap.");for(let t of e)this.h._addDoubleVectorEntry(r,t);this.h._addDoubleVectorToInputStream(r,t,n)})}addFloatVectorToStream(e,t,n){aa(this,t,t=>{let r=this.h._allocateFloatVector(e.length);if(!r)throw Error("Unable to allocate new float vector on heap.");for(let t of e)this.h._addFloatVectorEntry(r,t);this.h._addFloatVectorToInputStream(r,t,n)})}addIntVectorToStream(e,t,n){aa(this,t,t=>{let r=this.h._allocateIntVector(e.length);if(!r)throw Error("Unable to allocate new int vector on heap.");for(let t of e)this.h._addIntVectorEntry(r,t);this.h._addIntVectorToInputStream(r,t,n)})}addUintVectorToStream(e,t,n){aa(this,t,t=>{let r=this.h._allocateUintVector(e.length);if(!r)throw Error("Unable to allocate new unsigned int vector on heap.");for(let t of e)this.h._addUintVectorEntry(r,t);this.h._addUintVectorToInputStream(r,t,n)})}addStringVectorToStream(e,t,n){aa(this,t,t=>{let r=this.h._allocateStringVector(e.length);if(!r)throw Error("Unable to allocate new string vector on heap.");for(let t of e)aa(this,t,e=>{this.h._addStringVectorEntry(r,e)});this.h._addStringVectorToInputStream(r,t,n)})}addBoolToInputSidePacket(e,t){aa(this,t,t=>{this.h._addBoolToInputSidePacket(e,t)})}addDoubleToInputSidePacket(e,t){aa(this,t,t=>{this.h._addDoubleToInputSidePacket(e,t)})}addFloatToInputSidePacket(e,t){aa(this,t,t=>{this.h._addFloatToInputSidePacket(e,t)})}addIntToInputSidePacket(e,t){aa(this,t,t=>{this.h._addIntToInputSidePacket(e,t)})}addUintToInputSidePacket(e,t){aa(this,t,t=>{this.h._addUintToInputSidePacket(e,t)})}addStringToInputSidePacket(e,t){aa(this,t,t=>{aa(this,e,e=>{this.h._addStringToInputSidePacket(e,t)})})}addProtoToInputSidePacket(e,t,n){aa(this,n,n=>{aa(this,t,t=>{let r=this.h._malloc(e.length);this.h.HEAPU8.set(e,r),this.h._addProtoToInputSidePacket(r,e.length,t,n),this.h._free(r)})})}addBoolVectorToInputSidePacket(e,t){aa(this,t,t=>{let n=this.h._allocateBoolVector(e.length);if(!n)throw Error("Unable to allocate new bool vector on heap.");for(let t of e)this.h._addBoolVectorEntry(n,t);this.h._addBoolVectorToInputSidePacket(n,t)})}addDoubleVectorToInputSidePacket(e,t){aa(this,t,t=>{let n=this.h._allocateDoubleVector(e.length);if(!n)throw Error("Unable to allocate new double vector on heap.");for(let t of e)this.h._addDoubleVectorEntry(n,t);this.h._addDoubleVectorToInputSidePacket(n,t)})}addFloatVectorToInputSidePacket(e,t){aa(this,t,t=>{let n=this.h._allocateFloatVector(e.length);if(!n)throw Error("Unable to allocate new float vector on heap.");for(let t of e)this.h._addFloatVectorEntry(n,t);this.h._addFloatVectorToInputSidePacket(n,t)})}addIntVectorToInputSidePacket(e,t){aa(this,t,t=>{let n=this.h._allocateIntVector(e.length);if(!n)throw Error("Unable to allocate new int vector on heap.");for(let t of e)this.h._addIntVectorEntry(n,t);this.h._addIntVectorToInputSidePacket(n,t)})}addUintVectorToInputSidePacket(e,t){aa(this,t,t=>{let n=this.h._allocateUintVector(e.length);if(!n)throw Error("Unable to allocate new unsigned int vector on heap.");for(let t of e)this.h._addUintVectorEntry(n,t);this.h._addUintVectorToInputSidePacket(n,t)})}addStringVectorToInputSidePacket(e,t){aa(this,t,t=>{let n=this.h._allocateStringVector(e.length);if(!n)throw Error("Unable to allocate new string vector on heap.");for(let t of e)aa(this,t,e=>{this.h._addStringVectorEntry(n,e)});this.h._addStringVectorToInputSidePacket(n,t)})}attachBoolListener(e,t){au(this,e,t),aa(this,e,e=>{this.h._attachBoolListener(e)})}attachBoolVectorListener(e,t){ac(this,e,t),aa(this,e,e=>{this.h._attachBoolVectorListener(e)})}attachIntListener(e,t){au(this,e,t),aa(this,e,e=>{this.h._attachIntListener(e)})}attachIntVectorListener(e,t){ac(this,e,t),aa(this,e,e=>{this.h._attachIntVectorListener(e)})}attachUintListener(e,t){au(this,e,t),aa(this,e,e=>{this.h._attachUintListener(e)})}attachUintVectorListener(e,t){ac(this,e,t),aa(this,e,e=>{this.h._attachUintVectorListener(e)})}attachDoubleListener(e,t){au(this,e,t),aa(this,e,e=>{this.h._attachDoubleListener(e)})}attachDoubleVectorListener(e,t){ac(this,e,t),aa(this,e,e=>{this.h._attachDoubleVectorListener(e)})}attachFloatListener(e,t){au(this,e,t),aa(this,e,e=>{this.h._attachFloatListener(e)})}attachFloatVectorListener(e,t){ac(this,e,t),aa(this,e,e=>{this.h._attachFloatVectorListener(e)})}attachStringListener(e,t){au(this,e,t),aa(this,e,e=>{this.h._attachStringListener(e)})}attachStringVectorListener(e,t){ac(this,e,t),aa(this,e,e=>{this.h._attachStringVectorListener(e)})}attachProtoListener(e,t,n){au(this,e,t),aa(this,e,e=>{this.h._attachProtoListener(e,n||!1)})}attachProtoVectorListener(e,t,n){ac(this,e,t),aa(this,e,e=>{this.h._attachProtoVectorListener(e,n||!1)})}attachAudioListener(e,t,n){this.h._attachAudioListener||console.warn('Attempting to use attachAudioListener without support for output audio. Is build dep ":gl_graph_runner_audio_out" missing?'),au(this,e,(e,n)=>{t(e=new Float32Array(e.buffer,e.byteOffset,e.length/4),n)}),aa(this,e,e=>{this.h._attachAudioListener(e,n||!1)})}finishProcessing(){this.h._waitUntilIdle()}closeGraph(){this.h._closeGraph(),this.h.simpleListeners=void 0,this.h.emptyPacketListeners=void 0}},class extends N{V(){this.h._registerModelResourcesGraphService()}});async function ah(e,t){let n=await (async(e,t,n)=>{if(e&&await ao(e),!self.ModuleFactory||t&&(await ao(t),!self.ModuleFactory))throw Error("ModuleFactory not set.");return self.Module&&n&&((e=self.Module).locateFile=n.locateFile,n.mainScriptUrlOrBlob&&(e.mainScriptUrlOrBlob=n.mainScriptUrlOrBlob)),n=await self.ModuleFactory(self.Module||n),self.ModuleFactory=self.Module=void 0,new aW(n,null)})(e.wasmLoaderPath,e.assetLoaderPath,{locateFile:t=>t.endsWith(".wasm")?e.wasmBinaryPath.toString():e.assetBinaryPath&&t.endsWith(".data")?e.assetBinaryPath.toString():t});return await n.J(t),n}async function af(e,t){return ah(e,t)}function ap(e){try{let t=e.D.length;if(1===t)throw Error(e.D[0].message);if(1<t)throw Error("Encountered multiple errors: "+e.D.map(e=>e.message).join(", "))}finally{e.D=[]}}function am(e,t){e.B=Math.max(e.B,t)}var ag=class{constructor(e){this.i=e,this.D=[],this.B=0,this.i.setAutoRenderToScreen(!1)}setGraph(e,t){this.i.attachErrorListener((e,t)=>{this.D.push(Error(t))}),this.i.V(),this.i.setGraph(e,t),ap(this)}finishProcessing(){this.i.finishProcessing(),ap(this)}close(){this.i.closeGraph()}};ag.prototype.close=ag.prototype.close;var ay=class extends ou{constructor(e){super(e)}},ab=[0,oW,oN,oE,-1,oC],av=class extends ou{constructor(){super()}};av.A=[4];class a_{constructor(e){this.i=[],this.data=e,this.length=e.length}}var aw=class{constructor(e,t,n){this.i=e,this.j=t,this.l=n}get size(){let e=0;for(let t=0;t<this.i.length;t++)e+=this.i[t].length;return e}};function ax(e){if(e.i)try{e.h._free(e.j)}catch{}finally{e.i=!1}}var ak=class{constructor(e,t){this.h=e,this.l=t,this.j=this.h._malloc(t)>>>0,this.o=this.h.HEAPU8,this.i=!!this.j}get offset(){if(!this.i)throw Error("WasmFileReference has been freed.");return this.j}get size(){if(!this.i)throw Error("WasmFileReference has been freed.");return this.l}set(e,t){this.o.set(e,this.j+(t??0))}},aS=class extends ou{constructor(){super()}};aS.A=[4],aS.prototype.i=oH([0,oU,2,oM,oN]);var aA=class extends ou{constructor(){super()}},aI=[0,oR,-5],aE=[0,oU,oz,-1,oW],aT=class extends ou{constructor(){super()}},az=[0,oN,-6,1,oN,1,[0,oR,oW,-2],[0,oR,oE],oW,-2,[0,oR,-1,oW,oE,oq],1,oR],aC=class extends ou{constructor(){super()}};aC.A=[5,7];var aj=[0,[4,6],az,oN,1,oO,oM,o$,oV],aN=[0,oI,aE,aj,oN],aO=[0,oN,oR,-1],aP=class extends ou{constructor(){super()}};aP.A=[29],aP.prototype.i=oH([0,oU,8,aI,1,oN,1,oN,aN,aO,1,oW,oU,aj,aN,oN,5,oW,oj,1,ab]);var aR=class extends ou{constructor(){super()}},aM=class extends ou{constructor(){super()}},aU=[2,4];aM.prototype.i=oH([0,aU,oN,o$,oN,oD,[0,1,oU]]);let a$=(z=class extends ad{},C=class extends z{O(e,t){aa(this,"lora_model_ref_in",n=>{this.h._addRawDataSpanToInputStream(e.offset,e.size,n,t)})}},j=class extends C{addStreamingReaderToInputSidePacket(e,t){this.h.addStreamingReaderToInputSidePacket((t,n,r)=>(async function(e,t,n,r,s){if(2===s)return e.i=[],e.j=()=>Promise.resolve(void 0),e.l(),Promise.resolve(0);for(;e.size<n+r;){var i=await e.j();if(void 0===i)break;e.i.push(new a_(i))}if(e.size<n+r)throw Error(`Data size is too small: ${e.size}, expected at least ${n+r}.`);i=t._malloc(r)>>>0;let o=0;for(let a=0;a<e.i.length;a++){let l=e.i[a];if(n>=l.length){n-=l.length;continue}let u=Math.min(r,l.length-n);if(void 0===(n=function(e,t,n,r){if(void 0!==e.data){var s=new Uint8Array(e.data.buffer,t,n);return 1===r&&function(e,t,n){for(let[r,s]of(e.i.push([t,n]),e.i.sort((e,t)=>e[0]-t[0]),t=0,e.i))(n=r)<=t&&(t=Math.max(t,n+s));t===e.length&&(e.data=void 0)}(e,t,n),s}}(l,n,u,s)))throw Error("Data has already been released.");if(t.HEAPU8.set(n,i+o),n=0,o+=u,0==(r-=u))break}if(0!==r)throw Error("Data not found.");return Promise.resolve(i)})(e,this.h,t,n,r),t)}},class e extends j{static async W(t,n){let r;n||=await e.M();let s=[];for(let e of t?.requiredFeatures??[])n.features.has(e)?s.push(e):console.warn(`WebGPU feature ${e} is not supported.`);t={...t,requiredFeatures:s};try{r=await n.requestDevice(t)}catch(e){throw console.error("Unable to initialize WebGPU with the requested features."),e}return n=await n.requestAdapterInfo(),r.adapterInfo=n,r}static async M(e){if(!(e=await navigator.gpu.requestAdapter(e)))throw Error("Unable to request adapter from navigator.gpu; Ensure WebGPU is enabled.");return e}T(e){if(t)"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement&&(t.id="canvas_webgpu");else var t=new OffscreenCanvas(1,1);t.getContext("webgpu").configure({device:e,format:navigator.gpu.getPreferredCanvasFormat()}),this.h.preinitializedWebGPUDevice=e}P(){return this.h.ccall("closeGraph","void",[],[],{async:!0})}});class aL extends a${}var aF=class{constructor(e){this.j=e,this.i=aB,aB++}},aB=0;class aD{constructor(){let e,t;this.promise=new Promise((n,r)=>{e=n,t=r}),this.i=e,this.j=t}}async function aq(){let e=await aL.M({powerPreference:"high-performance"});var t=e.limits.maxBufferSize;if(524550144>e.limits.maxStorageBufferBindingSize)throw Error(`The WebGPU device is unable to execute LLM tasks, because the required maxStorageBufferBindingSize is at least 524550144 but your device only supports maxStorageBufferBindingSize of ${t}`);if(786825216<=t)t=786825216;else{if(!(524550144<=t))throw Error(`The WebGPU device is unable to execute LLM tasks, because the required maxBufferSize is at least 524550144 but your device only supports maxBufferSize of ${t}`);t=524550144}return aL.W({requiredFeatures:["shader-f16"],requiredLimits:{maxStorageBufferBindingSize:524550144,maxBufferSize:t}},e)}function aV(e){if(0<e.C.length){let t=[...e.C];if(e.C.length=0,!e.o)throw t;e.o.j(t),e.o=void 0}}var aW=class extends ag{constructor(e,t){if(super(new aL(e,t)),this.G=[],this.j=!1,this.C=[],this.F=e=>{let t=(e=e.error).message.match(/exceeds the max buffer size limit \(([0-9]+)\)\./);t&&524550144<Number(t[1])?e=Error(`Failed to run this LLM model, but you could try a smaller LLM model. WebGPU throws: "${e.message}"`):e.message.match(/is larger than the maximum binding size/)&&(e=Error(`Failed to run LLM inference, the supported max binding size is smaller than the required size. WebGPU throws: "${e.message}"`)),this.C.push(e)},this.l=new av,on(this.l,1,new at),this.s=new ay,on(this.l,3,this.s),i3(this.l,2,iW(512)),e=this.s,!Number.isFinite(2))throw i$("enum");oe(e,1,2,0),oo(this.s,2,1),oe(this.s,3,iL(1),0),oe(this.s,4,iL(1),0)}J(e){var t,n,r;let s;if(this.j)throw Error("Cannot set options while loading or processing.");this.j=!0,e.baseOptions?.gpuOptions?.device&&(this.u&&this.u.removeEventListener("uncapturederror",this.F),this.u=e.baseOptions.gpuOptions.device,this.i.T(this.u),this.u.addEventListener("uncapturederror",this.F)),"maxTokens"in e&&i3(this.l,2,iW(e.maxTokens??512)),"topK"in e&&(oo(this.s,2,e.topK??1),e.topK&&!e.randomSeed&&console.warn("'topK' option ignored; it requires randomSeed to be set.")),"temperature"in e&&(oe(this.s,4,iL(e.temperature??1),0),e.temperature&&!e.randomSeed&&console.warn("'temperature' option ignored; it requires randomSeed to be set.")),e.randomSeed&&i3(this.s,5,iq(e.randomSeed)),"loraRanks"in e&&i7(this.l,4,e.loraRanks??[]);let i=new Promise(e=>{s=e});if(e.baseOptions?.modelAssetPath||e.baseOptions?.modelAssetBuffer){if(e.baseOptions.modelAssetPath&&e.baseOptions.modelAssetBuffer)throw Error("Cannot set both baseOptions.modelAssetPath and baseOptions.modelAssetBuffer");let i=!1;e.baseOptions.modelAssetPath?this.H=function(e,t){let n=fetch(e.toString()).then(e=>e?.body?.getReader());return new aw([],async()=>{let t;try{t=await n}catch(t){throw Error(`Error loading model from "${e.toString()}": ${t}`)}let{value:r,done:s}=await t.read();if(!s)return r},t)}(e.baseOptions.modelAssetPath,s):e.baseOptions.modelAssetBuffer instanceof Uint8Array?(this.H=(t=e.baseOptions.modelAssetBuffer,n=s,new aw([new a_(t)],()=>Promise.resolve(void 0),n)),i=!0):e.baseOptions.modelAssetBuffer?(this.H=(r=e.baseOptions.modelAssetBuffer,new aw([],async()=>{let{value:e,done:t}=await r.read();if(!t)return e},s)),i=!0):s(),i&&(e.baseOptions.modelAssetBuffer=void 0)}return Promise.all([i,e=(function(e){let t=function(e){let t=new ae;ol(t,10,"text_in"),ol(t,10,"token_cost_in"),ol(t,10,"lora_model_id_to_apply_in"),ol(t,10,"lora_model_ref_in"),ol(t,10,"lora_model_id_to_load_in"),ol(t,16,"streaming_reader"),ol(t,15,"text_out"),ol(t,15,"text_end"),ol(t,15,"token_cost_out");var n=new o6;oa(n,2,"TokenizerInputBuildCalculator"),ol(n,3,"PROMPT:text_in"),ol(n,3,"LORA_ID:lora_model_id_to_apply_in"),ol(n,4,"prompt"),o7(t,n),oa(n=new o6,2,"ModelDataCalculator"),ol(n,6,"MODEL_DATA:__side_packet_1"),ol(n,6,"MODEL_TYPE:model_type"),ol(n,5,"READ_DATA_FN:streaming_reader"),ol(n,3,"LORA_MODEL_SPAN:lora_model_ref_in"),ol(n,3,"LORA_MODEL_ID:lora_model_id_to_load_in"),ol(n,4,"LORA_DATA:lora_model_data"),o7(t,n),oa(n=new o6,2,"Gpt2UnicodeMappingCalculator"),ol(n,5,"MODEL_TYPE:model_type"),ol(n,6,"BYTES_TO_UNICODE_MAPPING:tokenizer_mapping"),o7(t,n),oa(n=new oZ,1,"type.googleapis.com/odml.infra.proto.TokenizerCalculatorOptions");var r=new aM,s=iH(i1(e.l))??0;oo(r,1,s),oa(s=new aR,2,"spm_vocab_model"),null==s&&(s=void 0);var i=r.m,o=ik(i);iR(o);for(var a=o,l=0,u=0;u<aU.length;u++){var c=aU[u];null!=i6(i,a,c)&&(0!==l&&(a=i4(i,a,l)),l=c)}if((a=l)&&4!==a&&null!=s&&(o=i4(i,o,a)),i4(i,o,4,s),oo(r,3,2),oG(n,r.i()),oa(r=new o6,2,"TokenizerCalculator"),oi(r,8,oZ,n),ol(r,5,"MODEL_DATA:__side_packet_1"),ol(r,3,"PROMPT_AND_INPUT_OPTIONS:prompt"),ol(r,5,"BYTES_TO_UNICODE_MAPPING:tokenizer_mapping"),ol(r,6,"PROCESSOR_GETTER:__input_side_1"),ol(r,4,"IDS_AND_INPUT_OPTIONS:__stream_0"),o7(t,r),oa(n=new oZ,1,"type.googleapis.com/odml.infra.proto.LlmGpuCalculatorOptions"),oo(r=new aP,12,3),oa(r,1,"llm.tflite"),oo(r,14,0),oo(r,22,1),on(r,31,s=ot(e.l,ay,3)),oe(s=new aA,1,!0,!1),oe(s,2,!0,!1),oe(s,5,!0,!1),on(r,10,s),o=2&(i=ik(s=(u=e.l).m))?1:2,i0(u,l=ix(a=i5(s,i,4)),void 0,!1)){for((4&l||Object.isFrozen(a))&&(a=ip(a),l=or(l,i),i=i4(s,i,4,a)),c=u=0;u<a.length;u++){let e=iV(a[u]);null!=e&&(a[c++]=e)}c<u&&(a.length=c),l=iw(l=i8(l,i),20,!0),l=iw(l,4096,!1),iS(a,l=iw(l,8192,!1)),2&l&&Object.freeze(a)}return i9(l)||(u=l,(l=(c=1===o||4===o&&!!(32&l))?iw(l,2,!0):os(l,i,!1))!==u&&iS(a,l),c&&Object.freeze(a)),2===o&&i9(l)&&(iS(a=ip(a),l=os(l=or(l,i),i,!1)),i4(s,i,4,a)),i7(r,29,a),s=new aC,oo(i=new aT,1,1),oo(i,2,e=iH(i1(e.l))??0),on(s,1,i),on(r,20,s),oG(n,r.i()),oa(e=new o6,2,"LlmGpuCalculator"),oi(e,8,oZ,n),ol(e,3,"IDS_AND_INPUT_OPTIONS:__stream_0"),ol(e,3,"FINISH:finish"),ol(e,3,"LORA_DATA:lora_model_data"),ol(e,5,"MODEL_DATA:__side_packet_1"),ol(e,4,"DECODED_IDS:__stream_3"),ol(e,4,"OUTPUT_END:__stream_4"),oa(n=new oX,1,"FINISH"),oe(n,2,!0,!1),oi(e,13,oX,n),o7(t,e),oa(e=new o6,2,"IsPacketPresentCalculator"),ol(e,3,"__stream_4"),ol(e,4,"text_end"),o7(t,e),oa(e=new oZ,1,"type.googleapis.com/odml.infra.proto.DetokenizerCalculatorOptions"),oo(n=new aS,5,1),ol(n,4,"<eos>"),ol(n,4,"<|endoftext|>"),oG(e,n.i()),oa(n=new o6,2,"DetokenizerCalculator"),oi(n,8,oZ,e),ol(n,3,"IDS_AND_INPUT_OPTIONS:__stream_3"),ol(n,5,"PROCESSOR_GETTER:__input_side_1"),ol(n,5,"BYTES_TO_UNICODE_MAPPING:tokenizer_mapping"),ol(n,5,"MODEL_DATA:__side_packet_1"),ol(n,4,"FINISH_AND_INPUT_OPTIONS:finish"),ol(n,4,"WORDS:text_out"),o7(t,n),oa(e=new o6,2,"TokenCostCalculator"),ol(e,3,"PROMPT:token_cost_in"),ol(e,5,"PROCESSOR_GETTER:__input_side_1"),ol(e,5,"BYTES_TO_UNICODE_MAPPING:tokenizer_mapping"),ol(e,4,"NUM_TOKENS:token_cost_out"),o7(t,e),t}(e);e.i.attachStringVectorListener("text_out",(t,n)=>{var r=0===e.G.length;null==t||0===t.length?r="":(t=(t=(t=t[0]).replaceAll(""," ")).replaceAll("<0x0A>","\n"),r&&(t=t.trimStart()),r=t.split("\\[eod\\]",1)[0]),e.G.push(r),e.I&&0===e.C.length&&e.I(r,!1),am(e,n)}),e.i.attachEmptyPacketListener("text_out",t=>{am(e,t)}),e.i.attachBoolListener("text_end",(t,n)=>{e.j=!1,am(e,n),aV(e),e.o&&(e.o.i(e.G.join("")),e.o=void 0),e.I&&e.I("",!0)}),e.i.attachEmptyPacketListener("text_end",t=>{e.j=!1,am(e,t),aV(e),e.o&&(e.o.i(e.G.join("")),e.o=void 0)}),e.i.attachIntListener("token_cost_out",(t,n)=>{e.L=t,am(e,n)}),e.H&&e.i.addStreamingReaderToInputSidePacket(e.H,"streaming_reader");let n=t.i();return e.u?.removeEventListener("uncapturederror",e.F),e.i.P().then(()=>{e.u?.addEventListener("uncapturederror",e.F),e.C.length=0,e.setGraph(new Uint8Array(n),!0),e.finishProcessing()})})(this).then(()=>{})]).then(()=>{this.j=!1,aV(this)})}get baseOptions(){return ot(this.l,at,1)}set baseOptions(e){on(this.l,1,e)}S(e,t,n){if(this.j)throw Error("Previous invocation or loading is still ongoing.");if(this.I="function"==typeof t?t:n,this.G.length=0,this.j=!0,n=this.B+1,this.i.addStringToStream(e,"text_in",n),t instanceof aF){if(t.j!==this)throw this.j=!1,Error("The LoRA model was not loaded by this LLM Inference task.");this.i.addUintToStream(t.i,"lora_model_id_to_apply_in",n)}else this.i.addEmptyPacketToStream("lora_model_id_to_apply_in",n);return this.finishProcessing(),this.o=new aD,this.o.promise}X(e){if(this.j)throw Error("Previous invocation or loading is still ongoing.");return this.j=!0,this.L=void 0,this.i.addStringToStream(e,"token_cost_in",this.B+1),this.finishProcessing(),this.j=!1,this.L}async U(e){if(this.j)throw Error("Cannot load LoRA model while loading or processing.");if(this.j=!0,e instanceof Uint8Array){var t=new ak(this.i.h,e.length);t.set(e),e=t}else e=await async function(e,t){var n=await fetch(t.toString());e=new ak(e,t=Number(n.headers.get("content-length")));let r=0;for(n=n?.body?.getReader();;){let{value:t,done:s}=await n.read();if(s)break;e.set(t,r),r+=t.byteLength}if(t!==r)throw ax(e),Error(`File could not be fully loaded to memory, so was not retained. Loaded ${r}/${t} bytes before failure`);return e}(this.i.h,e);return t=new aF(this),this.i.O(e,this.B+1),this.i.addUintToStream(t.i,"lora_model_id_to_load_in",this.B+1),this.finishProcessing(),ax(e),this.j=!1,t}close(){this.u?.removeEventListener("uncapturederror",this.F),super.close()}};aW.prototype.loadLoraModel=aW.prototype.U,aW.prototype.sizeInTokens=aW.prototype.X,aW.prototype.generateResponse=aW.prototype.S,aW.prototype.setOptions=aW.prototype.J,aW.createWebGpuDevice=aq,aW.createFromModelPath=async function(e,t){return af(e,t={baseOptions:{gpuOptions:{device:await aq()},modelAssetPath:t}})},aW.createFromModelBuffer=async function(e,t){return af(e,t={baseOptions:{gpuOptions:{device:await aq()},modelAssetBuffer:t}})},aW.createFromOptions=async function(e,t){if(!t.baseOptions?.gpuOptions?.device){let e=await aq();t.baseOptions=t.baseOptions??{},t.baseOptions.gpuOptions=t?.baseOptions?.gpuOptions??{},t.baseOptions.gpuOptions.device=e}return af(e,t)};var aH=Object.defineProperty,aG=Object.getOwnPropertySymbols,aZ=Object.prototype.hasOwnProperty,aJ=Object.prototype.propertyIsEnumerable,aK=(e,t,n)=>t in e?aH(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,aX=B("chromeai"),aY=" ```json\n",aQ="\n```";TransformStream,B("chromeai"),B("chromeai"),B("chromeai:polyfill")},8794:function(e,t,n){"use strict";n.d(t,{k:function(){return r}});let r=(e,t=21)=>(n=t)=>{let r="",s=0|n;for(;s--;)r+=e[Math.random()*e.length|0];return r}},3496:function(e,t,n){"use strict";var r,s,i,o,a,l="vercel.ai.error",u=Symbol.for(l),c=class e extends Error{constructor({name:e,message:t,cause:n}){super(t),this[r]=!0,this.name=e,this.cause=n}static isInstance(t){return e.hasMarker(t,l)}static hasMarker(e,t){let n=Symbol.for(t);return null!=e&&"object"==typeof e&&n in e&&"boolean"==typeof e[n]&&!0===e[n]}};r=u;var d=c,h="AI_APICallError",f=`vercel.ai.error.${h}`,p=Symbol.for(f),m=class extends d{constructor({message:e,url:t,requestBodyValues:n,statusCode:r,responseHeaders:i,responseBody:o,cause:a,isRetryable:l=null!=r&&(408===r||409===r||429===r||r>=500),data:u}){super({name:h,message:e,cause:a}),this[s]=!0,this.url=t,this.requestBodyValues=n,this.statusCode=r,this.responseHeaders=i,this.responseBody=o,this.isRetryable=l,this.data=u}static isInstance(e){return d.hasMarker(e,f)}};function g(e){return null==e?"unknown error":"string"==typeof e?e:e instanceof Error?e.message:JSON.stringify(e)}s=p,Symbol.for("vercel.ai.error.AI_EmptyResponseBodyError");var y="AI_InvalidArgumentError",b=`vercel.ai.error.${y}`,v=Symbol.for(b),_=class extends d{constructor({message:e,cause:t,argument:n}){super({name:y,message:e,cause:t}),this[i]=!0,this.argument=n}static isInstance(e){return d.hasMarker(e,b)}};i=v,Symbol.for("vercel.ai.error.AI_InvalidPromptError"),Symbol.for("vercel.ai.error.AI_InvalidResponseDataError");var w="AI_JSONParseError",x=`vercel.ai.error.${w}`,k=Symbol.for(x),S=class extends d{constructor({text:e,cause:t}){super({name:w,message:`JSON parsing failed: Text: ${e}.
Error message: ${g(t)}`,cause:t}),this[o]=!0,this.text=e}static isInstance(e){return d.hasMarker(e,x)}};o=k,Symbol.for("vercel.ai.error.AI_LoadAPIKeyError"),Symbol.for("vercel.ai.error.AI_LoadSettingError"),Symbol.for("vercel.ai.error.AI_NoContentGeneratedError"),Symbol.for("vercel.ai.error.AI_NoSuchModelError"),Symbol.for("vercel.ai.error.AI_TooManyEmbeddingValuesForCallError");var A="AI_TypeValidationError",I=`vercel.ai.error.${A}`,E=Symbol.for(I),T=class e extends d{constructor({value:e,cause:t}){super({name:A,message:`Type validation failed: Value: ${JSON.stringify(e)}.
Error message: ${g(t)}`,cause:t}),this[a]=!0,this.value=e}static isInstance(e){return d.hasMarker(e,I)}static wrap({value:t,cause:n}){return e.isInstance(n)&&n.value===t?n:new e({value:t,cause:n})}};a=E,Symbol.for("vercel.ai.error.AI_UnsupportedFunctionalityError");var z=n(8794),C=n(318);function j(...e){return e.reduce((e,t)=>({...e,...null!=t?t:{}}),{})}function N(e){let t={};return e.headers.forEach((e,n)=>{t[n]=e}),t}n(3656);var O=(({prefix:e,size:t=16,alphabet:n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:r="-"}={})=>{let s=(0,z.k)(n,t);if(null==e)return s;if(n.includes(r))throw new _({argument:"separator",message:`The separator "${r}" must not be part of the alphabet "${n}".`});return t=>`${e}${r}${s(t)}`})();function P(e){return e instanceof Error&&("AbortError"===e.name||"TimeoutError"===e.name)}var R=Symbol.for("vercel.ai.validator");function M({value:e,schema:t}){let n="object"==typeof t&&null!==t&&R in t&&!0===t[R]&&"validate"in t?t:{[R]:!0,validate:e=>{let n=t.safeParse(e);return n.success?{success:!0,value:n.data}:{success:!1,error:n.error}}};try{if(null==n.validate)return{success:!0,value:e};let t=n.validate(e);if(t.success)return t;return{success:!1,error:T.wrap({value:e,cause:t.error})}}catch(t){return{success:!1,error:T.wrap({value:e,cause:t})}}}function U({text:e,schema:t}){try{let n=C.parse(e);if(null==t)return{success:!0,value:n,rawValue:n};let r=M({value:n,schema:t});return r.success?{...r,rawValue:n}:r}catch(t){return{success:!1,error:S.isInstance(t)?t:new S({text:e,cause:t})}}}var $=()=>globalThis.fetch,L=async({url:e,headers:t,body:n,failedResponseHandler:r,successfulResponseHandler:s,abortSignal:i,fetch:o})=>F({url:e,headers:{"Content-Type":"application/json",...t},body:{content:JSON.stringify(n),values:n},failedResponseHandler:r,successfulResponseHandler:s,abortSignal:i,fetch:o}),F=async({url:e,headers:t={},body:n,successfulResponseHandler:r,failedResponseHandler:s,abortSignal:i,fetch:o=$()})=>{try{let a=await o(e,{method:"POST",headers:Object.fromEntries(Object.entries(t).filter(([e,t])=>null!=t)),body:n.content,signal:i}),l=N(a);if(!a.ok){let t;try{t=await s({response:a,url:e,requestBodyValues:n.values})}catch(t){if(P(t)||m.isInstance(t))throw t;throw new m({message:"Failed to process error response",cause:t,statusCode:a.status,url:e,responseHeaders:l,requestBodyValues:n.values})}throw t.value}try{return await r({response:a,url:e,requestBodyValues:n.values})}catch(t){if(t instanceof Error&&(P(t)||m.isInstance(t)))throw t;throw new m({message:"Failed to process successful response",cause:t,statusCode:a.status,url:e,responseHeaders:l,requestBodyValues:n.values})}}catch(t){if(P(t))throw t;if(t instanceof TypeError&&"fetch failed"===t.message){let r=t.cause;if(null!=r)throw new m({message:`Cannot connect to API: ${r.message}`,cause:r,url:e,requestBodyValues:n.values,isRetryable:!0})}throw t}},B=e=>async({response:t,url:n,requestBodyValues:r})=>{let s=await t.text(),i=U({text:s,schema:e}),o=N(t);if(!i.success)throw new m({message:"Invalid JSON response",cause:i.error,statusCode:t.status,responseHeaders:o,responseBody:s,url:n,requestBodyValues:r});return{responseHeaders:o,value:i.value,rawValue:i.rawValue}},{btoa:D,atob:q}=globalThis,V=n(858),W=n(2244),H=n(9851);function G(e){let t=[];for(let{content:n,role:r}of e)switch(r){case"system":t.push({content:n,role:"system"});break;case"user":t.push({...n.reduce((e,t)=>{if("text"===t.type)e.content+=t.text;else if("image"===t.type&&t.image instanceof URL)throw new W.A_({functionality:"Image URLs in user messages"});else"image"===t.type&&t.image instanceof Uint8Array&&(e.images=e.images||[],e.images.push(function(e){let t="";for(let n=0;n<e.length;n++)t+=String.fromCodePoint(e[n]);return D(t)}(t.image)));return e},{content:""}),role:"user"});break;case"assistant":{let e=[],r=[];for(let t of n)switch(t.type){case"text":e.push(t.text);break;case"tool-call":r.push({function:{arguments:t.args,name:t.toolName},id:t.toolCallId,type:"function"});break;default:throw Error(`Unsupported part: ${t}`)}t.push({content:e.join(","),role:"assistant",tool_calls:r.length>0?r:void 0});break}case"tool":t.push(...n.map(e=>({content:"object"==typeof e.result?JSON.stringify(e.result):`${e.result}`,role:"tool",tool_call_id:e.toolCallId})));break;default:throw Error(`Unsupported role: ${r}`)}return t}var Z=class{constructor({tools:e,type:t}){this._firstMessage=!0,this._tools=e,this._toolPartial="",this._toolCalls=[],this._type=t,this._detectedToolCall=!1}get toolCalls(){return this._toolCalls}get detectedToolCall(){return this._detectedToolCall}parse({controller:e,delta:t}){var n;if(this.detectToolCall(t),!this._detectedToolCall)return!1;this._toolPartial+=t;let r=(0,H.parse)(this._toolPartial);for(let[s,i]of(Array.isArray(r)||(r=[r]),r.entries())){let r=null!=(n=JSON.stringify(null==i?void 0:i.parameters))?n:"";if(""===r)continue;this._toolCalls[s]||(this._toolCalls[s]={function:{arguments:"",name:i.name},id:O(),type:"function"});let o=this._toolCalls[s];o.function.arguments=r,e.enqueue({argsTextDelta:t,toolCallId:o.id,toolCallType:"function",toolName:o.function.name,type:"tool-call-delta"})}return!0}finish({controller:e}){for(let t of this.toolCalls)e.enqueue({args:t.function.arguments,toolCallId:t.id,toolCallType:"function",toolName:t.function.name,type:"tool-call"});return this.finishReason()}detectToolCall(e){this._tools&&0!==this._tools.length&&this._firstMessage&&("object-tool"===this._type?this._detectedToolCall=!0:"regular"===this._type&&(e.trim().startsWith("{")||e.trim().startsWith("["))&&(this._detectedToolCall=!0),this._firstMessage=!1)}finishReason(){return this.detectedToolCall?"object-tool"===this._type?"stop":"tool-calls":"stop"}},J=(({errorSchema:e,errorToMessage:t,isRetryable:n})=>async({response:r,url:s,requestBodyValues:i})=>{let o=await r.text(),a=N(r);if(""===o.trim())return{responseHeaders:a,value:new m({message:r.statusText,url:s,requestBodyValues:i,statusCode:r.status,responseHeaders:a,responseBody:o,isRetryable:null==n?void 0:n(r)})};try{let l=function({text:e,schema:t}){try{let n=C.parse(e);if(null==t)return n;return function({value:e,schema:t}){let n=M({value:e,schema:t});if(!n.success)throw T.wrap({value:e,cause:n.error});return n.value}({value:n,schema:t})}catch(t){if(S.isInstance(t)||T.isInstance(t))throw t;throw new S({text:e,cause:t})}}({text:o,schema:e});return{responseHeaders:a,value:new m({message:t(l),url:s,requestBodyValues:i,statusCode:r.status,responseHeaders:a,responseBody:o,data:l,isRetryable:null==n?void 0:n(r,l)})}}catch(e){return{responseHeaders:a,value:new m({message:r.statusText,url:s,requestBodyValues:i,statusCode:r.status,responseHeaders:a,responseBody:o,isRetryable:null==n?void 0:n(r)})}}})({errorSchema:V.z.object({error:V.z.object({code:V.z.string().nullable(),message:V.z.string(),param:V.z.any().nullable(),type:V.z.string()})}),errorToMessage:e=>e.error.message}),K=class extends TransformStream{constructor(){super({flush:e=>{0!==this.buffer.length&&e.enqueue(this.buffer)},transform:(e,t)=>{for(e=this.buffer+e;;){let n=e.indexOf("\n");if(-1===n)break;t.enqueue(e.slice(0,n)),e=e.slice(n+1)}this.buffer=e}}),this.buffer=""}},X=e=>async({response:t})=>{let n=N(t);if(null===t.body)throw new W.g8({});return{responseHeaders:n,value:t.body.pipeThrough(new TextDecoderStream).pipeThrough(new K).pipeThrough(new TransformStream({transform(t,n){n.enqueue(U({schema:e,text:t}))}}))}},Y=class{constructor(e,t,n){this.modelId=e,this.settings=t,this.config=n,this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsImageUrls=!1}get supportsStructuredOutputs(){var e;return null!=(e=this.settings.structuredOutputs)&&e}get provider(){return this.config.provider}getArguments({frequencyPenalty:e,maxTokens:t,mode:n,presencePenalty:r,prompt:s,responseFormat:i,seed:o,stopSequences:a,temperature:l,topK:u,topP:c}){let d=n.type,h=[];void 0===i||"json"!==i.type||void 0===i.schema||this.supportsStructuredOutputs||h.push({details:"JSON response format schema is only supported with structuredOutputs",setting:"responseFormat",type:"unsupported-setting"});let f={format:null==i?void 0:i.type,model:this.modelId,options:Object.fromEntries(Object.entries({f16_kv:this.settings.f16Kv,frequency_penalty:e,low_vram:this.settings.lowVram,main_gpu:this.settings.mainGpu,min_p:this.settings.minP,mirostat:this.settings.mirostat,mirostat_eta:this.settings.mirostatEta,mirostat_tau:this.settings.mirostatTau,num_batch:this.settings.numBatch,num_ctx:this.settings.numCtx,num_gpu:this.settings.numGpu,num_keep:this.settings.numKeep,num_predict:t,num_thread:this.settings.numThread,numa:this.settings.numa,penalize_newline:this.settings.penalizeNewline,presence_penalty:r,repeat_last_n:this.settings.repeatLastN,repeat_penalty:this.settings.repeatPenalty,seed:o,stop:a,temperature:l,tfs_z:this.settings.tfsZ,top_k:u,top_p:c,typical_p:this.settings.typicalP,use_mlock:this.settings.useMlock,use_mmap:this.settings.useMmap,vocab_only:this.settings.vocabOnly}).filter(([,e])=>void 0!==e))};switch(d){case"regular":{let{tools:e,toolWarnings:t}=function({mode:e}){var t;let n=(null==(t=e.tools)?void 0:t.length)?e.tools:void 0,r=[],s=e.toolChoice;if(void 0===n)return{tools:void 0,toolWarnings:r};let i=[];for(let e of n)"provider-defined"===e.type?r.push({tool:e,type:"unsupported-tool"}):i.push({function:{description:e.description,name:e.name,parameters:e.parameters},type:"function"});if(void 0===s)return{tools:i,toolWarnings:r};let o=s.type;switch(o){case"auto":return{tools:i,toolWarnings:r};case"none":return{tools:void 0,toolWarnings:r};default:throw new W.A_({functionality:`Unsupported tool choice type: ${o}`})}}({mode:n});return{args:{...f,messages:G(s),tools:e},type:d,warnings:[...h,...t]}}case"object-json":return{args:{...f,format:this.supportsStructuredOutputs&&void 0!==n.schema?n.schema:"json",messages:G(s)},type:d,warnings:h};case"object-tool":return{args:{...f,messages:G(s),tool_choice:{function:{name:n.tool.name},type:"function"},tools:[{function:{description:n.tool.description,name:n.tool.name,parameters:n.tool.parameters},type:"function"}]},type:d,warnings:h};default:throw Error(`Unsupported type: ${d}`)}}async doGenerate(e){var t,n;let{args:r,warnings:s}=this.getArguments(e),i={...r,stream:!1},{responseHeaders:o,value:a}=await L({abortSignal:e.abortSignal,body:i,failedResponseHandler:J,fetch:this.config.fetch,headers:j(this.config.headers(),e.headers),successfulResponseHandler:B(Q),url:`${this.config.baseURL}/chat`}),{messages:l,...u}=i,c=null==(t=a.message.tool_calls)?void 0:t.map(e=>{var t;return{args:JSON.stringify(e.function.arguments),toolCallId:null!=(t=e.id)?t:O(),toolCallType:"function",toolName:e.function.name}});return{finishReason:function({finishReason:e,hasToolCalls:t}){return"stop"===e?t?"tool-calls":"stop":"other"}({finishReason:a.done_reason,hasToolCalls:void 0!==c&&c.length>0}),rawCall:{rawPrompt:l,rawSettings:u},rawResponse:{headers:o},request:{body:JSON.stringify(i)},text:null!=(n=a.message.content)?n:void 0,toolCalls:c,usage:{completionTokens:a.eval_count||0,promptTokens:a.prompt_eval_count||0},warnings:s}}async doStream(e){if(this.settings.simulateStreaming){let t=await this.doGenerate(e),n=new ReadableStream({start(e){if(e.enqueue({type:"response-metadata",...t.response}),t.text&&e.enqueue({textDelta:t.text,type:"text-delta"}),t.toolCalls)for(let n of t.toolCalls)e.enqueue({argsTextDelta:n.args,toolCallId:n.toolCallId,toolCallType:"function",toolName:n.toolName,type:"tool-call-delta"}),e.enqueue({type:"tool-call",...n});e.enqueue({finishReason:t.finishReason,logprobs:t.logprobs,providerMetadata:t.providerMetadata,type:"finish",usage:t.usage}),e.close()}});return{rawCall:t.rawCall,rawResponse:t.rawResponse,stream:n,warnings:t.warnings}}let{args:t,type:n,warnings:r}=this.getArguments(e),{responseHeaders:s,value:i}=await L({abortSignal:e.abortSignal,body:t,failedResponseHandler:J,fetch:this.config.fetch,headers:j(this.config.headers(),e.headers),successfulResponseHandler:X(ee),url:`${this.config.baseURL}/chat`}),{messages:o,...a}=t,l=new Z({tools:"regular"===e.mode.type?e.mode.tools:"object-tool"===e.mode.type?[e.mode.tool]:void 0,type:n}),u="other",c={completionTokens:Number.NaN,promptTokens:Number.NaN},{experimentalStreamTools:d=!0}=this.settings;return{rawCall:{rawPrompt:o,rawSettings:a},rawResponse:{headers:s},request:{body:JSON.stringify(t)},stream:i.pipeThrough(new TransformStream({async flush(e){e.enqueue({finishReason:u,type:"finish",usage:c})},async transform(e,t){if(!e.success){t.enqueue({error:e.error,type:"error"});return}let n=e.value;if(n.done){u=l.finish({controller:t}),c={completionTokens:n.eval_count,promptTokens:n.prompt_eval_count||0};return}d&&l.parse({controller:t,delta:n.message.content})||null===n.message.content||t.enqueue({textDelta:n.message.content,type:"text-delta"})}})),warnings:r}}},Q=V.z.object({created_at:V.z.string(),done:V.z.literal(!0),done_reason:V.z.string().optional().nullable(),eval_count:V.z.number(),eval_duration:V.z.number(),load_duration:V.z.number().optional(),message:V.z.object({content:V.z.string(),role:V.z.string(),tool_calls:V.z.array(V.z.object({function:V.z.object({arguments:V.z.record(V.z.any()),name:V.z.string()}),id:V.z.string().optional()})).optional().nullable()}),model:V.z.string(),prompt_eval_count:V.z.number().optional(),prompt_eval_duration:V.z.number().optional(),total_duration:V.z.number()}),ee=V.z.discriminatedUnion("done",[V.z.object({created_at:V.z.string(),done:V.z.literal(!1),message:V.z.object({content:V.z.string(),role:V.z.string()}),model:V.z.string()}),V.z.object({created_at:V.z.string(),done:V.z.literal(!0),eval_count:V.z.number(),eval_duration:V.z.number(),load_duration:V.z.number().optional(),model:V.z.string(),prompt_eval_count:V.z.number().optional(),prompt_eval_duration:V.z.number().optional(),total_duration:V.z.number()})]),et=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return null!=(e=this.settings.maxEmbeddingsPerCall)?e:2048}get supportsParallelCalls(){return!1}async doEmbed({abortSignal:e,values:t}){if(t.length>this.maxEmbeddingsPerCall)throw new W.ON({maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,modelId:this.modelId,provider:this.provider,values:t});let{responseHeaders:n,value:r}=await L({abortSignal:e,body:{input:t,model:this.modelId},failedResponseHandler:J,fetch:this.config.fetch,headers:this.config.headers(),successfulResponseHandler:B(en),url:`${this.config.baseURL}/embed`});return{embeddings:r.embeddings,rawResponse:{headers:n},usage:r.prompt_eval_count?{tokens:r.prompt_eval_count}:void 0}}},en=V.z.object({embeddings:V.z.array(V.z.array(V.z.number())),prompt_eval_count:V.z.number().nullable()});!function(e={}){var t,n;let r=null!=(t=null==(n=e.baseURL)?void 0:n.replace(/\/$/,""))?t:"http://127.0.0.1:11434/api",s=()=>({...e.headers}),i=(t,n={})=>new Y(t,n,{baseURL:r,fetch:e.fetch,headers:s,provider:"ollama.chat"}),o=(t,n={})=>new et(t,n,{baseURL:r,fetch:e.fetch,headers:s,provider:"ollama.embedding"}),a=function(e,t){if(new.target)throw Error("The Ollama model function cannot be called with the new keyword.");return i(e,t)};a.chat=i,a.embedding=o,a.languageModel=i,a.textEmbedding=o,a.textEmbeddingModel=o}()},1679:function(e,t,n){"use strict";let r,s,i,o,a,l,u,c,d,h;n.d(t,{ZP:function(){return rC}});let f="RFC3986",p={RFC1738:e=>String(e).replace(/%20/g,"+"),RFC3986:e=>String(e)};Object.prototype.hasOwnProperty;let m=Array.isArray,g=(()=>{let e=[];for(let t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e})();function y(e,t){if(m(e)){let n=[];for(let r=0;r<e.length;r+=1)n.push(t(e[r]));return n}return t(e)}let b=Object.prototype.hasOwnProperty,v={brackets:e=>String(e)+"[]",comma:"comma",indices:(e,t)=>String(e)+"["+t+"]",repeat:e=>String(e)},_=Array.isArray,w=Array.prototype.push,x=function(e,t){w.apply(e,_(t)?t:[t])},k=Date.prototype.toISOString,S={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:(e,t,n,r,s)=>{if(0===e.length)return e;let i=e;if("symbol"==typeof e?i=Symbol.prototype.toString.call(e):"string"!=typeof e&&(i=String(e)),"iso-8859-1"===n)return escape(i).replace(/%u[0-9a-f]{4}/gi,function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"});let o="";for(let e=0;e<i.length;e+=1024){let t=i.length>=1024?i.slice(e,e+1024):i,n=[];for(let e=0;e<t.length;++e){let r=t.charCodeAt(e);if(45===r||46===r||95===r||126===r||r>=48&&r<=57||r>=65&&r<=90||r>=97&&r<=122||"RFC1738"===s&&(40===r||41===r)){n[n.length]=t.charAt(e);continue}if(r<128){n[n.length]=g[r];continue}if(r<2048){n[n.length]=g[192|r>>6]+g[128|63&r];continue}if(r<55296||r>=57344){n[n.length]=g[224|r>>12]+g[128|r>>6&63]+g[128|63&r];continue}e+=1,r=65536+((1023&r)<<10|1023&t.charCodeAt(e)),n[n.length]=g[240|r>>18]+g[128|r>>12&63]+g[128|r>>6&63]+g[128|63&r]}o+=n.join("")}return o},encodeValuesOnly:!1,format:f,formatter:p[f],indices:!1,serializeDate:e=>k.call(e),skipNulls:!1,strictNullHandling:!1},A={},I="4.104.0",E=!1;class T{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}let z=()=>{s||function(e,t={auto:!1}){if(E)throw Error(`you must \`import 'openai/shims/${e.kind}'\` before importing anything else from openai`);if(s)throw Error(`can't \`import 'openai/shims/${e.kind}'\` after \`import 'openai/shims/${s}'\``);E=t.auto,s=e.kind,i=e.fetch,e.Request,e.Response,e.Headers,o=e.FormData,e.Blob,a=e.File,l=e.ReadableStream,u=e.getMultipartRequestOptions,c=e.getDefaultAgent,d=e.fileFromPath,h=e.isFsReadStream}(function({manuallyImported:e}={}){let t,n,r,s;let i=e?"You may need to use polyfills":`Add one of these imports before your first \`import  from 'openai'\`:
- \`import 'openai/shims/node'\` (if you're running on Node)
- \`import 'openai/shims/web'\` (otherwise)
`;try{t=fetch,n=Request,r=Response,s=Headers}catch(e){throw Error(`this environment is missing the following Web Fetch API type: ${e.message}. ${i}`)}return{kind:"web",fetch:t,Request:n,Response:r,Headers:s,FormData:"undefined"!=typeof FormData?FormData:class{constructor(){throw Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${i}`)}},Blob:"undefined"!=typeof Blob?Blob:class{constructor(){throw Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${i}`)}},File:"undefined"!=typeof File?File:class{constructor(){throw Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${i}`)}},ReadableStream:"undefined"!=typeof ReadableStream?ReadableStream:class{constructor(){throw Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${i}`)}},getMultipartRequestOptions:async(e,t)=>({...t,body:new T(e)}),getDefaultAgent:e=>void 0,fileFromPath:()=>{throw Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:e=>!1}}(),{auto:!0})};z();class C extends Error{}class j extends C{constructor(e,t,n,r){super(`${j.makeMessage(e,t,n)}`),this.status=e,this.headers=r,this.request_id=r?.["x-request-id"],this.error=t,this.code=t?.code,this.param=t?.param,this.type=t?.type}static makeMessage(e,t,n){let r=t?.message?"string"==typeof t.message?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&r?`${e} ${r}`:e?`${e} status code (no body)`:r||"(no status code or body)"}static generate(e,t,n,r){if(!e||!r)return new O({message:n,cause:tU(t)});let s=t?.error;return 400===e?new R(e,s,n,r):401===e?new M(e,s,n,r):403===e?new U(e,s,n,r):404===e?new $(e,s,n,r):409===e?new L(e,s,n,r):422===e?new F(e,s,n,r):429===e?new B(e,s,n,r):e>=500?new D(e,s,n,r):new j(e,s,n,r)}}class N extends j{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class O extends j{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class P extends O{constructor({message:e}={}){super({message:e??"Request timed out."})}}class R extends j{}class M extends j{}class U extends j{}class $ extends j{}class L extends j{}class F extends j{}class B extends j{}class D extends j{}class q extends C{constructor(){super("Could not parse response content as the length limit was reached")}}class V extends C{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}var W,H,G,Z,J,K,X,Y,Q,ee,et,en,er,es,ei,eo,ea,el,eu,ec,ed,eh,ef,ep,em,eg,ey,eb,ev,e_,ew,ex,ek,eS,eA,eI,eE,eT,ez,eC,ej,eN,eO,eP,eR,eM,eU,e$,eL,eF,eB,eD,eq,eV,eW,eH,eG,eZ,eJ,eK,eX,eY,eQ,e0,e1,e2=n(5313).lW,e6=function(e,t,n,r,s){if("m"===r)throw TypeError("Private method is not writable");if("a"===r&&!s)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n},e3=function(e,t,n,r){if("a"===n&&!r)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};class e4{constructor(){W.set(this,void 0),this.buffer=new Uint8Array,e6(this,W,null,"f")}decode(e){let t;if(null==e)return[];let n=e instanceof ArrayBuffer?new Uint8Array(e):"string"==typeof e?new TextEncoder().encode(e):e,r=new Uint8Array(this.buffer.length+n.length);r.set(this.buffer),r.set(n,this.buffer.length),this.buffer=r;let s=[];for(;null!=(t=function(e,t){for(let n=t??0;n<e.length;n++){if(10===e[n])return{preceding:n,index:n+1,carriage:!1};if(13===e[n])return{preceding:n,index:n+1,carriage:!0}}return null}(this.buffer,e3(this,W,"f")));){if(t.carriage&&null==e3(this,W,"f")){e6(this,W,t.index,"f");continue}if(null!=e3(this,W,"f")&&(t.index!==e3(this,W,"f")+1||t.carriage)){s.push(this.decodeText(this.buffer.slice(0,e3(this,W,"f")-1))),this.buffer=this.buffer.slice(e3(this,W,"f")),e6(this,W,null,"f");continue}let e=null!==e3(this,W,"f")?t.preceding-1:t.preceding,n=this.decodeText(this.buffer.slice(0,e));s.push(n),this.buffer=this.buffer.slice(t.index),e6(this,W,null,"f")}return s}decodeText(e){if(null==e)return"";if("string"==typeof e)return e;if(void 0!==e2){if(e instanceof e2)return e.toString();if(e instanceof Uint8Array)return e2.from(e).toString();throw new C(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if("undefined"!=typeof TextDecoder){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new C(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new C("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){return this.buffer.length?this.decode("\n"):[]}}function e5(e){if(e[Symbol.asyncIterator])return e;let t=e.getReader();return{async next(){try{let e=await t.read();return e?.done&&t.releaseLock(),e}catch(e){throw t.releaseLock(),e}},async return(){let e=t.cancel();return t.releaseLock(),await e,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}W=new WeakMap,e4.NEWLINE_CHARS=new Set(["\n","\r"]),e4.NEWLINE_REGEXP=/\r\n|[\n\r]/g;class e8{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let n=!1;return new e8(async function*(){if(n)throw Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let r=!1;try{for await(let n of e9(e,t))if(!r){if(n.data.startsWith("[DONE]")){r=!0;continue}if(null===n.event||n.event.startsWith("response.")||n.event.startsWith("transcript.")){let t;try{t=JSON.parse(n.data)}catch(e){throw console.error("Could not parse message into JSON:",n.data),console.error("From chunk:",n.raw),e}if(t&&t.error)throw new j(void 0,t.error,void 0,tA(e.headers));yield t}else{let e;try{e=JSON.parse(n.data)}catch(e){throw console.error("Could not parse message into JSON:",n.data),console.error("From chunk:",n.raw),e}if("error"==n.event)throw new j(void 0,e.error,e.message,void 0);yield{event:n.event,data:e}}}r=!0}catch(e){if(e instanceof Error&&"AbortError"===e.name)return;throw e}finally{r||t.abort()}},t)}static fromReadableStream(e,t){let n=!1;async function*r(){let t=new e4;for await(let n of e5(e))for(let e of t.decode(n))yield e;for(let e of t.flush())yield e}return new e8(async function*(){if(n)throw Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let e=!1;try{for await(let t of r())!e&&t&&(yield JSON.parse(t));e=!0}catch(e){if(e instanceof Error&&"AbortError"===e.name)return;throw e}finally{e||t.abort()}},t)}[Symbol.asyncIterator](){return this.iterator()}tee(){let e=[],t=[],n=this.iterator(),r=r=>({next:()=>{if(0===r.length){let r=n.next();e.push(r),t.push(r)}return r.shift()}});return[new e8(()=>r(e),this.controller),new e8(()=>r(t),this.controller)]}toReadableStream(){let e;let t=this,n=new TextEncoder;return new l({async start(){e=t[Symbol.asyncIterator]()},async pull(t){try{let{value:r,done:s}=await e.next();if(s)return t.close();let i=n.encode(JSON.stringify(r)+"\n");t.enqueue(i)}catch(e){t.error(e)}},async cancel(){await e.return?.()}})}}async function*e9(e,t){if(!e.body)throw t.abort(),new C("Attempted to iterate over a response with no body");let n=new te,r=new e4;for await(let t of e7(e5(e.body)))for(let e of r.decode(t)){let t=n.decode(e);t&&(yield t)}for(let e of r.flush()){let t=n.decode(e);t&&(yield t)}}async function*e7(e){let t=new Uint8Array;for await(let n of e){let e;if(null==n)continue;let r=n instanceof ArrayBuffer?new Uint8Array(n):"string"==typeof n?new TextEncoder().encode(n):n,s=new Uint8Array(t.length+r.length);for(s.set(t),s.set(r,t.length),t=s;-1!==(e=function(e){for(let t=0;t<e.length-1;t++){if(10===e[t]&&10===e[t+1]||13===e[t]&&13===e[t+1])return t+2;if(13===e[t]&&10===e[t+1]&&t+3<e.length&&13===e[t+2]&&10===e[t+3])return t+4}return -1}(t));)yield t.slice(0,e),t=t.slice(e)}t.length>0&&(yield t)}class te{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;let e={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],e}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,r]=function(e,t){let n=e.indexOf(":");return -1!==n?[e.substring(0,n),":",e.substring(n+t.length)]:[e,"",""]}(e,":");return r.startsWith(" ")&&(r=r.substring(1)),"event"===t?this.event=r:"data"===t&&this.data.push(r),null}}var tt=n(5313).lW;let tn=e=>null!=e&&"object"==typeof e&&"string"==typeof e.url&&"function"==typeof e.blob,tr=e=>null!=e&&"object"==typeof e&&"string"==typeof e.name&&"number"==typeof e.lastModified&&ts(e),ts=e=>null!=e&&"object"==typeof e&&"number"==typeof e.size&&"string"==typeof e.type&&"function"==typeof e.text&&"function"==typeof e.slice&&"function"==typeof e.arrayBuffer,ti=e=>tr(e)||tn(e)||h(e);async function to(e,t,n){var r;if(tr(e=await e))return e;if(tn(e)){let r=await e.blob();t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()??"unknown_file");let s=ts(r)?[await r.arrayBuffer()]:[r];return new a(s,t,n)}let s=await ta(e);if(t||(t=(tl((r=e).name)||tl(r.filename)||tl(r.path)?.split(/[\\/]/).pop())??"unknown_file"),!n?.type){let e=s[0]?.type;"string"==typeof e&&(n={...n,type:e})}return new a(s,t,n)}async function ta(e){let t=[];if("string"==typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)t.push(e);else if(ts(e))t.push(await e.arrayBuffer());else if(tu(e))for await(let n of e)t.push(n);else throw Error(`Unexpected data type: ${typeof e}; constructor: ${e?.constructor?.name}; props: ${function(e){let t=Object.getOwnPropertyNames(e);return`[${t.map(e=>`"${e}"`).join(", ")}]`}(e)}`);return t}let tl=e=>"string"==typeof e?e:void 0!==tt&&e instanceof tt?String(e):void 0,tu=e=>null!=e&&"object"==typeof e&&"function"==typeof e[Symbol.asyncIterator],tc=e=>e&&"object"==typeof e&&e.body&&"MultipartBody"===e[Symbol.toStringTag],td=async e=>{let t=await th(e.body);return u(t,e)},th=async e=>{let t=new o;return await Promise.all(Object.entries(e||{}).map(([e,n])=>tp(t,e,n))),t},tf=e=>{if(ti(e))return!0;if(Array.isArray(e))return e.some(tf);if(e&&"object"==typeof e){for(let t in e)if(tf(e[t]))return!0}return!1},tp=async(e,t,n)=>{if(void 0!==n){if(null==n)throw TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`);if("string"==typeof n||"number"==typeof n||"boolean"==typeof n)e.append(t,String(n));else if(ti(n)){let r=await to(n);e.append(t,r)}else if(Array.isArray(n))await Promise.all(n.map(n=>tp(e,t+"[]",n)));else if("object"==typeof n)await Promise.all(Object.entries(n).map(([n,r])=>tp(e,`${t}[${n}]`,r)));else throw TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}};var tm=n(5313).lW,tg=n(3656),ty=function(e,t,n,r,s){if("m"===r)throw TypeError("Private method is not writable");if("a"===r&&!s)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n},tb=function(e,t,n,r){if("a"===n&&!r)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};async function tv(e){let{response:t}=e;if(e.options.stream)return(tq("response",t.status,t.url,t.headers,t.body),e.options.__streamClass)?e.options.__streamClass.fromSSEResponse(t,e.controller):e8.fromSSEResponse(t,e.controller);if(204===t.status)return null;if(e.options.__binaryResponse)return t;let n=t.headers.get("content-type"),r=n?.split(";")[0]?.trim();if(r?.includes("application/json")||r?.endsWith("+json")){let e=await t.json();return tq("response",t.status,t.url,t.headers,e),t_(e,t)}let s=await t.text();return tq("response",t.status,t.url,t.headers,s),s}function t_(e,t){return!e||"object"!=typeof e||Array.isArray(e)?e:Object.defineProperty(e,"_request_id",{value:t.headers.get("x-request-id"),enumerable:!1})}z();class tw extends Promise{constructor(e,t=tv){super(e=>{e(null)}),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new tw(this.responsePromise,async t=>t_(e(await this.parseResponse(t),t),t.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){let[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class tx{constructor({baseURL:e,maxRetries:t=2,timeout:n=6e5,httpAgent:r,fetch:s}){this.baseURL=e,this.maxRetries=tM("maxRetries",t),this.timeout=tM("timeout",n),this.httpAgent=r,this.fetch=s??i}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...tj(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${tV()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then(async n=>{let r=n&&ts(n?.body)?new DataView(await n.body.arrayBuffer()):n?.body instanceof DataView?n.body:n?.body instanceof ArrayBuffer?new DataView(n.body):n&&ArrayBuffer.isView(n?.body)?new DataView(n.body.buffer):n?.body;return{method:e,path:t,...n,body:r}}))}getAPIList(e,t,n){return this.requestAPIList(t,{method:"get",path:e,...n})}calculateContentLength(e){if("string"==typeof e){if(void 0!==tm)return tm.byteLength(e,"utf8").toString();if("undefined"!=typeof TextEncoder)return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:t=0}={}){let n={...e},{method:r,path:s,query:i,headers:o={}}=n,a=ArrayBuffer.isView(n.body)||n.__binaryRequest&&"string"==typeof n.body?n.body:tc(n.body)?n.body.body:n.body?JSON.stringify(n.body,null,2):null,l=this.calculateContentLength(a),u=this.buildURL(s,i);"timeout"in n&&tM("timeout",n.timeout),n.timeout=n.timeout??this.timeout;let d=n.httpAgent??this.httpAgent??c(u),h=n.timeout+1e3;"number"==typeof d?.options?.timeout&&h>(d.options.timeout??0)&&(d.options.timeout=h),this.idempotencyHeader&&"get"!==r&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),o[this.idempotencyHeader]=e.idempotencyKey);let f=this.buildHeaders({options:n,headers:o,contentLength:l,retryCount:t});return{req:{method:r,...a&&{body:a},headers:f,...d&&{agent:d},signal:n.signal??null},url:u,timeout:n.timeout}}buildHeaders({options:e,headers:t,contentLength:n,retryCount:r}){let i={};n&&(i["content-length"]=n);let o=this.defaultHeaders(e);return tB(i,o),tB(i,t),tc(e.body)&&"node"!==s&&delete i["content-type"],void 0===tG(o,"x-stainless-retry-count")&&void 0===tG(t,"x-stainless-retry-count")&&(i["x-stainless-retry-count"]=String(r)),void 0===tG(o,"x-stainless-timeout")&&void 0===tG(t,"x-stainless-timeout")&&e.timeout&&(i["x-stainless-timeout"]=String(Math.trunc(e.timeout/1e3))),this.validateHeaders(i,t),i}async prepareOptions(e){}async prepareRequest(e,{url:t,options:n}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(e=>[...e])):{...e}:{}}makeStatusError(e,t,n,r){return j.generate(e,t,n,r)}request(e,t=null){return new tw(this.makeRequest(e,t))}async makeRequest(e,t){let n=await e,r=n.maxRetries??this.maxRetries;null==t&&(t=r),await this.prepareOptions(n);let{req:s,url:i,timeout:o}=this.buildRequest(n,{retryCount:r-t});if(await this.prepareRequest(s,{url:i,options:n}),tq("request",i,n,s.headers),n.signal?.aborted)throw new N;let a=new AbortController,l=await this.fetchWithTimeout(i,s,o,a).catch(tU);if(l instanceof Error){if(n.signal?.aborted)throw new N;if(t)return this.retryRequest(n,t);if("AbortError"===l.name)throw new P;throw new O({cause:l})}let u=tA(l.headers);if(!l.ok){if(t&&this.shouldRetry(l)){let e=`retrying, ${t} attempts remaining`;return tq(`response (error; ${e})`,l.status,i,u),this.retryRequest(n,t,u)}let e=await l.text().catch(e=>tU(e).message),r=tN(e),s=r?void 0:e,o=t?"(error; no more retries left)":"(error; not retryable)";throw tq(`response (error; ${o})`,l.status,i,u,s),this.makeStatusError(l.status,r,s,u)}return{response:l,options:n,controller:a}}requestAPIList(e,t){return new tS(this,this.makeRequest(t,null),e)}buildURL(e,t){let n=new URL(tP(e)?e:this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),r=this.defaultQuery();return tL(r)||(t={...r,...t}),"object"==typeof t&&t&&!Array.isArray(t)&&(n.search=this.stringifyQuery(t)),n.toString()}stringifyQuery(e){return Object.entries(e).filter(([e,t])=>void 0!==t).map(([e,t])=>{if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return`${encodeURIComponent(e)}=${encodeURIComponent(t)}`;if(null===t)return`${encodeURIComponent(e)}=`;throw new C(`Cannot stringify type ${typeof t}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,t,n,r){let{signal:s,...i}=t||{};s&&s.addEventListener("abort",()=>r.abort());let o=setTimeout(()=>r.abort(),n),a={signal:r.signal,...i};return a.method&&(a.method=a.method.toUpperCase()),this.fetch.call(void 0,e,a).finally(()=>{clearTimeout(o)})}shouldRetry(e){let t=e.headers.get("x-should-retry");return"true"===t||"false"!==t&&(408===e.status||409===e.status||429===e.status||e.status>=500)}async retryRequest(e,t,n){let r;let s=n?.["retry-after-ms"];if(s){let e=parseFloat(s);Number.isNaN(e)||(r=e)}let i=n?.["retry-after"];if(i&&!r){let e=parseFloat(i);r=Number.isNaN(e)?Date.parse(i)-Date.now():1e3*e}if(!(r&&0<=r&&r<6e4)){let n=e.maxRetries??this.maxRetries;r=this.calculateDefaultRetryTimeoutMillis(t,n)}return await tR(r),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){return Math.min(.5*Math.pow(2,t-e),8)*(1-.25*Math.random())*1e3}getUserAgent(){return`${this.constructor.name}/JS ${I}`}}class tk{constructor(e,t,n,r){H.set(this,void 0),ty(this,H,e,"f"),this.options=r,this.response=t,this.body=n}hasNextPage(){return!!this.getPaginatedItems().length&&null!=this.nextPageInfo()}async getNextPage(){let e=this.nextPageInfo();if(!e)throw new C("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");let t={...this.options};if("params"in e&&"object"==typeof t.query)t.query={...t.query,...e.params};else if("url"in e){for(let[n,r]of[...Object.entries(t.query||{}),...e.url.searchParams.entries()])e.url.searchParams.set(n,r);t.query=void 0,t.path=e.url.toString()}return await tb(this,H,"f").requestAPIList(this.constructor,t)}async *iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async *[(H=new WeakMap,Symbol.asyncIterator)](){for await(let e of this.iterPages())for(let t of e.getPaginatedItems())yield t}}class tS extends tw{constructor(e,t,n){super(t,async t=>new n(e,t.response,await tv(t),t.options))}async *[Symbol.asyncIterator](){for await(let e of(await this))yield e}}let tA=e=>new Proxy(Object.fromEntries(e.entries()),{get(e,t){let n=t.toString();return e[n.toLowerCase()]||e[n]}}),tI={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__metadata:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},tE=e=>"object"==typeof e&&null!==e&&!tL(e)&&Object.keys(e).every(e=>tF(tI,e)),tT=()=>{if("undefined"!=typeof Deno&&null!=Deno.build)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":I,"X-Stainless-OS":tC(Deno.build.os),"X-Stainless-Arch":tz(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":"string"==typeof Deno.version?Deno.version:Deno.version?.deno??"unknown"};if("undefined"!=typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":I,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":tg.version};if("[object process]"===Object.prototype.toString.call(void 0!==tg?tg:0))return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":I,"X-Stainless-OS":tC(tg.platform),"X-Stainless-Arch":tz(tg.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":tg.version};let e=function(){if("undefined"==typeof navigator||!navigator)return null;for(let{key:e,pattern:t}of[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}]){let n=t.exec(navigator.userAgent);if(n){let t=n[1]||0,r=n[2]||0,s=n[3]||0;return{browser:e,version:`${t}.${r}.${s}`}}}return null}();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":I,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":I,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}},tz=e=>"x32"===e?"x32":"x86_64"===e||"x64"===e?"x64":"arm"===e?"arm":"aarch64"===e||"arm64"===e?"arm64":e?`other:${e}`:"unknown",tC=e=>(e=e.toLowerCase()).includes("ios")?"iOS":"android"===e?"Android":"darwin"===e?"MacOS":"win32"===e?"Windows":"freebsd"===e?"FreeBSD":"openbsd"===e?"OpenBSD":"linux"===e?"Linux":e?`Other:${e}`:"Unknown",tj=()=>r??(r=tT()),tN=e=>{try{return JSON.parse(e)}catch(e){return}},tO=/^[a-z][a-z0-9+.-]*:/i,tP=e=>tO.test(e),tR=e=>new Promise(t=>setTimeout(t,e)),tM=(e,t)=>{if("number"!=typeof t||!Number.isInteger(t))throw new C(`${e} must be an integer`);if(t<0)throw new C(`${e} must be a positive integer`);return t},tU=e=>{if(e instanceof Error)return e;if("object"==typeof e&&null!==e)try{return Error(JSON.stringify(e))}catch{}return Error(e)},t$=e=>void 0!==tg?tg.env?.[e]?.trim()??void 0:"undefined"!=typeof Deno?Deno.env?.get?.(e)?.trim():void 0;function tL(e){if(!e)return!0;for(let t in e)return!1;return!0}function tF(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function tB(e,t){for(let n in t){if(!tF(t,n))continue;let r=n.toLowerCase();if(!r)continue;let s=t[n];null===s?delete e[r]:void 0!==s&&(e[r]=s)}}let tD=new Set(["authorization","api-key"]);function tq(e,...t){void 0!==tg&&tg?.env?.DEBUG==="true"&&console.log(`OpenAI:DEBUG:${e}`,...t.map(e=>{if(!e)return e;if(e.headers){let t={...e,headers:{...e.headers}};for(let n in e.headers)tD.has(n.toLowerCase())&&(t.headers[n]="REDACTED");return t}let t=null;for(let n in e)tD.has(n.toLowerCase())&&(t??(t={...e}),t[n]="REDACTED");return t??e}))}let tV=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}),tW=()=>"undefined"!=typeof window&&void 0!==window.document&&"undefined"!=typeof navigator,tH=e=>"function"==typeof e?.get,tG=(e,t)=>{let n=t.toLowerCase();if(tH(e)){let r=t[0]?.toUpperCase()+t.substring(1).replace(/([^\w])(\w)/g,(e,t,n)=>t+n.toUpperCase());for(let s of[t,n,t.toUpperCase(),r]){let t=e.get(s);if(t)return t}}for(let[r,s]of Object.entries(e))if(r.toLowerCase()===n){if(Array.isArray(s)){if(s.length<=1)return s[0];return console.warn(`Received ${s.length} entries for the ${t} header, using the first entry.`),s[0]}return s}},tZ=e=>{if(void 0!==tm){let t=tm.from(e,"base64");return Array.from(new Float32Array(t.buffer,t.byteOffset,t.length/Float32Array.BYTES_PER_ELEMENT))}{let t=atob(e),n=t.length,r=new Uint8Array(n);for(let e=0;e<n;e++)r[e]=t.charCodeAt(e);return Array.from(new Float32Array(r.buffer))}};function tJ(e){return null!=e&&"object"==typeof e&&!Array.isArray(e)}class tK{constructor(e){this._client=e}}class tX extends tK{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}}class tY extends tK{list(e,t={},n){return tE(t)?this.list(e,{},t):this._client.getAPIList(`/chat/completions/${e}/messages`,t6,{query:t,...n})}}class tQ extends tk{constructor(e,t,n,r){super(e,t,n,r),this.data=n.data||[],this.object=n.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class t0 extends tk{constructor(e,t,n,r){super(e,t,n,r),this.data=n.data||[],this.has_more=n.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return!1!==this.has_more&&super.hasNextPage()}nextPageParams(){let e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;let t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){let e=this.getPaginatedItems();if(!e.length)return null;let t=e[e.length-1]?.id;return t?{params:{after:t}}:null}}class t1 extends tK{constructor(){super(...arguments),this.messages=new tY(this._client)}create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}retrieve(e,t){return this._client.get(`/chat/completions/${e}`,t)}update(e,t,n){return this._client.post(`/chat/completions/${e}`,{body:t,...n})}list(e={},t){return tE(e)?this.list({},e):this._client.getAPIList("/chat/completions",t2,{query:e,...t})}del(e,t){return this._client.delete(`/chat/completions/${e}`,t)}}class t2 extends t0{}class t6 extends t0{}t1.ChatCompletionsPage=t2,t1.Messages=tY;class t3 extends tK{constructor(){super(...arguments),this.completions=new t1(this._client)}}t3.Completions=t1,t3.ChatCompletionsPage=t2;class t4 extends tK{create(e,t){let n=!!e.encoding_format,r=n?e.encoding_format:"base64";n&&tq("Request","User defined encoding_format:",e.encoding_format);let s=this._client.post("/embeddings",{body:{...e,encoding_format:r},...t});return n?s:(tq("response","Decoding base64 embeddings to float32 array"),s._thenUnwrap(e=>(e&&e.data&&e.data.forEach(e=>{let t=e.embedding;e.embedding=tZ(t)}),e)))}}class t5 extends tK{create(e,t){return this._client.post("/files",td({body:e,...t}))}retrieve(e,t){return this._client.get(`/files/${e}`,t)}list(e={},t){return tE(e)?this.list({},e):this._client.getAPIList("/files",t8,{query:e,...t})}del(e,t){return this._client.delete(`/files/${e}`,t)}content(e,t){return this._client.get(`/files/${e}/content`,{...t,headers:{Accept:"application/binary",...t?.headers},__binaryResponse:!0})}retrieveContent(e,t){return this._client.get(`/files/${e}/content`,t)}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:n=18e5}={}){let r=new Set(["processed","error","deleted"]),s=Date.now(),i=await this.retrieve(e);for(;!i.status||!r.has(i.status);)if(await tR(t),i=await this.retrieve(e),Date.now()-s>n)throw new P({message:`Giving up on waiting for file ${e} to finish processing after ${n} milliseconds.`});return i}}class t8 extends t0{}t5.FileObjectsPage=t8;class t9 extends tK{createVariation(e,t){return this._client.post("/images/variations",td({body:e,...t}))}edit(e,t){return this._client.post("/images/edits",td({body:e,...t}))}generate(e,t){return this._client.post("/images/generations",{body:e,...t})}}class t7 extends tK{create(e,t){return this._client.post("/audio/speech",{body:e,...t,headers:{Accept:"application/octet-stream",...t?.headers},__binaryResponse:!0})}}class ne extends tK{create(e,t){return this._client.post("/audio/transcriptions",td({body:e,...t,stream:e.stream??!1,__metadata:{model:e.model}}))}}class nt extends tK{create(e,t){return this._client.post("/audio/translations",td({body:e,...t,__metadata:{model:e.model}}))}}class nn extends tK{constructor(){super(...arguments),this.transcriptions=new ne(this._client),this.translations=new nt(this._client),this.speech=new t7(this._client)}}nn.Transcriptions=ne,nn.Translations=nt,nn.Speech=t7;class nr extends tK{create(e,t){return this._client.post("/moderations",{body:e,...t})}}class ns extends tK{retrieve(e,t){return this._client.get(`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",ni,e)}del(e,t){return this._client.delete(`/models/${e}`,t)}}class ni extends tQ{}ns.ModelsPage=ni;class no extends tK{}class na extends tK{run(e,t){return this._client.post("/fine_tuning/alpha/graders/run",{body:e,...t})}validate(e,t){return this._client.post("/fine_tuning/alpha/graders/validate",{body:e,...t})}}class nl extends tK{constructor(){super(...arguments),this.graders=new na(this._client)}}nl.Graders=na;class nu extends tK{create(e,t,n){return this._client.getAPIList(`/fine_tuning/checkpoints/${e}/permissions`,nc,{body:t,method:"post",...n})}retrieve(e,t={},n){return tE(t)?this.retrieve(e,{},t):this._client.get(`/fine_tuning/checkpoints/${e}/permissions`,{query:t,...n})}del(e,t,n){return this._client.delete(`/fine_tuning/checkpoints/${e}/permissions/${t}`,n)}}class nc extends tQ{}nu.PermissionCreateResponsesPage=nc;class nd extends tK{constructor(){super(...arguments),this.permissions=new nu(this._client)}}nd.Permissions=nu,nd.PermissionCreateResponsesPage=nc;class nh extends tK{list(e,t={},n){return tE(t)?this.list(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,nf,{query:t,...n})}}class nf extends t0{}nh.FineTuningJobCheckpointsPage=nf;class np extends tK{constructor(){super(...arguments),this.checkpoints=new nh(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get(`/fine_tuning/jobs/${e}`,t)}list(e={},t){return tE(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",nm,{query:e,...t})}cancel(e,t){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},n){return tE(t)?this.listEvents(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,ng,{query:t,...n})}pause(e,t){return this._client.post(`/fine_tuning/jobs/${e}/pause`,t)}resume(e,t){return this._client.post(`/fine_tuning/jobs/${e}/resume`,t)}}class nm extends t0{}class ng extends t0{}np.FineTuningJobsPage=nm,np.FineTuningJobEventsPage=ng,np.Checkpoints=nh,np.FineTuningJobCheckpointsPage=nf;class ny extends tK{constructor(){super(...arguments),this.methods=new no(this._client),this.jobs=new np(this._client),this.checkpoints=new nd(this._client),this.alpha=new nl(this._client)}}ny.Methods=no,ny.Jobs=np,ny.FineTuningJobsPage=nm,ny.FineTuningJobEventsPage=ng,ny.Checkpoints=nd,ny.Alpha=nl;class nb extends tK{}class nv extends tK{constructor(){super(...arguments),this.graderModels=new nb(this._client)}}nv.GraderModels=nb;let n_=async e=>{let t=await Promise.allSettled(e),n=t.filter(e=>"rejected"===e.status);if(n.length){for(let e of n)console.error(e.reason);throw Error(`${n.length} promise(s) failed - see the above errors`)}let r=[];for(let e of t)"fulfilled"===e.status&&r.push(e.value);return r};class nw extends tK{create(e,t,n){return this._client.post(`/vector_stores/${e}/files`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}retrieve(e,t,n){return this._client.get(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}update(e,t,n,r){return this._client.post(`/vector_stores/${e}/files/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}list(e,t={},n){return tE(t)?this.list(e,{},t):this._client.getAPIList(`/vector_stores/${e}/files`,nx,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}del(e,t,n){return this._client.delete(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}async createAndPoll(e,t,n){let r=await this.create(e,t,n);return await this.poll(e,r.id,n)}async poll(e,t,n){let r={...n?.headers,"X-Stainless-Poll-Helper":"true"};for(n?.pollIntervalMs&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){let s=await this.retrieve(e,t,{...n,headers:r}).withResponse(),i=s.data;switch(i.status){case"in_progress":let o=5e3;if(n?.pollIntervalMs)o=n.pollIntervalMs;else{let e=s.response.headers.get("openai-poll-after-ms");if(e){let t=parseInt(e);isNaN(t)||(o=t)}}await tR(o);break;case"failed":case"completed":return i}}}async upload(e,t,n){let r=await this._client.files.create({file:t,purpose:"assistants"},n);return this.create(e,{file_id:r.id},n)}async uploadAndPoll(e,t,n){let r=await this.upload(e,t,n);return await this.poll(e,r.id,n)}content(e,t,n){return this._client.getAPIList(`/vector_stores/${e}/files/${t}/content`,nk,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}}class nx extends t0{}class nk extends tQ{}nw.VectorStoreFilesPage=nx,nw.FileContentResponsesPage=nk;class nS extends tK{create(e,t,n){return this._client.post(`/vector_stores/${e}/file_batches`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}retrieve(e,t,n){return this._client.get(`/vector_stores/${e}/file_batches/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}cancel(e,t,n){return this._client.post(`/vector_stores/${e}/file_batches/${t}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}async createAndPoll(e,t,n){let r=await this.create(e,t);return await this.poll(e,r.id,n)}listFiles(e,t,n={},r){return tE(n)?this.listFiles(e,t,{},n):this._client.getAPIList(`/vector_stores/${e}/file_batches/${t}/files`,nx,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}async poll(e,t,n){let r={...n?.headers,"X-Stainless-Poll-Helper":"true"};for(n?.pollIntervalMs&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){let{data:s,response:i}=await this.retrieve(e,t,{...n,headers:r}).withResponse();switch(s.status){case"in_progress":let o=5e3;if(n?.pollIntervalMs)o=n.pollIntervalMs;else{let e=i.headers.get("openai-poll-after-ms");if(e){let t=parseInt(e);isNaN(t)||(o=t)}}await tR(o);break;case"failed":case"cancelled":case"completed":return s}}}async uploadAndPoll(e,{files:t,fileIds:n=[]},r){if(null==t||0==t.length)throw Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");let s=Math.min(r?.maxConcurrency??5,t.length),i=this._client,o=t.values(),a=[...n];async function l(e){for(let t of e){let e=await i.files.create({file:t,purpose:"assistants"},r);a.push(e.id)}}let u=Array(s).fill(o).map(l);return await n_(u),await this.createAndPoll(e,{file_ids:a})}}class nA extends tK{constructor(){super(...arguments),this.files=new nw(this._client),this.fileBatches=new nS(this._client)}create(e,t){return this._client.post("/vector_stores",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,n){return this._client.post(`/vector_stores/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}list(e={},t){return tE(e)?this.list({},e):this._client.getAPIList("/vector_stores",nI,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}del(e,t){return this._client.delete(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}search(e,t,n){return this._client.getAPIList(`/vector_stores/${e}/search`,nE,{body:t,method:"post",...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}}class nI extends t0{}class nE extends tQ{}nA.VectorStoresPage=nI,nA.VectorStoreSearchResponsesPage=nE,nA.Files=nw,nA.VectorStoreFilesPage=nx,nA.FileContentResponsesPage=nk,nA.FileBatches=nS;class nT extends tK{create(e,t){return this._client.post("/assistants",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,n){return this._client.post(`/assistants/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}list(e={},t){return tE(e)?this.list({},e):this._client.getAPIList("/assistants",nz,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}del(e,t){return this._client.delete(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}}class nz extends t0{}function nC(e){return"function"==typeof e.parse}nT.AssistantsPage=nz;let nj=e=>e?.role==="assistant",nN=e=>e?.role==="function",nO=e=>e?.role==="tool";var nP=function(e,t,n,r,s){if("m"===r)throw TypeError("Private method is not writable");if("a"===r&&!s)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n},nR=function(e,t,n,r){if("a"===n&&!r)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};class nM{constructor(){G.add(this),this.controller=new AbortController,Z.set(this,void 0),J.set(this,()=>{}),K.set(this,()=>{}),X.set(this,void 0),Y.set(this,()=>{}),Q.set(this,()=>{}),ee.set(this,{}),et.set(this,!1),en.set(this,!1),er.set(this,!1),es.set(this,!1),nP(this,Z,new Promise((e,t)=>{nP(this,J,e,"f"),nP(this,K,t,"f")}),"f"),nP(this,X,new Promise((e,t)=>{nP(this,Y,e,"f"),nP(this,Q,t,"f")}),"f"),nR(this,Z,"f").catch(()=>{}),nR(this,X,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},nR(this,G,"m",ei).bind(this))},0)}_connected(){this.ended||(nR(this,J,"f").call(this),this._emit("connect"))}get ended(){return nR(this,et,"f")}get errored(){return nR(this,en,"f")}get aborted(){return nR(this,er,"f")}abort(){this.controller.abort()}on(e,t){return(nR(this,ee,"f")[e]||(nR(this,ee,"f")[e]=[])).push({listener:t}),this}off(e,t){let n=nR(this,ee,"f")[e];if(!n)return this;let r=n.findIndex(e=>e.listener===t);return r>=0&&n.splice(r,1),this}once(e,t){return(nR(this,ee,"f")[e]||(nR(this,ee,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,n)=>{nP(this,es,!0,"f"),"error"!==e&&this.once("error",n),this.once(e,t)})}async done(){nP(this,es,!0,"f"),await nR(this,X,"f")}_emit(e,...t){if(nR(this,et,"f"))return;"end"===e&&(nP(this,et,!0,"f"),nR(this,Y,"f").call(this));let n=nR(this,ee,"f")[e];if(n&&(nR(this,ee,"f")[e]=n.filter(e=>!e.once),n.forEach(({listener:e})=>e(...t))),"abort"===e){let e=t[0];nR(this,es,"f")||n?.length||Promise.reject(e),nR(this,K,"f").call(this,e),nR(this,Q,"f").call(this,e),this._emit("end");return}if("error"===e){let e=t[0];nR(this,es,"f")||n?.length||Promise.reject(e),nR(this,K,"f").call(this,e),nR(this,Q,"f").call(this,e),this._emit("end")}}_emitFinal(){}}function nU(e){return e?.$brand==="auto-parseable-response-format"}function n$(e){return e?.$brand==="auto-parseable-tool"}function nL(e,t){let n=e.choices.map(e=>{var n;if("length"===e.finish_reason)throw new q;if("content_filter"===e.finish_reason)throw new V;return{...e,message:{...e.message,...e.message.tool_calls?{tool_calls:e.message.tool_calls?.map(e=>(function(e,t){let n=e.tools?.find(e=>e.function?.name===t.function.name);return{...t,function:{...t.function,parsed_arguments:n$(n)?n.$parseRaw(t.function.arguments):n?.function.strict?JSON.parse(t.function.arguments):null}}})(t,e))??void 0}:void 0,parsed:e.message.content&&!e.message.refusal?(n=e.message.content,t.response_format?.type!=="json_schema"?null:t.response_format?.type==="json_schema"?"$parseRaw"in t.response_format?t.response_format.$parseRaw(n):JSON.parse(n):null):null}}});return{...e,choices:n}}function nF(e){return!!nU(e.response_format)||(e.tools?.some(e=>n$(e)||"function"===e.type&&!0===e.function.strict)??!1)}Z=new WeakMap,J=new WeakMap,K=new WeakMap,X=new WeakMap,Y=new WeakMap,Q=new WeakMap,ee=new WeakMap,et=new WeakMap,en=new WeakMap,er=new WeakMap,es=new WeakMap,G=new WeakSet,ei=function(e){if(nP(this,en,!0,"f"),e instanceof Error&&"AbortError"===e.name&&(e=new N),e instanceof N)return nP(this,er,!0,"f"),this._emit("abort",e);if(e instanceof C)return this._emit("error",e);if(e instanceof Error){let t=new C(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new C(String(e)))};var nB=function(e,t,n,r){if("a"===n&&!r)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};class nD extends nM{constructor(){super(...arguments),eo.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){this._chatCompletions.push(e),this._emit("chatCompletion",e);let t=e.choices[0]?.message;return t&&this._addMessage(t),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t){if(this._emit("message",e),(nN(e)||nO(e))&&e.content)this._emit("functionCallResult",e.content);else if(nj(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(nj(e)&&e.tool_calls)for(let t of e.tool_calls)"function"===t.type&&this._emit("functionCall",t.function)}}async finalChatCompletion(){await this.done();let e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new C("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),nB(this,eo,"m",ea).call(this)}async finalMessage(){return await this.done(),nB(this,eo,"m",el).call(this)}async finalFunctionCall(){return await this.done(),nB(this,eo,"m",eu).call(this)}async finalFunctionCallResult(){return await this.done(),nB(this,eo,"m",ec).call(this)}async totalUsage(){return await this.done(),nB(this,eo,"m",ed).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){let e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);let t=nB(this,eo,"m",el).call(this);t&&this._emit("finalMessage",t);let n=nB(this,eo,"m",ea).call(this);n&&this._emit("finalContent",n);let r=nB(this,eo,"m",eu).call(this);r&&this._emit("finalFunctionCall",r);let s=nB(this,eo,"m",ec).call(this);null!=s&&this._emit("finalFunctionCallResult",s),this._chatCompletions.some(e=>e.usage)&&this._emit("totalUsage",nB(this,eo,"m",ed).call(this))}async _createChatCompletion(e,t,n){let r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),nB(this,eo,"m",eh).call(this,t);let s=await e.chat.completions.create({...t,stream:!1},{...n,signal:this.controller.signal});return this._connected(),this._addChatCompletion(nL(s,t))}async _runChatCompletion(e,t,n){for(let e of t.messages)this._addMessage(e,!1);return await this._createChatCompletion(e,t,n)}async _runFunctions(e,t,n){let r="function",{function_call:s="auto",stream:i,...o}=t,a="string"!=typeof s&&s?.name,{maxChatCompletions:l=10}=n||{},u={};for(let e of t.functions)u[e.name||e.function.name]=e;let c=t.functions.map(e=>({name:e.name||e.function.name,parameters:e.parameters,description:e.description}));for(let e of t.messages)this._addMessage(e,!1);for(let t=0;t<l;++t){let t;let i=await this._createChatCompletion(e,{...o,function_call:s,functions:c,messages:[...this.messages]},n),l=i.choices[0]?.message;if(!l)throw new C("missing message in ChatCompletion response");if(!l.function_call)return;let{name:d,arguments:h}=l.function_call,f=u[d];if(f){if(a&&a!==d){let e=`Invalid function_call: ${JSON.stringify(d)}. ${JSON.stringify(a)} requested. Please try again`;this._addMessage({role:r,name:d,content:e});continue}}else{let e=`Invalid function_call: ${JSON.stringify(d)}. Available options are: ${c.map(e=>JSON.stringify(e.name)).join(", ")}. Please try again`;this._addMessage({role:r,name:d,content:e});continue}try{t=nC(f)?await f.parse(h):h}catch(e){this._addMessage({role:r,name:d,content:e instanceof Error?e.message:String(e)});continue}let p=await f.function(t,this),m=nB(this,eo,"m",ef).call(this,p);if(this._addMessage({role:r,name:d,content:m}),a)return}}async _runTools(e,t,n){let r="tool",{tool_choice:s="auto",stream:i,...o}=t,a="string"!=typeof s&&s?.function?.name,{maxChatCompletions:l=10}=n||{},u=t.tools.map(e=>{if(n$(e)){if(!e.$callback)throw new C("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:e.$callback,name:e.function.name,description:e.function.description||"",parameters:e.function.parameters,parse:e.$parseRaw,strict:!0}}}return e}),c={};for(let e of u)"function"===e.type&&(c[e.function.name||e.function.function.name]=e.function);let d="tools"in t?u.map(e=>"function"===e.type?{type:"function",function:{name:e.function.name||e.function.function.name,parameters:e.function.parameters,description:e.function.description,strict:e.function.strict}}:e):void 0;for(let e of t.messages)this._addMessage(e,!1);for(let t=0;t<l;++t){let t=await this._createChatCompletion(e,{...o,tool_choice:s,tools:d,messages:[...this.messages]},n),i=t.choices[0]?.message;if(!i)throw new C("missing message in ChatCompletion response");if(!i.tool_calls?.length)break;for(let e of i.tool_calls){let t;if("function"!==e.type)continue;let n=e.id,{name:s,arguments:i}=e.function,o=c[s];if(o){if(a&&a!==s){let e=`Invalid tool_call: ${JSON.stringify(s)}. ${JSON.stringify(a)} requested. Please try again`;this._addMessage({role:r,tool_call_id:n,content:e});continue}}else{let e=`Invalid tool_call: ${JSON.stringify(s)}. Available options are: ${Object.keys(c).map(e=>JSON.stringify(e)).join(", ")}. Please try again`;this._addMessage({role:r,tool_call_id:n,content:e});continue}try{t=nC(o)?await o.parse(i):i}catch(t){let e=t instanceof Error?t.message:String(t);this._addMessage({role:r,tool_call_id:n,content:e});continue}let l=await o.function(t,this),u=nB(this,eo,"m",ef).call(this,l);if(this._addMessage({role:r,tool_call_id:n,content:u}),a)return}}}}eo=new WeakSet,ea=function(){return nB(this,eo,"m",el).call(this).content??null},el=function(){let e=this.messages.length;for(;e-- >0;){let t=this.messages[e];if(nj(t)){let{function_call:e,...n}=t,r={...n,content:t.content??null,refusal:t.refusal??null};return e&&(r.function_call=e),r}}throw new C("stream ended without producing a ChatCompletionMessage with role=assistant")},eu=function(){for(let e=this.messages.length-1;e>=0;e--){let t=this.messages[e];if(nj(t)&&t?.function_call)return t.function_call;if(nj(t)&&t?.tool_calls?.length)return t.tool_calls.at(-1)?.function}},ec=function(){for(let e=this.messages.length-1;e>=0;e--){let t=this.messages[e];if(nN(t)&&null!=t.content||nO(t)&&null!=t.content&&"string"==typeof t.content&&this.messages.some(e=>"assistant"===e.role&&e.tool_calls?.some(e=>"function"===e.type&&e.id===t.tool_call_id)))return t.content}},ed=function(){let e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(let{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},eh=function(e){if(null!=e.n&&e.n>1)throw new C("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},ef=function(e){return"string"==typeof e?e:void 0===e?"undefined":JSON.stringify(e)};class nq extends nD{static runFunctions(e,t,n){let r=new nq,s={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return r._run(()=>r._runFunctions(e,t,s)),r}static runTools(e,t,n){let r=new nq,s={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runTools"}};return r._run(()=>r._runTools(e,t,s)),r}_addMessage(e,t=!0){super._addMessage(e,t),nj(e)&&e.content&&this._emit("content",e.content)}}let nV={STR:1,NUM:2,ARR:4,OBJ:8,NULL:16,BOOL:32,NAN:64,INFINITY:128,MINUS_INFINITY:256,ALL:511};class nW extends Error{}class nH extends Error{}let nG=(e,t)=>{let n=e.length,r=0,s=e=>{throw new nW(`${e} at position ${r}`)},i=e=>{throw new nH(`${e} at position ${r}`)},o=()=>(d(),r>=n&&s("Unexpected end of input"),'"'===e[r])?a():"{"===e[r]?l():"["===e[r]?u():"null"===e.substring(r,r+4)||nV.NULL&t&&n-r<4&&"null".startsWith(e.substring(r))?(r+=4,null):"true"===e.substring(r,r+4)||nV.BOOL&t&&n-r<4&&"true".startsWith(e.substring(r))?(r+=4,!0):"false"===e.substring(r,r+5)||nV.BOOL&t&&n-r<5&&"false".startsWith(e.substring(r))?(r+=5,!1):"Infinity"===e.substring(r,r+8)||nV.INFINITY&t&&n-r<8&&"Infinity".startsWith(e.substring(r))?(r+=8,1/0):"-Infinity"===e.substring(r,r+9)||nV.MINUS_INFINITY&t&&1<n-r&&n-r<9&&"-Infinity".startsWith(e.substring(r))?(r+=9,-1/0):"NaN"===e.substring(r,r+3)||nV.NAN&t&&n-r<3&&"NaN".startsWith(e.substring(r))?(r+=3,NaN):c(),a=()=>{let o=r,a=!1;for(r++;r<n&&('"'!==e[r]||a&&"\\"===e[r-1]);)a="\\"===e[r]&&!a,r++;if('"'==e.charAt(r))try{return JSON.parse(e.substring(o,++r-Number(a)))}catch(e){i(String(e))}else if(nV.STR&t)try{return JSON.parse(e.substring(o,r-Number(a))+'"')}catch(t){return JSON.parse(e.substring(o,e.lastIndexOf("\\"))+'"')}s("Unterminated string literal")},l=()=>{r++,d();let i={};try{for(;"}"!==e[r];){if(d(),r>=n&&nV.OBJ&t)return i;let s=a();d(),r++;try{let e=o();Object.defineProperty(i,s,{value:e,writable:!0,enumerable:!0,configurable:!0})}catch(e){if(nV.OBJ&t)return i;throw e}d(),","===e[r]&&r++}}catch(e){if(nV.OBJ&t)return i;s("Expected '}' at end of object")}return r++,i},u=()=>{r++;let n=[];try{for(;"]"!==e[r];)n.push(o()),d(),","===e[r]&&r++}catch(e){if(nV.ARR&t)return n;s("Expected ']' at end of array")}return r++,n},c=()=>{if(0===r){"-"===e&&nV.NUM&t&&s("Not sure what '-' is");try{return JSON.parse(e)}catch(n){if(nV.NUM&t)try{if("."===e[e.length-1])return JSON.parse(e.substring(0,e.lastIndexOf(".")));return JSON.parse(e.substring(0,e.lastIndexOf("e")))}catch(e){}i(String(n))}}let o=r;for("-"===e[r]&&r++;e[r]&&!",]}".includes(e[r]);)r++;r!=n||nV.NUM&t||s("Unterminated number literal");try{return JSON.parse(e.substring(o,r))}catch(n){"-"===e.substring(o,r)&&nV.NUM&t&&s("Not sure what '-' is");try{return JSON.parse(e.substring(o,e.lastIndexOf("e")))}catch(e){i(String(e))}}},d=()=>{for(;r<n&&" \n\r	".includes(e[r]);)r++};return o()},nZ=e=>(function(e,t=nV.ALL){if("string"!=typeof e)throw TypeError(`expecting str, got ${typeof e}`);if(!e.trim())throw Error(`${e} is empty`);return nG(e.trim(),t)})(e,nV.ALL^nV.NUM);var nJ=function(e,t,n,r,s){if("m"===r)throw TypeError("Private method is not writable");if("a"===r&&!s)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n},nK=function(e,t,n,r){if("a"===n&&!r)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};class nX extends nD{constructor(e){super(),ep.add(this),em.set(this,void 0),eg.set(this,void 0),ey.set(this,void 0),nJ(this,em,e,"f"),nJ(this,eg,[],"f")}get currentChatCompletionSnapshot(){return nK(this,ey,"f")}static fromReadableStream(e){let t=new nX(null);return t._run(()=>t._fromReadableStream(e)),t}static createChatCompletion(e,t,n){let r=new nX(t);return r._run(()=>r._runChatCompletion(e,{...t,stream:!0},{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}})),r}async _createChatCompletion(e,t,n){super._createChatCompletion;let r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),nK(this,ep,"m",eb).call(this);let s=await e.chat.completions.create({...t,stream:!0},{...n,signal:this.controller.signal});for await(let e of(this._connected(),s))nK(this,ep,"m",e_).call(this,e);if(s.controller.signal?.aborted)throw new N;return this._addChatCompletion(nK(this,ep,"m",ek).call(this))}async _fromReadableStream(e,t){let n;let r=t?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),nK(this,ep,"m",eb).call(this),this._connected();let s=e8.fromReadableStream(e,this.controller);for await(let e of s)n&&n!==e.id&&this._addChatCompletion(nK(this,ep,"m",ek).call(this)),nK(this,ep,"m",e_).call(this,e),n=e.id;if(s.controller.signal?.aborted)throw new N;return this._addChatCompletion(nK(this,ep,"m",ek).call(this))}[(em=new WeakMap,eg=new WeakMap,ey=new WeakMap,ep=new WeakSet,eb=function(){this.ended||nJ(this,ey,void 0,"f")},ev=function(e){let t=nK(this,eg,"f")[e.index];return t||(t={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},nK(this,eg,"f")[e.index]=t),t},e_=function(e){if(this.ended)return;let t=nK(this,ep,"m",eA).call(this,e);for(let n of(this._emit("chunk",e,t),e.choices)){let e=t.choices[n.index];null!=n.delta.content&&e.message?.role==="assistant"&&e.message?.content&&(this._emit("content",n.delta.content,e.message.content),this._emit("content.delta",{delta:n.delta.content,snapshot:e.message.content,parsed:e.message.parsed})),null!=n.delta.refusal&&e.message?.role==="assistant"&&e.message?.refusal&&this._emit("refusal.delta",{delta:n.delta.refusal,snapshot:e.message.refusal}),n.logprobs?.content!=null&&e.message?.role==="assistant"&&this._emit("logprobs.content.delta",{content:n.logprobs?.content,snapshot:e.logprobs?.content??[]}),n.logprobs?.refusal!=null&&e.message?.role==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:n.logprobs?.refusal,snapshot:e.logprobs?.refusal??[]});let r=nK(this,ep,"m",ev).call(this,e);for(let t of(e.finish_reason&&(nK(this,ep,"m",ex).call(this,e),null!=r.current_tool_call_index&&nK(this,ep,"m",ew).call(this,e,r.current_tool_call_index)),n.delta.tool_calls??[]))r.current_tool_call_index!==t.index&&(nK(this,ep,"m",ex).call(this,e),null!=r.current_tool_call_index&&nK(this,ep,"m",ew).call(this,e,r.current_tool_call_index)),r.current_tool_call_index=t.index;for(let t of n.delta.tool_calls??[]){let n=e.message.tool_calls?.[t.index];n?.type&&(n?.type==="function"?this._emit("tool_calls.function.arguments.delta",{name:n.function?.name,index:t.index,arguments:n.function.arguments,parsed_arguments:n.function.parsed_arguments,arguments_delta:t.function?.arguments??""}):n?.type)}}},ew=function(e,t){if(nK(this,ep,"m",ev).call(this,e).done_tool_calls.has(t))return;let n=e.message.tool_calls?.[t];if(!n)throw Error("no tool call snapshot");if(!n.type)throw Error("tool call snapshot missing `type`");if("function"===n.type){let e=nK(this,em,"f")?.tools?.find(e=>"function"===e.type&&e.function.name===n.function.name);this._emit("tool_calls.function.arguments.done",{name:n.function.name,index:t,arguments:n.function.arguments,parsed_arguments:n$(e)?e.$parseRaw(n.function.arguments):e?.function.strict?JSON.parse(n.function.arguments):null})}else n.type},ex=function(e){let t=nK(this,ep,"m",ev).call(this,e);if(e.message.content&&!t.content_done){t.content_done=!0;let n=nK(this,ep,"m",eS).call(this);this._emit("content.done",{content:e.message.content,parsed:n?n.$parseRaw(e.message.content):null})}e.message.refusal&&!t.refusal_done&&(t.refusal_done=!0,this._emit("refusal.done",{refusal:e.message.refusal})),e.logprobs?.content&&!t.logprobs_content_done&&(t.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:e.logprobs.content})),e.logprobs?.refusal&&!t.logprobs_refusal_done&&(t.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:e.logprobs.refusal}))},ek=function(){if(this.ended)throw new C("stream has ended, this shouldn't happen");let e=nK(this,ey,"f");if(!e)throw new C("request ended without sending any chunks");return nJ(this,ey,void 0,"f"),nJ(this,eg,[],"f"),function(e,t){var n;let{id:r,choices:s,created:i,model:o,system_fingerprint:a,...l}=e;return n={...l,id:r,choices:s.map(({message:t,finish_reason:n,index:r,logprobs:s,...i})=>{if(!n)throw new C(`missing finish_reason for choice ${r}`);let{content:o=null,function_call:a,tool_calls:l,...u}=t,c=t.role;if(!c)throw new C(`missing role for choice ${r}`);if(a){let{arguments:e,name:l}=a;if(null==e)throw new C(`missing function_call.arguments for choice ${r}`);if(!l)throw new C(`missing function_call.name for choice ${r}`);return{...i,message:{content:o,function_call:{arguments:e,name:l},role:c,refusal:t.refusal??null},finish_reason:n,index:r,logprobs:s}}return l?{...i,index:r,finish_reason:n,logprobs:s,message:{...u,role:c,content:o,refusal:t.refusal??null,tool_calls:l.map((t,n)=>{let{function:s,type:i,id:o,...a}=t,{arguments:l,name:u,...c}=s||{};if(null==o)throw new C(`missing choices[${r}].tool_calls[${n}].id
${nY(e)}`);if(null==i)throw new C(`missing choices[${r}].tool_calls[${n}].type
${nY(e)}`);if(null==u)throw new C(`missing choices[${r}].tool_calls[${n}].function.name
${nY(e)}`);if(null==l)throw new C(`missing choices[${r}].tool_calls[${n}].function.arguments
${nY(e)}`);return{...a,id:o,type:i,function:{...c,name:u,arguments:l}}})}}:{...i,message:{...u,content:o,role:c,refusal:t.refusal??null},finish_reason:n,index:r,logprobs:s}}),created:i,model:o,object:"chat.completion",...a?{system_fingerprint:a}:{}},t&&nF(t)?nL(n,t):{...n,choices:n.choices.map(e=>({...e,message:{...e.message,parsed:null,...e.message.tool_calls?{tool_calls:e.message.tool_calls}:void 0}}))}}(e,nK(this,em,"f"))},eS=function(){let e=nK(this,em,"f")?.response_format;return nU(e)?e:null},eA=function(e){var t,n,r,s;let i=nK(this,ey,"f"),{choices:o,...a}=e;for(let{delta:o,finish_reason:l,index:u,logprobs:c=null,...d}of(i?Object.assign(i,a):i=nJ(this,ey,{...a,choices:[]},"f"),e.choices)){let e=i.choices[u];if(e||(e=i.choices[u]={finish_reason:l,index:u,message:{},logprobs:c,...d}),c){if(e.logprobs){let{content:r,refusal:s,...i}=c;Object.assign(e.logprobs,i),r&&((t=e.logprobs).content??(t.content=[]),e.logprobs.content.push(...r)),s&&((n=e.logprobs).refusal??(n.refusal=[]),e.logprobs.refusal.push(...s))}else e.logprobs=Object.assign({},c)}if(l&&(e.finish_reason=l,nK(this,em,"f")&&nF(nK(this,em,"f")))){if("length"===l)throw new q;if("content_filter"===l)throw new V}if(Object.assign(e,d),!o)continue;let{content:a,refusal:h,function_call:f,role:p,tool_calls:m,...g}=o;if(Object.assign(e.message,g),h&&(e.message.refusal=(e.message.refusal||"")+h),p&&(e.message.role=p),f&&(e.message.function_call?(f.name&&(e.message.function_call.name=f.name),f.arguments&&((r=e.message.function_call).arguments??(r.arguments=""),e.message.function_call.arguments+=f.arguments)):e.message.function_call=f),a&&(e.message.content=(e.message.content||"")+a,!e.message.refusal&&nK(this,ep,"m",eS).call(this)&&(e.message.parsed=nZ(e.message.content))),m)for(let{index:t,id:n,type:r,function:i,...o}of(e.message.tool_calls||(e.message.tool_calls=[]),m)){let a=(s=e.message.tool_calls)[t]??(s[t]={});Object.assign(a,o),n&&(a.id=n),r&&(a.type=r),i&&(a.function??(a.function={name:i.name??"",arguments:""})),i?.name&&(a.function.name=i.name),i?.arguments&&(a.function.arguments+=i.arguments,function(e,t){if(!e)return!1;let n=e.tools?.find(e=>e.function?.name===t.function.name);return n$(n)||n?.function.strict||!1}(nK(this,em,"f"),a)&&(a.function.parsed_arguments=nZ(a.function.arguments)))}}return i},Symbol.asyncIterator)](){let e=[],t=[],n=!1;return this.on("chunk",n=>{let r=t.shift();r?r.resolve(n):e.push(n)}),this.on("end",()=>{for(let e of(n=!0,t))e.resolve(void 0);t.length=0}),this.on("abort",e=>{for(let r of(n=!0,t))r.reject(e);t.length=0}),this.on("error",e=>{for(let r of(n=!0,t))r.reject(e);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((e,n)=>t.push({resolve:e,reject:n})).then(e=>e?{value:e,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new e8(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function nY(e){return JSON.stringify(e)}class nQ extends nX{static fromReadableStream(e){let t=new nQ(null);return t._run(()=>t._fromReadableStream(e)),t}static runFunctions(e,t,n){let r=new nQ(null),s={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return r._run(()=>r._runFunctions(e,t,s)),r}static runTools(e,t,n){let r=new nQ(t),s={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runTools"}};return r._run(()=>r._runTools(e,t,s)),r}}class n0 extends tK{parse(e,t){return!function(e){for(let t of e??[]){if("function"!==t.type)throw new C(`Currently only \`function\` tool types support auto-parsing; Received \`${t.type}\``);if(!0!==t.function.strict)throw new C(`The \`${t.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t?.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(t=>nL(t,e))}runFunctions(e,t){return e.stream?nQ.runFunctions(this._client,e,t):nq.runFunctions(this._client,e,t)}runTools(e,t){return e.stream?nQ.runTools(this._client,e,t):nq.runTools(this._client,e,t)}stream(e,t){return nX.createChatCompletion(this._client,e,t)}}class n1 extends tK{constructor(){super(...arguments),this.completions=new n0(this._client)}}(n1||(n1={})).Completions=n0;class n2 extends tK{create(e,t){return this._client.post("/realtime/sessions",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}}class n6 extends tK{create(e,t){return this._client.post("/realtime/transcription_sessions",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}}class n3 extends tK{constructor(){super(...arguments),this.sessions=new n2(this._client),this.transcriptionSessions=new n6(this._client)}}n3.Sessions=n2,n3.TranscriptionSessions=n6;var n4=function(e,t,n,r){if("a"===n&&!r)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},n5=function(e,t,n,r,s){if("m"===r)throw TypeError("Private method is not writable");if("a"===r&&!s)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n};class n8 extends nM{constructor(){super(...arguments),eI.add(this),eE.set(this,[]),eT.set(this,{}),ez.set(this,{}),eC.set(this,void 0),ej.set(this,void 0),eN.set(this,void 0),eO.set(this,void 0),eP.set(this,void 0),eR.set(this,void 0),eM.set(this,void 0),eU.set(this,void 0),e$.set(this,void 0)}[(eE=new WeakMap,eT=new WeakMap,ez=new WeakMap,eC=new WeakMap,ej=new WeakMap,eN=new WeakMap,eO=new WeakMap,eP=new WeakMap,eR=new WeakMap,eM=new WeakMap,eU=new WeakMap,e$=new WeakMap,eI=new WeakSet,Symbol.asyncIterator)](){let e=[],t=[],n=!1;return this.on("event",n=>{let r=t.shift();r?r.resolve(n):e.push(n)}),this.on("end",()=>{for(let e of(n=!0,t))e.resolve(void 0);t.length=0}),this.on("abort",e=>{for(let r of(n=!0,t))r.reject(e);t.length=0}),this.on("error",e=>{for(let r of(n=!0,t))r.reject(e);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((e,n)=>t.push({resolve:e,reject:n})).then(e=>e?{value:e,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){let t=new n8;return t._run(()=>t._fromReadableStream(e)),t}async _fromReadableStream(e,t){let n=t?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),this._connected();let r=e8.fromReadableStream(e,this.controller);for await(let e of r)n4(this,eI,"m",eL).call(this,e);if(r.controller.signal?.aborted)throw new N;return this._addRun(n4(this,eI,"m",eF).call(this))}toReadableStream(){return new e8(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,t,n,r,s){let i=new n8;return i._run(()=>i._runToolAssistantStream(e,t,n,r,{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}})),i}async _createToolAssistantStream(e,t,n,r,s){let i=s?.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));let o={...r,stream:!0},a=await e.submitToolOutputs(t,n,o,{...s,signal:this.controller.signal});for await(let e of(this._connected(),a))n4(this,eI,"m",eL).call(this,e);if(a.controller.signal?.aborted)throw new N;return this._addRun(n4(this,eI,"m",eF).call(this))}static createThreadAssistantStream(e,t,n){let r=new n8;return r._run(()=>r._threadAssistantStream(e,t,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}})),r}static createAssistantStream(e,t,n,r){let s=new n8;return s._run(()=>s._runAssistantStream(e,t,n,{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}})),s}currentEvent(){return n4(this,eM,"f")}currentRun(){return n4(this,eU,"f")}currentMessageSnapshot(){return n4(this,eC,"f")}currentRunStepSnapshot(){return n4(this,e$,"f")}async finalRunSteps(){return await this.done(),Object.values(n4(this,eT,"f"))}async finalMessages(){return await this.done(),Object.values(n4(this,ez,"f"))}async finalRun(){if(await this.done(),!n4(this,ej,"f"))throw Error("Final run was not received.");return n4(this,ej,"f")}async _createThreadAssistantStream(e,t,n){let r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort()));let s={...t,stream:!0},i=await e.createAndRun(s,{...n,signal:this.controller.signal});for await(let e of(this._connected(),i))n4(this,eI,"m",eL).call(this,e);if(i.controller.signal?.aborted)throw new N;return this._addRun(n4(this,eI,"m",eF).call(this))}async _createAssistantStream(e,t,n,r){let s=r?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));let i={...n,stream:!0},o=await e.create(t,i,{...r,signal:this.controller.signal});for await(let e of(this._connected(),o))n4(this,eI,"m",eL).call(this,e);if(o.controller.signal?.aborted)throw new N;return this._addRun(n4(this,eI,"m",eF).call(this))}static accumulateDelta(e,t){for(let[n,r]of Object.entries(t)){if(!e.hasOwnProperty(n)){e[n]=r;continue}let t=e[n];if(null==t||"index"===n||"type"===n){e[n]=r;continue}if("string"==typeof t&&"string"==typeof r)t+=r;else if("number"==typeof t&&"number"==typeof r)t+=r;else if(tJ(t)&&tJ(r))t=this.accumulateDelta(t,r);else if(Array.isArray(t)&&Array.isArray(r)){if(t.every(e=>"string"==typeof e||"number"==typeof e)){t.push(...r);continue}for(let e of r){if(!tJ(e))throw Error(`Expected array delta entry to be an object but got: ${e}`);let n=e.index;if(null==n)throw console.error(e),Error("Expected array delta entry to have an `index` property");if("number"!=typeof n)throw Error(`Expected array delta entry \`index\` property to be a number but got ${n}`);let r=t[n];null==r?t.push(e):t[n]=this.accumulateDelta(r,e)}continue}else throw Error(`Unhandled record type: ${n}, deltaValue: ${r}, accValue: ${t}`);e[n]=t}return e}_addRun(e){return e}async _threadAssistantStream(e,t,n){return await this._createThreadAssistantStream(t,e,n)}async _runAssistantStream(e,t,n,r){return await this._createAssistantStream(t,e,n,r)}async _runToolAssistantStream(e,t,n,r,s){return await this._createToolAssistantStream(n,e,t,r,s)}}eL=function(e){if(!this.ended)switch(n5(this,eM,e,"f"),n4(this,eI,"m",eq).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":n4(this,eI,"m",eG).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":n4(this,eI,"m",eD).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":n4(this,eI,"m",eB).call(this,e);break;case"error":throw Error("Encountered an error event in event processing - errors should be processed earlier")}},eF=function(){if(this.ended)throw new C("stream has ended, this shouldn't happen");if(!n4(this,ej,"f"))throw Error("Final run has not been received");return n4(this,ej,"f")},eB=function(e){let[t,n]=n4(this,eI,"m",eW).call(this,e,n4(this,eC,"f"));for(let e of(n5(this,eC,t,"f"),n4(this,ez,"f")[t.id]=t,n)){let n=t.content[e.index];n?.type=="text"&&this._emit("textCreated",n.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(let n of e.data.delta.content){if("text"==n.type&&n.text){let e=n.text,r=t.content[n.index];if(r&&"text"==r.type)this._emit("textDelta",e,r.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(n.index!=n4(this,eN,"f")){if(n4(this,eO,"f"))switch(n4(this,eO,"f").type){case"text":this._emit("textDone",n4(this,eO,"f").text,n4(this,eC,"f"));break;case"image_file":this._emit("imageFileDone",n4(this,eO,"f").image_file,n4(this,eC,"f"))}n5(this,eN,n.index,"f")}n5(this,eO,t.content[n.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(void 0!==n4(this,eN,"f")){let t=e.data.content[n4(this,eN,"f")];if(t)switch(t.type){case"image_file":this._emit("imageFileDone",t.image_file,n4(this,eC,"f"));break;case"text":this._emit("textDone",t.text,n4(this,eC,"f"))}}n4(this,eC,"f")&&this._emit("messageDone",e.data),n5(this,eC,void 0,"f")}},eD=function(e){let t=n4(this,eI,"m",eV).call(this,e);switch(n5(this,e$,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":let n=e.data.delta;if(n.step_details&&"tool_calls"==n.step_details.type&&n.step_details.tool_calls&&"tool_calls"==t.step_details.type)for(let e of n.step_details.tool_calls)e.index==n4(this,eP,"f")?this._emit("toolCallDelta",e,t.step_details.tool_calls[e.index]):(n4(this,eR,"f")&&this._emit("toolCallDone",n4(this,eR,"f")),n5(this,eP,e.index,"f"),n5(this,eR,t.step_details.tool_calls[e.index],"f"),n4(this,eR,"f")&&this._emit("toolCallCreated",n4(this,eR,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":n5(this,e$,void 0,"f"),"tool_calls"==e.data.step_details.type&&n4(this,eR,"f")&&(this._emit("toolCallDone",n4(this,eR,"f")),n5(this,eR,void 0,"f")),this._emit("runStepDone",e.data,t)}},eq=function(e){n4(this,eE,"f").push(e),this._emit("event",e)},eV=function(e){switch(e.event){case"thread.run.step.created":return n4(this,eT,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=n4(this,eT,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let n=e.data;if(n.delta){let r=n8.accumulateDelta(t,n.delta);n4(this,eT,"f")[e.data.id]=r}return n4(this,eT,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":n4(this,eT,"f")[e.data.id]=e.data}if(n4(this,eT,"f")[e.data.id])return n4(this,eT,"f")[e.data.id];throw Error("No snapshot available")},eW=function(e,t){let n=[];switch(e.event){case"thread.message.created":return[e.data,n];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let r=e.data;if(r.delta.content)for(let e of r.delta.content)if(e.index in t.content){let n=t.content[e.index];t.content[e.index]=n4(this,eI,"m",eH).call(this,e,n)}else t.content[e.index]=e,n.push(e);return[t,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},eH=function(e,t){return n8.accumulateDelta(t,e)},eG=function(e){switch(n5(this,eU,e.data,"f"),e.event){case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":n5(this,ej,e.data,"f"),n4(this,eR,"f")&&(this._emit("toolCallDone",n4(this,eR,"f")),n5(this,eR,void 0,"f"))}};class n9 extends tK{create(e,t,n){return this._client.post(`/threads/${e}/messages`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}retrieve(e,t,n){return this._client.get(`/threads/${e}/messages/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}update(e,t,n,r){return this._client.post(`/threads/${e}/messages/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}list(e,t={},n){return tE(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/messages`,n7,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}del(e,t,n){return this._client.delete(`/threads/${e}/messages/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}}class n7 extends t0{}n9.MessagesPage=n7;class re extends tK{retrieve(e,t,n,r={},s){return tE(r)?this.retrieve(e,t,n,{},r):this._client.get(`/threads/${e}/runs/${t}/steps/${n}`,{query:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}list(e,t,n={},r){return tE(n)?this.list(e,t,{},n):this._client.getAPIList(`/threads/${e}/runs/${t}/steps`,rt,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}}class rt extends t0{}re.RunStepsPage=rt;class rn extends tK{constructor(){super(...arguments),this.steps=new re(this._client)}create(e,t,n){let{include:r,...s}=t;return this._client.post(`/threads/${e}/runs`,{query:{include:r},body:s,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers},stream:t.stream??!1})}retrieve(e,t,n){return this._client.get(`/threads/${e}/runs/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}update(e,t,n,r){return this._client.post(`/threads/${e}/runs/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}list(e,t={},n){return tE(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/runs`,rr,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}cancel(e,t,n){return this._client.post(`/threads/${e}/runs/${t}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}async createAndPoll(e,t,n){let r=await this.create(e,t,n);return await this.poll(e,r.id,n)}createAndStream(e,t,n){return n8.createAssistantStream(e,this._client.beta.threads.runs,t,n)}async poll(e,t,n){let r={...n?.headers,"X-Stainless-Poll-Helper":"true"};for(n?.pollIntervalMs&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){let{data:s,response:i}=await this.retrieve(e,t,{...n,headers:{...n?.headers,...r}}).withResponse();switch(s.status){case"queued":case"in_progress":case"cancelling":let o=5e3;if(n?.pollIntervalMs)o=n.pollIntervalMs;else{let e=i.headers.get("openai-poll-after-ms");if(e){let t=parseInt(e);isNaN(t)||(o=t)}}await tR(o);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return s}}}stream(e,t,n){return n8.createAssistantStream(e,this._client.beta.threads.runs,t,n)}submitToolOutputs(e,t,n,r){return this._client.post(`/threads/${e}/runs/${t}/submit_tool_outputs`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers},stream:n.stream??!1})}async submitToolOutputsAndPoll(e,t,n,r){let s=await this.submitToolOutputs(e,t,n,r);return await this.poll(e,s.id,r)}submitToolOutputsStream(e,t,n,r){return n8.createToolAssistantStream(e,t,this._client.beta.threads.runs,n,r)}}class rr extends t0{}rn.RunsPage=rr,rn.Steps=re,rn.RunStepsPage=rt;class rs extends tK{constructor(){super(...arguments),this.runs=new rn(this._client),this.messages=new n9(this._client)}create(e={},t){return tE(e)?this.create({},e):this._client.post("/threads",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,n){return this._client.post(`/threads/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}del(e,t){return this._client.delete(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers},stream:e.stream??!1})}async createAndRunPoll(e,t){let n=await this.createAndRun(e,t);return await this.runs.poll(n.thread_id,n.id,t)}createAndRunStream(e,t){return n8.createThreadAssistantStream(e,this._client.beta.threads,t)}}rs.Runs=rn,rs.RunsPage=rr,rs.Messages=n9,rs.MessagesPage=n7;class ri extends tK{constructor(){super(...arguments),this.realtime=new n3(this._client),this.chat=new n1(this._client),this.assistants=new nT(this._client),this.threads=new rs(this._client)}}ri.Realtime=n3,ri.Assistants=nT,ri.AssistantsPage=nz,ri.Threads=rs;class ro extends tK{create(e,t){return this._client.post("/batches",{body:e,...t})}retrieve(e,t){return this._client.get(`/batches/${e}`,t)}list(e={},t){return tE(e)?this.list({},e):this._client.getAPIList("/batches",ra,{query:e,...t})}cancel(e,t){return this._client.post(`/batches/${e}/cancel`,t)}}class ra extends t0{}ro.BatchesPage=ra;class rl extends tK{create(e,t,n){return this._client.post(`/uploads/${e}/parts`,td({body:t,...n}))}}class ru extends tK{constructor(){super(...arguments),this.parts=new rl(this._client)}create(e,t){return this._client.post("/uploads",{body:e,...t})}cancel(e,t){return this._client.post(`/uploads/${e}/cancel`,t)}complete(e,t,n){return this._client.post(`/uploads/${e}/complete`,{body:t,...n})}}function rc(e,t){let n=e.output.map(e=>{if("function_call"===e.type)return{...e,parsed_arguments:function(e,t){var n,r;let s=(n=e.tools??[],r=t.name,n.find(e=>"function"===e.type&&e.name===r));return{...t,...t,parsed_arguments:s?.$brand==="auto-parseable-tool"?s.$parseRaw(t.arguments):s?.strict?JSON.parse(t.arguments):null}}(t,e)};if("message"===e.type){let n=e.content.map(e=>{var n;return"output_text"===e.type?{...e,parsed:(n=e.text,t.text?.format?.type!=="json_schema"?null:"$parseRaw"in t.text?.format?(t.text?.format).$parseRaw(n):JSON.parse(n))}:e});return{...e,content:n}}return e}),r=Object.assign({},e,{output:n});return Object.getOwnPropertyDescriptor(e,"output_text")||rd(r),Object.defineProperty(r,"output_parsed",{enumerable:!0,get(){for(let e of r.output)if("message"===e.type){for(let t of e.content)if("output_text"===t.type&&null!==t.parsed)return t.parsed}return null}}),r}function rd(e){let t=[];for(let n of e.output)if("message"===n.type)for(let e of n.content)"output_text"===e.type&&t.push(e.text);e.output_text=t.join("")}ru.Parts=rl;class rh extends tK{list(e,t={},n){return tE(t)?this.list(e,{},t):this._client.getAPIList(`/responses/${e}/input_items`,ry,{query:t,...n})}}var rf=function(e,t,n,r,s){if("m"===r)throw TypeError("Private method is not writable");if("a"===r&&!s)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n},rp=function(e,t,n,r){if("a"===n&&!r)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};class rm extends nM{constructor(e){super(),eZ.add(this),eJ.set(this,void 0),eK.set(this,void 0),eX.set(this,void 0),rf(this,eJ,e,"f")}static createResponse(e,t,n){let r=new rm(t);return r._run(()=>r._createOrRetrieveResponse(e,t,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}})),r}async _createOrRetrieveResponse(e,t,n){let r;let s=n?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),rp(this,eZ,"m",eY).call(this);let i=null;for await(let s of("response_id"in t?(r=await e.responses.retrieve(t.response_id,{stream:!0},{...n,signal:this.controller.signal,stream:!0}),i=t.starting_after??null):r=await e.responses.create({...t,stream:!0},{...n,signal:this.controller.signal}),this._connected(),r))rp(this,eZ,"m",eQ).call(this,s,i);if(r.controller.signal?.aborted)throw new N;return rp(this,eZ,"m",e0).call(this)}[(eJ=new WeakMap,eK=new WeakMap,eX=new WeakMap,eZ=new WeakSet,eY=function(){this.ended||rf(this,eK,void 0,"f")},eQ=function(e,t){if(this.ended)return;let n=(e,n)=>{(null==t||n.sequence_number>t)&&this._emit(e,n)},r=rp(this,eZ,"m",e1).call(this,e);switch(n("event",e),e.type){case"response.output_text.delta":{let t=r.output[e.output_index];if(!t)throw new C(`missing output at index ${e.output_index}`);if("message"===t.type){let r=t.content[e.content_index];if(!r)throw new C(`missing content at index ${e.content_index}`);if("output_text"!==r.type)throw new C(`expected content to be 'output_text', got ${r.type}`);n("response.output_text.delta",{...e,snapshot:r.text})}break}case"response.function_call_arguments.delta":{let t=r.output[e.output_index];if(!t)throw new C(`missing output at index ${e.output_index}`);"function_call"===t.type&&n("response.function_call_arguments.delta",{...e,snapshot:t.arguments});break}default:n(e.type,e)}},e0=function(){if(this.ended)throw new C("stream has ended, this shouldn't happen");let e=rp(this,eK,"f");if(!e)throw new C("request ended without sending any events");rf(this,eK,void 0,"f");let t=function(e,t){return t&&nU(t.text?.format)?rc(e,t):{...e,output_parsed:null,output:e.output.map(e=>"function_call"===e.type?{...e,parsed_arguments:null}:"message"===e.type?{...e,content:e.content.map(e=>({...e,parsed:null}))}:e)}}(e,rp(this,eJ,"f"));return rf(this,eX,t,"f"),t},e1=function(e){let t=rp(this,eK,"f");if(!t){if("response.created"!==e.type)throw new C(`When snapshot hasn't been set yet, expected 'response.created' event, got ${e.type}`);return rf(this,eK,e.response,"f")}switch(e.type){case"response.output_item.added":t.output.push(e.item);break;case"response.content_part.added":{let n=t.output[e.output_index];if(!n)throw new C(`missing output at index ${e.output_index}`);"message"===n.type&&n.content.push(e.part);break}case"response.output_text.delta":{let n=t.output[e.output_index];if(!n)throw new C(`missing output at index ${e.output_index}`);if("message"===n.type){let t=n.content[e.content_index];if(!t)throw new C(`missing content at index ${e.content_index}`);if("output_text"!==t.type)throw new C(`expected content to be 'output_text', got ${t.type}`);t.text+=e.delta}break}case"response.function_call_arguments.delta":{let n=t.output[e.output_index];if(!n)throw new C(`missing output at index ${e.output_index}`);"function_call"===n.type&&(n.arguments+=e.delta);break}case"response.completed":rf(this,eK,e.response,"f")}return t},Symbol.asyncIterator)](){let e=[],t=[],n=!1;return this.on("event",n=>{let r=t.shift();r?r.resolve(n):e.push(n)}),this.on("end",()=>{for(let e of(n=!0,t))e.resolve(void 0);t.length=0}),this.on("abort",e=>{for(let r of(n=!0,t))r.reject(e);t.length=0}),this.on("error",e=>{for(let r of(n=!0,t))r.reject(e);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((e,n)=>t.push({resolve:e,reject:n})).then(e=>e?{value:e,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();let e=rp(this,eX,"f");if(!e)throw new C("stream ended without producing a ChatCompletion");return e}}class rg extends tK{constructor(){super(...arguments),this.inputItems=new rh(this._client)}create(e,t){return this._client.post("/responses",{body:e,...t,stream:e.stream??!1})._thenUnwrap(e=>("object"in e&&"response"===e.object&&rd(e),e))}retrieve(e,t={},n){return this._client.get(`/responses/${e}`,{query:t,...n,stream:t?.stream??!1})}del(e,t){return this._client.delete(`/responses/${e}`,{...t,headers:{Accept:"*/*",...t?.headers}})}parse(e,t){return this._client.responses.create(e,t)._thenUnwrap(t=>rc(t,e))}stream(e,t){return rm.createResponse(this._client,e,t)}cancel(e,t){return this._client.post(`/responses/${e}/cancel`,{...t,headers:{Accept:"*/*",...t?.headers}})}}class ry extends t0{}rg.InputItems=rh;class rb extends tK{retrieve(e,t,n,r){return this._client.get(`/evals/${e}/runs/${t}/output_items/${n}`,r)}list(e,t,n={},r){return tE(n)?this.list(e,t,{},n):this._client.getAPIList(`/evals/${e}/runs/${t}/output_items`,rv,{query:n,...r})}}class rv extends t0{}rb.OutputItemListResponsesPage=rv;class r_ extends tK{constructor(){super(...arguments),this.outputItems=new rb(this._client)}create(e,t,n){return this._client.post(`/evals/${e}/runs`,{body:t,...n})}retrieve(e,t,n){return this._client.get(`/evals/${e}/runs/${t}`,n)}list(e,t={},n){return tE(t)?this.list(e,{},t):this._client.getAPIList(`/evals/${e}/runs`,rw,{query:t,...n})}del(e,t,n){return this._client.delete(`/evals/${e}/runs/${t}`,n)}cancel(e,t,n){return this._client.post(`/evals/${e}/runs/${t}`,n)}}class rw extends t0{}r_.RunListResponsesPage=rw,r_.OutputItems=rb,r_.OutputItemListResponsesPage=rv;class rx extends tK{constructor(){super(...arguments),this.runs=new r_(this._client)}create(e,t){return this._client.post("/evals",{body:e,...t})}retrieve(e,t){return this._client.get(`/evals/${e}`,t)}update(e,t,n){return this._client.post(`/evals/${e}`,{body:t,...n})}list(e={},t){return tE(e)?this.list({},e):this._client.getAPIList("/evals",rk,{query:e,...t})}del(e,t){return this._client.delete(`/evals/${e}`,t)}}class rk extends t0{}rx.EvalListResponsesPage=rk,rx.Runs=r_,rx.RunListResponsesPage=rw;class rS extends tK{retrieve(e,t,n){return this._client.get(`/containers/${e}/files/${t}/content`,{...n,headers:{Accept:"application/binary",...n?.headers},__binaryResponse:!0})}}class rA extends tK{constructor(){super(...arguments),this.content=new rS(this._client)}create(e,t,n){return this._client.post(`/containers/${e}/files`,td({body:t,...n}))}retrieve(e,t,n){return this._client.get(`/containers/${e}/files/${t}`,n)}list(e,t={},n){return tE(t)?this.list(e,{},t):this._client.getAPIList(`/containers/${e}/files`,rI,{query:t,...n})}del(e,t,n){return this._client.delete(`/containers/${e}/files/${t}`,{...n,headers:{Accept:"*/*",...n?.headers}})}}class rI extends t0{}rA.FileListResponsesPage=rI,rA.Content=rS;class rE extends tK{constructor(){super(...arguments),this.files=new rA(this._client)}create(e,t){return this._client.post("/containers",{body:e,...t})}retrieve(e,t){return this._client.get(`/containers/${e}`,t)}list(e={},t){return tE(e)?this.list({},e):this._client.getAPIList("/containers",rT,{query:e,...t})}del(e,t){return this._client.delete(`/containers/${e}`,{...t,headers:{Accept:"*/*",...t?.headers}})}}class rT extends t0{}rE.ContainerListResponsesPage=rT,rE.Files=rA,rE.FileListResponsesPage=rI,n(3656);class rz extends tx{constructor({baseURL:e=t$("OPENAI_BASE_URL"),apiKey:t=t$("OPENAI_API_KEY"),organization:n=t$("OPENAI_ORG_ID")??null,project:r=t$("OPENAI_PROJECT_ID")??null,...s}={}){if(void 0===t)throw new C("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");let i={apiKey:t,organization:n,project:r,...s,baseURL:e||"https://api.openai.com/v1"};if(!i.dangerouslyAllowBrowser&&tW())throw new C("It looks like you're running in a browser-like environment.\n\nThis is disabled by default, as it risks exposing your secret API credentials to attackers.\nIf you understand the risks and have appropriate mitigations in place,\nyou can set the `dangerouslyAllowBrowser` option to `true`, e.g.,\n\nnew OpenAI({ apiKey, dangerouslyAllowBrowser: true });\n\nhttps://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety\n");super({baseURL:i.baseURL,timeout:i.timeout??6e5,httpAgent:i.httpAgent,maxRetries:i.maxRetries,fetch:i.fetch}),this.completions=new tX(this),this.chat=new t3(this),this.embeddings=new t4(this),this.files=new t5(this),this.images=new t9(this),this.audio=new nn(this),this.moderations=new nr(this),this.models=new ns(this),this.fineTuning=new ny(this),this.graders=new nv(this),this.vectorStores=new nA(this),this.beta=new ri(this),this.batches=new ro(this),this.uploads=new ru(this),this.responses=new rg(this),this.evals=new rx(this),this.containers=new rE(this),this._options=i,this.apiKey=t,this.organization=n,this.project=r}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return function(e,t={}){let n,r=e,s=function(e=S){let t;if(void 0!==e.allowEmptyArrays&&"boolean"!=typeof e.allowEmptyArrays)throw TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(void 0!==e.encodeDotInKeys&&"boolean"!=typeof e.encodeDotInKeys)throw TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(null!==e.encoder&&void 0!==e.encoder&&"function"!=typeof e.encoder)throw TypeError("Encoder has to be a function.");let n=e.charset||S.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let r=f;if(void 0!==e.format){if(!b.call(p,e.format))throw TypeError("Unknown format option provided.");r=e.format}let s=p[r],i=S.filter;if(("function"==typeof e.filter||_(e.filter))&&(i=e.filter),t=e.arrayFormat&&e.arrayFormat in v?e.arrayFormat:"indices"in e?e.indices?"indices":"repeat":S.arrayFormat,"commaRoundTrip"in e&&"boolean"!=typeof e.commaRoundTrip)throw TypeError("`commaRoundTrip` must be a boolean, or absent");let o=void 0===e.allowDots?!0==!!e.encodeDotInKeys||S.allowDots:!!e.allowDots;return{addQueryPrefix:"boolean"==typeof e.addQueryPrefix?e.addQueryPrefix:S.addQueryPrefix,allowDots:o,allowEmptyArrays:"boolean"==typeof e.allowEmptyArrays?!!e.allowEmptyArrays:S.allowEmptyArrays,arrayFormat:t,charset:n,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:S.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:void 0===e.delimiter?S.delimiter:e.delimiter,encode:"boolean"==typeof e.encode?e.encode:S.encode,encodeDotInKeys:"boolean"==typeof e.encodeDotInKeys?e.encodeDotInKeys:S.encodeDotInKeys,encoder:"function"==typeof e.encoder?e.encoder:S.encoder,encodeValuesOnly:"boolean"==typeof e.encodeValuesOnly?e.encodeValuesOnly:S.encodeValuesOnly,filter:i,format:r,formatter:s,serializeDate:"function"==typeof e.serializeDate?e.serializeDate:S.serializeDate,skipNulls:"boolean"==typeof e.skipNulls?e.skipNulls:S.skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:S.strictNullHandling}}(t);"function"==typeof s.filter?r=(0,s.filter)("",r):_(s.filter)&&(n=s.filter);let i=[];if("object"!=typeof r||null===r)return"";let o=v[s.arrayFormat],a="comma"===o&&s.commaRoundTrip;n||(n=Object.keys(r)),s.sort&&n.sort(s.sort);let l=new WeakMap;for(let e=0;e<n.length;++e){let t=n[e];s.skipNulls&&null===r[t]||x(i,function e(t,n,r,s,i,o,a,l,u,c,d,h,f,p,m,g,b,v){var w,k;let I,E=t,T=v,z=0,C=!1;for(;void 0!==(T=T.get(A))&&!C;){let e=T.get(t);if(z+=1,void 0!==e){if(e===z)throw RangeError("Cyclic object value");C=!0}void 0===T.get(A)&&(z=0)}if("function"==typeof c?E=c(n,E):E instanceof Date?E=f?.(E):"comma"===r&&_(E)&&(E=y(E,function(e){return e instanceof Date?f?.(e):e})),null===E){if(o)return u&&!g?u(n,S.encoder,b,"key",p):n;E=""}if("string"==typeof(w=E)||"number"==typeof w||"boolean"==typeof w||"symbol"==typeof w||"bigint"==typeof w||(k=E)&&"object"==typeof k&&k.constructor&&k.constructor.isBuffer&&k.constructor.isBuffer(k)){if(u){let e=g?n:u(n,S.encoder,b,"key",p);return[m?.(e)+"="+m?.(u(E,S.encoder,b,"value",p))]}return[m?.(n)+"="+m?.(String(E))]}let j=[];if(void 0===E)return j;if("comma"===r&&_(E))g&&u&&(E=y(E,u)),I=[{value:E.length>0?E.join(",")||null:void 0}];else if(_(c))I=c;else{let e=Object.keys(E);I=d?e.sort(d):e}let N=l?String(n).replace(/\./g,"%2E"):String(n),O=s&&_(E)&&1===E.length?N+"[]":N;if(i&&_(E)&&0===E.length)return O+"[]";for(let n=0;n<I.length;++n){let y=I[n],w="object"==typeof y&&void 0!==y.value?y.value:E[y];if(a&&null===w)continue;let k=h&&l?y.replace(/\./g,"%2E"):y,S=_(E)?"function"==typeof r?r(O,k):O:O+(h?"."+k:"["+k+"]");v.set(t,z);let T=new WeakMap;T.set(A,v),x(j,e(w,S,r,s,i,o,a,l,"comma"===r&&g&&_(E)?null:u,c,d,h,f,p,m,g,b,T))}return j}(r[t],t,o,a,s.allowEmptyArrays,s.strictNullHandling,s.skipNulls,s.encodeDotInKeys,s.encode?s.encoder:null,s.filter,s.sort,s.allowDots,s.serializeDate,s.format,s.formatter,s.encodeValuesOnly,s.charset,l))}let u=i.join(s.delimiter),c=!0===s.addQueryPrefix?"?":"";return s.charsetSentinel&&("iso-8859-1"===s.charset?c+="utf8=%26%2310003%3B&":c+="utf8=%E2%9C%93&"),u.length>0?c+u:""}(e,{arrayFormat:"brackets"})}}rz.OpenAI=rz,rz.DEFAULT_TIMEOUT=6e5,rz.OpenAIError=C,rz.APIError=j,rz.APIConnectionError=O,rz.APIConnectionTimeoutError=P,rz.APIUserAbortError=N,rz.NotFoundError=$,rz.ConflictError=L,rz.RateLimitError=B,rz.BadRequestError=R,rz.AuthenticationError=M,rz.InternalServerError=D,rz.PermissionDeniedError=U,rz.UnprocessableEntityError=F,rz.toFile=to,rz.fileFromPath=d,rz.Completions=tX,rz.Chat=t3,rz.ChatCompletionsPage=t2,rz.Embeddings=t4,rz.Files=t5,rz.FileObjectsPage=t8,rz.Images=t9,rz.Audio=nn,rz.Moderations=nr,rz.Models=ns,rz.ModelsPage=ni,rz.FineTuning=ny,rz.Graders=nv,rz.VectorStores=nA,rz.VectorStoresPage=nI,rz.VectorStoreSearchResponsesPage=nE,rz.Beta=ri,rz.Batches=ro,rz.BatchesPage=ra,rz.Uploads=ru,rz.Responses=rg,rz.Evals=rx,rz.EvalListResponsesPage=rk,rz.Containers=rE,rz.ContainerListResponsesPage=rT;var rC=rz},858:function(e,t,n){"use strict";let r;n.d(t,{z:function(){return d}});var s,i,o,a,l,u,c,d={};n.r(d),n.d(d,{BRAND:function(){return eR},DIRTY:function(){return I},EMPTY_PATH:function(){return x},INVALID:function(){return A},NEVER:function(){return ty},OK:function(){return E},ParseStatus:function(){return S},Schema:function(){return R},ZodAny:function(){return el},ZodArray:function(){return eh},ZodBigInt:function(){return en},ZodBoolean:function(){return er},ZodBranded:function(){return eM},ZodCatch:function(){return eO},ZodDate:function(){return es},ZodDefault:function(){return eN},ZodDiscriminatedUnion:function(){return eg},ZodEffects:function(){return ez},ZodEnum:function(){return eI},ZodError:function(){return g},ZodFirstPartyTypeKind:function(){return c},ZodFunction:function(){return ex},ZodIntersection:function(){return ey},ZodIssueCode:function(){return p},ZodLazy:function(){return ek},ZodLiteral:function(){return eS},ZodMap:function(){return e_},ZodNaN:function(){return eP},ZodNativeEnum:function(){return eE},ZodNever:function(){return ec},ZodNull:function(){return ea},ZodNullable:function(){return ej},ZodNumber:function(){return et},ZodObject:function(){return ef},ZodOptional:function(){return eC},ZodParsedType:function(){return h},ZodPipeline:function(){return eU},ZodPromise:function(){return eT},ZodReadonly:function(){return e$},ZodRecord:function(){return ev},ZodSchema:function(){return R},ZodSet:function(){return ew},ZodString:function(){return ee},ZodSymbol:function(){return ei},ZodTransformer:function(){return ez},ZodTuple:function(){return eb},ZodType:function(){return R},ZodUndefined:function(){return eo},ZodUnion:function(){return ep},ZodUnknown:function(){return eu},ZodVoid:function(){return ed},addIssueToContext:function(){return k},any:function(){return eY},array:function(){return e2},bigint:function(){return eH},boolean:function(){return eG},coerce:function(){return tg},custom:function(){return eF},date:function(){return eZ},datetimeRegex:function(){return Q},defaultErrorMap:function(){return y},discriminatedUnion:function(){return e5},effect:function(){return tl},enum:function(){return ti},function:function(){return tn},getErrorMap:function(){return _},getParsedType:function(){return f},instanceof:function(){return eD},intersection:function(){return e8},isAborted:function(){return T},isAsync:function(){return j},isDirty:function(){return z},isValid:function(){return C},late:function(){return eB},lazy:function(){return tr},literal:function(){return ts},makeIssue:function(){return w},map:function(){return te},nan:function(){return eW},nativeEnum:function(){return to},never:function(){return e0},null:function(){return eX},nullable:function(){return tc},number:function(){return eV},object:function(){return e6},objectUtil:function(){return l},oboolean:function(){return tm},onumber:function(){return tp},optional:function(){return tu},ostring:function(){return tf},pipeline:function(){return th},preprocess:function(){return td},promise:function(){return ta},quotelessJson:function(){return m},record:function(){return e7},set:function(){return tt},setErrorMap:function(){return v},strictObject:function(){return e3},string:function(){return eq},symbol:function(){return eJ},transformer:function(){return tl},tuple:function(){return e9},undefined:function(){return eK},union:function(){return e4},unknown:function(){return eQ},util:function(){return a},void:function(){return e1}}),(s=a||(a={})).assertEqual=e=>{},s.assertIs=function(e){},s.assertNever=function(e){throw Error()},s.arrayToEnum=e=>{let t={};for(let n of e)t[n]=n;return t},s.getValidEnumValues=e=>{let t=s.objectKeys(e).filter(t=>"number"!=typeof e[e[t]]),n={};for(let r of t)n[r]=e[r];return s.objectValues(n)},s.objectValues=e=>s.objectKeys(e).map(function(t){return e[t]}),s.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{let t=[];for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t},s.find=(e,t)=>{for(let n of e)if(t(n))return n},s.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&Number.isFinite(e)&&Math.floor(e)===e,s.joinValues=function(e,t=" | "){return e.map(e=>"string"==typeof e?`'${e}'`:e).join(t)},s.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t,(l||(l={})).mergeShapes=(e,t)=>({...e,...t});let h=a.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),f=e=>{switch(typeof e){case"undefined":return h.undefined;case"string":return h.string;case"number":return Number.isNaN(e)?h.nan:h.number;case"boolean":return h.boolean;case"function":return h.function;case"bigint":return h.bigint;case"symbol":return h.symbol;case"object":if(Array.isArray(e))return h.array;if(null===e)return h.null;if(e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch)return h.promise;if("undefined"!=typeof Map&&e instanceof Map)return h.map;if("undefined"!=typeof Set&&e instanceof Set)return h.set;if("undefined"!=typeof Date&&e instanceof Date)return h.date;return h.object;default:return h.unknown}},p=a.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),m=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:");class g extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};let t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){let t=e||function(e){return e.message},n={_errors:[]},r=e=>{for(let s of e.issues)if("invalid_union"===s.code)s.unionErrors.map(r);else if("invalid_return_type"===s.code)r(s.returnTypeError);else if("invalid_arguments"===s.code)r(s.argumentsError);else if(0===s.path.length)n._errors.push(t(s));else{let e=n,r=0;for(;r<s.path.length;){let n=s.path[r];r===s.path.length-1?(e[n]=e[n]||{_errors:[]},e[n]._errors.push(t(s))):e[n]=e[n]||{_errors:[]},e=e[n],r++}}};return r(this),n}static assert(e){if(!(e instanceof g))throw Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,a.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=e=>e.message){let t={},n=[];for(let r of this.issues)r.path.length>0?(t[r.path[0]]=t[r.path[0]]||[],t[r.path[0]].push(e(r))):n.push(e(r));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}}g.create=e=>new g(e);var y=(e,t)=>{let n;switch(e.code){case p.invalid_type:n=e.received===h.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case p.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,a.jsonStringifyReplacer)}`;break;case p.unrecognized_keys:n=`Unrecognized key(s) in object: ${a.joinValues(e.keys,", ")}`;break;case p.invalid_union:n="Invalid input";break;case p.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${a.joinValues(e.options)}`;break;case p.invalid_enum_value:n=`Invalid enum value. Expected ${a.joinValues(e.options)}, received '${e.received}'`;break;case p.invalid_arguments:n="Invalid function arguments";break;case p.invalid_return_type:n="Invalid function return type";break;case p.invalid_date:n="Invalid date";break;case p.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:a.assertNever(e.validation):n="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case p.too_small:n="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case p.too_big:n="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case p.custom:n="Invalid input";break;case p.invalid_intersection_types:n="Intersection results could not be merged";break;case p.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case p.not_finite:n="Number must be finite";break;default:n=t.defaultError,a.assertNever(e)}return{message:n}};let b=y;function v(e){b=e}function _(){return b}let w=e=>{let{data:t,path:n,errorMaps:r,issueData:s}=e,i=[...n,...s.path||[]],o={...s,path:i};if(void 0!==s.message)return{...s,path:i,message:s.message};let a="";for(let e of r.filter(e=>!!e).slice().reverse())a=e(o,{data:t,defaultError:a}).message;return{...s,path:i,message:a}},x=[];function k(e,t){let n=b,r=w({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===y?void 0:y].filter(e=>!!e)});e.common.issues.push(r)}class S{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){let n=[];for(let r of t){if("aborted"===r.status)return A;"dirty"===r.status&&e.dirty(),n.push(r.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){let n=[];for(let e of t){let t=await e.key,r=await e.value;n.push({key:t,value:r})}return S.mergeObjectSync(e,n)}static mergeObjectSync(e,t){let n={};for(let r of t){let{key:t,value:s}=r;if("aborted"===t.status||"aborted"===s.status)return A;"dirty"===t.status&&e.dirty(),"dirty"===s.status&&e.dirty(),"__proto__"!==t.value&&(void 0!==s.value||r.alwaysSet)&&(n[t.value]=s.value)}return{status:e.value,value:n}}}let A=Object.freeze({status:"aborted"}),I=e=>({status:"dirty",value:e}),E=e=>({status:"valid",value:e}),T=e=>"aborted"===e.status,z=e=>"dirty"===e.status,C=e=>"valid"===e.status,j=e=>"undefined"!=typeof Promise&&e instanceof Promise;(i=u||(u={})).errToObj=e=>"string"==typeof e?{message:e}:e||{},i.toString=e=>"string"==typeof e?e:e?.message;class N{constructor(e,t,n,r){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=r}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}let O=(e,t)=>{if(C(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let t=new g(e.common.issues);return this._error=t,this._error}}};function P(e){if(!e)return{};let{errorMap:t,invalid_type_error:n,required_error:r,description:s}=e;if(t&&(n||r))throw Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return t?{errorMap:t,description:s}:{errorMap:(t,s)=>{let{message:i}=e;return"invalid_enum_value"===t.code?{message:i??s.defaultError}:void 0===s.data?{message:i??r??s.defaultError}:"invalid_type"!==t.code?{message:s.defaultError}:{message:i??n??s.defaultError}},description:s}}class R{get description(){return this._def.description}_getType(e){return f(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:f(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new S,ctx:{common:e.parent.common,data:e.data,parsedType:f(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let t=this._parse(e);if(j(t))throw Error("Synchronous parse encountered promise.");return t}_parseAsync(e){return Promise.resolve(this._parse(e))}parse(e,t){let n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){let n={common:{issues:[],async:t?.async??!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:f(e)},r=this._parseSync({data:e,path:n.path,parent:n});return O(n,r)}"~validate"(e){let t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:f(e)};if(!this["~standard"].async)try{let n=this._parseSync({data:e,path:[],parent:t});return C(n)?{value:n.value}:{issues:t.common.issues}}catch(e){e?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(e=>C(e)?{value:e.value}:{issues:t.common.issues})}async parseAsync(e,t){let n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){let n={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:f(e)},r=this._parse({data:e,path:n.path,parent:n});return O(n,await (j(r)?r:Promise.resolve(r)))}refine(e,t){let n=e=>"string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(e):t;return this._refinement((t,r)=>{let s=e(t),i=()=>r.addIssue({code:p.custom,...n(t)});return"undefined"!=typeof Promise&&s instanceof Promise?s.then(e=>!!e||(i(),!1)):!!s||(i(),!1)})}refinement(e,t){return this._refinement((n,r)=>!!e(n)||(r.addIssue("function"==typeof t?t(n,r):t),!1))}_refinement(e){return new ez({schema:this,typeName:c.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:e=>this["~validate"](e)}}optional(){return eC.create(this,this._def)}nullable(){return ej.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return eh.create(this)}promise(){return eT.create(this,this._def)}or(e){return ep.create([this,e],this._def)}and(e){return ey.create(this,e,this._def)}transform(e){return new ez({...P(this._def),schema:this,typeName:c.ZodEffects,effect:{type:"transform",transform:e}})}default(e){return new eN({...P(this._def),innerType:this,defaultValue:"function"==typeof e?e:()=>e,typeName:c.ZodDefault})}brand(){return new eM({typeName:c.ZodBranded,type:this,...P(this._def)})}catch(e){return new eO({...P(this._def),innerType:this,catchValue:"function"==typeof e?e:()=>e,typeName:c.ZodCatch})}describe(e){return new this.constructor({...this._def,description:e})}pipe(e){return eU.create(this,e)}readonly(){return e$.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}let M=/^c[^\s-]{8,}$/i,U=/^[0-9a-z]+$/,$=/^[0-9A-HJKMNP-TV-Z]{26}$/i,L=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,F=/^[a-z0-9_-]{21}$/i,B=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,D=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,q=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,V=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,W=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,H=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,G=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Z=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,J=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,K="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",X=RegExp(`^${K}$`);function Y(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:null==e.precision&&(t=`${t}(\\.\\d+)?`);let n=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${n}`}function Q(e){let t=`${K}T${Y(e)}`,n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,RegExp(`^${t}$`)}class ee extends R{_parse(e){var t,n,s,i;let o;if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==h.string){let t=this._getOrReturnCtx(e);return k(t,{code:p.invalid_type,expected:h.string,received:t.parsedType}),A}let l=new S;for(let u of this._def.checks)if("min"===u.kind)e.data.length<u.value&&(k(o=this._getOrReturnCtx(e,o),{code:p.too_small,minimum:u.value,type:"string",inclusive:!0,exact:!1,message:u.message}),l.dirty());else if("max"===u.kind)e.data.length>u.value&&(k(o=this._getOrReturnCtx(e,o),{code:p.too_big,maximum:u.value,type:"string",inclusive:!0,exact:!1,message:u.message}),l.dirty());else if("length"===u.kind){let t=e.data.length>u.value,n=e.data.length<u.value;(t||n)&&(o=this._getOrReturnCtx(e,o),t?k(o,{code:p.too_big,maximum:u.value,type:"string",inclusive:!0,exact:!0,message:u.message}):n&&k(o,{code:p.too_small,minimum:u.value,type:"string",inclusive:!0,exact:!0,message:u.message}),l.dirty())}else if("email"===u.kind)q.test(e.data)||(k(o=this._getOrReturnCtx(e,o),{validation:"email",code:p.invalid_string,message:u.message}),l.dirty());else if("emoji"===u.kind)r||(r=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),r.test(e.data)||(k(o=this._getOrReturnCtx(e,o),{validation:"emoji",code:p.invalid_string,message:u.message}),l.dirty());else if("uuid"===u.kind)L.test(e.data)||(k(o=this._getOrReturnCtx(e,o),{validation:"uuid",code:p.invalid_string,message:u.message}),l.dirty());else if("nanoid"===u.kind)F.test(e.data)||(k(o=this._getOrReturnCtx(e,o),{validation:"nanoid",code:p.invalid_string,message:u.message}),l.dirty());else if("cuid"===u.kind)M.test(e.data)||(k(o=this._getOrReturnCtx(e,o),{validation:"cuid",code:p.invalid_string,message:u.message}),l.dirty());else if("cuid2"===u.kind)U.test(e.data)||(k(o=this._getOrReturnCtx(e,o),{validation:"cuid2",code:p.invalid_string,message:u.message}),l.dirty());else if("ulid"===u.kind)$.test(e.data)||(k(o=this._getOrReturnCtx(e,o),{validation:"ulid",code:p.invalid_string,message:u.message}),l.dirty());else if("url"===u.kind)try{new URL(e.data)}catch{k(o=this._getOrReturnCtx(e,o),{validation:"url",code:p.invalid_string,message:u.message}),l.dirty()}else"regex"===u.kind?(u.regex.lastIndex=0,u.regex.test(e.data)||(k(o=this._getOrReturnCtx(e,o),{validation:"regex",code:p.invalid_string,message:u.message}),l.dirty())):"trim"===u.kind?e.data=e.data.trim():"includes"===u.kind?e.data.includes(u.value,u.position)||(k(o=this._getOrReturnCtx(e,o),{code:p.invalid_string,validation:{includes:u.value,position:u.position},message:u.message}),l.dirty()):"toLowerCase"===u.kind?e.data=e.data.toLowerCase():"toUpperCase"===u.kind?e.data=e.data.toUpperCase():"startsWith"===u.kind?e.data.startsWith(u.value)||(k(o=this._getOrReturnCtx(e,o),{code:p.invalid_string,validation:{startsWith:u.value},message:u.message}),l.dirty()):"endsWith"===u.kind?e.data.endsWith(u.value)||(k(o=this._getOrReturnCtx(e,o),{code:p.invalid_string,validation:{endsWith:u.value},message:u.message}),l.dirty()):"datetime"===u.kind?Q(u).test(e.data)||(k(o=this._getOrReturnCtx(e,o),{code:p.invalid_string,validation:"datetime",message:u.message}),l.dirty()):"date"===u.kind?X.test(e.data)||(k(o=this._getOrReturnCtx(e,o),{code:p.invalid_string,validation:"date",message:u.message}),l.dirty()):"time"===u.kind?RegExp(`^${Y(u)}$`).test(e.data)||(k(o=this._getOrReturnCtx(e,o),{code:p.invalid_string,validation:"time",message:u.message}),l.dirty()):"duration"===u.kind?D.test(e.data)||(k(o=this._getOrReturnCtx(e,o),{validation:"duration",code:p.invalid_string,message:u.message}),l.dirty()):"ip"===u.kind?(t=e.data,("v4"===(n=u.version)||!n)&&V.test(t)||("v6"===n||!n)&&H.test(t)||(k(o=this._getOrReturnCtx(e,o),{validation:"ip",code:p.invalid_string,message:u.message}),l.dirty())):"jwt"===u.kind?!function(e,t){if(!B.test(e))return!1;try{let[n]=e.split("."),r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),s=JSON.parse(atob(r));if("object"!=typeof s||null===s||"typ"in s&&s?.typ!=="JWT"||!s.alg||t&&s.alg!==t)return!1;return!0}catch{return!1}}(e.data,u.alg)&&(k(o=this._getOrReturnCtx(e,o),{validation:"jwt",code:p.invalid_string,message:u.message}),l.dirty()):"cidr"===u.kind?(s=e.data,("v4"===(i=u.version)||!i)&&W.test(s)||("v6"===i||!i)&&G.test(s)||(k(o=this._getOrReturnCtx(e,o),{validation:"cidr",code:p.invalid_string,message:u.message}),l.dirty())):"base64"===u.kind?Z.test(e.data)||(k(o=this._getOrReturnCtx(e,o),{validation:"base64",code:p.invalid_string,message:u.message}),l.dirty()):"base64url"===u.kind?J.test(e.data)||(k(o=this._getOrReturnCtx(e,o),{validation:"base64url",code:p.invalid_string,message:u.message}),l.dirty()):a.assertNever(u);return{status:l.value,value:e.data}}_regex(e,t,n){return this.refinement(t=>e.test(t),{validation:t,code:p.invalid_string,...u.errToObj(n)})}_addCheck(e){return new ee({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...u.errToObj(e)})}url(e){return this._addCheck({kind:"url",...u.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...u.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...u.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...u.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...u.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...u.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...u.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...u.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...u.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...u.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...u.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...u.errToObj(e)})}datetime(e){return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===e?.precision?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...u.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return"string"==typeof e?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:void 0===e?.precision?null:e?.precision,...u.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...u.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...u.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...u.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...u.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...u.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...u.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...u.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...u.errToObj(t)})}nonempty(e){return this.min(1,u.errToObj(e))}trim(){return new ee({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new ee({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new ee({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>"datetime"===e.kind)}get isDate(){return!!this._def.checks.find(e=>"date"===e.kind)}get isTime(){return!!this._def.checks.find(e=>"time"===e.kind)}get isDuration(){return!!this._def.checks.find(e=>"duration"===e.kind)}get isEmail(){return!!this._def.checks.find(e=>"email"===e.kind)}get isURL(){return!!this._def.checks.find(e=>"url"===e.kind)}get isEmoji(){return!!this._def.checks.find(e=>"emoji"===e.kind)}get isUUID(){return!!this._def.checks.find(e=>"uuid"===e.kind)}get isNANOID(){return!!this._def.checks.find(e=>"nanoid"===e.kind)}get isCUID(){return!!this._def.checks.find(e=>"cuid"===e.kind)}get isCUID2(){return!!this._def.checks.find(e=>"cuid2"===e.kind)}get isULID(){return!!this._def.checks.find(e=>"ulid"===e.kind)}get isIP(){return!!this._def.checks.find(e=>"ip"===e.kind)}get isCIDR(){return!!this._def.checks.find(e=>"cidr"===e.kind)}get isBase64(){return!!this._def.checks.find(e=>"base64"===e.kind)}get isBase64url(){return!!this._def.checks.find(e=>"base64url"===e.kind)}get minLength(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}ee.create=e=>new ee({checks:[],typeName:c.ZodString,coerce:e?.coerce??!1,...P(e)});class et extends R{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){let t;if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==h.number){let t=this._getOrReturnCtx(e);return k(t,{code:p.invalid_type,expected:h.number,received:t.parsedType}),A}let n=new S;for(let r of this._def.checks)"int"===r.kind?a.isInteger(e.data)||(k(t=this._getOrReturnCtx(e,t),{code:p.invalid_type,expected:"integer",received:"float",message:r.message}),n.dirty()):"min"===r.kind?(r.inclusive?e.data<r.value:e.data<=r.value)&&(k(t=this._getOrReturnCtx(e,t),{code:p.too_small,minimum:r.value,type:"number",inclusive:r.inclusive,exact:!1,message:r.message}),n.dirty()):"max"===r.kind?(r.inclusive?e.data>r.value:e.data>=r.value)&&(k(t=this._getOrReturnCtx(e,t),{code:p.too_big,maximum:r.value,type:"number",inclusive:r.inclusive,exact:!1,message:r.message}),n.dirty()):"multipleOf"===r.kind?0!==function(e,t){let n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,s=n>r?n:r;return Number.parseInt(e.toFixed(s).replace(".",""))%Number.parseInt(t.toFixed(s).replace(".",""))/10**s}(e.data,r.value)&&(k(t=this._getOrReturnCtx(e,t),{code:p.not_multiple_of,multipleOf:r.value,message:r.message}),n.dirty()):"finite"===r.kind?Number.isFinite(e.data)||(k(t=this._getOrReturnCtx(e,t),{code:p.not_finite,message:r.message}),n.dirty()):a.assertNever(r);return{status:n.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,u.toString(t))}gt(e,t){return this.setLimit("min",e,!1,u.toString(t))}lte(e,t){return this.setLimit("max",e,!0,u.toString(t))}lt(e,t){return this.setLimit("max",e,!1,u.toString(t))}setLimit(e,t,n,r){return new et({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:u.toString(r)}]})}_addCheck(e){return new et({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:u.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:u.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:u.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:u.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:u.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:u.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:u.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:u.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:u.toString(e)})}get minValue(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>"int"===e.kind||"multipleOf"===e.kind&&a.isInteger(e.value))}get isFinite(){let e=null,t=null;for(let n of this._def.checks){if("finite"===n.kind||"int"===n.kind||"multipleOf"===n.kind)return!0;"min"===n.kind?(null===t||n.value>t)&&(t=n.value):"max"===n.kind&&(null===e||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}}et.create=e=>new et({checks:[],typeName:c.ZodNumber,coerce:e?.coerce||!1,...P(e)});class en extends R{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){let t;if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==h.bigint)return this._getInvalidInput(e);let n=new S;for(let r of this._def.checks)"min"===r.kind?(r.inclusive?e.data<r.value:e.data<=r.value)&&(k(t=this._getOrReturnCtx(e,t),{code:p.too_small,type:"bigint",minimum:r.value,inclusive:r.inclusive,message:r.message}),n.dirty()):"max"===r.kind?(r.inclusive?e.data>r.value:e.data>=r.value)&&(k(t=this._getOrReturnCtx(e,t),{code:p.too_big,type:"bigint",maximum:r.value,inclusive:r.inclusive,message:r.message}),n.dirty()):"multipleOf"===r.kind?e.data%r.value!==BigInt(0)&&(k(t=this._getOrReturnCtx(e,t),{code:p.not_multiple_of,multipleOf:r.value,message:r.message}),n.dirty()):a.assertNever(r);return{status:n.value,value:e.data}}_getInvalidInput(e){let t=this._getOrReturnCtx(e);return k(t,{code:p.invalid_type,expected:h.bigint,received:t.parsedType}),A}gte(e,t){return this.setLimit("min",e,!0,u.toString(t))}gt(e,t){return this.setLimit("min",e,!1,u.toString(t))}lte(e,t){return this.setLimit("max",e,!0,u.toString(t))}lt(e,t){return this.setLimit("max",e,!1,u.toString(t))}setLimit(e,t,n,r){return new en({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:u.toString(r)}]})}_addCheck(e){return new en({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:u.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:u.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:u.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:u.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:u.toString(t)})}get minValue(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}en.create=e=>new en({checks:[],typeName:c.ZodBigInt,coerce:e?.coerce??!1,...P(e)});class er extends R{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==h.boolean){let t=this._getOrReturnCtx(e);return k(t,{code:p.invalid_type,expected:h.boolean,received:t.parsedType}),A}return E(e.data)}}er.create=e=>new er({typeName:c.ZodBoolean,coerce:e?.coerce||!1,...P(e)});class es extends R{_parse(e){let t;if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==h.date){let t=this._getOrReturnCtx(e);return k(t,{code:p.invalid_type,expected:h.date,received:t.parsedType}),A}if(Number.isNaN(e.data.getTime()))return k(this._getOrReturnCtx(e),{code:p.invalid_date}),A;let n=new S;for(let r of this._def.checks)"min"===r.kind?e.data.getTime()<r.value&&(k(t=this._getOrReturnCtx(e,t),{code:p.too_small,message:r.message,inclusive:!0,exact:!1,minimum:r.value,type:"date"}),n.dirty()):"max"===r.kind?e.data.getTime()>r.value&&(k(t=this._getOrReturnCtx(e,t),{code:p.too_big,message:r.message,inclusive:!0,exact:!1,maximum:r.value,type:"date"}),n.dirty()):a.assertNever(r);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new es({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:u.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:u.toString(t)})}get minDate(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}es.create=e=>new es({checks:[],coerce:e?.coerce||!1,typeName:c.ZodDate,...P(e)});class ei extends R{_parse(e){if(this._getType(e)!==h.symbol){let t=this._getOrReturnCtx(e);return k(t,{code:p.invalid_type,expected:h.symbol,received:t.parsedType}),A}return E(e.data)}}ei.create=e=>new ei({typeName:c.ZodSymbol,...P(e)});class eo extends R{_parse(e){if(this._getType(e)!==h.undefined){let t=this._getOrReturnCtx(e);return k(t,{code:p.invalid_type,expected:h.undefined,received:t.parsedType}),A}return E(e.data)}}eo.create=e=>new eo({typeName:c.ZodUndefined,...P(e)});class ea extends R{_parse(e){if(this._getType(e)!==h.null){let t=this._getOrReturnCtx(e);return k(t,{code:p.invalid_type,expected:h.null,received:t.parsedType}),A}return E(e.data)}}ea.create=e=>new ea({typeName:c.ZodNull,...P(e)});class el extends R{constructor(){super(...arguments),this._any=!0}_parse(e){return E(e.data)}}el.create=e=>new el({typeName:c.ZodAny,...P(e)});class eu extends R{constructor(){super(...arguments),this._unknown=!0}_parse(e){return E(e.data)}}eu.create=e=>new eu({typeName:c.ZodUnknown,...P(e)});class ec extends R{_parse(e){let t=this._getOrReturnCtx(e);return k(t,{code:p.invalid_type,expected:h.never,received:t.parsedType}),A}}ec.create=e=>new ec({typeName:c.ZodNever,...P(e)});class ed extends R{_parse(e){if(this._getType(e)!==h.undefined){let t=this._getOrReturnCtx(e);return k(t,{code:p.invalid_type,expected:h.void,received:t.parsedType}),A}return E(e.data)}}ed.create=e=>new ed({typeName:c.ZodVoid,...P(e)});class eh extends R{_parse(e){let{ctx:t,status:n}=this._processInputParams(e),r=this._def;if(t.parsedType!==h.array)return k(t,{code:p.invalid_type,expected:h.array,received:t.parsedType}),A;if(null!==r.exactLength){let e=t.data.length>r.exactLength.value,s=t.data.length<r.exactLength.value;(e||s)&&(k(t,{code:e?p.too_big:p.too_small,minimum:s?r.exactLength.value:void 0,maximum:e?r.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:r.exactLength.message}),n.dirty())}if(null!==r.minLength&&t.data.length<r.minLength.value&&(k(t,{code:p.too_small,minimum:r.minLength.value,type:"array",inclusive:!0,exact:!1,message:r.minLength.message}),n.dirty()),null!==r.maxLength&&t.data.length>r.maxLength.value&&(k(t,{code:p.too_big,maximum:r.maxLength.value,type:"array",inclusive:!0,exact:!1,message:r.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map((e,n)=>r.type._parseAsync(new N(t,e,t.path,n)))).then(e=>S.mergeArray(n,e));let s=[...t.data].map((e,n)=>r.type._parseSync(new N(t,e,t.path,n)));return S.mergeArray(n,s)}get element(){return this._def.type}min(e,t){return new eh({...this._def,minLength:{value:e,message:u.toString(t)}})}max(e,t){return new eh({...this._def,maxLength:{value:e,message:u.toString(t)}})}length(e,t){return new eh({...this._def,exactLength:{value:e,message:u.toString(t)}})}nonempty(e){return this.min(1,e)}}eh.create=(e,t)=>new eh({type:e,minLength:null,maxLength:null,exactLength:null,typeName:c.ZodArray,...P(t)});class ef extends R{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;let e=this._def.shape(),t=a.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==h.object){let t=this._getOrReturnCtx(e);return k(t,{code:p.invalid_type,expected:h.object,received:t.parsedType}),A}let{status:t,ctx:n}=this._processInputParams(e),{shape:r,keys:s}=this._getCached(),i=[];if(!(this._def.catchall instanceof ec&&"strip"===this._def.unknownKeys))for(let e in n.data)s.includes(e)||i.push(e);let o=[];for(let e of s){let t=r[e],s=n.data[e];o.push({key:{status:"valid",value:e},value:t._parse(new N(n,s,n.path,e)),alwaysSet:e in n.data})}if(this._def.catchall instanceof ec){let e=this._def.unknownKeys;if("passthrough"===e)for(let e of i)o.push({key:{status:"valid",value:e},value:{status:"valid",value:n.data[e]}});else if("strict"===e)i.length>0&&(k(n,{code:p.unrecognized_keys,keys:i}),t.dirty());else if("strip"===e);else throw Error("Internal ZodObject error: invalid unknownKeys value.")}else{let e=this._def.catchall;for(let t of i){let r=n.data[t];o.push({key:{status:"valid",value:t},value:e._parse(new N(n,r,n.path,t)),alwaysSet:t in n.data})}}return n.common.async?Promise.resolve().then(async()=>{let e=[];for(let t of o){let n=await t.key,r=await t.value;e.push({key:n,value:r,alwaysSet:t.alwaysSet})}return e}).then(e=>S.mergeObjectSync(t,e)):S.mergeObjectSync(t,o)}get shape(){return this._def.shape()}strict(e){return u.errToObj,new ef({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,n)=>{let r=this._def.errorMap?.(t,n).message??n.defaultError;return"unrecognized_keys"===t.code?{message:u.errToObj(e).message??r}:{message:r}}}:{}})}strip(){return new ef({...this._def,unknownKeys:"strip"})}passthrough(){return new ef({...this._def,unknownKeys:"passthrough"})}extend(e){return new ef({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new ef({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:c.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new ef({...this._def,catchall:e})}pick(e){let t={};for(let n of a.objectKeys(e))e[n]&&this.shape[n]&&(t[n]=this.shape[n]);return new ef({...this._def,shape:()=>t})}omit(e){let t={};for(let n of a.objectKeys(this.shape))e[n]||(t[n]=this.shape[n]);return new ef({...this._def,shape:()=>t})}deepPartial(){return function e(t){if(t instanceof ef){let n={};for(let r in t.shape){let s=t.shape[r];n[r]=eC.create(e(s))}return new ef({...t._def,shape:()=>n})}return t instanceof eh?new eh({...t._def,type:e(t.element)}):t instanceof eC?eC.create(e(t.unwrap())):t instanceof ej?ej.create(e(t.unwrap())):t instanceof eb?eb.create(t.items.map(t=>e(t))):t}(this)}partial(e){let t={};for(let n of a.objectKeys(this.shape)){let r=this.shape[n];e&&!e[n]?t[n]=r:t[n]=r.optional()}return new ef({...this._def,shape:()=>t})}required(e){let t={};for(let n of a.objectKeys(this.shape))if(e&&!e[n])t[n]=this.shape[n];else{let e=this.shape[n];for(;e instanceof eC;)e=e._def.innerType;t[n]=e}return new ef({...this._def,shape:()=>t})}keyof(){return eA(a.objectKeys(this.shape))}}ef.create=(e,t)=>new ef({shape:()=>e,unknownKeys:"strip",catchall:ec.create(),typeName:c.ZodObject,...P(t)}),ef.strictCreate=(e,t)=>new ef({shape:()=>e,unknownKeys:"strict",catchall:ec.create(),typeName:c.ZodObject,...P(t)}),ef.lazycreate=(e,t)=>new ef({shape:e,unknownKeys:"strip",catchall:ec.create(),typeName:c.ZodObject,...P(t)});class ep extends R{_parse(e){let{ctx:t}=this._processInputParams(e),n=this._def.options;if(t.common.async)return Promise.all(n.map(async e=>{let n={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:n}),ctx:n}})).then(function(e){for(let t of e)if("valid"===t.result.status)return t.result;for(let n of e)if("dirty"===n.result.status)return t.common.issues.push(...n.ctx.common.issues),n.result;let n=e.map(e=>new g(e.ctx.common.issues));return k(t,{code:p.invalid_union,unionErrors:n}),A});{let e;let r=[];for(let s of n){let n={...t,common:{...t.common,issues:[]},parent:null},i=s._parseSync({data:t.data,path:t.path,parent:n});if("valid"===i.status)return i;"dirty"!==i.status||e||(e={result:i,ctx:n}),n.common.issues.length&&r.push(n.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;let s=r.map(e=>new g(e));return k(t,{code:p.invalid_union,unionErrors:s}),A}}get options(){return this._def.options}}ep.create=(e,t)=>new ep({options:e,typeName:c.ZodUnion,...P(t)});let em=e=>{if(e instanceof ek)return em(e.schema);if(e instanceof ez)return em(e.innerType());if(e instanceof eS)return[e.value];if(e instanceof eI)return e.options;if(e instanceof eE)return a.objectValues(e.enum);if(e instanceof eN)return em(e._def.innerType);if(e instanceof eo)return[void 0];else if(e instanceof ea)return[null];else if(e instanceof eC)return[void 0,...em(e.unwrap())];else if(e instanceof ej)return[null,...em(e.unwrap())];else if(e instanceof eM)return em(e.unwrap());else if(e instanceof e$)return em(e.unwrap());else if(e instanceof eO)return em(e._def.innerType);else return[]};class eg extends R{_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==h.object)return k(t,{code:p.invalid_type,expected:h.object,received:t.parsedType}),A;let n=this.discriminator,r=t.data[n],s=this.optionsMap.get(r);return s?t.common.async?s._parseAsync({data:t.data,path:t.path,parent:t}):s._parseSync({data:t.data,path:t.path,parent:t}):(k(t,{code:p.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),A)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,n){let r=new Map;for(let n of t){let t=em(n.shape[e]);if(!t.length)throw Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let s of t){if(r.has(s))throw Error(`Discriminator property ${String(e)} has duplicate value ${String(s)}`);r.set(s,n)}}return new eg({typeName:c.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:r,...P(n)})}}class ey extends R{_parse(e){let{status:t,ctx:n}=this._processInputParams(e),r=(e,r)=>{if(T(e)||T(r))return A;let s=function e(t,n){let r=f(t),s=f(n);if(t===n)return{valid:!0,data:t};if(r===h.object&&s===h.object){let r=a.objectKeys(n),s=a.objectKeys(t).filter(e=>-1!==r.indexOf(e)),i={...t,...n};for(let r of s){let s=e(t[r],n[r]);if(!s.valid)return{valid:!1};i[r]=s.data}return{valid:!0,data:i}}if(r===h.array&&s===h.array){if(t.length!==n.length)return{valid:!1};let r=[];for(let s=0;s<t.length;s++){let i=e(t[s],n[s]);if(!i.valid)return{valid:!1};r.push(i.data)}return{valid:!0,data:r}}return r===h.date&&s===h.date&&+t==+n?{valid:!0,data:t}:{valid:!1}}(e.value,r.value);return s.valid?((z(e)||z(r))&&t.dirty(),{status:t.value,value:s.data}):(k(n,{code:p.invalid_intersection_types}),A)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([e,t])=>r(e,t)):r(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}ey.create=(e,t,n)=>new ey({left:e,right:t,typeName:c.ZodIntersection,...P(n)});class eb extends R{_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==h.array)return k(n,{code:p.invalid_type,expected:h.array,received:n.parsedType}),A;if(n.data.length<this._def.items.length)return k(n,{code:p.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),A;!this._def.rest&&n.data.length>this._def.items.length&&(k(n,{code:p.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());let r=[...n.data].map((e,t)=>{let r=this._def.items[t]||this._def.rest;return r?r._parse(new N(n,e,n.path,t)):null}).filter(e=>!!e);return n.common.async?Promise.all(r).then(e=>S.mergeArray(t,e)):S.mergeArray(t,r)}get items(){return this._def.items}rest(e){return new eb({...this._def,rest:e})}}eb.create=(e,t)=>{if(!Array.isArray(e))throw Error("You must pass an array of schemas to z.tuple([ ... ])");return new eb({items:e,typeName:c.ZodTuple,rest:null,...P(t)})};class ev extends R{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==h.object)return k(n,{code:p.invalid_type,expected:h.object,received:n.parsedType}),A;let r=[],s=this._def.keyType,i=this._def.valueType;for(let e in n.data)r.push({key:s._parse(new N(n,e,n.path,e)),value:i._parse(new N(n,n.data[e],n.path,e)),alwaysSet:e in n.data});return n.common.async?S.mergeObjectAsync(t,r):S.mergeObjectSync(t,r)}get element(){return this._def.valueType}static create(e,t,n){return new ev(t instanceof R?{keyType:e,valueType:t,typeName:c.ZodRecord,...P(n)}:{keyType:ee.create(),valueType:e,typeName:c.ZodRecord,...P(t)})}}class e_ extends R{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==h.map)return k(n,{code:p.invalid_type,expected:h.map,received:n.parsedType}),A;let r=this._def.keyType,s=this._def.valueType,i=[...n.data.entries()].map(([e,t],i)=>({key:r._parse(new N(n,e,n.path,[i,"key"])),value:s._parse(new N(n,t,n.path,[i,"value"]))}));if(n.common.async){let e=new Map;return Promise.resolve().then(async()=>{for(let n of i){let r=await n.key,s=await n.value;if("aborted"===r.status||"aborted"===s.status)return A;("dirty"===r.status||"dirty"===s.status)&&t.dirty(),e.set(r.value,s.value)}return{status:t.value,value:e}})}{let e=new Map;for(let n of i){let r=n.key,s=n.value;if("aborted"===r.status||"aborted"===s.status)return A;("dirty"===r.status||"dirty"===s.status)&&t.dirty(),e.set(r.value,s.value)}return{status:t.value,value:e}}}}e_.create=(e,t,n)=>new e_({valueType:t,keyType:e,typeName:c.ZodMap,...P(n)});class ew extends R{_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==h.set)return k(n,{code:p.invalid_type,expected:h.set,received:n.parsedType}),A;let r=this._def;null!==r.minSize&&n.data.size<r.minSize.value&&(k(n,{code:p.too_small,minimum:r.minSize.value,type:"set",inclusive:!0,exact:!1,message:r.minSize.message}),t.dirty()),null!==r.maxSize&&n.data.size>r.maxSize.value&&(k(n,{code:p.too_big,maximum:r.maxSize.value,type:"set",inclusive:!0,exact:!1,message:r.maxSize.message}),t.dirty());let s=this._def.valueType;function i(e){let n=new Set;for(let r of e){if("aborted"===r.status)return A;"dirty"===r.status&&t.dirty(),n.add(r.value)}return{status:t.value,value:n}}let o=[...n.data.values()].map((e,t)=>s._parse(new N(n,e,n.path,t)));return n.common.async?Promise.all(o).then(e=>i(e)):i(o)}min(e,t){return new ew({...this._def,minSize:{value:e,message:u.toString(t)}})}max(e,t){return new ew({...this._def,maxSize:{value:e,message:u.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}ew.create=(e,t)=>new ew({valueType:e,minSize:null,maxSize:null,typeName:c.ZodSet,...P(t)});class ex extends R{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==h.function)return k(t,{code:p.invalid_type,expected:h.function,received:t.parsedType}),A;function n(e,n){return w({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,b,y].filter(e=>!!e),issueData:{code:p.invalid_arguments,argumentsError:n}})}function r(e,n){return w({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,b,y].filter(e=>!!e),issueData:{code:p.invalid_return_type,returnTypeError:n}})}let s={errorMap:t.common.contextualErrorMap},i=t.data;if(this._def.returns instanceof eT){let e=this;return E(async function(...t){let o=new g([]),a=await e._def.args.parseAsync(t,s).catch(e=>{throw o.addIssue(n(t,e)),o}),l=await Reflect.apply(i,this,a);return await e._def.returns._def.type.parseAsync(l,s).catch(e=>{throw o.addIssue(r(l,e)),o})})}{let e=this;return E(function(...t){let o=e._def.args.safeParse(t,s);if(!o.success)throw new g([n(t,o.error)]);let a=Reflect.apply(i,this,o.data),l=e._def.returns.safeParse(a,s);if(!l.success)throw new g([r(a,l.error)]);return l.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new ex({...this._def,args:eb.create(e).rest(eu.create())})}returns(e){return new ex({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,n){return new ex({args:e||eb.create([]).rest(eu.create()),returns:t||eu.create(),typeName:c.ZodFunction,...P(n)})}}class ek extends R{get schema(){return this._def.getter()}_parse(e){let{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}ek.create=(e,t)=>new ek({getter:e,typeName:c.ZodLazy,...P(t)});class eS extends R{_parse(e){if(e.data!==this._def.value){let t=this._getOrReturnCtx(e);return k(t,{received:t.data,code:p.invalid_literal,expected:this._def.value}),A}return{status:"valid",value:e.data}}get value(){return this._def.value}}function eA(e,t){return new eI({values:e,typeName:c.ZodEnum,...P(t)})}eS.create=(e,t)=>new eS({value:e,typeName:c.ZodLiteral,...P(t)});class eI extends R{_parse(e){if("string"!=typeof e.data){let t=this._getOrReturnCtx(e),n=this._def.values;return k(t,{expected:a.joinValues(n),received:t.parsedType,code:p.invalid_type}),A}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){let t=this._getOrReturnCtx(e),n=this._def.values;return k(t,{received:t.data,code:p.invalid_enum_value,options:n}),A}return E(e.data)}get options(){return this._def.values}get enum(){let e={};for(let t of this._def.values)e[t]=t;return e}get Values(){let e={};for(let t of this._def.values)e[t]=t;return e}get Enum(){let e={};for(let t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return eI.create(e,{...this._def,...t})}exclude(e,t=this._def){return eI.create(this.options.filter(t=>!e.includes(t)),{...this._def,...t})}}eI.create=eA;class eE extends R{_parse(e){let t=a.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==h.string&&n.parsedType!==h.number){let e=a.objectValues(t);return k(n,{expected:a.joinValues(e),received:n.parsedType,code:p.invalid_type}),A}if(this._cache||(this._cache=new Set(a.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){let e=a.objectValues(t);return k(n,{received:n.data,code:p.invalid_enum_value,options:e}),A}return E(e.data)}get enum(){return this._def.values}}eE.create=(e,t)=>new eE({values:e,typeName:c.ZodNativeEnum,...P(t)});class eT extends R{unwrap(){return this._def.type}_parse(e){let{ctx:t}=this._processInputParams(e);return t.parsedType!==h.promise&&!1===t.common.async?(k(t,{code:p.invalid_type,expected:h.promise,received:t.parsedType}),A):E((t.parsedType===h.promise?t.data:Promise.resolve(t.data)).then(e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap})))}}eT.create=(e,t)=>new eT({type:e,typeName:c.ZodPromise,...P(t)});class ez extends R{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===c.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:t,ctx:n}=this._processInputParams(e),r=this._def.effect||null,s={addIssue:e=>{k(n,e),e.fatal?t.abort():t.dirty()},get path(){return n.path}};if(s.addIssue=s.addIssue.bind(s),"preprocess"===r.type){let e=r.transform(n.data,s);if(n.common.async)return Promise.resolve(e).then(async e=>{if("aborted"===t.value)return A;let r=await this._def.schema._parseAsync({data:e,path:n.path,parent:n});return"aborted"===r.status?A:"dirty"===r.status||"dirty"===t.value?I(r.value):r});{if("aborted"===t.value)return A;let r=this._def.schema._parseSync({data:e,path:n.path,parent:n});return"aborted"===r.status?A:"dirty"===r.status||"dirty"===t.value?I(r.value):r}}if("refinement"===r.type){let e=e=>{let t=r.refinement(e,s);if(n.common.async)return Promise.resolve(t);if(t instanceof Promise)throw Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1!==n.common.async)return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(n=>"aborted"===n.status?A:("dirty"===n.status&&t.dirty(),e(n.value).then(()=>({status:t.value,value:n.value}))));{let r=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return"aborted"===r.status?A:("dirty"===r.status&&t.dirty(),e(r.value),{status:t.value,value:r.value})}}if("transform"===r.type){if(!1!==n.common.async)return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(e=>C(e)?Promise.resolve(r.transform(e.value,s)).then(e=>({status:t.value,value:e})):A);{let e=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!C(e))return A;let i=r.transform(e.value,s);if(i instanceof Promise)throw Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:i}}}a.assertNever(r)}}ez.create=(e,t,n)=>new ez({schema:e,typeName:c.ZodEffects,effect:t,...P(n)}),ez.createWithPreprocess=(e,t,n)=>new ez({schema:t,effect:{type:"preprocess",transform:e},typeName:c.ZodEffects,...P(n)});class eC extends R{_parse(e){return this._getType(e)===h.undefined?E(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}eC.create=(e,t)=>new eC({innerType:e,typeName:c.ZodOptional,...P(t)});class ej extends R{_parse(e){return this._getType(e)===h.null?E(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ej.create=(e,t)=>new ej({innerType:e,typeName:c.ZodNullable,...P(t)});class eN extends R{_parse(e){let{ctx:t}=this._processInputParams(e),n=t.data;return t.parsedType===h.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}eN.create=(e,t)=>new eN({innerType:e,typeName:c.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...P(t)});class eO extends R{_parse(e){let{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},r=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return j(r)?r.then(e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new g(n.common.issues)},input:n.data})})):{status:"valid",value:"valid"===r.status?r.value:this._def.catchValue({get error(){return new g(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}eO.create=(e,t)=>new eO({innerType:e,typeName:c.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...P(t)});class eP extends R{_parse(e){if(this._getType(e)!==h.nan){let t=this._getOrReturnCtx(e);return k(t,{code:p.invalid_type,expected:h.nan,received:t.parsedType}),A}return{status:"valid",value:e.data}}}eP.create=e=>new eP({typeName:c.ZodNaN,...P(e)});let eR=Symbol("zod_brand");class eM extends R{_parse(e){let{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}}class eU extends R{_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{let e=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return"aborted"===e.status?A:"dirty"===e.status?(t.dirty(),I(e.value)):this._def.out._parseAsync({data:e.value,path:n.path,parent:n})})();{let e=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return"aborted"===e.status?A:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:n.path,parent:n})}}static create(e,t){return new eU({in:e,out:t,typeName:c.ZodPipeline})}}class e$ extends R{_parse(e){let t=this._def.innerType._parse(e),n=e=>(C(e)&&(e.value=Object.freeze(e.value)),e);return j(t)?t.then(e=>n(e)):n(t)}unwrap(){return this._def.innerType}}function eL(e,t){let n="function"==typeof e?e(t):"string"==typeof e?{message:e}:e;return"string"==typeof n?{message:n}:n}function eF(e,t={},n){return e?el.create().superRefine((r,s)=>{let i=e(r);if(i instanceof Promise)return i.then(e=>{if(!e){let e=eL(t,r),i=e.fatal??n??!0;s.addIssue({code:"custom",...e,fatal:i})}});if(!i){let e=eL(t,r),i=e.fatal??n??!0;s.addIssue({code:"custom",...e,fatal:i})}}):el.create()}e$.create=(e,t)=>new e$({innerType:e,typeName:c.ZodReadonly,...P(t)});let eB={object:ef.lazycreate};(o=c||(c={})).ZodString="ZodString",o.ZodNumber="ZodNumber",o.ZodNaN="ZodNaN",o.ZodBigInt="ZodBigInt",o.ZodBoolean="ZodBoolean",o.ZodDate="ZodDate",o.ZodSymbol="ZodSymbol",o.ZodUndefined="ZodUndefined",o.ZodNull="ZodNull",o.ZodAny="ZodAny",o.ZodUnknown="ZodUnknown",o.ZodNever="ZodNever",o.ZodVoid="ZodVoid",o.ZodArray="ZodArray",o.ZodObject="ZodObject",o.ZodUnion="ZodUnion",o.ZodDiscriminatedUnion="ZodDiscriminatedUnion",o.ZodIntersection="ZodIntersection",o.ZodTuple="ZodTuple",o.ZodRecord="ZodRecord",o.ZodMap="ZodMap",o.ZodSet="ZodSet",o.ZodFunction="ZodFunction",o.ZodLazy="ZodLazy",o.ZodLiteral="ZodLiteral",o.ZodEnum="ZodEnum",o.ZodEffects="ZodEffects",o.ZodNativeEnum="ZodNativeEnum",o.ZodOptional="ZodOptional",o.ZodNullable="ZodNullable",o.ZodDefault="ZodDefault",o.ZodCatch="ZodCatch",o.ZodPromise="ZodPromise",o.ZodBranded="ZodBranded",o.ZodPipeline="ZodPipeline",o.ZodReadonly="ZodReadonly";let eD=(e,t={message:`Input not instance of ${e.name}`})=>eF(t=>t instanceof e,t),eq=ee.create,eV=et.create,eW=eP.create,eH=en.create,eG=er.create,eZ=es.create,eJ=ei.create,eK=eo.create,eX=ea.create,eY=el.create,eQ=eu.create,e0=ec.create,e1=ed.create,e2=eh.create,e6=ef.create,e3=ef.strictCreate,e4=ep.create,e5=eg.create,e8=ey.create,e9=eb.create,e7=ev.create,te=e_.create,tt=ew.create,tn=ex.create,tr=ek.create,ts=eS.create,ti=eI.create,to=eE.create,ta=eT.create,tl=ez.create,tu=eC.create,tc=ej.create,td=ez.createWithPreprocess,th=eU.create,tf=()=>eq().optional(),tp=()=>eV().optional(),tm=()=>eG().optional(),tg={string:e=>ee.create({...e,coerce:!0}),number:e=>et.create({...e,coerce:!0}),boolean:e=>er.create({...e,coerce:!0}),bigint:e=>en.create({...e,coerce:!0}),date:e=>es.create({...e,coerce:!0})},ty=A}}]);